Run started:2025-05-25 12:59:33.432260

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/pyproject_toml/__init__.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	                raise NotImplementedError(
97	                    "No PEP supports SPDX at 2021-03-07 when I write, see "
98	                    "https://www.python.org/dev/peps/pep-0621/#id88"
99	                )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
50	        super().__init__(*args, **kwargs)
51	        self.pool = futures.ProcessPoolExecutor(max_workers=1)
52	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
305	        # Change version.
306	        with open("VERSION", "wt", encoding="utf-8") as version_file:
307	            version_file.write("0.0.2")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
306	        with open("VERSION", "wt", encoding="utf-8") as version_file:
307	            version_file.write("0.0.2")
308	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
315	        # And if rebuilding the exact same sdist/wheel?
316	        open(os.path.join(dist_dir, second_result), "wb").close()
317	        third_result = build_method(dist_dir)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
324	            "pyproject.toml": DALS(
325	                """
326	                [build-system]
327	                requires = ["pyproject_toml"]
328	                build-backend = "pyproject_toml.build_system.build_backend"
329	
330	                [project]
331	                name = "foo"
332	                license = {text = "MIT"}
333	                description = "This is a Python package"
334	                dynamic = ["version", "readme"]
335	                classifiers = [
336	                    "Development Status :: 5 - Production/Stable",
337	                    "Intended Audience :: Developers"
338	                ]
339	                urls = {Homepage = "http://github.com"}
340	                dependencies = [
341	                    "appdirs",
342	                ]
343	
344	                [project.optional-dependencies]
345	                all = [
346	                    "tomli>=1",
347	                    "pyscaffold>=4,<5",
348	                    'importlib; python_version == "2.6"',
349	                ]
350	
351	                [project.scripts]
352	                foo = "foo.cli:main"
353	
354	                [tool.setuptools]
355	                zip-safe = false
356	                package-dir = {"" = "src"}
357	                packages = {find = {where = ["src"]}}
358	                license-files = ["LICENSE*"]
359	
360	                [tool.setuptools.dynamic]
361	                version = {attr = "foo.__version__"}
362	                readme = {file = "README.rst"}
363	
364	                [tool.distutils.sdist]
365	                formats = "gztar"
366	                """
367	            ),
368	            "MANIFEST.in": DALS(
369	                """

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
394	
395	        with tarfile.open(os.path.join(tmpdir, "temp", sdist_path)) as tar:
396	            sdist_contents = set(tar.getnames())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
399	            wheel_contents = set(zipfile.namelist())
400	            metadata = str(zipfile.read("foo-0.1.dist-info/METADATA"), "utf-8")
401	            license = str(zipfile.read("foo-0.1.dist-info/LICENSE.txt"), "utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
400	            metadata = str(zipfile.read("foo-0.1.dist-info/METADATA"), "utf-8")
401	            license = str(zipfile.read("foo-0.1.dist-info/LICENSE.txt"), "utf-8")
402	            epoints = str(zipfile.read("foo-0.1.dist-info/entry_points.txt"), "utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
401	            license = str(zipfile.read("foo-0.1.dist-info/LICENSE.txt"), "utf-8")
402	            epoints = str(zipfile.read("foo-0.1.dist-info/entry_points.txt"), "utf-8")
403	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
503	
504	        with tarfile.open(os.path.join(tmpdir, "temp", sdist_path)) as tar:
505	            pkg_info = str(tar.extractfile("foo-42/PKG-INFO").read(), "utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
504	        with tarfile.open(os.path.join(tmpdir, "temp", sdist_path)) as tar:
505	            pkg_info = str(tar.extractfile("foo-42/PKG-INFO").read(), "utf-8")
506	            members = tar.getnames()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
509	        with ZipFile(os.path.join(tmpdir, "temp", wheel_file)) as zipfile:
510	            metadata = str(zipfile.read("foo-42.dist-info/METADATA"), "utf-8")
511	            members = zipfile.namelist()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
572	
573	        with open(setup_loc, "rt", encoding="utf-8") as file_handler:
574	            content = file_handler.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
573	        with open(setup_loc, "rt", encoding="utf-8") as file_handler:
574	            content = file_handler.read()
575	        with open(setup_loc, "wt", encoding="utf-8") as file_handler:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
574	            content = file_handler.read()
575	        with open(setup_loc, "wt", encoding="utf-8") as file_handler:
576	            file_handler.write(content.replace("version='0.0.0'", "version='0.0.1'"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
575	        with open(setup_loc, "wt", encoding="utf-8") as file_handler:
576	            file_handler.write(content.replace("version='0.0.0'", "version='0.0.1'"))
577	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
577	
578	        shutil.rmtree(sdist_into_directory)
579	        os.makedirs(sdist_into_directory)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
605	        targz_path = build_backend.build_sdist("temp")
606	        with tarfile.open(os.path.join("temp", targz_path)) as tar:
607	            assert any("pyproject.toml" in name for name in tar.getnames())

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
615	        targz_path = build_backend.build_sdist("temp")
616	        with tarfile.open(os.path.join("temp", targz_path)) as tar:
617	            assert any("setup.py" in name for name in tar.getnames())

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pyproject_toml-0.1.0/pyproject_toml-0.1.0/tests/test_build_backend.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
641	        targz_path = build_backend.build_sdist("temp")
642	        with tarfile.open(os.path.join("temp", targz_path)) as tar:
643	            assert not any("setup.py" in name for name in tar.getnames())

--------------------------------------------------

Code scanned:
	Total lines of code: 997
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 0.0
Files skipped (0):
