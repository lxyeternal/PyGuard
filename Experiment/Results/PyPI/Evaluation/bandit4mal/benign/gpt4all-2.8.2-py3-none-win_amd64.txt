Run started:2025-05-25 12:37:54.353921

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
32	# Detect Rosetta 2
33	if platform.system() == "Darwin" and platform.processor() == "i386":
34	    if subprocess.run(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
32	# Detect Rosetta 2
33	if platform.system() == "Darwin" and platform.processor() == "i386":
34	    if subprocess.run(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
32	# Detect Rosetta 2
33	if platform.system() == "Darwin" and platform.processor() == "i386":
34	    if subprocess.run(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
43	def _load_cuda(rtver: str, blasver: str) -> None:
44	    if platform.system() == "Linux":
45	        cudalib   = f"lib/libcudart.so.{rtver}"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
43	def _load_cuda(rtver: str, blasver: str) -> None:
44	    if platform.system() == "Linux":
45	        cudalib   = f"lib/libcudart.so.{rtver}"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
43	def _load_cuda(rtver: str, blasver: str) -> None:
44	    if platform.system() == "Linux":
45	        cudalib   = f"lib/libcudart.so.{rtver}"

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
51	    # preload the CUDA libs so the backend can find them
52	    ctypes.CDLL(os.path.join(cuda_runtime.__path__[0], cudalib), mode=ctypes.RTLD_GLOBAL)
53	    ctypes.CDLL(os.path.join(cublas.__path__[0], cublaslib), mode=ctypes.RTLD_GLOBAL)

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
52	    ctypes.CDLL(os.path.join(cuda_runtime.__path__[0], cudalib), mode=ctypes.RTLD_GLOBAL)
53	    ctypes.CDLL(os.path.join(cublas.__path__[0], cublaslib), mode=ctypes.RTLD_GLOBAL)
54	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
57	cuda_found = False
58	if platform.system() in ("Linux", "Windows"):
59	    try:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
57	cuda_found = False
58	if platform.system() in ("Linux", "Windows"):
59	    try:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
57	cuda_found = False
58	if platform.system() in ("Linux", "Windows"):
59	    try:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
76	def load_llmodel_library():
77	    ext = {"Darwin": "dylib", "Linux": "so", "Windows": "dll"}[platform.system()]
78	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
76	def load_llmodel_library():
77	    ext = {"Darwin": "dylib", "Linux": "so", "Windows": "dll"}[platform.system()]
78	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
76	def load_llmodel_library():
77	    ext = {"Darwin": "dylib", "Linux": "so", "Windows": "dll"}[platform.system()]
78	

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
80	        # macOS, Linux, MinGW
81	        lib = ctypes.CDLL(str(MODEL_LIB_PATH / f"libllmodel.{ext}"))
82	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
85	        # MSVC
86	        lib = ctypes.CDLL(str(MODEL_LIB_PATH / "llmodel.dll"))
87	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/_pyllmodel.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
557	        # immediately
558	        thread = threading.Thread(
559	            target=run_llmodel_prompt,
560	            args=(prompt, prompt_template, _generator_callback_wrapper(callback)),
561	            kwargs=kwargs,
562	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	        """
278	        resp = requests.get("https://gpt4all.io/models/models3.json")
279	        if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	        """
278	        resp = requests.get("https://gpt4all.io/models/models3.json")
279	        if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
313	                if model_filename == m["filename"]:
314	                    tmpl = m.get("promptTemplate", DEFAULT_PROMPT_TEMPLATE)
315	                    # change to Python-style formatting

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	            # If model file does not exist, download
340	            filesize = config.get("filesize")
341	            config["path"] = str(cls.download_model(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
341	            config["path"] = str(cls.download_model(
342	                model_filename, model_path, verbose=verbose, url=config.get("url"),
343	                expected_size=None if filesize is None else int(filesize), expected_md5=config.get("md5sum"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
342	                model_filename, model_path, verbose=verbose, url=config.get("url"),
343	                expected_size=None if filesize is None else int(filesize), expected_md5=config.get("md5sum"),
344	            ))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
375	        if url is None:
376	            url = f"https://gpt4all.io/models/gguf/{model_filename}"
377	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
383	                headers["Accept-Encoding"] = "identity"  # Content-Encoding changes meaning of ranges
384	            response = requests.get(url, stream=True, headers=headers)
385	            if response.status_code not in (200, 206):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	                raise ValueError(f'Request failed: HTTP {response.status_code} {response.reason}')
387	            if offset and (response.status_code != 206 or str(offset) not in response.headers.get('Content-Range', '')):
388	                raise ValueError('Connection was interrupted and server does not support range requests')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
388	                raise ValueError('Connection was interrupted and server does not support range requests')
389	            if (enc := response.headers.get("Content-Encoding")) is not None:
390	                raise ValueError(f"Expected identity Content-Encoding, got {enc}")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
392	
393	        response = make_request()
394	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	
395	        total_size_in_bytes = int(response.headers.get("content-length", 0))
396	        block_size = 2**20  # 1 MB

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
406	                            for data in response.iter_content(block_size):
407	                                partf.write(data)
408	                                progress_bar.update(len(data))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
413	                                    # the socket was closed during a read - retry
414	                                    response = make_request(progress_bar.n)
415	                                    continue

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
420	                            # server closed connection prematurely - retry
421	                            response = make_request(progress_bar.n)
422	                            continue

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
432	                    with tqdm(desc="Verifying", total=file_size, unit="iB", unit_scale=True) as bar:
433	                        while chunk := partf.read(block_size):
434	                            hsh.update(chunk)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
619	        if system_prompt is None:
620	            system_prompt = self.config.get("systemPrompt", "")
621	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/gpt4all-2.8.2-py3-none-win_amd64/gpt4all/gpt4all.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
622	        if prompt_template is None:
623	            if (tmpl := self.config.get("promptTemplate")) is None:
624	                warnings.warn("Use of a sideloaded model or allow_download=False without specifying a prompt template "

--------------------------------------------------

Code scanned:
	Total lines of code: 1159
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 29.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 4.0
Files skipped (0):
