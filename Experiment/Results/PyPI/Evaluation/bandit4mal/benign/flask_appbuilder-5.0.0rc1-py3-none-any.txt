Run started:2025-05-25 12:58:07.999761

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	SQLA_REPO_URL = (
19	    "https://github.com/dpgaspar/Flask-AppBuilder-Skeleton/archive/refs/heads/v5.zip"
20	)
21	MONGOENGIE_REPO_URL = (
22	    "https://github.com/dpgaspar/Flask-AppBuilder-Skeleton-me/archive/master.zip"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	MONGOENGIE_REPO_URL = (
22	    "https://github.com/dpgaspar/Flask-AppBuilder-Skeleton-me/archive/master.zip"
23	)
24	ADDON_REPO_URL = (
25	    "https://github.com/dpgaspar/Flask-AppBuilder-Skeleton-AddOn/archive/master.zip"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	ADDON_REPO_URL = (
25	    "https://github.com/dpgaspar/Flask-AppBuilder-Skeleton-AddOn/archive/master.zip"
26	)
27	
28	MIN_SECRET_KEY_SIZE = 20
29	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
323	        if engine.lower() == "sqlalchemy":
324	            url = urlopen(SQLA_REPO_URL)
325	            dirname = "Flask-AppBuilder-Skeleton-5"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
326	        elif engine.lower() == "mongoengine":
327	            url = urlopen(MONGOENGIE_REPO_URL)
328	            dirname = "Flask-AppBuilder-Skeleton-me-master"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
328	            dirname = "Flask-AppBuilder-Skeleton-me-master"
329	        zipfile = ZipFile(BytesIO(url.read()))
330	        zipfile.extractall()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
334	        config_filename = os.path.join(os.path.abspath(name), "config.py")
335	        template = jinja2.Template(open(template_filename).read())
336	        rendered_template = template.render({"secret_key": secret_key})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
337	        with open(config_filename, "w") as fd:
338	            fd.write(rendered_template)
339	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
369	        dirname = "Flask-AppBuilder-Skeleton-AddOn-master"
370	        url = urlopen(ADDON_REPO_URL)
371	        zipfile = ZipFile(BytesIO(url.read()))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
370	        url = urlopen(ADDON_REPO_URL)
371	        zipfile = ZipFile(BytesIO(url.read()))
372	        zipfile.extractall()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
376	        f = open(os.path.join(full_name, "config.py"), "w")
377	        f.write("ADDON_NAME='" + name + "'\n")
378	        f.write("FULL_ADDON_NAME='fab_addon_' + ADDON_NAME\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
377	        f.write("ADDON_NAME='" + name + "'\n")
378	        f.write("FULL_ADDON_NAME='fab_addon_' + ADDON_NAME\n")
379	        f.close()

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
441	    keywords_args = " -k ".join(keywords)
442	    os.popen(
443	        "pybabel extract -F {0} -k {1} -o {2} {3}".format(
444	            config, keywords_args, output, input
445	        )

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
447	    click.echo(click.style("Starting Update target:{0}".format(target), fg="green"))
448	    os.popen("pybabel update -N -i {0} -d {1}".format(output, target))
449	    click.echo(click.style("Finish, you can start your translations", fg="green"))

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/cli.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
462	    click.echo(click.style("Starting Compile target:{0}".format(target), fg="green"))
463	    os.popen("pybabel compile -f -d {0}".format(target))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/const.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
193	
194	MICROSOFT_KEY_SET_URL = "https://login.microsoftonline.com/common/discovery/keys"

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/models/generic/__init__.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
419	        self.delete_all(PSModel())
420	        out = os.popen("ps -p {0} -f".format(pk))
421	        for line in out.readlines():

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/models/generic/__init__.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
426	        self.delete_all(PSModel())
427	        out = os.popen("ps -ef")
428	        for line in out.readlines():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
720	
721	        return requests.get(MICROSOFT_KEY_SET_URL).json()
722	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
723	    def _decode_and_validate_azure_jwt(self, id_token: str) -> Dict[str, str]:
724	        verify_signature = self.oauth_remotes["azure"].client_kwargs.get(
725	            "verify_signature", False
726	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
739	
740	        resp = requests.get(jwks_url)
741	        if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
756	
757	        verify_signature = self.oauth_remotes["authentik"].client_kwargs.get(
758	            "verify_signature", True
759	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
761	            # Validate the token using authentik certificate
762	            jwks_uri = self.oauth_remotes["authentik"].server_metadata.get("jwks_uri")
763	            if jwks_uri:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
779	    def register_views(self):
780	        if not current_app.config.get("FAB_ADD_SECURITY_VIEWS", True):
781	            return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
865	        self.appbuilder.menu.add_separator("Security")
866	        if current_app.config.get("FAB_ADD_SECURITY_PERMISSION_VIEW", True):
867	            self.appbuilder.add_view(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:874
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
873	            )
874	        if current_app.config.get("FAB_ADD_SECURITY_VIEW_MENU_VIEW", True):
875	            self.appbuilder.add_view(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	            )
882	        if current_app.config.get("FAB_ADD_SECURITY_PERMISSION_VIEWS_VIEW", True):
883	            self.appbuilder.add_view(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
894	        """
895	        roles_mapping = current_app.config.get("FAB_ROLES_MAPPING", {})
896	        for pk, name in roles_mapping.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1124	    ) -> str:
1125	        raw_value = ldap_dict.get(field_name, [bytes()])
1126	        # decode - if empty string, default to fallback, otherwise take first element

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1130	    def ldap_extract_list(ldap_dict: Dict[str, bytes], field_name: str) -> List[str]:
1131	        raw_list = ldap_dict.get(field_name, [])
1132	        # decode - removing empty strings

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1377	        if len(self.auth_roles_mapping) > 0:
1378	            user_role_keys = userinfo.get("role_keys", [])
1379	            user_role_objects.update(self.get_roles_from_keys(user_role_keys))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1444	                username=username,
1445	                first_name=userinfo.get("first_name", ""),
1446	                last_name=userinfo.get("last_name", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1445	                first_name=userinfo.get("first_name", ""),
1446	                last_name=userinfo.get("last_name", ""),
1447	                email=userinfo.get("email", "") or f"{username}@email.notfound",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1446	                last_name=userinfo.get("last_name", ""),
1447	                email=userinfo.get("email", "") or f"{username}@email.notfound",
1448	                role=self._oauth_calculate_user_roles(userinfo),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1495	        """
1496	        builtin_pvms = self.builtin_roles.get(role.name, [])
1497	        for pvm in builtin_pvms:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1527	        for provider in self.openid_providers:
1528	            if provider.get("name") == provider_name:
1529	                return provider.get("url")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1528	            if provider.get("name") == provider_name:
1529	                return provider.get("url")
1530	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1744	        for method_name, permission_name in baseview.method_permission_name.items():
1745	            old_permission_name = baseview.previous_method_permission_name.get(
1746	                method_name
1747	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1748	            # Actions do not get prefix when normally defined
1749	            if hasattr(baseview, "actions") and baseview.actions.get(
1750	                old_permission_name
1751	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1773	    ) -> None:
1774	        old_pvm = state_transition["add"].get((old_view_name, old_perm_name))
1775	        if old_pvm:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1840	                if add_all_flag:
1841	                    old_perm_names = permission_mapping.get(new_perm_name)
1842	                    old_perm_names = old_perm_names or (new_perm_name,)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1851	                else:
1852	                    old_perm_names = permission_mapping.get(new_perm_name) or set()
1853	                    for old_perm_name in old_perm_names:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/flask_appbuilder-5.0.0rc1-py3-none-any/flask_appbuilder/security/manager.py:1889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1888	            for pvm in permissions:
1889	                new_pvm_states = state_transitions["add"].get(
1890	                    (pvm.view_menu.name, pvm.permission.name)
1891	                )

--------------------------------------------------

Code scanned:
	Total lines of code: 16378
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 39.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 0.0
Files skipped (0):
