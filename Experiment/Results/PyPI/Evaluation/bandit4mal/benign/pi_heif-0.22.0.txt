Run started:2025-05-25 13:19:33.469970

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/libheif/linux_build_libs.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	
14	LIBX265_URL = "https://bitbucket.org/multicoreware/x265_git/get/0b75c44c10e605fe9e9ebed58f04a46271131827.tar.gz"
15	LIBAOM_URL = "https://aomedia.googlesource.com/aom/+archive/v3.6.1.tar.gz"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/libheif/linux_build_libs.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	LIBX265_URL = "https://bitbucket.org/multicoreware/x265_git/get/0b75c44c10e605fe9e9ebed58f04a46271131827.tar.gz"
15	LIBAOM_URL = "https://aomedia.googlesource.com/aom/+archive/v3.6.1.tar.gz"
16	LIBDE265_URL = "https://github.com/strukturag/libde265/releases/download/v1.0.15/libde265-1.0.15.tar.gz"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/libheif/linux_build_libs.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	LIBAOM_URL = "https://aomedia.googlesource.com/aom/+archive/v3.6.1.tar.gz"
16	LIBDE265_URL = "https://github.com/strukturag/libde265/releases/download/v1.0.15/libde265-1.0.15.tar.gz"
17	LIBHEIF_URL = "https://github.com/strukturag/libheif/releases/download/v1.19.7/libheif-1.19.7.tar.gz"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/libheif/linux_build_libs.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	LIBDE265_URL = "https://github.com/strukturag/libde265/releases/download/v1.0.15/libde265-1.0.15.tar.gz"
17	LIBHEIF_URL = "https://github.com/strukturag/libheif/releases/download/v1.19.7/libheif-1.19.7.tar.gz"
18	
19	
20	def download_file(url: str, out_path: str) -> bool:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/libheif/linux_build_libs.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	    else:
90	        download_extract_to(f"https://www.nasm.us/pub/nasm/releasebuilds/{version}/nasm-{version}.tar.gz", tool_path)
91	        chdir(tool_path)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/pi_heif/as_plugin.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	    warn(
210	        "The AVIF support in this library is marked as deprecated and will be removed in the next version. "
211	        "If you still need AVIF support until it natively appears in Pillow, use the "
212	        "https://github.com/fdintino/pillow-avif-plugin project instead.",
213	        DeprecationWarning,
214	        stacklevel=2,
215	    )
216	    if not _pi_heif.get_lib_info()["AVIF"]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/setup.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
278	except RequiredDependencyException as err:
279	    MSG = f"""
280	
281	The headers or library files could not be found for {err},
282	a required dependency when compiling Pillow-Heif from source.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/setup.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
287	"""
288	    sys.stderr.write(MSG)
289	    raise RequiredDependencyException(MSG) from None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/opencv_test.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	        options.SAVE_HDR_TO_12_BIT = bool(enc_bits == 12)
34	        cv_img = cv2.imread(img, cv2.IMREAD_UNCHANGED)
35	        assert cv_img.shape[2] == 3  # 3 channels(BGR)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/opencv_test.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	        options.SAVE_HDR_TO_12_BIT = bool(enc_bits == 12)
60	        cv_img = cv2.imread(img, cv2.IMREAD_UNCHANGED)
61	        assert cv_img.shape[2] == 4  # 4 channels(BGRA)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/opencv_test.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	def test_save_bgr_8bit_color_mode(img):
83	    cv_img = cv2.imread(img, cv2.IMREAD_UNCHANGED)
84	    assert cv_img.shape[2] == 3  # 3 channels(BGR)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/opencv_test.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	def test_save_bgra_8bit_color_mode(img):
103	    cv_img = cv2.imread(img, cv2.IMREAD_UNCHANGED)
104	    assert cv_img.shape[2] == 4  # 4 channels(BGRA)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/orientation_test.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    xmp_1 = (
19	        '<?xpacket begin="\xef\xbb\xbf" id="W5M0MpCehiHzreSzNTczkc9d"?>\n'
20	        '<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 5.4.0">\n'
21	        ' <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n'
22	        '  <rdf:Description rdf:about=""\n'
23	        '    xmlns:exif="http://ns.adobe.com/exif/1.0/"\n'
24	        '    xmlns:tiff="http://ns.adobe.com/tiff/1.0/"\n'
25	        '   tiff:Orientation="' + str(orientation) + '"/>\n </rdf:RDF>\n</x:xmpmeta>\n<?xpacket end="r"?>'
26	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/orientation_test.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    xmp_2 = (
28	        '<?xpacket begin="\xef\xbb\xbf" id="W5M0MpCehiHzreSzNTczkc9d"?>\n'
29	        '<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Image::ExifTool 12.30">\n'
30	        '<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n\n'
31	        ' <rdf:Description rdf:about=""\n'
32	        '  xmlns:exif="http://ns.adobe.com/exif/1.0/">\n'
33	        "  <exif:ColorSpace>1</exif:ColorSpace>\n"
34	        "  <exif:PixelXDimension>384</exif:PixelXDimension>\n"
35	        "  <exif:PixelYDimension>512</exif:PixelYDimension>\n"
36	        " </rdf:Description>\n\n"
37	        ' <rdf:Description rdf:about=""\n'
38	        '  xmlns:tiff="http://ns.adobe.com/tiff/1.0/">\n'
39	        "  <tiff:Orientation>"
40	        + str(orientation)
41	        + '</tiff:Orientation>\n </rdf:Description>\n</rdf:RDF>\n</x:xmpmeta>\n<?xpacket end="r"?>'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/read_test.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
128	    with builtins.open(img_path, "rb") as fh:
129	        b = fh.read()
130	        bytes_io = BytesIO(b)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/read_test.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	    with builtins.open(img_path, "rb") as fh:
160	        bytes_io = BytesIO(fh.read())
161	        for fp in [bytes_io, fh, img_path, img_path.as_posix()]:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/write_test.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
621	    z = binary_data_with_padding.rstrip(b"\x00")
622	    assert zlib.decompress(z) == binary_data_to_encode
623	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pi_heif-0.22.0/pi_heif-0.22.0/tests/write_test.py:622
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
621	    z = binary_data_with_padding.rstrip(b"\x00")
622	    assert zlib.decompress(z) == binary_data_to_encode
623	

--------------------------------------------------

Code scanned:
	Total lines of code: 4855
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 1.0
Files skipped (0):
