Run started:2025-05-25 12:42:31.242261

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/__doc__.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	__email__       = "qianwenjie@gmail.com"
7	__url__         = "https://github.com/qwj/python-proxy"
8	
9	try:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
260	class AES(RAW):
261	    g1 = base64.b64decode(b'Y3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7Fg==')
262	    g2 = [a<<1&0xff^0x1b if a&0x80 else a<<1 for a in g1]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:261
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
260	class AES(RAW):
261	    g1 = base64.b64decode(b'Y3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7Fg==')
262	    g2 = [a<<1&0xff^0x1b if a&0x80 else a<<1 for a in g1]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
263	    g3 = [a^(a<<1&0xff^0x1b if a&0x80 else a<<1) for a in g1]
264	    Rcon = base64.b64decode(b'jQECBAgQIECAGzZs2KtNmi9evGPGlzVq1LN9+u/FkTly5NO9YcKfJUqUM2bMgx06dOjL')
265	    shifts = tuple((j,j&3|((j>>2)+(j&3))*4&12,j+3&3|((j>>2)+(j+3&3))*4&12,j+2&3|((j>>2)+(j+2&3))*4&12,j+1&3|((j>>2)+(j+1&3))*4&12) for j in range(16))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:264
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
263	    g3 = [a^(a<<1&0xff^0x1b if a&0x80 else a<<1) for a in g1]
264	    Rcon = base64.b64decode(b'jQECBAgQIECAGzZs2KtNmi9evGPGlzVq1LN9+u/FkTly5NO9YcKfJUqUM2bMgx06dOjL')
265	    shifts = tuple((j,j&3|((j>>2)+(j&3))*4&12,j+3&3|((j>>2)+(j+3&3))*4&12,j+2&3|((j>>2)+(j+2&3))*4&12,j+1&3|((j>>2)+(j+1&3))*4&12) for j in range(16))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
321	class Camellia(RAW):
322	    S1 = base64.b64decode(b'cIIs7LMnwOXkhVc16gyuQSPva5NFGaUh7Q5PTh1lkr2GuK+PfOsfzj4w3F9exQsapuE5ytVHXT3ZAVrWUVZsTYsNmmb7zLAtdBIrIPCxhJnfTMvCNH52BW23qTHRFwTXFFg6Yd4bERwyD5wWUxjyIv5Ez7LDtXqRJAjoqGD8aVCq0KB9oYlil1RbHpXg/2TSEMQASKP3dduKA+baCT/dlIdcgwLNSpAzc2f2851/v+JSm9gmyDfGO4GWb0sTvmMu6XmnjJ9uvI4p9fm2L/20WXiYBmrnRnG61CWrQoiijfpyB7lV+O6sCjZJKmg8OPGkQCjTe7vJQ8EV4630d8eAng==')
323	    S2, S3, S4 = bytes(i>>7|(i&0x7f)<<1 for i in S1), bytes(i>>1|(i&1)<<7 for i in S1), S1[::2]+S1[1::2]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:322
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
321	class Camellia(RAW):
322	    S1 = base64.b64decode(b'cIIs7LMnwOXkhVc16gyuQSPva5NFGaUh7Q5PTh1lkr2GuK+PfOsfzj4w3F9exQsapuE5ytVHXT3ZAVrWUVZsTYsNmmb7zLAtdBIrIPCxhJnfTMvCNH52BW23qTHRFwTXFFg6Yd4bERwyD5wWUxjyIv5Ez7LDtXqRJAjoqGD8aVCq0KB9oYlil1RbHpXg/2TSEMQASKP3dduKA+baCT/dlIdcgwLNSpAzc2f2851/v+JSm9gmyDfGO4GWb0sTvmMu6XmnjJ9uvI4p9fm2L/20WXiYBmrnRnG61CWrQoiijfpyB7lV+O6sCjZJKmg8OPGkQCjTe7vJQ8EV4630d8eAng==')
323	    S2, S3, S4 = bytes(i>>7|(i&0x7f)<<1 for i in S1), bytes(i>>1|(i&1)<<7 for i in S1), S1[::2]+S1[1::2]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
324	    S = (S1, S4, S3, S2, S4, S3, S2, S1)
325	    KS = base64.b64decode(b'AAIICiAiKCpIShETGTM5OxIQQkBKSCMhKykAAgwOJCYoKkRGTE4RExkbMTM1Nz0/EhAaGEZESkgjIS8t')
326	    KS = tuple((i%16//4, i%4*32, (64,51,49,36,34)[i>>4]) for i in KS)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:325
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
324	    S = (S1, S4, S3, S2, S4, S3, S2, S1)
325	    KS = base64.b64decode(b'AAIICiAiKCpIShETGTM5OxIQQkBKSCMhKykAAgwOJCYoKkRGTE4RExkbMTM1Nz0/EhAaGEZESkgjIS8t')
326	    KS = tuple((i%16//4, i%4*32, (64,51,49,36,34)[i>>4]) for i in KS)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
379	class SEED(RAW):
380	    S0 = base64.b64decode(b'qYXW01QdrCVdQxgeUfzKYyhEIJ3g4sgXpY8De7sT0u5wjD+oMt32dOyVC1dcW70BJBxzmBDM8tks53KDm9GGyWBQo+sNtp5Pt1rGeKYSr9Vhw7RBUn2NCB+ZABkEU/fh/XYvJ7CLDquibpNNaXwJCr/v88WHFP5k3i5LGgYha2YC9ZKKDLN+0HpHluUmgK3foTA3rjYVIjj0p0VMgemElzXLzjxxEceJdfva+JRZgsT/STlnwM/XuA+OQiORbNukNPFIwm89LUC+PrzBqrpOVTvcaH+c2EpWd6DtRrUrZfrjubGfXvnmsjHqbV/k8M2IFjpY1GIpBzPoGwV5kGoqmg==')
381	    S1 = base64.b64decode(b'OOgtps/es7ivYFXHRG9rW8NiM7UpoOKn05ERBhy8NkvviGyoF8QW9MJF4dY/PY6YKE72PqX5Dd/YK2Z6Jy/xckLUQcBzZ6yL962AH8osqjTSC+7pXZQY+FeuCMUTzYa5/33BMfWKarHRINcCIgRocQfbnZlhvuZZ3VGQ3Jqjq9CBD0ca4+yNv5Z7XKKhYyNNyJ6cOgwuum6fWvKS80l4zBX7cHV/NRADZG3GdNW06gl2Gf5AEuC9BfoB8CpeqVZDhRSJm7DlSHmX/B6CIYwbX3dUsh0lTwBG7VhS637ayf0wlWU8tuS7fA5QOSYyhGmTN+ckpMtTCofZTIOPzjtKtw==')

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:380
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
379	class SEED(RAW):
380	    S0 = base64.b64decode(b'qYXW01QdrCVdQxgeUfzKYyhEIJ3g4sgXpY8De7sT0u5wjD+oMt32dOyVC1dcW70BJBxzmBDM8tks53KDm9GGyWBQo+sNtp5Pt1rGeKYSr9Vhw7RBUn2NCB+ZABkEU/fh/XYvJ7CLDquibpNNaXwJCr/v88WHFP5k3i5LGgYha2YC9ZKKDLN+0HpHluUmgK3foTA3rjYVIjj0p0VMgemElzXLzjxxEceJdfva+JRZgsT/STlnwM/XuA+OQiORbNukNPFIwm89LUC+PrzBqrpOVTvcaH+c2EpWd6DtRrUrZfrjubGfXvnmsjHqbV/k8M2IFjpY1GIpBzPoGwV5kGoqmg==')
381	    S1 = base64.b64decode(b'OOgtps/es7ivYFXHRG9rW8NiM7UpoOKn05ERBhy8NkvviGyoF8QW9MJF4dY/PY6YKE72PqX5Dd/YK2Z6Jy/xckLUQcBzZ6yL962AH8osqjTSC+7pXZQY+FeuCMUTzYa5/33BMfWKarHRINcCIgRocQfbnZlhvuZZ3VGQ3Jqjq9CBD0ca4+yNv5Z7XKKhYyNNyJ6cOgwuum6fWvKS80l4zBX7cHV/NRADZG3GdNW06gl2Gf5AEuC9BfoB8CpeqVZDhRSJm7DlSHmX/B6CIYwbX3dUsh0lTwBG7VhS637ayf0wlWU8tuS7fA5QOSYyhGmTN+ckpMtTCofZTIOPzjtKtw==')

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
380	    S0 = base64.b64decode(b'qYXW01QdrCVdQxgeUfzKYyhEIJ3g4sgXpY8De7sT0u5wjD+oMt32dOyVC1dcW70BJBxzmBDM8tks53KDm9GGyWBQo+sNtp5Pt1rGeKYSr9Vhw7RBUn2NCB+ZABkEU/fh/XYvJ7CLDquibpNNaXwJCr/v88WHFP5k3i5LGgYha2YC9ZKKDLN+0HpHluUmgK3foTA3rjYVIjj0p0VMgemElzXLzjxxEceJdfva+JRZgsT/STlnwM/XuA+OQiORbNukNPFIwm89LUC+PrzBqrpOVTvcaH+c2EpWd6DtRrUrZfrjubGfXvnmsjHqbV/k8M2IFjpY1GIpBzPoGwV5kGoqmg==')
381	    S1 = base64.b64decode(b'OOgtps/es7ivYFXHRG9rW8NiM7UpoOKn05ERBhy8NkvviGyoF8QW9MJF4dY/PY6YKE72PqX5Dd/YK2Z6Jy/xckLUQcBzZ6yL962AH8osqjTSC+7pXZQY+FeuCMUTzYa5/33BMfWKarHRINcCIgRocQfbnZlhvuZZ3VGQ3Jqjq9CBD0ca4+yNv5Z7XKKhYyNNyJ6cOgwuum6fWvKS80l4zBX7cHV/NRADZG3GdNW06gl2Gf5AEuC9BfoB8CpeqVZDhRSJm7DlSHmX/B6CIYwbX3dUsh0lTwBG7VhS637ayf0wlWU8tuS7fA5QOSYyhGmTN+ckpMtTCofZTIOPzjtKtw==')
382	    G = lambda self, x, M=b'\xfc\xf3\xcf\x3f': sum((self.S0[x&0xff]&M[i]^self.S1[x>>8&0xff]&M[i+1&3]^self.S0[x>>16&0xff]&M[i+2&3]^self.S1[x>>24&0xff]&M[i+3&3])<<i*8 for i in range(4))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:381
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
380	    S0 = base64.b64decode(b'qYXW01QdrCVdQxgeUfzKYyhEIJ3g4sgXpY8De7sT0u5wjD+oMt32dOyVC1dcW70BJBxzmBDM8tks53KDm9GGyWBQo+sNtp5Pt1rGeKYSr9Vhw7RBUn2NCB+ZABkEU/fh/XYvJ7CLDquibpNNaXwJCr/v88WHFP5k3i5LGgYha2YC9ZKKDLN+0HpHluUmgK3foTA3rjYVIjj0p0VMgemElzXLzjxxEceJdfva+JRZgsT/STlnwM/XuA+OQiORbNukNPFIwm89LUC+PrzBqrpOVTvcaH+c2EpWd6DtRrUrZfrjubGfXvnmsjHqbV/k8M2IFjpY1GIpBzPoGwV5kGoqmg==')
381	    S1 = base64.b64decode(b'OOgtps/es7ivYFXHRG9rW8NiM7UpoOKn05ERBhy8NkvviGyoF8QW9MJF4dY/PY6YKE72PqX5Dd/YK2Z6Jy/xckLUQcBzZ6yL962AH8osqjTSC+7pXZQY+FeuCMUTzYa5/33BMfWKarHRINcCIgRocQfbnZlhvuZZ3VGQ3Jqjq9CBD0ca4+yNv5Z7XKKhYyNNyJ6cOgwuum6fWvKS80l4zBX7cHV/NRADZG3GdNW06gl2Gf5AEuC9BfoB8CpeqVZDhRSJm7DlSHmX/B6CIYwbX3dUsh0lTwBG7VhS637ayf0wlWU8tuS7fA5QOSYyhGmTN+ckpMtTCofZTIOPzjtKtw==')
382	    G = lambda self, x, M=b'\xfc\xf3\xcf\x3f': sum((self.S0[x&0xff]&M[i]^self.S1[x>>8&0xff]&M[i+1&3]^self.S0[x>>16&0xff]&M[i+2&3]^self.S1[x>>24&0xff]&M[i+3&3])<<i*8 for i in range(4))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
403	class RC2(RAW):
404	    S = base64.b64decode(b'2Xj5xBndte0o6f15SqDYncZ+N4MrdlOOYkxkiESL+6IXmln1h7NPE2FFbY0JgX0yvY9A64a3ewvwlSEiXGtOglTWZZPOYLIcc1bAFKeM8dwSdcofO77k0UI91DCjPLYmb78O2kZpB1cn8h2bvJRDA/gRx/aQ7z7nBsPVL8hmHtcI6OregFLu94Sqcqw1TWoqlhrScVoVSXRLn9BeBBik7MLgQW4PUcvMJJGvUKH0cDmZfDqFI7i0evwCNlslVZcxLV36mOOKkq4F3ykQZ2y6ydMA5s/hnqgsYxYBP1jiiakNODQbqzP/sLtIDF+5sc0uxfPbR+WlnHcKpiBo/n/BrQ==')
405	    B = list(range(20))+[-4,-3,-2,-1]+list(range(20,44))+[-4,-3,-2,-1]+list(range(44,64))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/cipherpy.py:404
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
403	class RC2(RAW):
404	    S = base64.b64decode(b'2Xj5xBndte0o6f15SqDYncZ+N4MrdlOOYkxkiESL+6IXmln1h7NPE2FFbY0JgX0yvY9A64a3ewvwlSEiXGtOglTWZZPOYLIcc1bAFKeM8dwSdcofO77k0UI91DCjPLYmb78O2kZpB1cn8h2bvJRDA/gRx/aQ7z7nBsPVL8hmHtcI6OregFLu94Sqcqw1TWoqlhrScVoVSXRLn9BeBBik7MLgQW4PUcvMJJGvUKH0cDmZfDqFI7i0evwCNlslVZcxLV36mOOKkq4F3ykQZ2y6ydMA5s/hnqgsYxYBP1jiiakNODQbqzP/sLtIDF+5sc0uxfPbR+WlnHcKpiBo/n/BrQ==')
405	    B = list(range(20))+[-4,-3,-2,-1]+list(range(20,44))+[-4,-3,-2,-1]+list(range(44,64))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/plugin.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	        reader._buffer[0:0] = data
29	        writer.write(b'HTTP/1.1 200 OK\r\nConnection: keep-alive\r\nContent-Encoding: gzip\r\nContent-Type: text/html\r\nDate: ' + datetime.datetime.now().strftime('%a, %d %b %Y %H:%M:%S GMT').encode() + b'\r\nServer: nginx\r\nVary: Accept-Encoding\r\n\r\n')
30	    async def init_server_data(self, reader, writer, cipher, raddr):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/plugin.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
30	    async def init_server_data(self, reader, writer, cipher, raddr):
31	        writer.write(f'GET / HTTP/1.1\r\nHost: {raddr}\r\nUser-Agent: curl\r\nAccept-Encoding: gzip, deflate\r\nConnection: keep-alive\r\n\r\n'.encode())
32	        await reader.read_until(b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/plugin.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	        addhmac = lambda s: s + hmac.new(key+sessionid, s, hashlib.sha1).digest()[:10]
52	        writer.write(addhmac((b"\x16\x03\x03" + packstr(b"\x02\x00" + packstr(b'\x03\x03' + addhmac(utc_time.to_bytes(4, 'big') + os.urandom(18)) + b'\x20' + sessionid + b'\xc0\x2f\x00\x00\x05\xff\x01\x00\x01\x00')) + (b"\x16\x03\x03" + packstr(b"\x04\x00" + packstr(os.urandom(random.randrange(164)*2+64))) if random.randint(0, 8) < 1 else b'') + b"\x14\x03\x03\x00\x01\x01\x16\x03\x03" + packstr(os.urandom(random.choice((32, 40)))))[:-10]))
53	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/plugin.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
57	        addhmac = lambda s: s + hmac.new(key+sessionid, s, hashlib.sha1).digest()[:10]
58	        writer.write(b"\x16\x03\x01" + packstr(b"\x01\x00" + packstr(b'\x03\x03' + addhmac(int(time.time()).to_bytes(4, 'big') + os.urandom(18)) + b"\x20" + sessionid + b"\x00\x1c\xc0\x2b\xc0\x2f\xcc\xa9\xcc\xa8\xcc\x14\xcc\x13\xc0\x0a\xc0\x14\xc0\x09\xc0\x13\x00\x9c\x00\x35\x00\x2f\x00\x0a\x01\x00" + packstr(b"\xff\x01\x00\x01\x00\x00\x00" + packstr(packstr(b"\x00" + packstr(raddr.encode()))) + b"\x00\x17\x00\x00\x00\x23" + packstr(os.urandom((random.randrange(17)+8)*16)) + b"\x00\x0d\x00\x16\x00\x14\x06\x01\x06\x03\x05\x01\x05\x03\x04\x01\x04\x03\x03\x01\x03\x03\x02\x01\x02\x03\x00\x05\x00\x05\x01\x00\x00\x00\x00\x00\x12\x00\x00\x75\x50\x00\x00\x00\x0b\x00\x02\x01\x00\x00\x0a\x00\x06\x00\x04\x00\x17\x00\x18"))))
59	        writer.write(addhmac(b'\x14\x03\x03\x00\x01\x01\x16\x03\x03\x00\x20' + os.urandom(22)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/plugin.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	        writer.write(b"\x16\x03\x01" + packstr(b"\x01\x00" + packstr(b'\x03\x03' + addhmac(int(time.time()).to_bytes(4, 'big') + os.urandom(18)) + b"\x20" + sessionid + b"\x00\x1c\xc0\x2b\xc0\x2f\xcc\xa9\xcc\xa8\xcc\x14\xcc\x13\xc0\x0a\xc0\x14\xc0\x09\xc0\x13\x00\x9c\x00\x35\x00\x2f\x00\x0a\x01\x00" + packstr(b"\xff\x01\x00\x01\x00\x00\x00" + packstr(packstr(b"\x00" + packstr(raddr.encode()))) + b"\x00\x17\x00\x00\x00\x23" + packstr(os.urandom((random.randrange(17)+8)*16)) + b"\x00\x0d\x00\x16\x00\x14\x06\x01\x06\x03\x05\x01\x05\x03\x04\x01\x04\x03\x03\x01\x03\x03\x02\x01\x02\x03\x00\x05\x00\x05\x01\x00\x00\x00\x00\x00\x12\x00\x00\x75\x50\x00\x00\x00\x0b\x00\x02\x01\x00\x00\x0a\x00\x06\x00\x04\x00\x17\x00\x18"))))
59	        writer.write(addhmac(b'\x14\x03\x03\x00\x01\x01\x16\x03\x03\x00\x20' + os.urandom(22)))
60	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/plugin.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
134	                    break
135	                ret += zlib.decompress(b'x\x9c' + self.buf[2:l])
136	                del self.buf[:l]

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/plugin.py:135
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
134	                    break
135	                ret += zlib.decompress(b'x\x9c' + self.buf[2:l])
136	                del self.buf[:l]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	def socks_address(reader, n):
33	    return socket.inet_ntoa(reader.read(4)) if n == 1 else \
34	           reader.read(reader.read(1)[0]).decode() if n == 3 else \

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	    return socket.inet_ntoa(reader.read(4)) if n == 1 else \
34	           reader.read(reader.read(1)[0]).decode() if n == 3 else \
35	           socket.inet_ntop(socket.AF_INET6, reader.read(16)), \

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	    return socket.inet_ntoa(reader.read(4)) if n == 1 else \
34	           reader.read(reader.read(1)[0]).decode() if n == 3 else \
35	           socket.inet_ntop(socket.AF_INET6, reader.read(16)), \

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	           reader.read(reader.read(1)[0]).decode() if n == 3 else \
35	           socket.inet_ntop(socket.AF_INET6, reader.read(16)), \
36	           int.from_bytes(reader.read(2), 'big')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	           socket.inet_ntop(socket.AF_INET6, reader.read(16)), \
36	           int.from_bytes(reader.read(2), 'big')
37	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	            while not reader.at_eof() and not writer.is_closing():
60	                data = await reader.read(65536)
61	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
65	                stat_bytes(len(data))
66	                writer.write(data)
67	                await writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
71	            stat_conn(-1)
72	            writer.close()
73	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	        toauth = hashlib.sha224(rauth or b'').hexdigest().encode()
97	        writer_remote.write(toauth + b'\x0d\x0a\x01\x03' + packstr(host_name.encode()) + port.to_bytes(2, 'big') + b'\x0d\x0a')
98	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	    async def connect(self, reader_remote, writer_remote, rauth, host_name, port, **kw):
116	        writer_remote.write(rauth + b'\x03' + packstr(host_name.encode()) + port.to_bytes(2, 'big'))
117	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
163	    async def connect(self, reader_remote, writer_remote, rauth, host_name, port, writer_cipher_r, **kw):
164	        writer_remote.write(rauth)
165	        if writer_cipher_r and writer_cipher_r.ota:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	            checksum = hmac.new(writer_cipher_r.iv+writer_cipher_r.key, rdata, hashlib.sha1).digest()
168	            writer_remote.write(rdata + checksum[:10])
169	            self.patch_ota_writer(writer_cipher_r, writer_remote)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	        else:
171	            writer_remote.write(b'\x03' + packstr(host_name.encode()) + port.to_bytes(2, 'big'))
172	    def udp_accept(self, data, users, **kw):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	                return
179	            reader.read(len(user))
180	        n = reader.read(1)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	            reader.read(len(user))
180	        n = reader.read(1)[0]
181	        if n not in (1, 3, 4):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	        host_name, port = socks_address(reader, n)
184	        return user, host_name, port, reader.read()
185	    def udp_unpack(self, data):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	        reader = io.BytesIO(data)
187	        n = reader.read(1)[0]
188	        host_name, port = socks_address(reader, n)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
188	        host_name, port = socks_address(reader, n)
189	        return reader.read()
190	    def udp_pack(self, host_name, port, data):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
216	            authtable.set_authed(user)
217	        writer.write(b'\x00\x5a' + port.to_bytes(2, 'big') + ip)
218	        return user, socket.inet_ntoa(ip), port

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
220	        ip = socket.inet_aton((await asyncio.get_event_loop().getaddrinfo(host_name, port, family=socket.AF_INET))[0][4][0])
221	        writer_remote.write(b'\x04\x01' + port.to_bytes(2, 'big') + ip + rauth + b'\x00')
222	        assert await reader_remote.read_n(2) == b'\x00\x5a'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
236	                raise Exception(f'Unauthorized SOCKS')
237	            writer.write(b'\x05\x02')
238	            assert (await reader.read_n(1))[0] == 1, 'Unknown SOCKS auth'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
243	                raise Exception(f'Unauthorized SOCKS {u}:{p}')
244	            writer.write(b'\x01\x00')
245	        elif users and not user:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	        else:
248	            writer.write(b'\x05\x00')
249	        if users:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
253	        host_name, port, data = await socks_address_stream(reader, header[0])
254	        writer.write(b'\x05\x00\x00' + header + data)
255	        return user, host_name, port

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
257	        if rauth:
258	            writer_remote.write(b'\x05\x01\x02')
259	            assert await reader_remote.read_n(2) == b'\x05\x02'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
259	            assert await reader_remote.read_n(2) == b'\x05\x02'
260	            writer_remote.write(b'\x01' + b''.join(packstr(i) for i in rauth.split(b':', 1)))
261	            assert await reader_remote.read_n(2) == b'\x01\x00', 'Unknown SOCKS auth'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
262	        else:
263	            writer_remote.write(b'\x05\x01\x00')
264	            assert await reader_remote.read_n(2) == b'\x05\x00'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
264	            assert await reader_remote.read_n(2) == b'\x05\x00'
265	        writer_remote.write(b'\x05\x01\x00\x03' + packstr(host_name.encode()) + port.to_bytes(2, 'big'))
266	        assert await reader_remote.read_n(3) == b'\x05\x00\x00'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
270	        reader = io.BytesIO(data)
271	        if reader.read(3) != b'\x00\x00\x00':
272	            return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
272	            return
273	        n = reader.read(1)[0]
274	        if n not in (1, 3, 4):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	        host_name, port = socks_address(reader, n)
277	        return True, host_name, port, reader.read()
278	    def udp_connect(self, rauth, host_name, port, data, **kw):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
292	        async def reply(code, message, body=None, wait=False):
293	            writer.write(message)
294	            if body:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
294	            if body:
295	                writer.write(body)
296	            if wait:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
315	            if not user:
316	                user = next(filter(lambda i: ('Basic '+base64.b64encode(i).decode()) == pauth, users), None)
317	                if user is None:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:316
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
315	            if not user:
316	                user = next(filter(lambda i: ('Basic '+base64.b64encode(i).decode()) == pauth, users), None)
317	                if user is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
327	            async def connected(writer):
328	                writer.write(f'{method} {newpath} {ver}\r\n{lines}\r\n\r\n'.encode())
329	                return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
331	    async def connect(self, reader_remote, writer_remote, rauth, host_name, port, **kw):
332	        writer_remote.write(f'CONNECT {host_name}:{port} HTTP/1.1\r\nHost: {host_name}:{port}'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')
333	        await reader_remote.read_until(b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
331	    async def connect(self, reader_remote, writer_remote, rauth, host_name, port, **kw):
332	        writer_remote.write(f'CONNECT {host_name}:{port} HTTP/1.1\r\nHost: {host_name}:{port}'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')
333	        await reader_remote.read_until(b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:332
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
331	    async def connect(self, reader_remote, writer_remote, rauth, host_name, port, **kw):
332	        writer_remote.write(f'CONNECT {host_name}:{port} HTTP/1.1\r\nHost: {host_name}:{port}'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')
333	        await reader_remote.read_until(b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
337	            while not reader.at_eof() and not writer.is_closing():
338	                data = await reader.read(65536)
339	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
351	                stat_bytes(len(data))
352	                writer.write(data)
353	                await writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
357	            stat_conn(-1)
358	            writer.close()
359	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
372	                if not header or not host:
373	                    writer_remote.close()
374	                    raise Exception('Unknown HTTP header for protocol HTTPOnly')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
375	                method, path, ver = header.groups()
376	                data = f'{method} http://{host.group(1)}{path} {ver}\r\nHost: {host.group(1)}'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n' + buffer[pos+4:]
377	                buffer.clear()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:376
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
375	                method, path, ver = header.groups()
376	                data = f'{method} http://{host.group(1)}{path} {ver}\r\nHost: {host.group(1)}'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n' + buffer[pos+4:]
377	                buffer.clear()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
392	            if body:
393	                writer.write(body)
394	            if wait:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
400	        if rauth:
401	            headers.append(('proxy-authorization', 'Basic '+base64.b64encode(rauth)))
402	        writer_remote.send_headers(headers)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:401
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
400	        if rauth:
401	            headers.append(('proxy-authorization', 'Basic '+base64.b64encode(rauth)))
402	        writer_remote.send_headers(headers)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
521	            if not user:
522	                user = next(filter(lambda i: ('Basic '+base64.b64encode(i).decode()) == pauth, users), None)
523	                if user is None:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:522
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
521	            if not user:
522	                user = next(filter(lambda i: ('Basic '+base64.b64encode(i).decode()) == pauth, users), None)
523	                if user is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
523	                if user is None:
524	                    writer.write(f'{ver} 407 Proxy Authentication Required\r\nConnection: close\r\nProxy-Authenticate: Basic realm="simple"\r\n\r\n'.encode())
525	                    raise Exception('Unauthorized WebSocket')

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
530	            raise Exception(f'Unsupported headers {headers}')
531	        seckey = base64.b64decode(headers.get('Sec-WebSocket-Key'))
532	        rseckey = base64.b64encode(hashlib.sha1(seckey+b'amtf').digest()[:16]).decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:531
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
530	            raise Exception(f'Unsupported headers {headers}')
531	        seckey = base64.b64decode(headers.get('Sec-WebSocket-Key'))
532	        rseckey = base64.b64encode(hashlib.sha1(seckey+b'amtf').digest()[:16]).decode()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
531	        seckey = base64.b64decode(headers.get('Sec-WebSocket-Key'))
532	        rseckey = base64.b64encode(hashlib.sha1(seckey+b'amtf').digest()[:16]).decode()
533	        writer.write(f'{ver} 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: {rseckey}\r\nSec-WebSocket-Protocol: chat\r\n\r\n'.encode())

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:532
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
531	        seckey = base64.b64decode(headers.get('Sec-WebSocket-Key'))
532	        rseckey = base64.b64encode(hashlib.sha1(seckey+b'amtf').digest()[:16]).decode()
533	        writer.write(f'{ver} 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: {rseckey}\r\nSec-WebSocket-Protocol: chat\r\n\r\n'.encode())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
532	        rseckey = base64.b64encode(hashlib.sha1(seckey+b'amtf').digest()[:16]).decode()
533	        writer.write(f'{ver} 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: {rseckey}\r\nSec-WebSocket-Protocol: chat\r\n\r\n'.encode())
534	        self.patch_ws_stream(reader, writer, False)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
540	    async def connect(self, reader_remote, writer_remote, rauth, host_name, port, myhost, **kw):
541	        seckey = base64.b64encode(os.urandom(16)).decode()
542	        writer_remote.write(f'GET / HTTP/1.1\r\nHost: {myhost}\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Key: {seckey}\r\nSec-WebSocket-Protocol: chat\r\nSec-WebSocket-Version: 13'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:541
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
540	    async def connect(self, reader_remote, writer_remote, rauth, host_name, port, myhost, **kw):
541	        seckey = base64.b64encode(os.urandom(16)).decode()
542	        writer_remote.write(f'GET / HTTP/1.1\r\nHost: {myhost}\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Key: {seckey}\r\nSec-WebSocket-Protocol: chat\r\nSec-WebSocket-Version: 13'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
541	        seckey = base64.b64encode(os.urandom(16)).decode()
542	        writer_remote.write(f'GET / HTTP/1.1\r\nHost: {myhost}\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Key: {seckey}\r\nSec-WebSocket-Protocol: chat\r\nSec-WebSocket-Version: 13'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')
543	        await reader_remote.read_until(b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
541	        seckey = base64.b64encode(os.urandom(16)).decode()
542	        writer_remote.write(f'GET / HTTP/1.1\r\nHost: {myhost}\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Key: {seckey}\r\nSec-WebSocket-Protocol: chat\r\nSec-WebSocket-Version: 13'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')
543	        await reader_remote.read_until(b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:542
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
541	        seckey = base64.b64encode(os.urandom(16)).decode()
542	        writer_remote.write(f'GET / HTTP/1.1\r\nHost: {myhost}\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Key: {seckey}\r\nSec-WebSocket-Protocol: chat\r\nSec-WebSocket-Version: 13'.encode() + (b'\r\nProxy-Authorization: Basic '+base64.b64encode(rauth) if rauth else b'') + b'\r\n\r\n')
543	        await reader_remote.read_until(b'\r\n\r\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
605	            if data and not self.closed:
606	                writer.write(data)
607	        def close(self):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
608	            self.closed = True
609	            writer.close()
610	        def _force_close(self, exc):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
613	            ssl._app_transport._closed = True
614	            self.close()
615	        def abort(self):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
615	        def abort(self):
616	            self.close()
617	    ssl.connection_made(Transport())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
624	            while not reader.at_eof() and not ssl._app_transport._closed:
625	                data = await reader.read(read_size)
626	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
642	        def write(self, data):
643	            ssl._app_transport.write(data)
644	        def drain(self):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/proto.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
649	            if not ssl._app_transport._closed:
650	                ssl._app_transport.close()
651	    return ssl_reader, Writer()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
71	            remote_text = f'{remote_ip}:{remote_port}'
72	        local_addr = None if server_ip in ('127.0.0.1', '::1', None) else (server_ip, 0)
73	        reader_cipher, _ = await prepare_ciphers(cipher, reader, writer, server_side=False)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
91	            except Exception:
92	                writer_remote.close()
93	                raise Exception('Unknown remote protocol')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
100	            verbose(f'{str(ex) or "Unsupported protocol"} from {remote_ip}')
101	        try: writer.close()
102	        except Exception: pass

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
150	                    writer.write(b'\x00')
151	                writer.close()
152	            except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
208	                if prot.transport:
209	                    prot.transport.close()
210	            prot = lambda: Protocol(data)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
233	        except Exception:
234	            writer.close()
235	            raise

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
276	        whost, wport = self.jump.destination(host, port)
277	        data = self.rproto.udp_connect(rauth=self.auth, host_name=whost, port=wport, data=data)
278	        if self.cipher:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
296	        whost, wport = self.jump.destination(host, port)
297	        await self.rproto.connect(reader_remote=reader_remote, writer_remote=writer_remote, rauth=self.auth, host_name=whost, port=wport, writer_cipher_r=writer_cipher_r, myhost=self.host_name, sock=writer_remote.get_extra_info('socket'))
298	        return await self.jump.prepare_connection(reader_remote, writer_remote, host, port)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
318	        conn.initiate_connection()
319	        writer.write(conn.data_to_send())
320	        while not reader.at_eof() and not writer.is_closing():

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
327	                pass
328	            writer.write(conn.data_to_send())
329	            for event in events:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
343	                    conn.acknowledge_received_data(len(event.data), event.stream_id)
344	                    writer.write(conn.data_to_send())
345	                elif isinstance(event, h2.events.StreamEnded) or isinstance(event, h2.events.StreamReset):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
348	                    if not stream_writer.closed:
349	                        stream_writer.close()
350	                elif isinstance(event, h2.events.ConnectionTerminated):

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
355	                        stream_writer.window_update()
356	        writer.write(conn.data_to_send())
357	        writer.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
356	        writer.write(conn.data_to_send())
357	        writer.close()
358	    def get_stream(self, conn, writer, stream_id):

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
372	            def drain(self):
373	                writer.write(conn.data_to_send())
374	                return writer.drain()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
383	                conn.send_headers(stream_id, headers)
384	                writer.write(conn.data_to_send())
385	        stream_writer = StreamWriter()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
395	                    conn.send_data(stream_id, write_buffer[:chunk_size])
396	                    writer.write(conn.data_to_send())
397	                    del write_buffer[:chunk_size]

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
401	            conn.send_data(stream_id, b'', end_stream=True)
402	            writer.write(conn.data_to_send())
403	        asyncio.ensure_future(write_job())

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
467	                    super().quic_event_received(event)
468	            self.quic_egress_acm = aioquic.asyncio.connect(self.host_name, self.port, create_protocol=Protocol, configuration=self.quicclient)
469	            conn = await self.quic_egress_acm.__aenter__()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
479	            self.udpmap[stream_id] = reply
480	            conn._quic._get_or_create_stream_for_send(stream_id)
481	        conn._quic.send_stream_data(stream_id, data, False)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
486	        stream_id = conn._quic.get_next_available_stream_id(False)
487	        conn._quic._get_or_create_stream_for_send(stream_id)
488	        reader, writer = conn._create_stream(stream_id)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
570	                    stream_id = s._quic.get_next_available_stream_id(False)
571	                    s._quic._get_or_create_stream_for_send(stream_id)
572	                reader, writer = self.get_stream(s, stream_id)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
587	            self.handshake = asyncio.get_event_loop().create_future()
588	            self.quic_egress_acm = aioquic.asyncio.connect(self.host_name, self.port, create_protocol=self.get_protocol(), configuration=self.quicclient)
589	            conn = await self.quic_egress_acm.__aenter__()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
632	                client_keys = None
633	            conn = await asyncssh.connect(host=self.host_name, port=self.port, local_addr=local_addr, family=family, x509_trusted_certs=None, known_hosts=None, username=username, password=password, client_keys=client_keys, keepalive_interval=60, tunnel=tunnel)
634	            self.sshconn.set_result(conn)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
691	            try:
692	                self.writer.close()
693	            except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
706	                if self.closed:
707	                    writer.close()
708	                    break

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
720	                else:
721	                    writer.close()
722	                errwait = 0

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
726	                try:
727	                    writer.close()
728	                except Exception:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:803
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
802	            try:
803	                cipher = base64.b64decode(cipher).decode()
804	            except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:803
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
802	            try:
803	                cipher = base64.b64decode(cipher).decode()
804	            except Exception:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
824	        with open(url.fragment[1:]) as f:
825	            auth = f.read().rstrip().encode()
826	    else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
861	        except Exception:
862	            writer.close()
863	            raise Exception('Unknown remote protocol')

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
875	        while not reader.at_eof():
876	            s = await reader.read(65536)
877	            if not s:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
937	        with open(filename, 'rb') as f:
938	            args.httpget[path] = f.read()
939	    if args.daemon:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:1002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1001	    for server in servers:
1002	        server.close()
1003	    for server in servers:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_benign/pproxy-2.7.9-py3-none-any/pproxy/server.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1006	    loop.run_until_complete(loop.shutdown_asyncgens())
1007	    loop.close()
1008	

--------------------------------------------------

Code scanned:
	Total lines of code: 2572
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 106.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 108.0
		High: 18.0
Files skipped (0):
