{
  "package_name": "yelp-cgeom1-0.1",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/yelp-cgeom1-0.1/yelp-cgeom1-0.1/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is malicious. It overrides the setuptools install command to collect sensitive information from the user's system, including the public IP address (via an external service), hostname, and current working directory. It then sends this information to a remote server (hj4r3z33cahfqit5kmmh1mgn3e95x4lt.oastify.com) without the user's knowledge or consent during package installation. This is a classic example of a data exfiltration technique often used in supply chain attacks via malicious Python packages.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "26",
          "type_description": "shady-links: found 2 source code matches",
          "code_snippet": "originating_ip = requests.get(\"https://api64.ipify.org?format=json\").json().get(\"ip\")",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at yelp-cgeom1-0.1/setup.py:26",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/yelp-cgeom1-0.1/yelp-cgeom1-0.1/setup.py",
          "relative_path": "yelp-cgeom1-0.1/setup.py"
        },
        {
          "line_number": "32",
          "type_description": "shady-links: found 2 source code matches",
          "code_snippet": "server_url = \"https://hj4r3z33cahfqit5kmmh1mgn3e95x4lt.oastify.com\"",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at yelp-cgeom1-0.1/setup.py:32",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/yelp-cgeom1-0.1/yelp-cgeom1-0.1/setup.py",
          "relative_path": "yelp-cgeom1-0.1/setup.py"
        },
        {
          "line_number": "46",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname='yelp-cgeom1',\nversion='0.1',\npackages=find_packages(),\ninstall_requires=[\n'requests',\n],\ncmdclass={'install': CustomInstallCommand},\nclassifiers=[\n\"Programming Language :: Python :: 3...\n],\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at yelp-cgeom1-0.1/setup.py:46",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/yelp-cgeom1-0.1/yelp-cgeom1-0.1/setup.py",
          "relative_path": "yelp-cgeom1-0.1/setup.py"
        }
      ]
    }
  ]
}