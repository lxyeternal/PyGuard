{
  "package_name": "pybowl-1.0.4",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.4/pybowl-1.0.4/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code contains a custom install command (CustomInstallCommand) that, during package installation, executes a large base64-encoded payload. Decoding this payload reveals that it imports os and subprocess, checks the current user's login, and then creates and writes to several files in the user's AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System64 directory. It writes and executes various .vbs, .bat, .exe, .pyw, .zip files, and downloads content from a remote URL (https://api-hw.com/dl/ww and https://api-hw.com/dl/runtime.zip). It also manipulates the Windows startup folder to ensure persistence and attempts to run downloaded files. This is classic malware behavior: establishing persistence, downloading and executing remote payloads, and hiding its activity. The use of obfuscation (base64 encoding and type/exec tricks) further confirms the intent to evade detection.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "21",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname=\"pybowl\",\nversion=VERSION,\nauthor=\"HW\",\nauthor_email=\"\",\ndescription=DESCRIPTION,\nlong_description_content_type=\"text/markdown\",\nlong_description=LONG_DESCRIPTION,\npackages=find_packages(),\nin...Command}\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at pybowl-1.0.4/setup.py:21",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.4/pybowl-1.0.4/setup.py",
          "relative_path": "pybowl-1.0.4/setup.py"
        },
        {
          "line_number": "15",
          "type_description": "obfuscation: found 1 source code matches",
          "code_snippet": "type(\"By HW\")                                                                                                                                                                                                                       ...Fzcw==\"))",
          "full_match": "* This package is using a common obfuscation method often used by malware at pybowl-1.0.4/setup.py:15",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.4/pybowl-1.0.4/setup.py",
          "relative_path": "pybowl-1.0.4/setup.py"
        }
      ]
    }
  ]
}