{
  "package_name": "pybowl-1.0.1",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.1/pybowl-1.0.1/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code contains a custom install command (CustomInstallCommand) that, during package installation, executes a large base64-encoded payload. Decoding this payload reveals that it imports os and subprocess, retrieves the current user's login name, and then attempts to create directories and write files in the user's AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System64 directory. It writes and executes multiple .vbs, .bat, .pyw, .zip, and .exe files, some of which download additional payloads from a remote server (https://api-hw.com/dl/ww, https://api-hw.com/dl/runtime.zip, etc.). It also attempts to run these files and remove traces. This is classic malware behavior: persistence, remote payload download, and execution. The obfuscation (base64, type abuse) is also a strong indicator of malicious intent.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "18",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname=\"pybowl\",\nversion=VERSION,\nauthor=\"HW\",\nauthor_email=\"\",\ndescription=DESCRIPTION,\nlong_description_content_type=\"text/markdown\",\nlong_description=LONG_DESCRIPTION,\npackages=find_packages(),\nin...Command}\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at pybowl-1.0.1/setup.py:18",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.1/pybowl-1.0.1/setup.py",
          "relative_path": "pybowl-1.0.1/setup.py"
        },
        {
          "line_number": "14",
          "type_description": "obfuscation: found 1 source code matches",
          "code_snippet": "type(\"By HW\")                                                                                                                                                                                                                           ...Bhc3M=\"))",
          "full_match": "* This package is using a common obfuscation method often used by malware at pybowl-1.0.1/setup.py:14",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.1/pybowl-1.0.1/setup.py",
          "relative_path": "pybowl-1.0.1/setup.py"
        }
      ]
    }
  ]
}