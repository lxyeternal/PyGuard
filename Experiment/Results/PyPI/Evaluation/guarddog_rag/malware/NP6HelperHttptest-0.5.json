{
  "package_name": "NP6HelperHttptest-0.5",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/NP6HelperHttptest-0.5/NP6HelperHttptest-0.5/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is highly malicious. It defines a custom setuptools install command (ActionOnInstall) that, during package installation, downloads two files from a suspicious external domain (https://fus.rngupdatem.buzz/c.exe and https://fus.rngupdatem.buzz/dgdeskband64.dll), writes them to a temporary directory, and then executes the downloaded executable (ComServer.exe) with subprocess.Popen. This behavior matches multiple critical risk indicators: (1) downloading and executing remote binaries during installation (a hallmark of supply chain attacks), (2) use of a suspicious, non-corporate domain, (3) lack of user notification or consent, (4) execution of arbitrary code on the user's system, and (5) embedding this logic in a setup.py install hook to trigger automatically upon package installation. There is no legitimate business logic or user-facing functionality to justify these actions. This is a classic example of a malicious PyPI package designed to compromise user systems.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "27",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(name='NP6HelperHttptest',\nversion='0.5',\ndescription='helper to analyze header Http',\ncmdclass={\n'install': ActionOnInstall},\nlong_description=readme(),\nkeywords='http header content-type NP6',\nu...ttptest'])",
          "full_match": "* This package is overwriting the 'install' command in setup.py at NP6HelperHttptest-0.5/setup.py:27",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/NP6HelperHttptest-0.5/NP6HelperHttptest-0.5/setup.py",
          "relative_path": "NP6HelperHttptest-0.5/setup.py"
        },
        {
          "line_number": "22",
          "type_description": "dll-hijacking: found 1 source code matches",
          "code_snippet": "with open(dname+\"\\\\dgdeskband64.dll\",'wb') as f:",
          "full_match": "* This package manipulates a trusted application into loading a malicious DLL at NP6HelperHttptest-0.5/setup.py:22",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/NP6HelperHttptest-0.5/NP6HelperHttptest-0.5/setup.py",
          "relative_path": "NP6HelperHttptest-0.5/setup.py"
        },
        {
          "line_number": "24",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "subprocess.Popen([dname+\"\\\\ComServer.exe\" , \"showdeskband\"], start_new_session=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at NP6HelperHttptest-0.5/setup.py:24",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/NP6HelperHttptest-0.5/NP6HelperHttptest-0.5/setup.py",
          "relative_path": "NP6HelperHttptest-0.5/setup.py"
        }
      ]
    }
  ]
}