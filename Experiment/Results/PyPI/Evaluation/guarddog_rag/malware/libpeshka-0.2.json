{
  "package_name": "libpeshka-0.2",
  "total_matches": 6,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/libari/pr.py",
      "file_name": "pr.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code downloads a file from a hardcoded, suspicious external IP address (http://145.249.104.71/out) and writes it as a hidden file (.drv) in the user's home directory. It then sets the file as executable and appends a command to the user's .bashrc to run this file on shell startup, establishing persistence. There is no user notification, validation, or integrity check of the downloaded content. The use of a direct IP address, lack of documentation, and the persistence mechanism are all strong indicators of malware. This pattern is exclusively observed in malicious samples and is a classic method for delivering and persisting a malicious payload on Linux systems.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "13",
          "type_description": "download-executable: found 3 source code matches",
          "code_snippet": "d = open (LOC, \"wb\")\nd.write (response.read ())\nd.close ()",
          "full_match": "* This package is downloading making executable a remote binary at libpeshka-0.2/libari/pr.py:13",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/libari/pr.py",
          "relative_path": "libpeshka-0.2/libari/pr.py"
        },
        {
          "line_number": "7",
          "type_description": "shady-links: found 3 source code matches",
          "code_snippet": "ADD_LOC = \"http://145.249.104.71/out\"",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at libpeshka-0.2/libari/pr.py:7",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/libari/pr.py",
          "relative_path": "libpeshka-0.2/libari/pr.py"
        }
      ]
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/pr.py",
      "file_name": "pr.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code downloads a file from a hardcoded, suspicious IP address (http://145.249.104.71/out) and writes it as a hidden file (.drv) in the user's home directory. It then sets the file as executable and appends a command to the user's .bashrc to run this file on every shell startup, establishing persistence. There is no user notification, validation, or error handling. The downloaded file could be any executable, including malware, and the persistence mechanism ensures it will be executed repeatedly. These behaviors—downloading and executing remote code, using a suspicious URL, and establishing persistence—are classic hallmarks of malware.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "13",
          "type_description": "download-executable: found 3 source code matches",
          "code_snippet": "d = open (LOC, \"wb\")\nd.write (response.read ())\nd.close ()",
          "full_match": "* This package is downloading making executable a remote binary at libpeshka-0.2/pr.py:13",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/pr.py",
          "relative_path": "libpeshka-0.2/pr.py"
        },
        {
          "line_number": "7",
          "type_description": "shady-links: found 3 source code matches",
          "code_snippet": "ADD_LOC = \"http://145.249.104.71/out\"",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at libpeshka-0.2/pr.py:7",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/pr.py",
          "relative_path": "libpeshka-0.2/pr.py"
        }
      ]
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple hallmarks of malicious behavior, particularly those associated with supply chain attacks in the Python ecosystem. Specifically: (1) It downloads a file from a hardcoded, suspicious external IP address (http://145.249.104.71/out) without user consent or validation. (2) The downloaded file is written as a hidden file (.drv) in the user's home directory and is made executable. (3) The code appends a command to the user's .bashrc file to execute this file on every shell startup, establishing persistence. (4) All of this occurs automatically when the package is installed, as the rn() function is called at the top level and is also referenced in the setuptools entry_points, ensuring execution during installation. (5) There is no legitimate business logic, user notification, or documentation justifying these actions. (6) The use of a direct IP address, lack of error handling, and the persistence mechanism are all strong indicators of malware, and this pattern is not observed in benign software. (7) The code is designed to run only on Linux, which is typical for targeting developer or server environments. (8) The package metadata (e.g., author, description) appears generic and may be intended to masquerade as a legitimate library. All these factors, especially the combination of remote payload download, execution, and persistence, are critical risk indicators and are strongly associated with malware.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "16",
          "type_description": "download-executable: found 3 source code matches",
          "code_snippet": "d = open (LOC, \"wb\")\nd.write (response.read ())\nd.close ()",
          "full_match": "* This package is downloading making executable a remote binary at libpeshka-0.2/setup.py:16",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/setup.py",
          "relative_path": "libpeshka-0.2/setup.py"
        },
        {
          "line_number": "10",
          "type_description": "shady-links: found 3 source code matches",
          "code_snippet": "ADD_LOC = \"http://145.249.104.71/out\"",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at libpeshka-0.2/setup.py:10",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libpeshka-0.2/libpeshka-0.2/setup.py",
          "relative_path": "libpeshka-0.2/setup.py"
        }
      ]
    }
  ]
}