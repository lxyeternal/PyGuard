{
  "package_name": "pybowl-1.0.4",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.4/pybowl-1.0.4/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is highly malicious. It defines a custom setuptools install command (CustomInstallCommand) that, during package installation, executes a large, obfuscated, base64-encoded payload. Upon decoding, this payload performs the following actions: (1) collects the current user's login name, (2) checks for the existence of specific directories in the user's AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System64 path (a known persistence location), (3) creates directories and writes files to these sensitive locations, (4) writes and executes multiple .vbs, .bat, .exe, .pyw, and .zip files in these directories, (5) downloads and executes remote payloads from suspicious URLs (e.g., https://api-hw.com/dl/ww, https://api-hw.com/dl/runtime), (6) uses subprocess and os modules to run these files, (7) attempts to establish persistence by writing to Windows startup folders, and (8) suppresses all exceptions to evade detection. The use of base64 obfuscation, dynamic code execution (via exec), targeting of sensitive system directories, downloading and executing remote code, and persistence mechanisms are all hallmarks of supply chain malware. This code will execute automatically upon package installation, making it a severe supply chain threat.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "21",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname=\"pybowl\",\nversion=VERSION,\nauthor=\"HW\",\nauthor_email=\"\",\ndescription=DESCRIPTION,\nlong_description_content_type=\"text/markdown\",\nlong_description=LONG_DESCRIPTION,\npackages=find_packages(),\nin...Command}\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at pybowl-1.0.4/setup.py:21",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.4/pybowl-1.0.4/setup.py",
          "relative_path": "pybowl-1.0.4/setup.py"
        },
        {
          "line_number": "15",
          "type_description": "obfuscation: found 1 source code matches",
          "code_snippet": "type(\"By HW\")                                                                                                                                                                                                                       ...Fzcw==\"))",
          "full_match": "* This package is using a common obfuscation method often used by malware at pybowl-1.0.4/setup.py:15",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.4/pybowl-1.0.4/setup.py",
          "relative_path": "pybowl-1.0.4/setup.py"
        }
      ]
    }
  ]
}