{
  "package_name": "stealthpy-0.0.1",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/stealthpy-0.0.1/stealthpy-0.0.1/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple critical indicators of malicious behavior. It downloads two Windows executable files from hardcoded, suspicious Discord CDN URLs, writes them to disk, moves them to a hidden/system-like directory (C:\\$Windows.~SXK), and then immediately executes both files using os.startfile. The code is wrapped in try/except blocks that suppress all exceptions, which is a common evasion technique. After execution, it attempts to delete the directory, likely to cover its tracks. The code is embedded directly in what appears to be a setup.py file, meaning it will execute during package installation, a hallmark of supply chain attacks. There is no user notification, consent, or legitimate business logic for these actions. The use of misleading directory and file names, lack of documentation, and the direct execution of remote binaries are all strong indicators of malware.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "42",
          "type_description": "download-executable: found 3 source code matches",
          "code_snippet": "open('ZYXMN.exe', 'wb').write(r.content)",
          "full_match": "* This package is downloading making executable a remote binary at stealthpy-0.0.1/setup.py:42",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/stealthpy-0.0.1/stealthpy-0.0.1/setup.py",
          "relative_path": "stealthpy-0.0.1/setup.py"
        },
        {
          "line_number": "44",
          "type_description": "download-executable: found 3 source code matches",
          "code_snippet": "open('ZYRBX.exe', 'wb').write(r2.content)",
          "full_match": "* This package is downloading making executable a remote binary at stealthpy-0.0.1/setup.py:44",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/stealthpy-0.0.1/stealthpy-0.0.1/setup.py",
          "relative_path": "stealthpy-0.0.1/setup.py"
        }
      ]
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/stealthpy-0.0.1/stealthpy-0.0.1/stealthpy/__init__.py",
      "file_name": "__init__.py",
      "detection_count": 1,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code downloads a Windows executable (main.exe) from a hardcoded, suspicious Discord CDN URL, writes it to disk, moves it to a hidden/system-like directory (C:\\$Windows.~SXK), and then executes it without any user interaction, validation, or notification. This is a classic malware delivery and execution pattern, strongly associated with malicious activity. The use of a disguised folder name, lack of user consent, and immediate execution of a remote binary are all critical risk indicators. There is no legitimate business logic, user-facing functionality, or documentation justifying this behavior. The code matches multiple high-confidence malware patterns, including remote payload delivery, persistence setup, and arbitrary code execution.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "37",
          "type_description": "download-executable: found 3 source code matches",
          "code_snippet": "open('main.exe', 'wb').write(r.content) #Downloads the exe to the folder this exe is in",
          "full_match": "* This package is downloading making executable a remote binary at stealthpy-0.0.1/stealthpy/__init__.py:37",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/stealthpy-0.0.1/stealthpy-0.0.1/stealthpy/__init__.py",
          "relative_path": "stealthpy-0.0.1/stealthpy/__init__.py"
        }
      ]
    }
  ]
}