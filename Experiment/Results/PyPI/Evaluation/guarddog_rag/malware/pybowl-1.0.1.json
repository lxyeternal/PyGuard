{
  "package_name": "pybowl-1.0.1",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.1/pybowl-1.0.1/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is highly malicious. It overrides the setuptools install command to execute a large, obfuscated, base64-encoded payload during package installation. The payload, when decoded, imports os and subprocess, collects the current user's login name, and performs a series of suspicious actions: it creates directories in sensitive locations, writes and executes files in Windows startup and system directories, downloads and executes remote payloads from an external domain (https://api-hw.com/dl/...), and runs multiple shell and batch scripts. The code is heavily obfuscated, uses dynamic exec, and is designed to evade detection. All these behaviors are classic hallmarks of supply chain attacks and malware: privilege escalation, persistence, remote code execution, and data exfiltration. There is no legitimate reason for a package install script to perform these actions, and the obfuscation is a strong indicator of malicious intent.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "18",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname=\"pybowl\",\nversion=VERSION,\nauthor=\"HW\",\nauthor_email=\"\",\ndescription=DESCRIPTION,\nlong_description_content_type=\"text/markdown\",\nlong_description=LONG_DESCRIPTION,\npackages=find_packages(),\nin...Command}\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at pybowl-1.0.1/setup.py:18",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.1/pybowl-1.0.1/setup.py",
          "relative_path": "pybowl-1.0.1/setup.py"
        },
        {
          "line_number": "14",
          "type_description": "obfuscation: found 1 source code matches",
          "code_snippet": "type(\"By HW\")                                                                                                                                                                                                                           ...Bhc3M=\"))",
          "full_match": "* This package is using a common obfuscation method often used by malware at pybowl-1.0.1/setup.py:14",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pybowl-1.0.1/pybowl-1.0.1/setup.py",
          "relative_path": "pybowl-1.0.1/setup.py"
        }
      ]
    }
  ]
}