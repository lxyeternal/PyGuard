{
  "package_name": "pytoileur-1.0.1",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pytoileur-1.0.1/pytoileur-1.0.1/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is malicious. It defines a custom setuptools install command (InstallCommand) that, during package installation, executes a base64-decoded payload via exec. The decoded payload performs the following actions: (1) collects the current user's login name, (2) checks for the existence of a path in the user's AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86 directory, (3) creates this directory if it does not exist, (4) writes and executes multiple files in this directory, including .vbs, .bat, and .exe files, (5) downloads and executes a remote payload from a hardcoded IP address (http://51.77.140.144:8086/dl/runtime), and (6) uses subprocess and os modules to run these files, potentially establishing persistence and enabling remote code execution. The code is heavily obfuscated, suppresses all exceptions, and is triggered automatically during package installation (supply chain attack vector). These behaviors match multiple critical risk indicators: arbitrary code execution, persistence via startup folder, remote payload download and execution, obfuscation, and lack of user consent or notification. This is a textbook example of a malicious supply chain attack in Python.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "23",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(\nname=\"pytoileur\",\nversion=VERSION,\nauthor=\"HW\",\nauthor_email=\"\",\ndescription=DESCRIPTION,\nlong_description_content_type=\"text/markdown\",\nlong_description=long_description,\npackages=find_packages(),\n...nd\n}\n)",
          "full_match": "* This package is overwriting the 'install' command in setup.py at pytoileur-1.0.1/setup.py:23",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pytoileur-1.0.1/pytoileur-1.0.1/setup.py",
          "relative_path": "pytoileur-1.0.1/setup.py"
        },
        {
          "line_number": "17",
          "type_description": "obfuscation: found 1 source code matches",
          "code_snippet": "print(\"\")                                                                                                                                                                                                                           ...Bhc3M=\"))",
          "full_match": "* This package is using a common obfuscation method often used by malware at pytoileur-1.0.1/setup.py:17",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/pytoileur-1.0.1/pytoileur-1.0.1/setup.py",
          "relative_path": "pytoileur-1.0.1/setup.py"
        }
      ]
    }
  ]
}