Run started:2025-05-25 16:16:06.189734

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/aave_v3/deployer.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
345	#: (No patches yet)
346	AAVE_DEPLOYER_REPO = "https://github.com/tradingstrategy-ai/aave-v3-deploy.git"
347	
348	
349	#: List of manually parsed addressed from Hardhat deployment
350	#:
351	#:
352	HARDHAT_CONTRACTS = {

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/chain.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
118	            api_counter["total"] += 1
119	            return make_request(method, params)
120	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/chain.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
118	            api_counter["total"] += 1
119	            return make_request(method, params)
120	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/chain.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
150	            api_counter["total"] += 1
151	            return make_request(method, params)
152	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/chain.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
150	            api_counter["total"] += 1
151	            return make_request(method, params)
152	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/chain.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	    try:
204	        resp = requests.get(graphql_url, json={"query": "query{block{number}}"})
205	        return resp.status_code == 200 and resp.json()["data"]["block"]["number"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/docs/monkeypatch.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	    self.current_docname = docname
82	    self.docwriter.write(doctree, destination)
83	    self.docwriter.assemble_parts()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/event_reader/json_state.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	            with open(self.fname, "rt", encoding="utf-8") as f:
30	                last_block_text = f.read()
31	                return True, int(last_block_text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/event_reader/reader.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
538	        ):
539	            last_timestamp = event.get("timestamp")
540	            total_events += 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/event_reader/reader.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
744	                        # Assume extracted with extract_timestamps_json_rpc
745	                        last_timestamp = log.get("timestamp")
746	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/foundry/forge.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	
72	    output = proc.stdout.read().decode("utf-8") + proc.stderr.read().decode("utf-8")
73	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/foundry/forge.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	
72	    output = proc.stdout.read().decode("utf-8") + proc.stderr.read().decode("utf-8")
73	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	            if type(arg) == dict:
219	                code = arg.get("code")
220	                message = arg.get("message", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	                code = arg.get("code")
220	                message = arg.get("message", "")
221	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
278	                try:
279	                    return make_request(method, params)
280	                # https://github.com/python/mypy/issues/5349

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
298	            try:
299	                return make_request(method, params)
300	            except Exception as e:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
379	                )
380	                return make_request(method, [transaction])
381	        return make_request(method, params)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
380	                return make_request(method, [transaction])
381	        return make_request(method, params)
382	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
423	            if method != "eth_sendTransaction":
424	                return make_request(method, params)
425	            else:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
428	            if "from" not in transaction:
429	                return make_request(method, params)
430	            elif transaction.get("from") not in accounts:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
429	                return make_request(method, params)
430	            elif transaction.get("from") not in accounts:
431	                return make_request(method, params)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
430	            elif transaction.get("from") not in accounts:
431	                return make_request(method, params)
432	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
434	            raw_tx = account.sign_transaction(transaction).rawTransaction
435	            return make_request(RPCEndpoint("eth_sendRawTransaction"), [raw_tx.hex()])
436	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
454	        if method in STATIC_CALL_LIST:
455	            cached = cache.get(method)
456	            if cached:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/middleware.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
458	
459	        resp = make_request(method, params)
460	        cache[method] = resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
139	    try:
140	        response = web3.provider.make_request(method, args)  # type: ignore
141	        if "result" in response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	    anvil = shutil.which("anvil")
386	    assert anvil is not None, f"anvil command not in PATH {os.environ.get('PATH')}"
387	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
394	
395	    url = f"http://localhost:{port}"
396	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
477	    """
478	    web3.provider.make_request("anvil_impersonateAccount", [address])  # type: ignore
479	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
482	    """Call emv_increaseTime on Anvil"""
483	    make_anvil_custom_rpc_request(web3, "evm_increaseTime", [hex(seconds)])
484	    return seconds

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
490	    if timestamp is None:
491	        make_anvil_custom_rpc_request(web3, "evm_mine")
492	        # block = web3.eth.get_block(web3.eth.block_number)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
494	    else:
495	        make_anvil_custom_rpc_request(web3, "evm_mine", [timestamp])
496	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
499	    """Call evm_snapshot on Anvil"""
500	    return int(make_anvil_custom_rpc_request(web3, "evm_snapshot", []), 16)
501	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
510	    """
511	    ret_val = make_anvil_custom_rpc_request(web3, "evm_revert", [snapshot_id])
512	    return ret_val

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
516	    """Call evm_snapshot on Anvil"""
517	    return make_anvil_custom_rpc_request(web3, "anvil_dumpState")
518	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/anvil.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
521	    """Call evm_snapshot on Anvil"""
522	    return make_anvil_custom_rpc_request(web3, "anvil_loadState", [state])
523	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/fallback.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
183	                # Call the underlying provider
184	                resp_data = provider.make_request(method, params)
185	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/ganache.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
388	
389	    url = f"http://localhost:{port}"
390	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/llamanodes.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	        content = resp.json()
21	        return content.get("error").get("message") == "UserKey was not a ULID or UUID"
22	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/provider/llamanodes.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	        content = resp.json()
21	        return content.get("error").get("message") == "UserKey was not a ULID or UUID"
22	    except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/terms_of_service/acceptance_message.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	INITIAL_ACCEPTANCE_MESSAGE = """
24	I read and agree on terms of service (version 1) to use

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/token_analysis/tokensniffer.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	
452	        url = f"https://tokensniffer.com/api/v2/tokens/{chain_id}/{address}"
453	        resp = self.session.get(url, params=parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/token_analysis/tokensniffer.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
452	        url = f"https://tokensniffer.com/api/v2/tokens/{chain_id}/{address}"
453	        resp = self.session.get(url, params=parameters)
454	        if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/token_analysis/tokensniffer.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
603	        cache_key = f"{chain_id}-{address}"
604	        cached = self.cache.get(cache_key)
605	        if not cached:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/uniswap_v3/constants.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	UNISWAP_V3_SUBGRAPH_ENDPOINTS = {
65	    1 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/5zvR82QoaXYFyDEKLZ9t6v9adgnptxYpKpSbxtgVENFV",
66	    42161 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/FbCGRftH4a3yZugY7TnbYgPJVEv2LvMT6oF1fxPe9aJM",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/uniswap_v3/constants.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    1 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/5zvR82QoaXYFyDEKLZ9t6v9adgnptxYpKpSbxtgVENFV",
66	    42161 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/FbCGRftH4a3yZugY7TnbYgPJVEv2LvMT6oF1fxPe9aJM",
67	    10 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/Cghf4LfVqPiFw6fp6Y5X5Ubc8UpmUhSfJL82zwiBFLaj",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/uniswap_v3/constants.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    42161 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/FbCGRftH4a3yZugY7TnbYgPJVEv2LvMT6oF1fxPe9aJM",
67	    10 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/Cghf4LfVqPiFw6fp6Y5X5Ubc8UpmUhSfJL82zwiBFLaj",
68	    8453 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/3RGpVwLywy5nNV17BPRC3QvGZPwKXQFQLsSK6Txr2jzi"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/uniswap_v3/constants.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	    10 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/Cghf4LfVqPiFw6fp6Y5X5Ubc8UpmUhSfJL82zwiBFLaj",
68	    8453 : f"https://gateway-arbitrum.network.thegraph.com/api/$/subgraphs/id/3RGpVwLywy5nNV17BPRC3QvGZPwKXQFQLsSK6Txr2jzi"
69	}

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
32	
33	    a_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
34	    location = (host, port)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/utils.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
67	        logger.info("Attempting to allocate port %d to Anvil", random_port)
68	        if not is_localhost_port_listening(random_port, "127.0.0.1"):
69	            return random_port

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/vault/valuation.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
804	
805	            return call_multicall_batched_single_thread(
806	                multicall_contract,
807	                calls=calls,
808	                block_identifier=self.block_identifier,
809	                batch_size=self.batch_size,
810	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/config.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	#: Where do we hit our requets
4	VELVET_DEFAULT_API_URL = "https://eventsapi.velvetdao.xyz/api/v3"
5	
6	#: Velvet APIs that return tx payload underestimate gas
7	VELVET_GAS_EXTRA_SAFETY_MARGIN = 500_000

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/deposit.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
64	
65	    resp = requests.post(url, json=payload)
66	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/enso.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	        try:
89	            resp = session.post(url, json=payload)
90	            resp.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/enso.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
94	            logger.warning("Run out of retries")
95	            resp = requests.post(url, json=payload)
96	            resp.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/redeem.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	
55	    resp = requests.post(url, json=payload)
56	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/vault.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	#: Signing API URL
31	DEFAULT_VELVET_API_URL = "https://eventsapi.velvetdao.xyz/api/v3"
32	
33	
34	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/vault.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	        # url = f"https://api.velvet.capital/api/v3/portfolio/{self.spec.vault_address}"
123	        url = f"https://eventsapi.velvetdao.xyz/api/v3/portfolio/{self.spec.vault_address}"
124	        data = self.session.get(url).json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/vault.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	        url = f"https://eventsapi.velvetdao.xyz/api/v3/portfolio/{self.spec.vault_address}"
124	        data = self.session.get(url).json()
125	        if ("error" in data) or ("message" in data):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi-0.28.1/eth_defi/velvet/vault.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
323	        url = f"{self.api_url}/{endpoint}"
324	        resp = self.session.get(url)
325	        resp.raise_for_status()

--------------------------------------------------

Code scanned:
	Total lines of code: 21267
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 46.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 59.0
		High: 1.0
Files skipped (0):
