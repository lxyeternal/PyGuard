Run started:2025-05-25 16:00:50.950340

Test results:
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/data/websocket-agent-001/main.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
74	                    
75	                await websocket.send(json.dumps(response))
76	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/data/websocket-agent-001/main.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	        await service.stop()
106	        server.close()
107	        await server.wait_closed()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
38	try:
39	    shutil.rmtree(output_dir)
40	except FileNotFoundError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
274	intersphinx_mapping = {
275	    "sphinx": ("https://www.sphinx-doc.org/en/master", None),
276	    "python": ("https://docs.python.org/" + python_version, None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
275	    "sphinx": ("https://www.sphinx-doc.org/en/master", None),
276	    "python": ("https://docs.python.org/" + python_version, None),
277	    "matplotlib": ("https://matplotlib.org", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	    "python": ("https://docs.python.org/" + python_version, None),
277	    "matplotlib": ("https://matplotlib.org", None),
278	    "numpy": ("https://numpy.org/doc/stable", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	    "matplotlib": ("https://matplotlib.org", None),
278	    "numpy": ("https://numpy.org/doc/stable", None),
279	    "sklearn": ("https://scikit-learn.org/stable", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
278	    "numpy": ("https://numpy.org/doc/stable", None),
279	    "sklearn": ("https://scikit-learn.org/stable", None),
280	    "pandas": ("https://pandas.pydata.org/pandas-docs/stable", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
279	    "sklearn": ("https://scikit-learn.org/stable", None),
280	    "pandas": ("https://pandas.pydata.org/pandas-docs/stable", None),
281	    "scipy": ("https://docs.scipy.org/doc/scipy/reference", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
280	    "pandas": ("https://pandas.pydata.org/pandas-docs/stable", None),
281	    "scipy": ("https://docs.scipy.org/doc/scipy/reference", None),
282	    "setuptools": ("https://setuptools.pypa.io/en/stable/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	    "scipy": ("https://docs.scipy.org/doc/scipy/reference", None),
282	    "setuptools": ("https://setuptools.pypa.io/en/stable/", None),
283	    "pyscaffold": ("https://pyscaffold.org/en/stable", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/docs/conf.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
282	    "setuptools": ("https://setuptools.pypa.io/en/stable/", None),
283	    "pyscaffold": ("https://pyscaffold.org/en/stable", None),
284	}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/examples/gemini_agent_docker.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	    with open(os.path.join(os.path.dirname(__file__), "gemini_agent_config.py"), "r") as f:
58	        agent_code = f.read()
59	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/agent_manager.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
136	        with open(entry_path, "r") as f:
137	            code = f.read()
138	            

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/agent_manager.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
143	            with open(prompt_path, "r") as f:
144	                prompt = f.read()
145	                

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
37	    tar_stream = io.BytesIO()
38	    with tarfile.open(fileobj=tar_stream, mode='w') as tar:
39	        tarinfo = tarfile.TarInfo(name=name)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
92	        
93	        with open(os.path.join(temp_dir, "agent_code.py"), "w") as f:
94	            f.write(agent_package.get("code", ""))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	        with open(os.path.join(temp_dir, "agent_code.py"), "w") as f:
94	            f.write(agent_package.get("code", ""))
95	            

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
93	        with open(os.path.join(temp_dir, "agent_code.py"), "w") as f:
94	            f.write(agent_package.get("code", ""))
95	            

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
95	            
96	        with open(os.path.join(temp_dir, "requirements.txt"), "w") as f:
97	            f.write("\n".join(agent_package.get("dependencies", [])))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	        with open(os.path.join(temp_dir, "requirements.txt"), "w") as f:
97	            f.write("\n".join(agent_package.get("dependencies", [])))
98	            

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
96	        with open(os.path.join(temp_dir, "requirements.txt"), "w") as f:
97	            f.write("\n".join(agent_package.get("dependencies", [])))
98	            

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
98	            
99	        with open(os.path.join(temp_dir, "entrypoint.sh"), "w") as f:
100	            f.write("""#!/bin/bash

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	        with open(os.path.join(temp_dir, "entrypoint.sh"), "w") as f:
100	            f.write("""#!/bin/bash
101	set -e

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
99	        with open(os.path.join(temp_dir, "entrypoint.sh"), "w") as f:
100	            f.write("""#!/bin/bash
101	set -e

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
106	""")
107	        os.chmod(os.path.join(temp_dir, "entrypoint.sh"), 0o755)
108	        

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:107
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
106	""")
107	        os.chmod(os.path.join(temp_dir, "entrypoint.sh"), 0o755)
108	        

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
175	                    if os.path.exists(output_path):
176	                        with open(output_path, "r") as f:
177	                            output = json.load(f)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/docker.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
278	            try:
279	                shutil.rmtree(self.temp_dirs[session_id])
280	                del self.temp_dirs[session_id]

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/python.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
69	        
70	        exec(code, namespace)
71	        

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/python.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
142	        
143	        process = multiprocessing.Process(
144	            target=_execute_agent_task,
145	            args=(agent_code, session.context, result_queue)
146	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/resource.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	            with open(f"{cg_path}/cpu.max", "w") as f:
47	                f.write(f"{int(quota.cpu * 100000)} 100000")
48	                

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/resource.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	            with open(f"{cg_path}/memory.max", "w") as f:
50	                f.write(str(quota.memory))
51	                

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/resource.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	            with open(f"{cg_path}/io.max", "w") as f:
53	                f.write(f"rbps={quota.disk} wbps={quota.disk}")
54	                

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/resource.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	                with open(f"{cg_path}/cpu.max", "w") as f:
89	                    f.write(f"{int(quota.cpu * 100000)} 100000")
90	                    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/resource.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	                with open(f"{cg_path}/memory.max", "w") as f:
93	                    f.write(str(quota.memory))
94	                    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/resource.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	                with open(f"{cg_path}/io.max", "w") as f:
97	                    f.write(f"rbps={quota.disk} wbps={quota.disk}")
98	            

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/agents/runtime/resource.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
133	            cg_path = self.active_quotas[container_id]["path"]
134	            shutil.rmtree(cg_path)
135	            del self.active_quotas[container_id]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/cli/commands/agent/lifecycle.py:708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
707	        data_dir = args.data_dir or context.options.get("data_dir", "~/.mcps/agents")
708	        repo_url = args.repo or context.options.get("repo_url", "https://mcps.example.com/agents")
709	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/cli/commands/agent/lifecycle.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
735	                with open(os.path.join(agent_dir, "main.py"), "w") as f:
736	                    f.write("""
737	import sys

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/cli/commands/agent/lifecycle.py:781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
780	                with open(os.path.join(agent_dir, "main.py"), "w") as f:
781	                    f.write("""
782	import sys

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/config/cache.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	            if file_exists:
154	                f.write("\n" + log_data)
155	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/config/cache.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	            else:
156	                f.write(log_data)
157	        logger.debug(f"Saved log to {log_path}")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/config/cache.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
177	                import shutil
178	                shutil.rmtree(item)
179	        logger.info(f"Cleaned up temporary directory: {temp_dir}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/core/transports/http.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        try:
32	            response = self.session.get(f"{self.base_url}/health", timeout=self.timeout)
33	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/core/transports/http.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
49	        try:
50	            response = self.session.post(
51	                f"{self.base_url}/api/v1/invoke",
52	                json=payload,
53	                timeout=self.timeout
54	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/tools/remote/http.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	                token=credentials['token'],
30	                token_type=credentials.get('token_type', 'Bearer')
31	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/tools/remote/http.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
49	        try:
50	            response = self._session.post(url, json=params)
51	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/tools/remote/http.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	                success=True,
57	                result=result.get('result'),
58	                execution_time=execution_time,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/tools/remote/http.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	                execution_time=execution_time,
59	                metadata=result.get('metadata')
60	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/tools/remote/http.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	        try:
80	            response = self._session.get(url)
81	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/tools/remote/http.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
114	        try:
115	            response = self._session.post(url, json=params)
116	            return response.status_code == 200

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/src/mcps/utils/cache/log.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
70	            with open(log_path, "r") as f:
71	                log_data = f.read().rstrip()
72	            

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/lifecycle/data/basic_agent/main.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    with open("prompt.txt", "r") as f:
14	        return f.read()
15	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/lifecycle/data/websocket_agent/main.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
74	                    
75	                await websocket.send(json.dumps(response))
76	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/lifecycle/data/websocket_agent/main.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	        await service.stop()
106	        server.close()
107	        await server.wait_closed()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/lifecycle/fake_agent.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
237	                if not self.running:
238	                    await websocket.send(json.dumps({
239	                        "status": "error",
240	                        "message": "Agent is not running"
241	                    }))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/lifecycle/fake_agent.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
257	                        
258	                    await websocket.send(json.dumps(response))
259	                    

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/lifecycle/fake_agent.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
261	                    logger.error(f"Error handling WebSocket message: {e}")
262	                    await websocket.send(json.dumps({
263	                        "status": "error",
264	                        "message": str(e)
265	                    }))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/lifecycle/fake_agent.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
279	        if self.server:
280	            self.server.close()
281	            logger.info(f"WebSocket server for agent {self.agent_id} stopped")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	    with open(os.path.join(temp_dir, "agent_code.py"), "r") as f:
80	        assert f.read() == agent_package["code"]
81	        

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	    with open(os.path.join(temp_dir, "requirements.txt"), "r") as f:
83	        assert f.read() == "requests==2.28.1"
84	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
193	        with open(os.path.join(temp_dir, "agent_code.py"), "w") as f:
194	            f.write(agent_code)
195	        

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
193	        with open(os.path.join(temp_dir, "agent_code.py"), "w") as f:
194	            f.write(agent_code)
195	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
196	        with open(os.path.join(temp_dir, "requirements.txt"), "w") as f:
197	            f.write("")  # No dependencies
198	        

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
196	        with open(os.path.join(temp_dir, "requirements.txt"), "w") as f:
197	            f.write("")  # No dependencies
198	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
199	        with open(os.path.join(temp_dir, "entrypoint.sh"), "w") as f:
200	            f.write("""#!/bin/bash
201	set -e

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
199	        with open(os.path.join(temp_dir, "entrypoint.sh"), "w") as f:
200	            f.write("""#!/bin/bash
201	set -e

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
203	""")
204	        os.chmod(os.path.join(temp_dir, "entrypoint.sh"), 0o755)
205	        

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:204
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
203	""")
204	        os.chmod(os.path.join(temp_dir, "entrypoint.sh"), 0o755)
205	        

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/runtime/test_docker.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
247	                runtime.cleanup(session.session_id)
248	            shutil.rmtree(temp_dir)
249	        except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	    with open(os.path.join(temp_dir, "basic-agent-001", "main.py"), "w") as f:
50	        f.write("""
51	import sys

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
49	    with open(os.path.join(temp_dir, "basic-agent-001", "main.py"), "w") as f:
50	        f.write("""
51	import sys

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	    with open(os.path.join(temp_dir, "grpc-agent-001", "main.py"), "w") as f:
86	        f.write("""
87	import sys

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
85	    with open(os.path.join(temp_dir, "grpc-agent-001", "main.py"), "w") as f:
86	        f.write("""
87	import sys

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
123	    with open(os.path.join(temp_dir, "websocket-agent-001", "main.py"), "w") as f:
124	        f.write("""
125	import sys

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
123	    with open(os.path.join(temp_dir, "websocket-agent-001", "main.py"), "w") as f:
124	        f.write("""
125	import sys

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
143	    yield temp_dir
144	    shutil.rmtree(temp_dir)
145	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/agents/test_workflow.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
151	    yield temp_dir
152	    shutil.rmtree(temp_dir)
153	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/config/test_cache.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
19	    yield temp_dir
20	    shutil.rmtree(temp_dir)
21	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/config/test_cache.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
130	    with open(log_path, "r") as f:
131	        saved_data = f.read().strip()
132	    assert saved_data == log_data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/config/test_cache.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	    with open(log_path, "r") as f:
138	        saved_data = f.read().strip().split("\n")
139	    assert saved_data == [log_data, additional_log_data]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/config/test_cache.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
150	    with open(test_file, "w") as f:
151	        f.write("Test file")
152	    

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/config/test_cache.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
150	    with open(test_file, "w") as f:
151	        f.write("Test file")
152	    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/config/test_cache.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	    with open(test_dir / "nested_file.txt", "w") as f:
155	        f.write("Nested file")
156	    

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/config/test_cache.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
154	    with open(test_dir / "nested_file.txt", "w") as f:
155	        f.write("Nested file")
156	    

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcps/mcps-0.1.dev12/tests/utils/cache/test_cache.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
19	    yield temp_dir
20	    shutil.rmtree(temp_dir)
21	

--------------------------------------------------

Code scanned:
	Total lines of code: 9542
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 74.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 84.0
		High: 3.0
Files skipped (0):
