Run started:2025-05-25 16:09:43.829470

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/__init__.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
207	            )
208	            res = await self.request(
209	                "GET",
210	                v1_const.AFERO_CLIENTS[self._afero_client]["ACCOUNT_ID_URL"],
211	                headers=headers,
212	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/__init__.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
240	        params = {"expansions": "state"}
241	        res = await self.request(
242	            "get",
243	            v1_const.AFERO_CLIENTS[self._afero_client]["DATA_URL"].format(
244	                self.account_id
245	            ),
246	            headers=headers,
247	            params=params,
248	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/__init__.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
283	            kwargs["ssl"] = True
284	            async with self._web_session.request(method, url, **kwargs) as res:
285	                yield res

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/__init__.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
295	                await asyncio.sleep(retry_wait)
296	            async with self.create_request(method, url, **kwargs) as resp:
297	                # 503 means the service is temporarily unavailable, back off a bit.

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/auth.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
132	    async def generate_challenge_data() -> auth_challenge:
133	        code_verifier = base64.urlsafe_b64encode(os.urandom(40)).decode("utf-8")
134	        code_verifier = re.sub("[^a-zA-Z0-9]+", "", code_verifier)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/auth.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
135	        code_challenge = hashlib.sha256(code_verifier.encode("utf-8")).digest()
136	        code_challenge = base64.urlsafe_b64encode(code_challenge).decode("utf-8")
137	        code_challenge = code_challenge.replace("=", "")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	        "API_HOST": "api2.afero.net",
8	        "ACCOUNT_ID_URL": "https://api2.afero.net/v1/users/me",
9	        "DEFAULT_ENCODING": "gzip",
10	        "DATA_URL": "https://api2.afero.net/v1/accounts/{}/metadevices",
11	        "DEVICE_STATE": "https://api2.afero.net/v1/accounts/{}/metadevices/{}/state",
12	        "DATA_HOST": "semantics2.afero.net",
13	        "APPLICATION_ID": "hubspace",
14	        "DEFAULT_CLIENT_ID": "hubspace_android",
15	        "DEFAULT_REDIRECT_URI": "hubspace-app://loginredirect",
16	        "OPENID_REALM": "thd",
17	        "OPENID_HOST": "accounts.hubspaceconnect.com",
18	        "OPENID_URL": (
19	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
20	            "/protocol/openid-connect/auth"
21	        ),
22	        "CODE_URL": (
23	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
24	            "/login-actions/authenticate"
25	        ),
26	        "TOKEN_URL": (
27	            "https://accounts.hubspaceconnect.com/auth/realms/thd/"
28	            "protocol/openid-connect/token"
29	        ),
30	    },
31	    "myko": {
32	        "DEFAULT_USERAGENT": "Dart/3.1 (dart:io)",
33	        "DOMAIN": "sxz2xlhh.afero.net",
34	        "API_HOST": "api2.sxz2xlhh.afero.net",
35	        "ACCOUNT_ID_URL": "https://api2.sxz2xlhh.afero.net/v1/users/me",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	        "DEFAULT_ENCODING": "gzip",
10	        "DATA_URL": "https://api2.afero.net/v1/accounts/{}/metadevices",
11	        "DEVICE_STATE": "https://api2.afero.net/v1/accounts/{}/metadevices/{}/state",
12	        "DATA_HOST": "semantics2.afero.net",
13	        "APPLICATION_ID": "hubspace",
14	        "DEFAULT_CLIENT_ID": "hubspace_android",
15	        "DEFAULT_REDIRECT_URI": "hubspace-app://loginredirect",
16	        "OPENID_REALM": "thd",
17	        "OPENID_HOST": "accounts.hubspaceconnect.com",
18	        "OPENID_URL": (
19	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
20	            "/protocol/openid-connect/auth"
21	        ),
22	        "CODE_URL": (
23	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
24	            "/login-actions/authenticate"
25	        ),
26	        "TOKEN_URL": (
27	            "https://accounts.hubspaceconnect.com/auth/realms/thd/"
28	            "protocol/openid-connect/token"
29	        ),
30	    },
31	    "myko": {
32	        "DEFAULT_USERAGENT": "Dart/3.1 (dart:io)",
33	        "DOMAIN": "sxz2xlhh.afero.net",
34	        "API_HOST": "api2.sxz2xlhh.afero.net",
35	        "ACCOUNT_ID_URL": "https://api2.sxz2xlhh.afero.net/v1/users/me",
36	        "DEFAULT_ENCODING": "gzip",
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        "DATA_URL": "https://api2.afero.net/v1/accounts/{}/metadevices",
11	        "DEVICE_STATE": "https://api2.afero.net/v1/accounts/{}/metadevices/{}/state",
12	        "DATA_HOST": "semantics2.afero.net",
13	        "APPLICATION_ID": "hubspace",
14	        "DEFAULT_CLIENT_ID": "hubspace_android",
15	        "DEFAULT_REDIRECT_URI": "hubspace-app://loginredirect",
16	        "OPENID_REALM": "thd",
17	        "OPENID_HOST": "accounts.hubspaceconnect.com",
18	        "OPENID_URL": (
19	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
20	            "/protocol/openid-connect/auth"
21	        ),
22	        "CODE_URL": (
23	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
24	            "/login-actions/authenticate"
25	        ),
26	        "TOKEN_URL": (
27	            "https://accounts.hubspaceconnect.com/auth/realms/thd/"
28	            "protocol/openid-connect/token"
29	        ),
30	    },
31	    "myko": {
32	        "DEFAULT_USERAGENT": "Dart/3.1 (dart:io)",
33	        "DOMAIN": "sxz2xlhh.afero.net",
34	        "API_HOST": "api2.sxz2xlhh.afero.net",
35	        "ACCOUNT_ID_URL": "https://api2.sxz2xlhh.afero.net/v1/users/me",
36	        "DEFAULT_ENCODING": "gzip",
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",
38	        "DEVICE_STATE": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices/{}/state",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        "OPENID_URL": (
19	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
20	            "/protocol/openid-connect/auth"
21	        ),
22	        "CODE_URL": (
23	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
24	            "/login-actions/authenticate"
25	        ),
26	        "TOKEN_URL": (
27	            "https://accounts.hubspaceconnect.com/auth/realms/thd/"
28	            "protocol/openid-connect/token"
29	        ),
30	    },
31	    "myko": {
32	        "DEFAULT_USERAGENT": "Dart/3.1 (dart:io)",
33	        "DOMAIN": "sxz2xlhh.afero.net",
34	        "API_HOST": "api2.sxz2xlhh.afero.net",
35	        "ACCOUNT_ID_URL": "https://api2.sxz2xlhh.afero.net/v1/users/me",
36	        "DEFAULT_ENCODING": "gzip",
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",
38	        "DEVICE_STATE": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices/{}/state",
39	        "DATA_HOST": "semantics2.sxz2xlhh.afero.net",
40	        "APPLICATION_ID": "kfi",
41	        "DEFAULT_CLIENT_ID": "kfi_android",
42	        "DEFAULT_REDIRECT_URI": "kfi-app://loginredirect",
43	        "OPENID_REALM": "kfi",
44	        "OPENID_HOST": "accounts.mykoapp.com",
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        "CODE_URL": (
23	            "https://accounts.hubspaceconnect.com/auth/realms/thd"
24	            "/login-actions/authenticate"
25	        ),
26	        "TOKEN_URL": (
27	            "https://accounts.hubspaceconnect.com/auth/realms/thd/"
28	            "protocol/openid-connect/token"
29	        ),
30	    },
31	    "myko": {
32	        "DEFAULT_USERAGENT": "Dart/3.1 (dart:io)",
33	        "DOMAIN": "sxz2xlhh.afero.net",
34	        "API_HOST": "api2.sxz2xlhh.afero.net",
35	        "ACCOUNT_ID_URL": "https://api2.sxz2xlhh.afero.net/v1/users/me",
36	        "DEFAULT_ENCODING": "gzip",
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",
38	        "DEVICE_STATE": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices/{}/state",
39	        "DATA_HOST": "semantics2.sxz2xlhh.afero.net",
40	        "APPLICATION_ID": "kfi",
41	        "DEFAULT_CLIENT_ID": "kfi_android",
42	        "DEFAULT_REDIRECT_URI": "kfi-app://loginredirect",
43	        "OPENID_REALM": "kfi",
44	        "OPENID_HOST": "accounts.mykoapp.com",
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        "TOKEN_URL": (
27	            "https://accounts.hubspaceconnect.com/auth/realms/thd/"
28	            "protocol/openid-connect/token"
29	        ),
30	    },
31	    "myko": {
32	        "DEFAULT_USERAGENT": "Dart/3.1 (dart:io)",
33	        "DOMAIN": "sxz2xlhh.afero.net",
34	        "API_HOST": "api2.sxz2xlhh.afero.net",
35	        "ACCOUNT_ID_URL": "https://api2.sxz2xlhh.afero.net/v1/users/me",
36	        "DEFAULT_ENCODING": "gzip",
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",
38	        "DEVICE_STATE": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices/{}/state",
39	        "DATA_HOST": "semantics2.sxz2xlhh.afero.net",
40	        "APPLICATION_ID": "kfi",
41	        "DEFAULT_CLIENT_ID": "kfi_android",
42	        "DEFAULT_REDIRECT_URI": "kfi-app://loginredirect",
43	        "OPENID_REALM": "kfi",
44	        "OPENID_HOST": "accounts.mykoapp.com",
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	
51	MAX_RETRIES: Final[int] = 3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	        "API_HOST": "api2.sxz2xlhh.afero.net",
35	        "ACCOUNT_ID_URL": "https://api2.sxz2xlhh.afero.net/v1/users/me",
36	        "DEFAULT_ENCODING": "gzip",
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",
38	        "DEVICE_STATE": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices/{}/state",
39	        "DATA_HOST": "semantics2.sxz2xlhh.afero.net",
40	        "APPLICATION_ID": "kfi",
41	        "DEFAULT_CLIENT_ID": "kfi_android",
42	        "DEFAULT_REDIRECT_URI": "kfi-app://loginredirect",
43	        "OPENID_REALM": "kfi",
44	        "OPENID_HOST": "accounts.mykoapp.com",
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	
51	MAX_RETRIES: Final[int] = 3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        "DEFAULT_ENCODING": "gzip",
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",
38	        "DEVICE_STATE": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices/{}/state",
39	        "DATA_HOST": "semantics2.sxz2xlhh.afero.net",
40	        "APPLICATION_ID": "kfi",
41	        "DEFAULT_CLIENT_ID": "kfi_android",
42	        "DEFAULT_REDIRECT_URI": "kfi-app://loginredirect",
43	        "OPENID_REALM": "kfi",
44	        "OPENID_HOST": "accounts.mykoapp.com",
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	
51	MAX_RETRIES: Final[int] = 3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        "DATA_URL": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices",
38	        "DEVICE_STATE": "https://api2.sxz2xlhh.afero.net/v1/accounts/{}/metadevices/{}/state",
39	        "DATA_HOST": "semantics2.sxz2xlhh.afero.net",
40	        "APPLICATION_ID": "kfi",
41	        "DEFAULT_CLIENT_ID": "kfi_android",
42	        "DEFAULT_REDIRECT_URI": "kfi-app://loginredirect",
43	        "OPENID_REALM": "kfi",
44	        "OPENID_HOST": "accounts.mykoapp.com",
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	
51	MAX_RETRIES: Final[int] = 3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        "OPENID_HOST": "accounts.mykoapp.com",
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	
51	MAX_RETRIES: Final[int] = 3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        "OPENID_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/auth",
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	
51	MAX_RETRIES: Final[int] = 3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/v1_const.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        "CODE_URL": "https://accounts.mykoapp.com/auth/realms/kfi/login-actions/authenticate",
47	        "TOKEN_URL": "https://accounts.mykoapp.com/auth/realms/kfi/protocol/openid-connect/token",
48	    },
49	}
50	
51	MAX_RETRIES: Final[int] = 3

--------------------------------------------------

Code scanned:
	Total lines of code: 2790
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 0.0
Files skipped (2):
	/home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/util.py (syntax error while parsing AST from file)
	/home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/aioafero/aioafero/v1/models/light.py (syntax error while parsing AST from file)
