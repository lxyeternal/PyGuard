Run started:2025-05-25 16:04:33.825038

Test results:
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/embedding_model.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
77	        """
78	        response = requests.post(self.api_url, headers=self.headers, json=data, timeout=timeout)
79	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/embedding_model.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
103	        data = self._prepare_input(inputs)
104	        response = self._make_request(data, timeout=timeout)
105	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/embedding_model.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
167	        """
168	        response = requests.post(self.api_url, headers=self.headers, json=data, timeout=timeout)
169	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/embedding_model.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
185	        data = self._prepare_input(inputs)
186	        response = self._make_request(data, timeout=timeout)
187	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/openai_vlm.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
32	            with open(image_input, "rb") as image_file:
33	                return base64.b64encode(image_file.read()).decode('utf-8')
34	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/openai_vlm.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
32	            with open(image_input, "rb") as image_file:
33	                return base64.b64encode(image_file.read()).decode('utf-8')
34	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/openai_vlm.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	            with open(image_input, "rb") as image_file:
33	                return base64.b64encode(image_file.read()).decode('utf-8')
34	        else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/openai_vlm.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	            # 对于文件流对象，直接读取
36	            return base64.b64encode(image_input.read()).decode('utf-8')
37	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/openai_vlm.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
35	            # 对于文件流对象，直接读取
36	            return base64.b64encode(image_input.read()).decode('utf-8')
37	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/openai_vlm.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	            # 对于文件流对象，直接读取
36	            return base64.b64encode(image_input.read()).decode('utf-8')
37	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
304	            # Fix: Use additional_headers instead of extra_headers for websockets 15.0.1+
305	            async with websockets.connect(self.config.ws_url, additional_headers=header, max_size=1000000000) as ws:
306	                # Send full client request

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
306	                # Send full client request
307	                await ws.send(full_client_request)
308	                res = await ws.recv()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
307	                await ws.send(full_client_request)
308	                res = await ws.recv()
309	                if hasattr(ws, 'response_headers'):

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
338	                    # Send audio-only client request
339	                    await ws.send(audio_only_request)
340	                    res = await ws.recv()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
339	                    await ws.send(audio_only_request)
340	                    res = await ws.recv()
341	                    result = self.parse_response(res)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
382	        async with aiofiles.open(audio_path, mode="rb") as _f:
383	            data = await _f.read()
384	        audio_data = bytes(data)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
446	            # Fix: Use additional_headers instead of extra_headers for websockets 15.0.1+
447	            async with websockets.connect(self.config.ws_url, additional_headers=header,
448	                                          max_size=1000000000) as ws_server:
449	                print("Connected to STT service")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
454	                print("Sending initial request...")
455	                await ws_server.send(full_client_request)
456	                print("Waiting for response...")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
456	                print("Waiting for response...")
457	                response = await ws_server.recv()
458	                result = self.parse_response(response)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
515	                    try:
516	                        await ws_server.send(audio_only_request)
517	                    except Exception as e:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/stt_model.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
528	                    try:
529	                        response = await ws_server.recv()
530	                        result = self.parse_response(response)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	            if buffer is not None:
104	                buffer.write(audio_chunk)
105	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
132	            buffer = io.BytesIO()
133	            async with websockets.connect(self.config.api_url, additional_headers=headers, ping_interval=None) as ws:
134	                await ws.send(request)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
133	            async with websockets.connect(self.config.api_url, additional_headers=headers, ping_interval=None) as ws:
134	                await ws.send(request)
135	                while True:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
135	                while True:
136	                    response = await ws.recv()
137	                    done, _ = self._parse_response(response, buffer)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
142	            async def audio_generator():
143	                async with websockets.connect(self.config.api_url, additional_headers=headers,
144	                                              ping_interval=None) as ws:
145	                    await ws.send(request)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
144	                                              ping_interval=None) as ws:
145	                    await ws.send(request)
146	                    while True:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
146	                    while True:
147	                        response = await ws.recv()
148	                        done, chunk = self._parse_response(response)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
160	
161	        async with websockets.connect(self.config.api_url, additional_headers=headers, ping_interval=None) as ws:
162	            await ws.send(request)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
161	        async with websockets.connect(self.config.api_url, additional_headers=headers, ping_interval=None) as ws:
162	            await ws.send(request)
163	            response = await ws.recv()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/models/tts_model.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
162	            await ws.send(request)
163	            response = await ws.recv()
164	            # Parse and return query response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/nlp/stopwords.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
13	        logger.info(f"正在下载停用词表: {url}")
14	        response = requests.get(url, timeout=10)
15	        response.encoding = 'utf-8'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/nlp/stopwords.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
16	        with open(save_path, 'w', encoding='utf-8') as f:
17	            f.write(response.text)
18	        logger.info(f"停用词表已保存到: {os.path.abspath(save_path)}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/nlp/stopwords.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	def load_stopwords(stopwords_name='baidu_stopwords.txt',
26	                   backup_url='https://raw.githubusercontent.com/goto456/stopwords/master/baidu_stopwords.txt'):
27	    """
28	    加载停用词表（如果本地不存在则自动下载）

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/bocha_search_tool.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    def search_content(self, query):
20	        url = 'https://api.bochaai.com/v1/web-search'
21	        headers = {'Authorization': f'Bearer {self.api_key}', 'Content-Type': 'application/json'}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/bocha_search_tool.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
24	        # 发送POST请求
25	        response = requests.post(url, headers=headers, json=data)
26	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/bocha_search_tool.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	            raise Exception(f"Request Error in bocha_web_search! Error Code {response.status_code}. " \
29	                            f"Error Message: {json.loads(error_message).get('message')}")
30	        response = response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	    def __init__(self, index_names: list[str] = [], base_url: str = "http://localhost:8000", top_k: int = 5,
34	                 observer: MessageObserver = None, lang: str = "zh") -> None:
35	        """Initialize the KBSearchTool.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
59	    def forward(self, query: str) -> str:
60	        kb_search_response = requests.post(f"{self.base_url}/indices/search/hybrid",
61	            json={"index_names": self.index_names, "query": query, "top_k": self.top_k})
62	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        for index, single_search_result in enumerate(kb_search_results):
75	            search_result_message = SearchResultTextMessage(title=single_search_result.get("title", ""),
76	                text=single_search_result.get("content", ""), source_type=single_search_result.get("source_type", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            search_result_message = SearchResultTextMessage(title=single_search_result.get("title", ""),
76	                text=single_search_result.get("content", ""), source_type=single_search_result.get("source_type", ""),
77	                url=single_search_result.get("path_or_url", ""), filename=single_search_result.get("filename", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            search_result_message = SearchResultTextMessage(title=single_search_result.get("title", ""),
76	                text=single_search_result.get("content", ""), source_type=single_search_result.get("source_type", ""),
77	                url=single_search_result.get("path_or_url", ""), filename=single_search_result.get("filename", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	                text=single_search_result.get("content", ""), source_type=single_search_result.get("source_type", ""),
77	                url=single_search_result.get("path_or_url", ""), filename=single_search_result.get("filename", ""),
78	                published_date=single_search_result.get("create_time", ""), score=single_search_result.get("score", 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	                text=single_search_result.get("content", ""), source_type=single_search_result.get("source_type", ""),
77	                url=single_search_result.get("path_or_url", ""), filename=single_search_result.get("filename", ""),
78	                published_date=single_search_result.get("create_time", ""), score=single_search_result.get("score", 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	                url=single_search_result.get("path_or_url", ""), filename=single_search_result.get("filename", ""),
78	                published_date=single_search_result.get("create_time", ""), score=single_search_result.get("score", 0),
79	                score_details=single_search_result.get("score_details", {}), cite_index=self.record_ops + index,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	                url=single_search_result.get("path_or_url", ""), filename=single_search_result.get("filename", ""),
78	                published_date=single_search_result.get("create_time", ""), score=single_search_result.get("score", 0),
79	                score_details=single_search_result.get("score_details", {}), cite_index=self.record_ops + index,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	                published_date=single_search_result.get("create_time", ""), score=single_search_result.get("score", 0),
79	                score_details=single_search_result.get("score_details", {}), cite_index=self.record_ops + index,
80	                search_type=self.name, tool_sign=self.tool_sign)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/tools/knowledge_base_search_tool.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	    try:
96	        tool = KnowledgeBaseSearchTool(index_names=["medical"], base_url="http://localhost:8000", top_k=3)
97	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/utils/image_filter.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
43	            base64_data = path.split(',')[1]
44	            image_data = base64.b64decode(base64_data)
45	            image = Image.open(io.BytesIO(image_data))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/utils/image_filter.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
43	            base64_data = path.split(',')[1]
44	            image_data = base64.b64decode(base64_data)
45	            image = Image.open(io.BytesIO(image_data))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/utils/image_filter.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	
92	            image_data = await response.read()
93	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/utils/image_filter.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	                with tempfile.NamedTemporaryFile(suffix=os.path.splitext(path)[1], delete=False) as temp_file:
114	                    temp_file.write(image_data)
115	                    temp_file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/core/utils/image_filter.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
113	                with tempfile.NamedTemporaryFile(suffix=os.path.splitext(path)[1], delete=False) as temp_file:
114	                    temp_file.write(image_data)
115	                    temp_file.flush()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/data_process/process_worker_pool.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
23	        """
24	        self.executor = ThreadPoolExecutor(max_workers=max_workers)
25	        self.task_manager = None  # Will be set after initialization

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/data_process/process_worker_pool.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
173	                with tempfile.NamedTemporaryFile(mode="w", suffix=".txt", delete=False) as temp_file:
174	                    temp_file.write(source)
175	                    temp_path = temp_file.name

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/data_process/process_worker_pool.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	        # Get Elasticsearch service URL
212	        es_service_url = os.environ.get("ELASTICSEARCH_SERVICE", "http://localhost:8000")
213	        index_name = task_data.get("index_name", "knowledge_base")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/vector_database/elasticsearch_core.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
726	        print("Fetching sample articles data...")
727	        url = "https://raw.githubusercontent.com/elastic/elasticsearch-labs/main/notebooks/search/articles.json"
728	        try:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/nexent/nexent-0.1.0/nexent/vector_database/elasticsearch_core.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
734	            
735	            response = urlopen(url)
736	            articles = json.loads(response.read())

--------------------------------------------------

Code scanned:
	Total lines of code: 3595
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 49.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 55.0
		High: 3.0
Files skipped (0):
