Run started:2025-05-25 16:03:21.320751

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	        # Set API key from param or env var
61	        api_key = api_key or os.environ.get("CELLMAGE_API_KEY") or os.environ.get("OPENAI_API_KEY")
62	        if api_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	        # Set API key from param or env var
61	        api_key = api_key or os.environ.get("CELLMAGE_API_KEY") or os.environ.get("OPENAI_API_KEY")
62	        if api_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	        api_base = (
67	            api_base or os.environ.get("CELLMAGE_API_BASE") or os.environ.get("OPENAI_API_BASE")
68	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	        api_base = (
67	            api_base or os.environ.get("CELLMAGE_API_BASE") or os.environ.get("OPENAI_API_BASE")
68	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	        # Save api_key, api_base and default model
103	        api_key = self._instance_overrides.get("api_key")
104	        api_base = self._instance_overrides.get("api_base")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        api_key = self._instance_overrides.get("api_key")
104	        api_base = self._instance_overrides.get("api_base")
105	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	        model_alias = (
186	            call_overrides.get("model") or self._instance_overrides.get("model") or model_name
187	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	        model_alias = (
186	            call_overrides.get("model") or self._instance_overrides.get("model") or model_name
187	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
301	
302	        response = requests.post(
303	            url,
304	            headers=headers,
305	            json=payload,
306	            timeout=60,  # Default timeout of 60 seconds
307	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
327	            if "message" in result["choices"][0]:
328	                content = result["choices"][0]["message"].get("content", "")
329	                return content.strip()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
337	            self._last_token_usage = {
338	                "prompt_tokens": usage.get("prompt_tokens", 0),
339	                "completion_tokens": usage.get("completion_tokens", 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
338	                "prompt_tokens": usage.get("prompt_tokens", 0),
339	                "completion_tokens": usage.get("completion_tokens", 0),
340	                "total_tokens": usage.get("total_tokens", 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	                "completion_tokens": usage.get("completion_tokens", 0),
340	                "total_tokens": usage.get("total_tokens", 0),
341	            }

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
382	        # Set stream=True for requests to get response in chunks
383	        response = session.post(
384	            url,
385	            headers=headers,
386	            json=payload,
387	            stream=True,
388	            timeout=60,  # Default timeout of 60 seconds
389	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
446	            self._last_token_usage = {
447	                "prompt_tokens": token_usage_data.get("prompt_tokens", 0),
448	                "completion_tokens": token_usage_data.get("completion_tokens", 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	                "prompt_tokens": token_usage_data.get("prompt_tokens", 0),
448	                "completion_tokens": token_usage_data.get("completion_tokens", 0),
449	                "total_tokens": token_usage_data.get("total_tokens", 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	                "completion_tokens": token_usage_data.get("completion_tokens", 0),
449	                "total_tokens": token_usage_data.get("total_tokens", 0),
450	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
466	            error_info = response.json()
467	            error_message = error_info.get("error", {}).get("message", "Unknown error")
468	            _ = error_info.get("error", {}).get("type", "Unknown error type")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
466	            error_info = response.json()
467	            error_message = error_info.get("error", {}).get("message", "Unknown error")
468	            _ = error_info.get("error", {}).get("type", "Unknown error type")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
467	            error_message = error_info.get("error", {}).get("message", "Unknown error")
468	            _ = error_info.get("error", {}).get("type", "Unknown error type")
469	            status_code = response.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
467	            error_message = error_info.get("error", {}).get("message", "Unknown error")
468	            _ = error_info.get("error", {}).get("type", "Unknown error type")
469	            status_code = response.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
495	        # Extract api_base and api_key from instance overrides
496	        api_base = self._instance_overrides.get("api_base")
497	        api_key = self._instance_overrides.get("api_key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
496	        api_base = self._instance_overrides.get("api_base")
497	        api_key = self._instance_overrides.get("api_key")
498	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
513	
514	            response = requests.get(models_url, headers=headers, timeout=10)
515	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
538	        # Extract api_base and api_key from instance overrides
539	        api_base = self._instance_overrides.get("api_base")
540	        api_key = self._instance_overrides.get("api_key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
539	        api_base = self._instance_overrides.get("api_base")
540	        api_key = self._instance_overrides.get("api_key")
541	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/adapters/direct_client.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
556	
557	            response = requests.get(model_url, headers=headers, timeout=10)
558	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/resources/file_loader.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
141	            with open(filepath, "r", encoding="utf-8") as f:
142	                content = f.read()
143	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/resources/file_loader.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
268	                with open(filepath, "r", encoding="utf-8") as f:
269	                    content = f.read()
270	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/resources/file_loader.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
289	            with open(filepath, "r", encoding="utf-8") as f:
290	                content = f.read()
291	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/storage/markdown_store.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	            with open(full_path, "w", encoding="utf-8") as f:
158	                f.write("---\n")
159	                yaml.dump(metadata_dict, f, default_flow_style=False)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/storage/markdown_store.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
159	                yaml.dump(metadata_dict, f, default_flow_style=False)
160	                f.write("---\n\n")
161	                f.write(content.strip())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/storage/markdown_store.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	                f.write("---\n\n")
161	                f.write(content.strip())
162	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/storage/markdown_store.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
184	            with open(filepath, "r", encoding="utf-8") as f:
185	                content = f.read()
186	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/cellmage/cellmage-0.1.2/cellmage/storage/markdown_store.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
304	                        with open(filepath, "r", encoding="utf-8") as f:
305	                            content = f.read()
306	

--------------------------------------------------

Code scanned:
	Total lines of code: 4446
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 0.0
Files skipped (0):
