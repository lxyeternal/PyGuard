Run started:2025-05-25 15:50:06.950397

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/src/dicom_mcp/dicom_client.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
592	            # Read the DICOM file
593	            ds = dcmread(dicom_file)
594	            

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/src/dicom_mcp/dicom_client.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
604	                with open(pdf_path, 'wb') as pdf_file:
605	                    pdf_file.write(pdf_data)
606	                

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/src/dicom_mcp/dicom_client.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
604	                with open(pdf_path, 'wb') as pdf_file:
605	                    pdf_file.write(pdf_data)
606	                

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	# Configuration
18	ORTHANC_HOST = os.environ.get("ORTHANC_HOST", "localhost")
19	ORTHANC_PORT = int(os.environ.get("ORTHANC_PORT", "4242"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	ORTHANC_HOST = os.environ.get("ORTHANC_HOST", "localhost")
19	ORTHANC_PORT = int(os.environ.get("ORTHANC_PORT", "4242"))
20	ORTHANC_WEB_PORT = int(os.environ.get("ORTHANC_WEB_PORT", "8042"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	ORTHANC_PORT = int(os.environ.get("ORTHANC_PORT", "4242"))
20	ORTHANC_WEB_PORT = int(os.environ.get("ORTHANC_WEB_PORT", "8042"))
21	ORTHANC_AET = os.environ.get("ORTHANC_AET", "ORTHANC")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	ORTHANC_WEB_PORT = int(os.environ.get("ORTHANC_WEB_PORT", "8042"))
21	ORTHANC_AET = os.environ.get("ORTHANC_AET", "ORTHANC")
22	ORTHANC_USERNAME = os.environ.get("ORTHANC_USERNAME", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	ORTHANC_AET = os.environ.get("ORTHANC_AET", "ORTHANC")
22	ORTHANC_USERNAME = os.environ.get("ORTHANC_USERNAME", "")
23	ORTHANC_PASSWORD = os.environ.get("ORTHANC_PASSWORD", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	ORTHANC_USERNAME = os.environ.get("ORTHANC_USERNAME", "")
23	ORTHANC_PASSWORD = os.environ.get("ORTHANC_PASSWORD", "")
24	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	        if ORTHANC_USERNAME and ORTHANC_PASSWORD:
50	            response = requests.get(
51	                f"http://{ORTHANC_HOST}:{ORTHANC_WEB_PORT}/system",
52	                auth=(ORTHANC_USERNAME, ORTHANC_PASSWORD),
53	                timeout=2
54	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	        else:
56	            response = requests.get(
57	                f"http://{ORTHANC_HOST}:{ORTHANC_WEB_PORT}/system",
58	                timeout=2
59	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	    with tempfile.NamedTemporaryFile(suffix='.dcm', delete=False) as temp:
136	        dcmwrite(temp.name, ds)
137	        temp_path = temp.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
135	    with tempfile.NamedTemporaryFile(suffix='.dcm', delete=False) as temp:
136	        dcmwrite(temp.name, ds)
137	        temp_path = temp.name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
141	        with open(temp_path, 'rb') as f:
142	            dicom_data = f.read()
143	        

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
145	        if ORTHANC_USERNAME and ORTHANC_PASSWORD:
146	            response = requests.post(
147	                f"http://{ORTHANC_HOST}:{ORTHANC_WEB_PORT}/instances",
148	                data=dicom_data,
149	                auth=(ORTHANC_USERNAME, ORTHANC_PASSWORD),
150	                headers={'Content-Type': 'application/dicom'}
151	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
152	        else:
153	            response = requests.post(
154	                f"http://{ORTHANC_HOST}:{ORTHANC_WEB_PORT}/instances",
155	                data=dicom_data,
156	                headers={'Content-Type': 'application/dicom'}
157	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	    for patient in result:
230	        if patient.get("PatientID") == "TEST123":
231	            patient_found = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	    for study in result:
250	        if study.get("StudyID") == "TEST01":
251	            study_found = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	            study_found = True
252	            study_uid = study.get("StudyInstanceUID")
253	            break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	    for series in result:
274	        if series.get("SeriesNumber") == 1:
275	            series_found = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	            series_found = True
276	            series_uid = series.get("SeriesInstanceUID")
277	            break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_mcp.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	    for instance in result:
296	        if instance.get("InstanceNumber") == 1:
297	            instance_found = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_pdf.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	    try:
27	        response = requests.get(f"http://{ORTHANC_HOST}:{ORTHANC_WEB_PORT}/system")
28	        return response.status_code == 200

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_pdf.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
105	    with open('tests/synthetic-pet-ct-reports.md', 'r') as file:
106	        markdown_content = file.read()
107	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_pdf.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182	            with open(temp_path, 'rb') as f:
183	                dicom_data = f.read()
184	            

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_pdf.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
186	            if ORTHANC_USERNAME and ORTHANC_PASSWORD:
187	                response = requests.post(
188	                    f"http://{ORTHANC_HOST}:{ORTHANC_WEB_PORT}/instances",
189	                    data=dicom_data,
190	                    auth=(ORTHANC_USERNAME, ORTHANC_PASSWORD),
191	                    headers={'Content-Type': 'application/dicom'}
192	                )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/dicom-mcp/dicom_mcp-0.1.0/tests/test_dicom_pdf.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
193	            else:
194	                response = requests.post(
195	                    f"http://{ORTHANC_HOST}:{ORTHANC_WEB_PORT}/instances",
196	                    data=dicom_data,
197	                    headers={'Content-Type': 'application/dicom'}
198	                )

--------------------------------------------------

Code scanned:
	Total lines of code: 1713
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 0.0
Files skipped (0):
