Run started:2025-05-25 15:52:30.195880

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/config.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	        import requests
26	        json_str = requests.get(path)
27	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/config.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	        with open(path, "r+", encoding="utf-8") as f:
29	            json_str = f.read()
30	    global app_config

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/config.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	    with open(config_file, "r+", encoding="utf-8") as f:
47	        json_str = f.read()
48	        local_config = json.loads(json_str)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/config.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	            with open(config_file, "w", encoding="utf-8") as f:
52	                f.write(json.dumps(app_config, indent=4, ensure_ascii=False))
53	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
75	        with open(file_path, 'rb') as f:
76	            data = f.read()
77	        return hashlib.md5(data).hexdigest()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
140	        import base64
141	        encode_string = base64.b64encode(source.encode(encoding=encoding))
142	        return encode_string.decode(encoding=encoding)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
140	        import base64
141	        encode_string = base64.b64encode(source.encode(encoding=encoding))
142	        return encode_string.decode(encoding=encoding)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
154	        import base64
155	        decode_string = base64.b64decode(source)
156	        return decode_string.decode(encoding=encoding)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:155
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
154	        import base64
155	        decode_string = base64.b64decode(source)
156	        return decode_string.decode(encoding=encoding)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
189	            cls._aes_pad(source, encoding).encode(encoding))
190	        result = str(base64.b64encode(resource), encoding=encoding)
191	        return result

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:190
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
189	            cls._aes_pad(source, encoding).encode(encoding))
190	        result = str(base64.b64encode(resource), encoding=encoding)
191	        return result

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
237	        # 对签名进行处理
238	        sign = base64.b64encode(sign)  # 对数据进行base64加密
239	        sign = sign.decode()  # 再进行编码

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:238
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
237	        # 对签名进行处理
238	        sign = base64.b64encode(sign)  # 对数据进行base64加密
239	        sign = sign.decode()  # 再进行编码

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
252	        with open(key_file) as f:
253	            key_file_content = f.read()
254	            rsa_key = RSA.importKey(key_file_content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
292	        with open(public_pem_save_path, 'wb+') as f:
293	            f.write(public_key)
294	        private_key = key_pair.exportKey()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
295	        with open(private_pem_save_path, 'wb+') as f:
296	            f.write(private_key)
297	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
317	        # base64编码，并转为字符串
318	        text_encrypted_base64 = base64.b64encode(encrypt).decode()
319	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:318
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
317	        # base64编码，并转为字符串
318	        text_encrypted_base64 = base64.b64encode(encrypt).decode()
319	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
335	        decrypt = cipher_private_obj.decrypt(
336	            base64.b64decode(source.encode('utf-8')),
337	            Crypto.Random.new().read)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:336
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
335	        decrypt = cipher_private_obj.decrypt(
336	            base64.b64decode(source.encode('utf-8')),
337	            Crypto.Random.new().read)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/crypto.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
417	            while True:
418	                data = fp.read(blocksize)
419	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/csv.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
535	                    str_write += '\n'
536	                    outfile.write(str_write)
537	            return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/excel.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
366	                for j in range(cell_num_begin[1], cell_num_begin[1] + len(data[0])):
367	                    sheet.write(
368	                        i-1, j-1, data[i - cell_num_begin[0]][j - cell_num_begin[1]])
369	            # 保存

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/file.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
379	            with open(local_file, 'rb') as fileobj:
380	                assert bucket.get_object(object_name).read() == fileobj.read()
381	        except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/file.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
379	            with open(local_file, 'rb') as fileobj:
380	                assert bucket.get_object(object_name).read() == fileobj.read()
381	        except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/file.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
519	        with open(local_file, 'rb') as file_byte:
520	            file_bytes = file_byte.read()
521	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/host.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
20	        try:
21	            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
22	            s.connect(('114.114.114.114', 80))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/host.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
21	            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
22	            s.connect(('114.114.114.114', 80))
23	            ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/host.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	            s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
22	            s.connect(('114.114.114.114', 80))
23	            ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/host.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
26	        finally:
27	            s.close()
28	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/http.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	        try:
63	            return requests.get(url=url,
64	                                params=params,
65	                                headers=headers,
66	                                **kwargs)
67	        except:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/http.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
87	                if "json" in kwargs:
88	                    return requests.post(url=url, headers=headers, **kwargs)
89	                else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/http.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
89	                else:
90	                    return requests.post(url=url, json=data, headers=headers, **kwargs)
91	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/http.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
91	
92	            return requests.post(url=url, data=data, headers=headers, **kwargs)
93	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/common/share_config.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	        import requests
26	        json_str = requests.get(path)
27	    else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
64	            return ""
65	        cipher_text = str(base64.b64encode(source.encode(encoding=encoding)), 'utf-8')
66	        return cipher_text

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
64	            return ""
65	        cipher_text = str(base64.b64encode(source.encode(encoding=encoding)), 'utf-8')
66	        return cipher_text

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
77	            return ""
78	        plain_text = str(base64.b64decode(source), 'utf-8')
79	        return plain_text

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
77	            return ""
78	        plain_text = str(base64.b64decode(source), 'utf-8')
79	        return plain_text

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
112	        # 所以这里统一把加密后的字符串转化为base64
113	        return str(base64.b64encode(cipher_text), encoding)
114	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:113
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
112	        # 所以这里统一把加密后的字符串转化为base64
113	        return str(base64.b64encode(cipher_text), encoding)
114	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
127	        try:
128	            encry_text = base64.b64decode(source)
129	            password = password.encode(encoding)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/cryptography_helper.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
127	        try:
128	            encry_text = base64.b64decode(source)
129	            password = password.encode(encoding)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        app_id = app_id if app_id else share_config.get_value("app_id")
48	        authorize_url = "https://open.weixin.qq.com/connect/oauth2/authorize?appid={0}&redirect_uri={1}&response_type=code&scope={2}&state={3}&connect_redirect=1#wechat_redirect".format(app_id, CodingHelper.url_encode(redirect_uri), scope, CodingHelper.url_encode(state))
49	        return authorize_url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        # 通过code获取access_token
73	        requset_url = 'https://api.weixin.qq.com/sns/oauth2/access_token'
74	        response = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	        try:
76	            response = requests.get(requset_url, params=param)
77	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	            access_token = response_data['access_token']
85	            requset_url = "https://api.weixin.qq.com/sns/userinfo"
86	            response = requests.get(requset_url, params={'access_token': access_token, 'openid': open_id, 'lang': "zh_CN"})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	            requset_url = "https://api.weixin.qq.com/sns/userinfo"
86	            response = requests.get(requset_url, params={'access_token': access_token, 'openid': open_id, 'lang': "zh_CN"})
87	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	            redis_init = CoreHelper.redis_init(config_dict=share_config.get_value("platform_redis"))
118	            jsapi_ticket = redis_init.get(redis_key)
119	            if not jsapi_ticket:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	                redis_init.delete(redis_key)
165	            requset_url = f"https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token={access_token}&type=jsapi"
166	            response = requests.get(requset_url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	            requset_url = f"https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token={access_token}&type=jsapi"
166	            response = requests.get(requset_url)
167	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	        redis_init = CoreHelper.redis_init(config_dict=share_config.get_value("platform_redis"))
226	        code2_session_dict = redis_init.get(redis_key)
227	        if code2_session_dict:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	        # 通过code获取sessionkey
239	        requset_url = 'https://api.weixin.qq.com/sns/jscode2session'
240	        response = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	        try:
242	            response = requests.get(requset_url, params=param)
243	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	                redis_init.delete(redis_key)
285	            access_token = redis_init.get(redis_key)
286	            if access_token:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
327	                redis_init.delete(redis_key)
328	            requset_url = 'https://api.weixin.qq.com/cgi-bin/token'
329	            response = requests.get(requset_url, params=param)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
328	            requset_url = 'https://api.weixin.qq.com/cgi-bin/token'
329	            response = requests.get(requset_url, params=param)
330	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
375	        try:
376	            requset_url = 'https://api.weixin.qq.com/cgi-bin/message/subscribe/send?access_token=' + access_token
377	            param = {"touser": open_id, "page": page, "lang": lang, "data": request_data, "template_id": template_id, "miniprogram_state": miniprogram_state}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
377	            param = {"touser": open_id, "page": page, "lang": lang, "data": request_data, "template_id": template_id, "miniprogram_state": miniprogram_state}
378	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers={'Content-Type': 'application/json'})
379	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	        try:
421	            requset_url = 'https://api.weixin.qq.com/wxa/business/getuserphonenumber?access_token=' + access_token
422	            param = {'code': code}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
422	            param = {'code': code}
423	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers={'Content-Type': 'application/json'})
424	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
458	        redis_key = "create_qr_code_unlimit:" + CryptoHelper.md5_encrypt(f"{page}_{scene}")
459	        redis_value = redis_init.get(redis_key)
460	        if redis_value:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
477	            headers = {"Content-type": "application/json"}
478	            requset_url = 'https://api.weixin.qq.com/wxa/getwxacodeunlimit?access_token=' + access_token
479	            param = {"page": page, "scene": scene, "width": width, "env_version": env_version, "check_path":check_path}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
479	            param = {"page": page, "scene": scene, "width": width, "env_version": env_version, "check_path":check_path}
480	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
481	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
513	        redis_key = "wechat_qr_code:" + CryptoHelper.md5_encrypt(f"{path}")
514	        redis_value = redis_init.get(redis_key)
515	        if redis_value:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
532	            headers = {"Content-type": "application/json"}
533	            requset_url = 'https://api.weixin.qq.com/cgi-bin/wxaapp/createwxaqrcode?access_token=' + access_token
534	            param = {"path": path, "width": width}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
534	            param = {"path": path, "width": width}
535	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
536	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
581	        try:
582	            requset_url = 'https://api.weixin.qq.com/wxa/msg_sec_check?access_token=' + access_token
583	            headers = {"Content-type": "application/json"}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
584	            param = {"content": content, "scene": scene, "openid": open_id, "nickname": nickname, "version": 2}
585	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
586	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
630	        try:
631	            requset_url = 'https://api.weixin.qq.com/wxa/media_check_async?access_token=' + access_token
632	            headers = {"Content-type": "application/json"}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
633	            param = {"media_url": media_url,"media_type": media_type, "scene": scene, "openid": open_id, "version": 2}
634	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
635	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
671	        try:
672	            session_key = CoreHelper.redis_init().get(f"{app_id}_wechat_sessionkey:{open_id}")
673	            wx_data_crypt = WeChatDataCrypt(app_id, session_key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
784	        with open(private_key_path) as file:
785	            private_key = file.read()
786	        try:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
789	            digest = SHA256.new(sign_str.encode('utf-8'))
790	            return base64.b64encode(signer.sign(digest)).decode('utf-8')
791	        except Exception:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:790
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
789	            digest = SHA256.new(sign_str.encode('utf-8'))
790	            return base64.b64encode(signer.sign(digest)).decode('utf-8')
791	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
824	        redis_key = "generate_scheme:" + CryptoHelper.md5_encrypt(f"{page}_{query}_{env_version}_{is_expire}_{expire_type}_{expire_interval}_{expire_time}")
825	        redis_value = redis_init.get(redis_key)
826	        if redis_value:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
845	            headers = {"Content-type": "application/json"}
846	            requset_url = 'https://api.weixin.qq.com/wxa/generatescheme?access_token=' + access_token
847	            param = {"jump_wxa": {"path": page, "query": query, "env_version": env_version}, "is_expire": is_expire, "expire_type": expire_type, "expire_interval": expire_interval, "expire_time": expire_time}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
847	            param = {"jump_wxa": {"path": page, "query": query, "env_version": env_version}, "is_expire": is_expire, "expire_type": expire_type, "expire_interval": expire_interval, "expire_time": expire_time}
848	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
849	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:901
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
900	        redis_key = "generate_urllink:" + CryptoHelper.md5_encrypt(f"{page}_{query}_{env_version}_{is_expire}_{expire_type}_{expire_interval}_{expire_time}_{cloud_base}")
901	        redis_value = redis_init.get(redis_key)
902	        if redis_value:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
921	            headers = {"Content-type": "application/json"}
922	            requset_url = 'https://api.weixin.qq.com/wxa/generate_urllink?access_token=' + access_token
923	            param = {"path": page, "query": query, "env_version": env_version, "is_expire": is_expire, "expire_type": expire_type, "expire_interval": expire_interval, "expire_time": expire_time, "cloud_base": cloud_base}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
923	            param = {"path": page, "query": query, "env_version": env_version, "is_expire": is_expire, "expire_type": expire_type, "expire_interval": expire_interval, "expire_time": expire_time, "cloud_base": cloud_base}
924	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
925	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
961	        redis_key = "generate_shortlink:" + CryptoHelper.md5_encrypt(f"{page}_{query}_{page_title}_{is_permanent}")
962	        redis_value = redis_init.get(redis_key)
963	        if redis_value:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
982	            headers = {"Content-type": "application/json"}
983	            requset_url = 'https://api.weixin.qq.com/wxa/genwxashortlink?access_token=' + access_token
984	            param = {"page_url": f"{page}?{query}", "page_title": page_title, "is_permanent": is_permanent}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
984	            param = {"page_url": f"{page}?{query}", "page_title": page_title, "is_permanent": is_permanent}
985	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
986	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1018
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1017	        redis_key = "wx_delivery_list"
1018	        redis_value = redis_init.get(redis_key)
1019	        if redis_value:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1038	            headers = {"Content-type": "application/json"}
1039	            requset_url = 'https://api.weixin.qq.com/cgi-bin/express/delivery/open_msg/get_delivery_list?access_token=' + access_token
1040	            param = {}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1040	            param = {}
1041	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
1042	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1092	            headers = {"Content-type": "application/json"}
1093	            requset_url = 'https://api.weixin.qq.com/wxa/sec/order/upload_shipping_info?access_token=' + access_token
1094	            param = {}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1101	            param["payer"] = {"openid": open_id}
1102	            response = requests.post(requset_url, data=json.dumps(param, ensure_ascii=False).encode('utf-8'), headers=headers)
1103	            response_data = CoreHelper.json_loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1143	        self.certificate_url = certificate_url if certificate_url else pay_config["certificate_url"]
1144	        self.private_key_url = private_key_url if private_key_url else pay_config.get("private_key_url", "")
1145	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1156	        redis_init = CoreHelper.redis_init()
1157	        prepay_id = redis_init.get(redis_key)
1158	        if prepay_id:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1161	        params['sign'] = WeChatHelper.get_sign(params, self.api_key)
1162	        respone = requests.post(unified_order_url, self.convert_request_xml(params), headers={'Content-Type': 'application/xml'})
1163	        response_data = xmltodict.parse(respone.text.encode('ISO-8859-1').decode('utf-8'))['xml']

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1197	        invoke_result_data = InvokeResultData()
1198	        spbill_create_ip = spbill_create_ip if CoreHelper.is_ip(spbill_create_ip) == True else "127.0.0.1"
1199	        params = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1221	        # 开发者调用支付统一下单API生成预交易单
1222	        unified_order_url = 'https://api.mch.weixin.qq.com/pay/unifiedorder'
1223	        invoke_result_data = self.get_prepay_id(unified_order_url, params)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1262	            request_xml = self.convert_request_xml(params)
1263	            queryorder_url = 'https://api.mch.weixin.qq.com/pay/orderquery'
1264	            respone = requests.post(queryorder_url, request_xml, headers={'Content-Type': 'application/xml'})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1263	            queryorder_url = 'https://api.mch.weixin.qq.com/pay/orderquery'
1264	            respone = requests.post(queryorder_url, request_xml, headers={'Content-Type': 'application/xml'})
1265	            response_data = xmltodict.parse(respone.text.encode('ISO-8859-1').decode('utf-8'))['xml']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1292	            request_xml = self.convert_request_xml(params)
1293	            queryorder_url = 'https://api.mch.weixin.qq.com/pay/closeorder'
1294	            respone = requests.post(queryorder_url, request_xml, headers={'Content-Type': 'application/xml'})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1293	            queryorder_url = 'https://api.mch.weixin.qq.com/pay/closeorder'
1294	            respone = requests.post(queryorder_url, request_xml, headers={'Content-Type': 'application/xml'})
1295	            response_data = xmltodict.parse(respone.text.encode('ISO-8859-1').decode('utf-8'))['xml']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1350	        params['sign'] = WeChatHelper.get_sign(params, self.api_key)
1351	        refund_url = 'https://api.mch.weixin.qq.com/secapi/pay/refund'
1352	        respone = post(url=refund_url, data=self.convert_request_xml(params), headers={'Content-Type': 'application/xml'}, pkcs12_filename=self.certificate_url, pkcs12_password=self.mch_id)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1351	        refund_url = 'https://api.mch.weixin.qq.com/secapi/pay/refund'
1352	        respone = post(url=refund_url, data=self.convert_request_xml(params), headers={'Content-Type': 'application/xml'}, pkcs12_filename=self.certificate_url, pkcs12_password=self.mch_id)
1353	        response_data = xmltodict.parse(respone.text.encode('ISO-8859-1').decode('utf-8'))['xml']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1388	            request_xml = self.convert_request_xml(params)
1389	            queryrefund_url = 'https://api.mch.weixin.qq.com/pay/refundquery'
1390	            respone = requests.post(queryrefund_url, request_xml, headers={'Content-Type': 'application/xml'})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1389	            queryrefund_url = 'https://api.mch.weixin.qq.com/pay/refundquery'
1390	            respone = requests.post(queryrefund_url, request_xml, headers={'Content-Type': 'application/xml'})
1391	            response_data = xmltodict.parse(respone.text.encode('ISO-8859-1').decode('utf-8'))['xml']

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1417	        invoke_result_data = InvokeResultData()
1418	        client_ip = client_ip if CoreHelper.is_ip(client_ip) == True else "127.0.0.1"
1419	        request_xml = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1425	            request_xml = self.convert_request_xml(params)
1426	            requset_url = 'https://api.mch.weixin.qq.com/mmpaymkttransfers/sendredpack'
1427	            # 重点是`cert=(certificate_url, private_key_url), verify=True`参数，查看源码后才知道是这样传ca证书
1428	            respone = requests.post(requset_url, data=request_xml, cert=(self.certificate_url, self.private_key_url), verify=True)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1427	            # 重点是`cert=(certificate_url, private_key_url), verify=True`参数，查看源码后才知道是这样传ca证书
1428	            respone = requests.post(requset_url, data=request_xml, cert=(self.certificate_url, self.private_key_url), verify=True)
1429	            response_data = xmltodict.parse(respone.text.encode('ISO-8859-1').decode('utf-8'))['xml']

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1551	        # base64 decode
1552	        session_key = base64.b64decode(self.session_key)
1553	        encryptedData = base64.b64decode(encryptedData)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1552
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1551	        # base64 decode
1552	        session_key = base64.b64decode(self.session_key)
1553	        encryptedData = base64.b64decode(encryptedData)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1552	        session_key = base64.b64decode(self.session_key)
1553	        encryptedData = base64.b64decode(encryptedData)
1554	        iv = base64.b64decode(iv)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1553
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1552	        session_key = base64.b64decode(self.session_key)
1553	        encryptedData = base64.b64decode(encryptedData)
1554	        iv = base64.b64decode(iv)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1553	        encryptedData = base64.b64decode(encryptedData)
1554	        iv = base64.b64decode(iv)
1555	        decrypted = {}

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1554
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1553	        encryptedData = base64.b64decode(encryptedData)
1554	        iv = base64.b64decode(iv)
1555	        decrypted = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1587	
1588	    base_url = 'https://api.mch.weixin.qq.com'
1589	
1590	    def __init__(self, app_id="", api_key="", mch_id="", mch_serial_no="", certificate_url="", private_key_url=""):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1593	        self.app_id = app_id if app_id else share_config.get_value("app_id")
1594	        self.mch_id = mch_id if mch_id else pay_config.get("mch_id", "")
1595	        self.api_key = api_key if api_key else pay_config.get("api_key", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1594	        self.mch_id = mch_id if mch_id else pay_config.get("mch_id", "")
1595	        self.api_key = api_key if api_key else pay_config.get("api_key", "")
1596	        self.mch_serial_no = mch_serial_no if mch_serial_no else pay_config.get("mch_serial_no", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1595	        self.api_key = api_key if api_key else pay_config.get("api_key", "")
1596	        self.mch_serial_no = mch_serial_no if mch_serial_no else pay_config.get("mch_serial_no", "")
1597	        self.certificate_url = certificate_url if certificate_url else pay_config.get("certificate_url", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1596	        self.mch_serial_no = mch_serial_no if mch_serial_no else pay_config.get("mch_serial_no", "")
1597	        self.certificate_url = certificate_url if certificate_url else pay_config.get("certificate_url", "")
1598	        self.private_key_url = private_key_url if private_key_url else pay_config.get("private_key_url", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1597	        self.certificate_url = certificate_url if certificate_url else pay_config.get("certificate_url", "")
1598	        self.private_key_url = private_key_url if private_key_url else pay_config.get("private_key_url", "")
1599	        self.timestamp = str(int(time.time()))

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1666	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1667	            res = requests.post(url=url, data=data, headers=headers, timeout=10)
1668	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1704	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1705	            res = requests.post(url=url, data=data, headers=headers, timeout=10)
1706	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1745	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1746	            res = requests.get(url=url, data=data, headers=headers, timeout=10)
1747	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1777	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1778	            res = requests.get(url=url, data=data, headers=headers, timeout=10)
1779	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1834	            redis_init = CoreHelper.redis_init()
1835	            prepay_id = redis_init.get(redis_key)
1836	            if not prepay_id:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1839	                headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1840	                res = requests.post(url=url, data=data, headers=headers, timeout=10)
1841	                response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1885	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1886	            res = requests.get(url=url, headers=headers, timeout=10)
1887	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1920	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1921	            res = requests.post(url=url, data=data, headers=headers, timeout=10)
1922	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:1971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1970	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
1971	            res = requests.post(url=url, data=data, headers=headers, timeout=10)
1972	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2000	            headers = {'Authorization': self._generate_auth_header(signature), 'Content-Type': 'application/json'}
2001	            res = requests.get(url=url, headers=headers, timeout=10)
2002	            response_data = CoreHelper.json_loads(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2024	        pay_config = share_config.get_value("wechat_pay", {})
2025	        self.api_key = api_key if api_key else pay_config.get("api_key", "")
2026	        self.public_key_url = public_key_url if public_key_url else pay_config.get("public_key_url", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2025	        self.api_key = api_key if api_key else pay_config.get("api_key", "")
2026	        self.public_key_url = public_key_url if public_key_url else pay_config.get("public_key_url", "")
2027	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2041	        with open(self.public_key_url) as file:
2042	            public_key = file.read()
2043	        public_rsa_key = RSA.importKey(public_key)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
2044	        public_signer = PKCS1_v1_5.new(public_rsa_key)
2045	        return public_signer.verify(digest, base64.b64decode(response_signature))  # 验签
2046	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2045
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
2044	        public_signer = PKCS1_v1_5.new(public_rsa_key)
2045	        return public_signer.verify(digest, base64.b64decode(response_signature))  # 验签
2046	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
2056	        cipher.update(associated_data.encode())
2057	        en_data = base64.b64decode(ciphertext.encode('utf-8'))
2058	        auth_tag = en_data[-16:]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2057
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
2056	        cipher.update(associated_data.encode())
2057	        en_data = base64.b64decode(ciphertext.encode('utf-8'))
2058	        auth_tag = en_data[-16:]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2071	        try:
2072	            if response_data.get("code") == 0:
2073	                result = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2074
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2073	                result = {
2074	                    "refund_id": response_data.get("refund_id"),  # 微信退款单号
2075	                    "out_refund_no": response_data.get("out_refund_no"),  # 商户退款单号

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2074	                    "refund_id": response_data.get("refund_id"),  # 微信退款单号
2075	                    "out_refund_no": response_data.get("out_refund_no"),  # 商户退款单号
2076	                    "transaction_id": response_data.get("transaction_id"),  # 微信订单号

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2075	                    "out_refund_no": response_data.get("out_refund_no"),  # 商户退款单号
2076	                    "transaction_id": response_data.get("transaction_id"),  # 微信订单号
2077	                    "out_trade_no": response_data.get("out_trade_no"),  # 商户订单号

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2076	                    "transaction_id": response_data.get("transaction_id"),  # 微信订单号
2077	                    "out_trade_no": response_data.get("out_trade_no"),  # 商户订单号
2078	                    "refund_fee": response_data.get("amount", {}).get("refund"),  # 退款金额

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2077	                    "out_trade_no": response_data.get("out_trade_no"),  # 商户订单号
2078	                    "refund_fee": response_data.get("amount", {}).get("refund"),  # 退款金额
2079	                    "total_fee": response_data.get("amount", {}).get("total"),  # 订单总金额

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2077	                    "out_trade_no": response_data.get("out_trade_no"),  # 商户订单号
2078	                    "refund_fee": response_data.get("amount", {}).get("refund"),  # 退款金额
2079	                    "total_fee": response_data.get("amount", {}).get("total"),  # 订单总金额

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2078	                    "refund_fee": response_data.get("amount", {}).get("refund"),  # 退款金额
2079	                    "total_fee": response_data.get("amount", {}).get("total"),  # 订单总金额
2080	                    "status": response_data.get("status"),  # 退款状态

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2078	                    "refund_fee": response_data.get("amount", {}).get("refund"),  # 退款金额
2079	                    "total_fee": response_data.get("amount", {}).get("total"),  # 订单总金额
2080	                    "status": response_data.get("status"),  # 退款状态

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2079	                    "total_fee": response_data.get("amount", {}).get("total"),  # 订单总金额
2080	                    "status": response_data.get("status"),  # 退款状态
2081	                    "success_time": response_data.get("success_time"),  # 退款成功时间

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2080	                    "status": response_data.get("status"),  # 退款状态
2081	                    "success_time": response_data.get("success_time"),  # 退款成功时间
2082	                    "refund_account": response_data.get("refund_account"),  # 退款资金来源

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2082
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2081	                    "success_time": response_data.get("success_time"),  # 退款成功时间
2082	                    "refund_account": response_data.get("refund_account"),  # 退款资金来源
2083	                    "refund_request_source": response_data.get("refund_request_source")  # 退款发起来源

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2083
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2082	                    "refund_account": response_data.get("refund_account"),  # 退款资金来源
2083	                    "refund_request_source": response_data.get("refund_request_source")  # 退款发起来源
2084	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2087
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2086	                result = {
2087	                    "error_code": response_data.get("code"),
2088	                    "error_message": response_data.get("message")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2087	                    "error_code": response_data.get("code"),
2088	                    "error_message": response_data.get("message")
2089	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2104	        try:
2105	            if response_data.get("code") == 0:
2106	                return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/customize/wechat_helper.py:2119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2118	        try:
2119	            return response_data.get("status")
2120	        except Exception:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/tao_top/top/api/base.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
256	        url = rest + "?" + urllib.parse.urlencode(sys_parameters)
257	        connection.request(self.__httpmethod, url, body=body, headers=header)
258	        response = connection.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/libs/tao_top/top/api/base.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
257	        connection.request(self.__httpmethod, url, body=body, headers=header)
258	        response = connection.getresponse()
259	        if response.status != 200:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/log.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
45	        if not project_name:
46	            if platform.system() == "Windows":
47	                project_name = os.getcwd().split('\\')[-1]

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/log.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
45	        if not project_name:
46	            if platform.system() == "Windows":
47	                project_name = os.getcwd().split('\\')[-1]

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/log.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
45	        if not project_name:
46	            if platform.system() == "Windows":
47	                project_name = os.getcwd().split('\\')[-1]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/log.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
152	            self.logger.removeHandler(self.handler_file)
153	            self.handler_file.close()
154	        if hasattr(self, "handler_console"):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/log.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
155	            self.logger.removeHandler(self.handler_console)
156	            self.handler_console.close()
157	        if hasattr(self, "handler_storage"):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/log.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
158	            self.logger.removeHandler(self.handler_storage)
159	            self.handler_storage.close()
160	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/models/order_base_model.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
342	                buf = bytearray(data)
343	                f.write(buf)
344	            f.close()

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/os.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
87	        """
88	        return os.chmod(path, mode)
89	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/os.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
87	        """
88	        return os.chmod(path, mode)
89	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/yy-core/yy_core/web_tornado/base_handler/base_handler.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
36	    """
37	    executor = ThreadPoolExecutor(THREAD_POOL_COUNT)
38	

--------------------------------------------------

Code scanned:
	Total lines of code: 40125
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 46.0
		High: 117.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 144.0
		High: 19.0
Files skipped (0):
