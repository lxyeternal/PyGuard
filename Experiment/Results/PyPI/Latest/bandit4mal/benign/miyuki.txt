Run started:2025-05-25 16:00:41.510142

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/config.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	MOVIE_SAVE_PATH_ROOT = 'movies_folder_miyuki'
5	COVER_URL_PREFIX = 'https://fourhoi.com/'
6	VIDEO_M3U8_PREFIX = 'https://surrit.com/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/config.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	COVER_URL_PREFIX = 'https://fourhoi.com/'
6	VIDEO_M3U8_PREFIX = 'https://surrit.com/'
7	VIDEO_PLAYLIST_SUFFIX = '/playlist.m3u8'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/url_sources.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	            # Use scraper.post
256	            response = self.scraper.post('https://missav.ai/api/login', data={'email': username, 'password': password}, timeout=20)
257	            logger.debug(f"Login response status: {response.status_code}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/url_sources.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	    def get_urls(self) -> list[str]:
282	        url = 'https://missav.ai/saved'
283	        logger.info(f"Fetching saved URLs from: {url}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/url_sources.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	    def get_urls(self) -> list[str]:
301	        search_url = f"https://missav.ai/search/{self.key}"
302	        # Define base URL for resolving relative links found

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/url_sources.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	        # Define base URL for resolving relative links found
303	        base_url = "https://missav.ai"
304	        # Escape key for safety in regex and use the public playlist regex
305	        search_regex = HREF_REGEX_PUBLIC_PLAYLIST # Use the same regex as playlists

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
32	    text = f"\rProgress: [{'#' * block + '-' * (bar_length - block)}] {current_value}/{max_value}"
33	    sys.stdout.write(text)
34	    sys.stdout.flush()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/utils.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
70	        if os.path.isdir(item_path):
71	            shutil.rmtree(item_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/video_downloader.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
42	        with open(TMP_HTML_FILE, 'w', encoding='utf-8') as file:
43	            file.write(html)
44	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/video_downloader.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	             with open(cover_path, 'wb') as f:
117	                  f.write(cover_content)
118	             logger.info(f"Cover downloaded successfully to {cover_path}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/video_downloader.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	        for i in range(start, end):
149	            url = f"https://surrit.com/{uuid}/{resolution}/video{i}.jpeg"
150	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/video_downloader.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	                      with open(file_path, 'wb') as f:
169	                            f.write(content)
170	                      display_progress_bar(video_offset_max + 1, self.counter)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/video_downloader.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	        for start, end in intervals:
184	            thread = threading.Thread(target=self._thread_task, args=(start, end, uuid, resolution, video_offset_max))
185	            threads.append(thread)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/video_downloader.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
212	                        with open(file_path, 'rb') as infile:
213	                            outfile.write(infile.read())
214	        if self.options.get('title_action') and self.title:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/miyuki/miyuki-0.8.0/miyuki/video_downloader.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
212	                        with open(file_path, 'rb') as infile:
213	                            outfile.write(infile.read())
214	        if self.options.get('title_action') and self.title:

--------------------------------------------------

Code scanned:
	Total lines of code: 603
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 0.0
Files skipped (0):
