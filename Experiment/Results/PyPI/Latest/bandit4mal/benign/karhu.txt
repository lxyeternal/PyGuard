Run started:2025-05-25 16:02:15.401811

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/Recordaudio.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
62	                    if self.device_index is None:
63	                        system = platform.system()
64	                        try:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/Recordaudio.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
62	                    if self.device_index is None:
63	                        system = platform.system()
64	                        try:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/Recordaudio.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
62	                    if self.device_index is None:
63	                        system = platform.system()
64	                        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/Recordaudio.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	                    # Start a background thread to capture audio frames
82	                    self.recording_thread = threading.Thread(target=self._capture_frames)
83	                    self.recording_thread.daemon = True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/Recordaudio.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	                try:
96	                    data = self.audio_stream.read(1024, exception_on_overflow=False)
97	                    self.frames.append(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/SpeechToText.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
15	                with open(output_file, "w") as f:
16	                    f.write("") # Create empty file
17	                return output_file

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/SpeechToText.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	            for _ in range(0, int(self.rate / self.chunk_size * duration)):
82	                data = stream.read(self.chunk_size)
83	                frames.append(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/SpeechToText.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	                with open(file_path, "rb") as audio_file:
111	                    content = audio_file.read()
112	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/TextToSpeech.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
149	            with tempfile.NamedTemporaryFile(suffix=".mp3", delete=False) as f:
150	                f.write(response.audio_content)
151	                temp_file = f.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/TextToSpeech.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
149	            with tempfile.NamedTemporaryFile(suffix=".mp3", delete=False) as f:
150	                f.write(response.audio_content)
151	                temp_file = f.name

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/TextToSpeech.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
158	
159	            system = platform.system()
160	            if system == "Darwin":  # macOS

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/TextToSpeech.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
158	
159	            system = platform.system()
160	            if system == "Darwin":  # macOS

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/TextToSpeech.py:159
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
158	
159	            system = platform.system()
160	            if system == "Darwin":  # macOS

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/ai_assistant.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    'api_key': os.getenv('GITHUB_TOKEN', ''),
18	    'ollama_base_url': os.getenv('OLLAMA_BASE_URL', 'http://localhost:11434/v1'),
19	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/ai_assistant.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	                return OpenAI(
121	                    base_url="https://models.inference.ai.azure.com",
122	                    api_key=API_CONFIG['api_key'],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/ai_assistant.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	            for entry in self.conversation_history:
169	                f.write(f"**[{entry['timestamp']}] {entry['role']}:** {entry['content']} \n\n")
170	        return filename

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/context_manager.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	            with open(filename, "r", encoding="utf-8") as file:
30	                self.current_context = file.read()
31	            return self.current_context

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/context_manager.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	        with open(filename, "w", encoding="utf-8") as file:
42	            file.write(self.current_context)
43	    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/context_manager.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	            with open(filename, "w", encoding="utf-8") as file:
51	                file.write("")
52	            self.current_context = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/context_manager.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	            self.client = OpenAI(
67	                base_url="https://models.inference.ai.azure.com",
68	                api_key=github_token,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/document_processor.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	                    with open(file_path, 'r', encoding='utf-8') as file:
24	                        files_content[filename] = file.read()
25	                except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/document_processor.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	            with open(file_path, 'r', encoding='utf-8') as file:
61	                return file.read()
62	        except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/interactive.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132	                if animation_thread is None or not animation_thread.is_alive():
133	                    animation_thread = threading.Thread(target=animation.start, args=("ðŸ§  processing...",))
134	                    animation_thread.daemon = True  # Make thread daemon so it exits when main thread exits

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        
53	        def __init__(self, base_url="http://192.168.1.69:8880/v1", voice="af_bella", connection_timeout=10):
54	            """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	            """
107	            api_url = "http://192.168.1.69:8880/v1/audio/voices"
108	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	                print(colored(f"Connecting to Kokoro TTS API (timeout: {timeout}s)...", "blue"))
114	                response = requests.get(api_url, timeout=timeout)
115	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
240	                p = pyaudio.PyAudio()
241	                system = platform.system()
242	                device_index = None # Default to None

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
240	                p = pyaudio.PyAudio()
241	                system = platform.system()
242	                device_index = None # Default to None

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:241
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
240	                p = pyaudio.PyAudio()
241	                system = platform.system()
242	                device_index = None # Default to None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	                        default_output = p.get_default_output_device_info()
247	                        device_index = default_output.get('index')
248	                    except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/kokorotts.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
272	                        if self.player: # Check if player exists before writing
273	                            self.player.write(chunk)
274	                        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/web_browser.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	                
43	            response = self.session.get(url, headers=self.get_headers(), timeout=10)
44	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/web_browser.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        try:
68	            url = "https://html.duckduckgo.com/html/"
69	            params = {'q': query}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/karhu/karhu-2.0.0/src/karhu/web_browser.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	            
74	            response = self.session.get(
75	                url, 
76	                params=params, 
77	                headers=self.get_headers(),
78	                timeout=10
79	            )

--------------------------------------------------

Code scanned:
	Total lines of code: 2458
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 3.0
Files skipped (0):
