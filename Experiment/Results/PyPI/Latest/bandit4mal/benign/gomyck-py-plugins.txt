Run started:2025-05-25 15:57:21.203531

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	  if os.path.exists(path):
65	    conf.read(path)
66	    sections = conf.sections()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
143	    try:
144	      shutil.rmtree(pythonPath)
145	    except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
147	    try:
148	      shutil.rmtree(msPlayPath)
149	    except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
151	    try:
152	      shutil.rmtree(driverPath)
153	    except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
155	    try:
156	      shutil.rmtree(taguiPath)
157	    except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
163	    with open(destFilePath, 'w') as newVersion:
164	      newVersion.write(Server.version)
165	      print('初始化安装, 版本信息为: {}'.format(Server.version))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
170	      print('本地版本信息为: {}, 程序版本信息为: {}'.format(oldV, Server.version))
171	      oldVersion.close()
172	    if oldV == Server.version and '-snapshot' not in oldV: return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
178	    with open(destFilePath, 'w') as newVersion:
179	      newVersion.write(Server.version)
180	      print('程序升级成功, 更新版本信息为: {}'.format(Server.version))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	      with open(init_flag, "w") as f:
264	        f.write("success")
265	        f.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
288	      with open(initFlag, 'w') as flag:
289	        flag.write(flagValue)
290	        print('interpreter init success: {}'.format(flagValue))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
297	      print('interpreter flag: {}'.format(flagValue))
298	      flag.close()
299	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
359	        try:
360	          shutil.rmtree(folder_path)
361	        except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
363	  print("End clear cache...")
364	  shutil.rmtree(Schedule.rpa_script_path, ignore_errors=True)
365	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/application.py:368
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
367	def is_port_in_use(port):
368	  with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
369	    return s.connect_ex(('localhost', port)) == 0

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/b64.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
3	def encode(param: str):
4	  return base64.b64encode(param.encode('UTF-8')).decode('UTF-8')
5	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/b64.py:4
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
3	def encode(param: str):
4	  return base64.b64encode(param.encode('UTF-8')).decode('UTF-8')
5	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/b64.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
6	def decode(param: str):
7	  return base64.b64decode(param.encode('UTF-8')).decode('UTF-8')

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/b64.py:7
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
6	def decode(param: str):
7	  return base64.b64decode(param.encode('UTF-8')).decode('UTF-8')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/bottle_webserver.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	      response.content_type = 'image/svg+xml'
90	      svg_icon = '''<?xml version="1.0" encoding="UTF-8"?>
91	      <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
92	          <circle cx="16" cy="16" r="14" fill="#007bff"/>
93	          <path d="M16 8a8 8 0 0 0-8 8h2a6 6 0 0 1 12 0h2a8 8 0 0 0-8-8z" fill="white"/>
94	          <circle cx="16" cy="20" r="2" fill="white"/>
95	      </svg>
96	      '''
97	      return svg_icon

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/bottle_webserver.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	    http_server = WSGIRefServer(port=self.port)
101	    print('Click the link below to open the service homepage %s' % '\n \t\t http://localhost:%s \n \t\t http://%s:%s' %  (self.port, sys_info.get_local_ipv4(), self.port), file=sys.stderr)
102	    self.bottle.run(server=http_server, quiet=self.quiet)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/bottle_webserver.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
131	
132	  def __init__(self, host='0.0.0.0', port=_default_port):
133	    super().__init__(host, port)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/bottle_websocket.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	
65	  def __init__(self, host='0.0.0.0', port=_default_port):
66	    super().__init__(host, port)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/browser_element_tools.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	  if "http" not in url[:5]:
305	    url = "http://%s" % url
306	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/compile_tools.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
10	  with open(out_file_path, 'wb') as f:
11	    f.write(bytecode)
12	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/compile_tools.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
15	  with open(file_path, 'r') as f:
16	    code = f.read()
17	  if code:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/czip.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	          rel_path = os.path.relpath(file_path, start=root_dir)
65	          file_dict[rel_path] = f.read()
66	      except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/czip.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	    with open(output_path, 'wb') as out_file:
81	      out_file.write(zip_buffer.read())
82	    print(f"Created single archive: {output_path}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/czip.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	    with open(output_path, 'wb') as out_file:
81	      out_file.write(zip_buffer.read())
82	    print(f"Created single archive: {output_path}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/czip.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	        filename_in_zip = os.path.basename(file_path)
108	        file_dict[filename_in_zip] = f.read()
109	    except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/czip.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	    with open(output_path, 'wb') as out_file:
125	      out_file.write(zip_buffer.read())
126	    print(f"Created archive: {output_path}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/czip.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	    with open(output_path, 'wb') as out_file:
125	      out_file.write(zip_buffer.read())
126	    print(f"Created archive: {output_path}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/download_tools.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	    with open(save_path, "wb") as f:
56	      f.write(content)
57	  return save_path

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/http_utils.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
6	  try:
7	    response = requests.get(url, params=params, headers=headers, timeout=60, verify=False)
8	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/http_utils.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
18	  result = ""
19	  response = requests.post(url, data=data, json=json, files=files, headers=headers, timeout=60, verify=False)
20	  response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/imgDialog.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	  # 创建一个Label控件用于显示图片
28	  resp = requests.get(imagePath)
29	  image = Image.open(BytesIO(resp.content))  # 替换你自己的图片路径

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/imgDialog.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	if __name__ == '__main__':
44	  showImageTip(root=None, title='在线授权', imagePath='https://blog.gomyck.com/img/pay-img/wechatPay2Me.jpg', tips='{}\n授权已失效,请联系微信:\n{}'.format(123, 123))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/metrics.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	    with open(_metrics_persistent_path, 'w') as persistent_file:
79	      persistent_file.write(cjson.dumps(_persistent_json))
80	      persistent_file.flush()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/pacth.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
55	      self.deleteSDK = True
56	      if os.path.exists(self.pythonPath): shutil.rmtree(self.pythonPath)
57	    except Exception as e:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/pacth.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
63	      self.deleteHPL = True
64	      if os.path.exists(self.playwrightPath): shutil.rmtree(self.playwrightPath)
65	    except Exception as e:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/pacth.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
71	      self.deleteDriver = True
72	      if os.path.exists(self.driverPath): shutil.rmtree(self.driverPath)
73	    except Exception as e:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/process_pool.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
16	  max_workers = min(32, os.cpu_count()) # 最多 32 个
17	  _process_pool = ProcessPoolExecutor(max_workers=max_workers)
18	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	  with open(work_path.get_app_path() + '/keys/resource_private_key.pem', 'r') as pri:
43	    private_key = RSA.import_key(pri.read())
44	    digest = MD5.new(data_layout(manifest).encode('utf-8'))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
44	    digest = MD5.new(data_layout(manifest).encode('utf-8'))
45	    return b64encode(pkcs1_15.new(private_key).sign(digest)).decode()
46	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
44	    digest = MD5.new(data_layout(manifest).encode('utf-8'))
45	    return b64encode(pkcs1_15.new(private_key).sign(digest)).decode()
46	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	  with open(work_path.get_app_path() + '/keys/resource_public_key.pem', 'r') as pub:
56	    public_key = RSA.import_key(pub.read())
57	    digest = MD5.new(data_layout(manifest).encode('utf-8'))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
58	    try:
59	      pkcs1_15.new(public_key).verify(digest, b64decode(sign_val))
60	      return True

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
58	    try:
59	      pkcs1_15.new(public_key).verify(digest, b64decode(sign_val))
60	      return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	  file_md5_sum = os.path.splitext(resource_name)[0].split('-')[-1]
74	  if file_md5_sum != get_md5_sum(file.read()):
75	    message = "资源包已损坏, 请重新打包"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        if file.filename == "manifest.json":
81	          manifest = json.loads(zf.read(file.filename))
82	          break

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
85	        resource_path = os.path.join(application.Upload.source_pkg_path, manifest['name'])
86	        shutil.rmtree(resource_path, ignore_errors=True)
87	        zf.extractall(resource_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
104	    with open(manifest_path, mode="r", encoding='utf-8') as f:
105	      manifest = json.loads(f.read())
106	      manifest["signature"] = signature(manifest)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	    with open(manifest_path, mode="w", encoding='utf-8') as f:
108	      f.write(json.dumps(manifest, indent=2, ensure_ascii=False))
109	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/resource_bundle_tools.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	          arcname = os.path.join(dir_path.split(resource_name)[-1], filename)
115	          zf.write(filepath, arcname=arcname)
116	    buffer.seek(0)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
33	    parts += cipher.encrypt(msg[i:i + ENCRYPT_CHUNK_SIZE].encode())
34	  encrypted_base64 = base64.b64encode(parts)
35	  return encrypted_base64.decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
33	    parts += cipher.encrypt(msg[i:i + ENCRYPT_CHUNK_SIZE].encode())
34	  encrypted_base64 = base64.b64encode(parts)
35	  return encrypted_base64.decode()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
41	  cipher = PKCS1_OAEP.new(public_key)
42	  encrypted_bytes = base64.b64decode(msg)
43	  for i in range(0, len(encrypted_bytes), decrypt_CHUNK_SIZE):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
41	  cipher = PKCS1_OAEP.new(public_key)
42	  encrypted_bytes = base64.b64decode(msg)
43	  for i in range(0, len(encrypted_bytes), decrypt_CHUNK_SIZE):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
51	  try:
52	    pkcs1_15.new(public_key).verify(hash_message, base64.b64decode(sign.encode()))
53	    return True

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
51	  try:
52	    pkcs1_15.new(public_key).verify(hash_message, base64.b64decode(sign.encode()))
53	    return True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
62	  signature = pkcs1_15.new(private_key).sign(hash_message)
63	  return base64.b64encode(signature).decode()
64	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/rsa.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
62	  signature = pkcs1_15.new(private_key).sign(hash_message)
63	  return base64.b64encode(signature).decode()
64	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
29	  if sm2_crypt is None: raise Exception('sm2 is not init!!!')
30	  return base64.b64encode(sm2_crypt.encrypt(encrypt_data.encode('UTF-8'))).decode('UTF-8')
31	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
29	  if sm2_crypt is None: raise Exception('sm2 is not init!!!')
30	  return base64.b64encode(sm2_crypt.encrypt(encrypt_data.encode('UTF-8'))).decode('UTF-8')
31	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
34	  if sm2_crypt is None: raise Exception('sm2 is not init!!!')
35	  return sm2_crypt.decrypt(base64.b64decode(encrypt_data.encode('UTF-8'))).decode('UTF-8')
36	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
34	  if sm2_crypt is None: raise Exception('sm2 is not init!!!')
35	  return sm2_crypt.decrypt(base64.b64decode(encrypt_data.encode('UTF-8'))).decode('UTF-8')
36	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	  crypt_sm4.set_key(key, SM4_ENCRYPT)
41	  encrypt_value = base64.b64encode(crypt_sm4.crypt_ecb(encrypt_text.encode()))
42	  return encrypt_value.decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	  crypt_sm4.set_key(key, SM4_ENCRYPT)
41	  encrypt_value = base64.b64encode(crypt_sm4.crypt_ecb(encrypt_text.encode()))
42	  return encrypt_value.decode()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
47	  crypt_sm4.set_key(key, SM4_DECRYPT)
48	  decrypt_value = crypt_sm4.crypt_ecb(base64.b64decode(decrypt_text))
49	  return decrypt_value.decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sm_tools.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
47	  crypt_sm4.set_key(key, SM4_DECRYPT)
48	  decrypt_value = crypt_sm4.crypt_ecb(base64.b64decode(decrypt_text))
49	  return decrypt_value.decode()

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
13	  import getpass
14	  return getpass.getuser()
15	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
13	  import getpass
14	  return getpass.getuser()
15	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	  with open(machine_file, 'w') as f:
39	    f.write(enc_code)
40	    f.flush()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
50	  disk_serial = ''
51	  if platform.system() == 'Windows':
52	    import ctypes

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
50	  disk_serial = ''
51	  if platform.system() == 'Windows':
52	    import ctypes

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
50	  disk_serial = ''
51	  if platform.system() == 'Windows':
52	    import ctypes

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	  try:
79	    response = requests.get("https://api.ipify.org?format=json")
80	    ip = response.json()["ip"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	  try:
79	    response = requests.get("https://api.ipify.org?format=json")
80	    ip = response.json()["ip"]

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:94
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
93	  print("Failed to get local IPv4 address, try another way...")
94	  s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
95	  try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
95	  try:
96	    s.connect(("8.8.8.8", 80))
97	    ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
95	  try:
96	    s.connect(("8.8.8.8", 80))
97	    ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
98	  except Exception:
99	    ip = '127.0.0.1'
100	  finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
100	  finally:
101	    s.close()
102	  return ip

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
108	  except:
109	    return '127.0.0.1'
110	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
143	def get_os_version():
144	  system = platform.system()
145	  if system == "Windows":

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
143	def get_os_version():
144	  system = platform.system()
145	  if system == "Windows":

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/sys_info.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
143	def get_os_version():
144	  system = platform.system()
145	  if system == "Windows":

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/thread_pool.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
15	  max_work_num = min(32, (os.cpu_count() or 1) + 4) # 最多 32 个
16	  _threadPool = ThreadPoolExecutor(max_workers= max_work_num, thread_name_prefix='ck-')
17	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/win_canvas.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
74	  data_queue = Queue()
75	  canvas_process = Process(target=_init_recorder, args=(data_queue,))
76	  canvas_process.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/win_control.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	  global control_json, screenshot_path
27	  with auto.UIAutomationInitializerInThread():
28	    win_canvas.data_queue.put(win_canvas.CanvasInfo(msg_type=win_canvas.MSGType.BOTTOM))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/gomyck-py-plugins/ctools/word_fill.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
215	            col = c + start_position[1]
216	            sheet.write(row, col, data[r][c], style=style)
217	

--------------------------------------------------

Code scanned:
	Total lines of code: 4399
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 63.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 73.0
		High: 17.0
Files skipped (0):
