Run started:2025-05-25 15:58:25.997369

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        self.Skey = self.get_default_key()
12	        self.url = 'https://api.claudeshop.top/v1/chat/completions'
13	        self.headers = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	            'Authorization': f'Bearer {self.Skey}',
16	            'User-Agent': 'Apifox/1.0.0 (https://apifox.com)',
17	            'Content-Type': 'application/json',
18	        }
19	
20	    def get_default_key(self):
21	        if 'GPT_KEY_FILE' not in os.environ:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	        with open(gpt_key_file, 'r') as f:
26	            Skey = f.read().strip()
27	        return Skey

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
41	    def call_api(self, prompt: str, model: str = 'gpt-4o') -> dict:
42	        payload = self.build_pay_load(prompt, model)
43	        response = requests.request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
42	        payload = self.build_pay_load(prompt, model)
43	        response = requests.request(
44	            'POST', self.url, headers=self.headers, data=payload
45	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
42	        payload = self.build_pay_load(prompt, model)
43	        response = requests.request(
44	            'POST', self.url, headers=self.headers, data=payload
45	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
49	    async def call_api_async(self, prompt: str, model: str = 'gpt-4o') -> dict:
50	        payload = self.build_pay_load(prompt, model)
51	        async with aiohttp.ClientSession() as session:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
51	        async with aiohttp.ClientSession() as session:
52	            async with session.post(
53	                self.url, headers=self.headers, data=payload
54	            ) as response:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	        self.Skey = self.get_default_key()
62	        self.url = 'https://dashscope.aliyuncs.com/compatible-mode/v1'
63	        self.client = OpenAI(api_key=self.Skey, base_url=self.url)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	        with open(ali_key_file, 'r') as f:
72	            Skey = f.read().strip()
73	        return Skey

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/html-alg-lib/html_alg_lib-2.0.1/html_alg_lib/call_api.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
259	    with open(args.html, 'r') as f:
260	        html = f.read()
261	    import time

--------------------------------------------------

Code scanned:
	Total lines of code: 1439
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 0.0
Files skipped (0):
