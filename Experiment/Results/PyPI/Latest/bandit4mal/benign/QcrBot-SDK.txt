Run started:2025-05-25 16:03:55.742138

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/adapters/websocket.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
65	        self._stop_connecting = True
66	        await self.disconnect()
67	        if self._connection_task and not self._connection_task.done():

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/adapters/websocket.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
127	            self.websocket = await asyncio.wait_for(
128	                websockets.connect(
129	                    self.url, extra_headers=headers, ping_interval=20, ping_timeout=20
130	                ),

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/adapters/websocket.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
136	            if self.on_connect:
137	                asyncio.create_task(self.on_connect())
138	        except asyncio.TimeoutError as e: raise SDKConnectionError(f"连接超时 ({connect_timeout}s)") from e

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/adapters/websocket.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
151	                try:
152	                    message = await self.websocket.recv()
153	                    if isinstance(message, str):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/adapters/websocket.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
175	                # 使用最后获取的 code 和 reason
176	                asyncio.create_task(self.on_disconnect(code, reason))
177	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/adapters/websocket.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
185	        if self.websocket and not self.websocket.closed:
186	            try: await self.websocket.close(code=1000, reason="Client disconnecting")
187	            except Exception as e: log.error(f"关闭 WebSocket 时发生错误: {e}", exc_info=True)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/adapters/websocket.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
194	        if self._connected and self.websocket and self.websocket.open:
195	            try: await self.websocket.send(data); log.debug(f"WS Sent: {data[:100]}")
196	            except WebSocketException as e: raise SDKConnectionError(f"发送时 WebSocket 错误: {e}") from e

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/QcrBot-SDK/qcrbot_sdk-1.0.0/QcrBot_SDK/api/client.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
45	        try:
46	            await self._adapter.send(req.model_dump_json()); log.info(f"Sent action (echo={echo}): {action_name}"); log.debug(f"Params(echo={echo}): {params}")
47	            resp = await asyncio.wait_for(fut, timeout=timeout); log.info(f"Got response (echo={echo}): status={resp.status}")

--------------------------------------------------

Code scanned:
	Total lines of code: 1715
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 0.0
Files skipped (0):
