Run started:2025-05-25 16:04:51.441337

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
46	            log.info(f"Cleaning existing target directory: {self.target_dir}")
47	            shutil.rmtree(self.target_dir)
48	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
62	        # Use platform module directly
63	        py_system = platform.system().lower()
64	        goos = py_system

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
62	        # Use platform module directly
63	        py_system = platform.system().lower()
64	        goos = py_system

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
62	        # Use platform module directly
63	        py_system = platform.system().lower()
64	        goos = py_system

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        asset_name = f"temporal_cli_{self.CLI_VERSION}_{goos}_{goarch}{archive_ext}"
93	        download_url = f"https://github.com/temporalio/cli/releases/download/v{self.CLI_VERSION}/{asset_name}"
94	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
115	            with (
116	                urllib.request.urlopen(req) as response,
117	                open(download_path, "wb") as out_file,

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
115	            with (
116	                urllib.request.urlopen(req) as response,
117	                open(download_path, "wb") as out_file,

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
116	                urllib.request.urlopen(req) as response,
117	                open(download_path, "wb") as out_file,
118	            ):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
124	            if archive_ext == ".tar.gz":
125	                with tarfile.open(download_path, "r:gz") as tar:
126	                    member_path = Path(binary_name)  # Assume binary is at root

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
157	                    # Extract the specific file, placing it directly in target_dir
158	                    with open(final_binary_path, "wb") as f_out:
159	                        f_out.write(zip_ref.read(member_path_in_zip))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
158	                    with open(final_binary_path, "wb") as f_out:
159	                        f_out.write(zip_ref.read(member_path_in_zip))
160	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
158	                    with open(final_binary_path, "wb") as f_out:
159	                        f_out.write(zip_ref.read(member_path_in_zip))
160	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
163	            # Make executable (important for non-Windows)
164	            if platform.system() != "Windows":
165	                current_stat = os.stat(final_binary_path)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
163	            # Make executable (important for non-Windows)
164	            if platform.system() != "Windows":
165	                current_stat = os.stat(final_binary_path)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:164
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
163	            # Make executable (important for non-Windows)
164	            if platform.system() != "Windows":
165	                current_stat = os.stat(final_binary_path)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
165	                current_stat = os.stat(final_binary_path)
166	                os.chmod(final_binary_path, current_stat.st_mode | stat.S_IEXEC)
167	                log.info(f"Made {final_binary_path} executable.")

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:166
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
165	                current_stat = os.stat(final_binary_path)
166	                os.chmod(final_binary_path, current_stat.st_mode | stat.S_IEXEC)
167	                log.info(f"Made {final_binary_path} executable.")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/temporalio-server/temporalio_server-0.1.0/fetch_temporal_cli.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
209	        log.info(f"Cleaning existing test target dir: {hook.target_dir}")
210	        shutil.rmtree(hook.target_dir)
211	    hook.target_dir.mkdir(parents=True, exist_ok=True)

--------------------------------------------------

Code scanned:
	Total lines of code: 148
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 3.0
Files skipped (0):
