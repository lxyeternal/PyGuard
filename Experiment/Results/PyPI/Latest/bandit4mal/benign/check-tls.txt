Run started:2025-05-25 15:58:21.837284

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/setup.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	    author='Gr√©goire Compagnon (obeone)',
7	    url='https://github.com/obeone/check-tls',
8	    license='MIT',

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/tls_checker.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	            try:
106	                ssock.close()
107	            except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/tls_checker.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
110	            try:
111	                sock.close()
112	            except Exception:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/tls_checker.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
128	                req = urllib.request.Request(url, headers={'User-Agent': 'Python-CertCheck/1.3'})
129	                with urllib.request.urlopen(req, timeout=10) as response:
130	                    if response.status == 200:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/tls_checker.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
130	                    if response.status == 200:
131	                        intermediate_der = response.read()
132	                        content_type = response.info().get_content_type().lower()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/tls_checker.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
329	                transparency_summary['details'][d] = None
330	                transparency_summary['crtsh_report_links'][d] = f"https://crt.sh/?q={d}"
331	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/tls_checker.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
333	                transparency_summary['total_records'] += len(res)
334	                transparency_summary['crtsh_report_links'][d] = f"https://crt.sh/?q={d}"
335	        transparency_summary['crtsh_records_found'] = transparency_summary['total_records']

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/utils/crl_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
19	        req = urllib.request.Request(url, headers={'User-Agent': 'Python-CertCheck/1.3'})
20	        with urllib.request.urlopen(req, timeout=CRL_TIMEOUT) as response:
21	            if response.status == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/utils/crtsh_utils.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    """Queries crt.sh for certificates related to the domain."""
19	    url = f"https://crt.sh/?q={quote_plus(domain)}&output=json"
20	    logging.info(f"Querying crt.sh for {domain}")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/utils/crtsh_utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
23	            url, headers={'User-Agent': 'Python-CertCheck/1.3'})
24	        with urllib.request.urlopen(req, timeout=CRTSH_TIMEOUT) as response:
25	            if response.status == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/web_server.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	HTML_TEMPLATE = """
13	<!doctype html>
14	<html lang='en'>
15	<head>
16	<meta charset='utf-8'>
17	<meta name='viewport' content='width=device-width, initial-scale=1'>
18	<link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css' rel='stylesheet'>
19	<style>
20	    /* Default Light Mode */
21	    :root {
22	        --bg-color: #f8f9fa; --text-color: #212529; --card-bg: #ffffff;
23	        --card-border: rgba(0, 0, 0, 0.175); --table-header-bg: #e9ecef;
24	        --table-border: #dee2e6; --input-bg: #ffffff; --input-border: #ced4da;
25	        --input-text: #495057; --muted-text: #6c757d; --link-color: #0d6efd;
26	        --shadow-color: rgba(0, 0, 0, 0.1); --success-text: #198754;
27	        --warning-text: #ffc107; --danger-text: #dc3545; --secondary-text: #6c757d;
28	        --info-text: #0dcaf0; /* For info like 'No CDP' */
29	        --info-badge-bg: #0dcaf0; --secondary-badge-bg: #6c757d;
30	        --success-badge-bg: #198754; --warning-badge-bg: #ffc107;
31	        --danger-badge-bg: #dc3545; --info-badge-text: black; /* Text color for info badge */
32	        --alert-danger-bg: #f8d7da; --alert-danger-border: #f5c6cb; --alert-danger-text: #842029;
33	        --alert-warning-bg: #fff3cd; --alert-warning-border: #ffecb5; --alert-warning-text: #664d03;
34	        --form-check-input-bg: #ffffff; --form-check-input-border: rgba(0, 0, 0, 0.25);
35	        --form-check-input-checked-bg: #0d6efd; --form-check-input-checked-border: #0d6efd;
36	        --form-check-label-color: var(--text-color);
37	    }
38	    body { padding-top: 20px; background-color: var(--bg-color); color: var(--text-color); transition: background-color 0.3s, color 0.3s; }
39	    .container { max-width: 1140px; }
40	    .card { background-color: var(--card-bg); border: 1px solid var(--card-border); box-shadow: 0 0.125rem 0.25rem var(--shadow-color); margin-bottom: 1.5rem; }
41	    .card-header { background-color: transparent; border-bottom: 1px solid var(--card-border); padding: 0.75rem 1.25rem; display: flex; justify-content: space-between; align-items: center; }
42	    .card-header strong { font-size: 1.2em; }
43	    .card-body { padding: 1.25rem; }
44	    .table { border-color: var(--table-border); margin-bottom: 1rem; }
45	    .table th { width: 150px; background-color: var(--table-header-bg); white-space: nowrap; color: var(--text-color); padding: 0.5rem; vertical-align: top; }
46	    .table td { color: var(--text-color); padding: 0.5rem; vertical-align: top; word-break: break-word; }
47	    .table-sm > :not(caption) > * > * { padding: 0.25rem 0.25rem; }
48	    .table-bordered { border: 1px solid var(--table-border); }
49	    .table-bordered th, .table-bordered td { border: 1px solid var(--table-border); }
50	    .badge { font-size: 0.9em; padding: 0.4em 0.6em;}
51	    .bg-success { background-color: var(--success-badge-bg) !important; color: white; }
52	    .bg-warning { background-color: var(--warning-badge-bg) !important; color: black; }
53	    .bg-danger { background-color: var(--danger-badge-bg) !important; color: white; }
54	    .bg-secondary { background-color: var(--secondary-badge-bg) !important; color: white; }
55	    .bg-info { background-color: var(--info-badge-bg) !important; color: var(--info-badge-text); }
56	    .fingerprint { font-family: monospace; font-size: 0.85em; word-break: break-all; }
57	    .text-danger { color: var(--danger-text) !important; }
58	    .text-warning { color: var(--warning-text) !important; }
59	    .text-success { color: var(--success-text) !important; }
60	    .text-muted { color: var(--muted-text) !important; }
61	    .text-secondary { color: var(--secondary-text) !important; }
62	    .text-info { color: var(--info-text) !important; }
63	    .section-title { border-bottom: 1px solid var(--table-border); padding-bottom: 5px; margin-bottom: 15px; margin-top: 1.5rem; font-weight: bold; }
64	    .card-body > div + div { margin-top: 1.5rem; }
65	    .cert-error { background-color: #f8d7da; border-color: #f5c6cb; color: #721c24; padding: 0.5rem; margin-top: 0.5rem; border-radius: .25rem;}
66	    .weak-crypto { font-weight: bold; color: var(--danger-text) !important; }
67	    .form-control { background-color: var(--input-bg); border: 1px solid var(--input-border); color: var(--input-text); }
68	    .form-control:focus { background-color: var(--input-bg); color: var(--input-text); border-color: #86b7fe; box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25); }
69	    .form-label { color: var(--text-color); }
70	    .form-check-label { color: var(--form-check-label-color); }
71	    .form-check-input { background-color: var(--form-check-input-bg); border: 1px solid var(--form-check-input-border); }
72	    .form-check-input:checked { background-color: var(--form-check-input-checked-bg); border-color: var(--form-check-input-checked-border); }
73	    .form-check-input:focus { border-color: #86b7fe; box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25); }
74	    .form-check-input[type=checkbox] { border-radius: .25em; }
75	    .bg-warning { color: #222 !important; }
76	    .cert-error { background-color: #5e2129; border-color: #a0414b; color: #ffb3b8; }
77	    .table th, .table td {
78	        background-color: var(--card-bg) !important;
79	        color: var(--text-color) !important;
80	        border-color: var(--table-border) !important;
81	    }
82	    body { background-color: var(--bg-color) !important; color: var(--text-color) !important; }
83	    .card, .shadow-sm { background-color: var(--card-bg) !important; color: var(--text-color) !important; }
84	    footer small { color: var(--muted-text); }
85	    a { color: var(--link-color); }
86	
87	    @media (prefers-color-scheme: dark) {
88	        :root {
89	            --bg-color: #181a1b; --text-color: #f4f4f4; --card-bg: #23272b;
90	            --card-border: #33363a;
91	            --table-header-bg: #292b2d;
92	            --table-border: #44474a; --input-bg: #23272b; --input-border: #666a6e;
93	            --input-text: #f4f4f4; --muted-text: #b0b3b8; --link-color: #7dbcff;
94	            --shadow-color: rgba(0, 0, 0, 0.4); --success-text: #5cf2b2;
95	            --warning-text: #ffe066; --danger-text: #ff7b72; --secondary-text: #b0b3b8;
96	            --info-text: #7dbcff;
97	            --info-badge-bg: #206bc4; --secondary-badge-bg: #5a6268;
98	            --success-badge-bg: #2ecc71; --warning-badge-bg: #ffe066;
99	            --danger-badge-bg: #ff4c51; --info-badge-text: #23272b;
100	            --alert-danger-bg: #3b2326; --alert-danger-border: #a0414b; --alert-danger-text: #ffb3b8;
101	            --alert-warning-bg: #665c03; --alert-warning-border: #c2a700; --alert-warning-text: #fffbe3;
102	            --form-check-input-bg: #292b2d; --form-check-input-border: #666a6e;
103	            --form-check-input-checked-bg: #0d6efd; --form-check-input-checked-border: #0d6efd;
104	            --form-check-label-color: var(--text-color);
105	        }
106	        .form-control, .form-select {
107	            background-color: var(--input-bg) !important;
108	            color: var(--input-text) !important;
109	            border-color: var(--input-border) !important;
110	        }
111	        .form-control::placeholder { color: #b0b3b8; }
112	        .form-select { background-color: var(--input-bg); border-color: var(--input-border); color: var(--input-text); }
113	        .form-check-input:focus { border-color: #86b7fe; box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25); }
114	        .form-check-input[type=checkbox] { border-radius: .25em; }
115	        .bg-warning { color: #222 !important; }
116	        .cert-error { background-color: #5e2129; border-color: #a0414b; color: #ffb3b8; }
117	        .table th, .table td {
118	            background-color: var(--card-bg) !important;
119	            color: var(--text-color) !important;
120	            border-color: var(--table-border) !important;
121	        }
122	        body { background-color: var(--bg-color) !important; color: var(--text-color) !important; }
123	        .card, .shadow-sm { background-color: var(--card-bg) !important; color: var(--text-color) !important; }
124	    }
125	    .tooltip-th {
126	        border-bottom: 1px dashed #888;
127	        cursor: help;
128	        text-decoration: none;
129	        position: relative;
130	    }
131	    .tooltip-th[data-tooltip]:hover:after, .tooltip-th[data-tooltip]:focus:after {
132	        content: attr(data-tooltip);
133	        position: absolute;
134	        left: 0;
135	        top: 120%;
136	        background: #222;
137	        color: #fff;
138	        padding: 6px 12px;
139	        border-radius: 4px;
140	        font-size: 0.75em;
141	        line-height: 1.4;
142	        white-space: pre-line;
143	        z-index: 10;
144	        opacity: 1;
145	        pointer-events: auto;
146	        transition: none;
147	        min-width: 220px;
148	        max-width: 350px;
149	        box-shadow: 0 2px 12px rgba(0,0,0,0.18);
150	    }
151	    .tooltip-th[data-tooltip]:after {
152	        opacity: 0;
153	        pointer-events: none;
154	        transition: opacity 0s;
155	    }
156	    .tooltip-th[data-tooltip]:hover:after, .tooltip-th[data-tooltip]:focus:after {
157	        opacity: 1;
158	        pointer-events: auto;
159	        transition-delay: 0s;
160	    }
161	</style>
162	<!doctype html>
163	<html lang='en'>
164	<head>
165	<meta charset='utf-8'>
166	<meta name='viewport' content='width=device-width, initial-scale=1'>
167	<link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css' rel='stylesheet'>
168	<title>TLS Analysis</title>
169	</head>
170	<body>
171	<div class='container'>
172	<h1 class='mb-4 text-center'>üîí TLS Certificate & Connection Analyzer</h1>
173	<form method='post' class='mb-5 p-4 border rounded shadow-sm' style='background-color: var(--card-bg);'>
174	<div class='mb-3'>
175	<label for='domains' class='form-label'>Domains to analyze (space or comma separated):</label>
176	<input type='text' class='form-control form-control-lg' id='domains' name='domains' placeholder='e.g. example.com test.org google.com' required>
177	</div>
178	<div class='row'>
179	    <div class='col-md-4 mb-3'>
180	        <div class='form-check'>
181	        <input class='form-check-input' type='checkbox' id='insecure' name='insecure' value='true' {% if insecure_checked %}checked{% endif %}>
182	        <label class='form-check-label' for='insecure'> Ignore SSL errors</label>
183	        </div>
184	    </div>
185	    <div class='col-md-4 mb-3'>
186	        <div class='form-check'>
187	        <input class='form-check-input' type='checkbox' id='no_transparency' name='no_transparency' value='true' {% if no_transparency_checked %}checked{% endif %}>
188	        <label class='form-check-label' for='no_transparency'> Skip Transparency Check</label>
189	        </div>
190	    </div>
191	    <div class='col-md-4 mb-3'>
192	        <div class='form-check'>
193	        <input class='form-check-input' type='checkbox' id='no_crl_check' name='no_crl_check' value='true' {% if no_crl_check_checked %}checked{% endif %}>
194	        <label class='form-check-label' for='no_crl_check'> Disable CRL Check</label>
195	        </div>
196	    </div>
197	</div>
198	<button type='submit' class='btn btn-primary w-100 btn-lg'>Analyze</button>
199	</form>
200	
201	{% if results %}
202	{% for result in results %}
203	<div class='card mb-4 shadow-sm'>
204	<div class='card-header'>
205	<strong>{{ result.domain }}</strong>
206	{% set status = result.status | default('failed') %}
207	{% if status == 'completed' %}<span class='badge bg-success'>COMPLETED</span>
208	{% elif status == 'completed_with_errors' %}<span class='badge bg-warning'>COMPLETED WITH ERRORS</span>
209	{% else %}<span class='badge bg-danger'>FAILED</span>{% endif %}
210	</div>
211	<div class='card-body'>
212	    {% if result.error_message %}<div class='alert alert-danger'><strong>Status:</strong> {{ result.error_message }}</div>{% endif %}
213	    <p class='text-muted'><small>Analysis Time: {{ result.analysis_timestamp | default('N/A') }}</small></p>
214	
215	    {# Validation Section #}
216	    <div> <h5 class='section-title'>Validation {{ get_tooltip('Whether the certificate is trusted by the system trust store. This is a critical check as it determines if the certificate is considered valid by the client.') }}</h5>
217	        {% set val = result.validation | default({}) %} {% set val_status = val.system_trust_store %}
218	        {% if val_status is sameas true %}<span class='badge bg-success'>‚úîÔ∏è Valid (System Trust)</span>
219	        {% elif val_status is sameas false %}<span class='badge bg-danger'>‚ùå Invalid (System Trust)</span> {% if val.error %}<small class='text-muted ps-2'>({{ val.error }})</small>{% endif %}
220	        {% elif val.error %}<span class='badge bg-danger'>‚ùå Error</span> <small class='text-muted ps-2'>({{ val.error }})</small>
221	        {% else %}<span class='badge bg-secondary'>N/A / Pending</span> {% endif %}
222	    </div>
223	
224	    {# Leaf Certificate Summary Section #}
225	    {% set certs_list = result.certificates | default([]) %}
226	    {% set leaf_cert = certs_list[0] if certs_list and 'error' not in certs_list[0] else none %}
227	    {% if leaf_cert %}
228	    <div> <h5 class='section-title'>Leaf Certificate Summary {{ get_tooltip('Summary of the leaf (end-entity) certificate.') }}</h5>
229	        <table class='table table-sm table-bordered'>
230	             <tr><th class="tooltip-th" data-tooltip="The primary domain name (CN) for which this certificate was issued. Browsers match this against the requested domain.">Common Name</th><td>{{ leaf_cert.common_name | default('N/A') }}</td></tr>
231	             <tr><th class="tooltip-th" data-tooltip="The exact date and time when this certificate will expire. After this point, browsers and clients will reject it as invalid.">Expires</th><td>
232	                 {% set days_leaf = leaf_cert.days_remaining %}
233	                 {{ (leaf_cert.not_after | replace("T", " ") | replace("Z", "") | replace("+00:00", ""))[:19] | default('N/A') }}
234	                 {% if days_leaf is not none %}<span class='{% if days_leaf < 30 %}text-danger{% elif days_leaf < 90 %}text-warning{% else %}text-success{% endif %} fw-bold'> ({{ days_leaf }} days)</span>
235	                 {% else %}<span class='text-secondary'>(Expiry N/A)</span> {% endif %}
236	             </td></tr>
237	             <tr><th class="tooltip-th" data-tooltip="Subject Alternative Names (SANs): all additional domains and subdomains this certificate is valid for, in addition to the Common Name.">SANs</th><td>{{ leaf_cert.san | join(", ") | default('None') }}</td></tr>
238	             <tr><th class="tooltip-th" data-tooltip="The organization or Certificate Authority (CA) that issued and signed this certificate.">Issuer</th><td>{{ leaf_cert.issuer | default('N/A') }}</td></tr>
239	        </table>
240	    </div>
241	    {% endif %}
242	
243	    {# Connection Health Section #}
244	    <div> <h5 class='section-title'>Connection Health {{ get_tooltip('TLS version, cipher, and protocol health of the connection.') }}</h5>
245	        {% set conn = result.connection_health | default({}) %}
246	        {% if not conn.checked %}<span class='badge bg-warning'>Not Checked / Failed</span> {% if conn.error %}<small class='text-muted ps-2'>({{ conn.error }})</small>{% endif %}
247	        {% else %}
248	        <table class='table table-sm table-bordered'>
249	            <tr><th class="tooltip-th" data-tooltip="The negotiated TLS protocol version used for this connection (e.g., TLS 1.3). Higher versions are generally more secure.">TLS Version</th><td>{{ conn.tls_version | default('N/A') }}</td></tr>
250	            <tr><th class="tooltip-th" data-tooltip="Indicates whether the server supports the latest TLS 1.3 protocol, which provides improved security and performance.">TLS 1.3 Support</th><td>
251	                {% set tls13_s = conn.supports_tls13 %}
252	                {% if tls13_s is sameas true %}<span class='text-success'>‚úîÔ∏è Yes</span>
253	                {% elif tls13_s is sameas false %}<span class='text-danger'>‚ùå No</span>
254	                {% else %}<span class='text-secondary'>N/A</span>{% endif %}
255	            </td></tr>
256	            <tr><th class="tooltip-th" data-tooltip="The specific cryptographic algorithms used to secure the connection, including key exchange, encryption, and authentication.">Cipher Suite</th><td>{{ conn.cipher_suite | default('N/A') }}</td></tr>
257	        </table>
258	        {% if conn.error %}<div class='alert alert-danger mt-2'><small>Connection Error: {{ conn.error }}</small></div>{% endif %}
259	        {% endif %}
260	    </div>
261	
262	    {# CRL Check Section #}
263	    <div><h5 class='section-title'>CRL Check (Leaf Certificate) {{ get_tooltip('Checks if the certificate is revoked using CRL.') }}</h5>
264	        {% set crl_check_data = result.crl_check | default({}) %}
265	        {% if not crl_check_data.checked %}
266	             <span class='badge bg-secondary'>Skipped</span>
267	        {% else %}
268	            {% set crl_status = crl_check_data.leaf_status | default('error') %}
269	            {% set crl_details = crl_check_data.details | default({}) %}
270	            {% set crl_reason = crl_details.reason if crl_details is mapping else 'No details' %}
271	            {% set crl_uri = crl_details.checked_uri if crl_details is mapping else None %}
272	
273	            {% if crl_status == "good" %} <span class='badge bg-success'>‚úîÔ∏è Good</span>
274	            {% elif crl_status == "revoked" %} <span class='badge bg-danger'>‚ùå REVOKED</span>
275	            {% elif crl_status == "crl_expired" %} <span class='badge bg-warning'>‚ö†Ô∏è CRL Expired</span>
276	            {% elif crl_status == "unreachable" %} <span class='badge bg-warning'>‚ö†Ô∏è Unreachable</span>
277	            {% elif crl_status == "parse_error" %} <span class='badge bg-danger'>‚ùå Parse Error</span>
278	            {% elif crl_status == "no_cdp" %} <span class='badge bg-info'>‚ÑπÔ∏è No CDP</span>
279	            {% elif crl_status == "no_http_cdp" %} <span class='badge bg-info'>‚ÑπÔ∏è No HTTP CDP</span>
280	            {% elif crl_status == "error" %} <span class='badge bg-danger'>‚ùå Error</span>
281	            {% else %} <span class='badge bg-secondary'>‚ùì Unknown</span>
282	            {% endif %}
283	            <p class='text-muted mt-1'><small>
284	                {{ crl_reason }}
285	                {% if crl_uri %} <br>Checked URI: {{ crl_uri }} {% endif %}
286	            </small></p>
287	        {% endif %}
288	    </div>
289	
290	    {# Certificate Chain Details Section #}
291	     <div> <h5 class='section-title'>Certificate Chain Details {{ get_tooltip('Details of each certificate in the chain.') }}</h5>
292	        {% if not certs_list and result.status != 'failed' %}<div class='alert alert-warning'>No certificates were processed successfully.</div>
293	        {% elif not certs_list and result.status == 'failed' %}<div class='alert alert-danger'>Certificate fetching or analysis failed.</div>
294	        {% endif %}
295	        {% for cert in certs_list %}
296	            <h6 class="mt-3">Certificate #{{ loop.index }}
297	                {% if cert.error %} <span class='text-danger'>(Error Analyzing)</span>
298	                {% elif cert.chain_index == 0 %} (Leaf)
299	                {% elif cert.is_ca %} (CA/Intermediate)
300	                {% else %} (Intermediate) {% endif %}
301	             </h6>
302	            {% if cert.error %}<div class='cert-error'><strong>Error:</strong> {{ cert.error }}</div>
303	            {% else %}
304	            <table class='table table-sm table-bordered mb-3'>
305	                <tr><th class="tooltip-th" data-tooltip="The distinguished name (DN) of the entity this certificate is issued to, including organization, location, and CN.">Subject</th><td>{{ cert.subject | default('N/A') }}</td></tr>
306	                <tr><th class="tooltip-th" data-tooltip="The organization or Certificate Authority (CA) that issued and signed this certificate.">Issuer</th><td>{{ cert.issuer | default('N/A') }}</td></tr>
307	                <tr><th class="tooltip-th" data-tooltip="The primary domain name (CN) for which this certificate was issued. Browsers match this against the requested domain.">Common Name</th><td>{{ cert.common_name | default('N/A') }}</td></tr>
308	                <tr><th class="tooltip-th" data-tooltip="A unique identifier assigned to this certificate by the issuer. Useful for revocation and auditing.">Serial</th><td>{{ cert.serial_number | default('N/A') }}</td></tr>
309	                <tr><th class="tooltip-th" data-tooltip="The X.509 version of this certificate. Modern certificates use version 3.">Version</th><td>{{ cert.version | default('N/A') }}</td></tr>
310	                <tr><th class="tooltip-th" data-tooltip="The period during which this certificate is considered valid, from 'not before' to 'not after' dates.">Validity</th><td>
311	                    {{ (cert.not_before | replace("T", " ") | replace("Z", "") | replace("+00:00", ""))[:19] | default('N/A') }} ‚Üí
312	                    {{ (cert.not_after | replace("T", " ") | replace("Z", "") | replace("+00:00", ""))[:19] | default('N/A') }} <br>
313	                    {% set days = cert.days_remaining %}
314	                    {% if days is not none %}<span class='{% if days < 30 %}text-danger{% elif days < 90 %}text-warning{% else %}text-success{% endif %} fw-bold'> ({{ days }} days remaining)</span>
315	                    {% else %}<span class='text-secondary'>(Expiry N/A)</span> {% endif %}
316	                </td></tr>
317	                <tr><th class="tooltip-th" data-tooltip="Details about the public key in this certificate, including algorithm (e.g., RSA, ECDSA) and key size in bits. Weak keys are insecure.">Key</th><td>
318	                    {% set k_algo = cert.public_key_algorithm | default('N/A') %} {% set k_size = cert.public_key_size_bits %} {{ k_algo }}
319	                    {% if k_size %}
320	                        {% set weak_key = (k_algo == 'RSA' and k_size < 2048) or ('ECDSA' in k_algo and k_size < 256) or (k_algo == 'DSA' and k_size < 2048) %}
321	                        (<span class='{% if weak_key %}weak-crypto{% endif %}'>{{ k_size }} bits</span>){% if weak_key %}<span class='weak-crypto ps-1'>(Weak)</span>{% endif %}
322	                    {% endif %}
323	                </td></tr>
324	                <tr><th class="tooltip-th" data-tooltip="The algorithm used by the issuer to sign this certificate. Weak signature algorithms (like SHA1/MD5) are insecure.">Signature Algo</th><td>
325	                     {% set sig_algo = cert.signature_algorithm | default('N/A') %} {% set weak_hash = "sha1" in sig_algo.lower() or "md5" in sig_algo.lower() %}
326	                     <span class='{% if weak_hash %}weak-crypto{% endif %}'>{{ sig_algo }}</span>{% if weak_hash %}<span class='weak-crypto ps-1'>(Weak)</span>{% endif %}
327	                </td></tr>
328	                 <tr><th class="tooltip-th" data-tooltip="The SHA-256 fingerprint is a unique hash of the certificate. It can be used to verify or pin a certificate.">SHA256 FP</th><td class='fingerprint'>{{ cert.sha256_fingerprint | default('N/A') }}</td></tr>
329	                <tr><th class="tooltip-th" data-tooltip="A high-level classification of the certificate's intended usage, such as server authentication or CA root.">Profile</th><td>{{ cert.profile | default('N/A') }}</td></tr>
330	                <tr><th class="tooltip-th" data-tooltip="Whether this certificate can act as a Certificate Authority (CA) and issue other certificates. PathLen shows CA depth.">Is CA</th><td> {% if cert.is_ca is sameas true %}Yes{% elif cert.is_ca is sameas false %}No{% else %}N/A{% endif %} {% if cert.is_ca %} (PathLen: {{ cert.path_length_constraint if cert.path_length_constraint is not none else 'None' }}) {% endif %} </td></tr>
331	                <tr><th class="tooltip-th" data-tooltip="Whether this certificate contains embedded Signed Certificate Timestamps (SCTs) for Certificate Transparency.">Embedded SCTs</th><td>
332	                    {% set sct_s = cert.has_scts %}
333	                    {% if sct_s is sameas true %}<span class='text-success'>‚úîÔ∏è Yes</span>
334	                    {% elif sct_s is sameas false %}<span class='text-warning'>‚ùå No</span>
335	                    {% else %}<span class='text-secondary'>N/A</span>{% endif %}
336	                </td></tr>
337	            </table>
338	            {% endif %}
339	        {% endfor %}
340	    </div>
341	
342	    {# Certificate Transparency Section #}
343	    <div> <h5 class='section-title'>Certificate Transparency (crt.sh) {{ get_tooltip('Checks for issued certificates for this and parent domains in public CT logs.') }}</h5>
344	         {% set trans = result.transparency | default({}) %}
345	         {% if not trans.checked %}<span class='badge bg-secondary'>Skipped</span>
346	         {% elif trans.errors %}
347	            <span class='badge bg-danger'>Error</span>
348	            <ul>
349	            {% for d, err in trans.errors.items() %}
350	                <li><strong>{{ d }}</strong>: {{ err }} {% if trans.crtsh_report_links and trans.crtsh_report_links[d] %}<a href="{{ trans.crtsh_report_links[d] }}" target="_blank" rel="noopener" class="ms-2">[View on crt.sh]</a>{% endif %}</li>
351	            {% endfor %}
352	            </ul>
353	         {% else %}
354	              <ul>
355	              {% for d, records in trans.details.items() %}
356	                  <li><strong>{{ d }}</strong>:
357	                      {% if records is none %} <span class='badge bg-danger'>Error</span>
358	                      {% else %} <span class='badge bg-info'>{{ records|length }} records</span>
359	                      {% endif %}
360	                      {% if trans.crtsh_report_links and trans.crtsh_report_links[d] %}<a href="{{ trans.crtsh_report_links[d] }}" target="_blank" rel="noopener" class="ms-2">[View on crt.sh]</a>{% endif %}
361	                  </li>
362	              {% endfor %}
363	              </ul>
364	              <span class='ps-2'>Total records found:</span> <span class='badge bg-info'>{{ trans.crtsh_records_found }}</span>
365	         {% endif %}
366	    </div>
367	
368	</div> {# End Card Body #}
369	</div> {# End Card #}
370	{% endfor %}
371	{% endif %}
372	<footer class='text-center text-muted mt-5 mb-3'> <small><a href="https://github.com/obeone/check-tls" target="_blank" rel="noopener">TLS Check</a></small></footer>
373	</div>
374	</body>
375	</html>
376	"""
377	
378	def run_server(args):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/web_server.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
429	
430	    logging.info(f"Starting Flask server on http://0.0.0.0:{args.port}")
431	    try:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/check-tls/check_tls-1.0.0/src/check_tls/web_server.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
431	    try:
432	        app.run(host='0.0.0.0', port=args.port, debug=False)
433	    except Exception as e:

--------------------------------------------------

Code scanned:
	Total lines of code: 1220
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 0.0
Files skipped (0):
