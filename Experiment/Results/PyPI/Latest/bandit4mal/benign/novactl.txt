Run started:2025-05-25 16:12:41.514786

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	    cfg = config.load_config()  # Ensure latest config
228	    leeway = cfg.get("token_leeway_seconds", 60)
229	    expected_issuer = cfg.get("oidc_issuer")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
228	    leeway = cfg.get("token_leeway_seconds", 60)
229	    expected_issuer = cfg.get("oidc_issuer")
230	    client_id = cfg.get("keycloak_client_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	    expected_issuer = cfg.get("oidc_issuer")
230	    client_id = cfg.get("keycloak_client_id")
231	    audience = client_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
239	        unverified_headers = jose_jwt.get_unverified_headers(token)
240	        kid = unverified_headers.get("kid")
241	        if not kid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	
244	        public_key = public_keys.get(kid)
245	        if not public_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	            public_keys = _get_public_keys()  # Try fetching again
252	            public_key = public_keys.get(kid)
253	            if not public_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
303	    cfg = config.load_config()
304	    token_endpoint = cfg.get("oidc_token_endpoint")
305	    client_id = cfg.get("keycloak_client_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
304	    token_endpoint = cfg.get("oidc_token_endpoint")
305	    client_id = cfg.get("keycloak_client_id")
306	    ssl_verify = cfg.get("ssl_verify", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
305	    client_id = cfg.get("keycloak_client_id")
306	    ssl_verify = cfg.get("ssl_verify", True)
307	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
329	
330	        id_token = new_tokens.get("id_token")
331	        access_token = new_tokens.get("access_token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	        id_token = new_tokens.get("id_token")
331	        access_token = new_tokens.get("access_token")
332	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	                error_details = e.response.json()
359	                error_code = error_details.get("error")
360	                logger.warning(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
409	        logger.info("Forcing token refresh.")
410	        refresh_token = tokens.get("refresh_token")
411	        if refresh_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
417	
418	    id_token = tokens.get("id_token")
419	    access_token = tokens.get("access_token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
418	    id_token = tokens.get("id_token")
419	    access_token = tokens.get("access_token")
420	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
430	        logger.info("Current tokens invalid or expired, attempting refresh.")
431	        refresh_token = tokens.get("refresh_token")
432	        if refresh_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
467	    cfg = config.load_config()
468	    device_auth_endpoint = cfg.get("oidc_device_auth_endpoint")
469	    token_endpoint = cfg.get("oidc_token_endpoint")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
468	    device_auth_endpoint = cfg.get("oidc_device_auth_endpoint")
469	    token_endpoint = cfg.get("oidc_token_endpoint")
470	    client_id = cfg.get("keycloak_client_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	    token_endpoint = cfg.get("oidc_token_endpoint")
470	    client_id = cfg.get("keycloak_client_id")
471	    scopes = cfg.get("additional_scopes", "openid email profile")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	    client_id = cfg.get("keycloak_client_id")
471	    scopes = cfg.get("additional_scopes", "openid email profile")
472	    ssl_verify = cfg.get("ssl_verify", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	    scopes = cfg.get("additional_scopes", "openid email profile")
472	    ssl_verify = cfg.get("ssl_verify", True)
473	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
498	
499	        device_code = device_data.get("device_code")
500	        user_code = device_data.get("user_code")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
499	        device_code = device_data.get("device_code")
500	        user_code = device_data.get("user_code")
501	        verification_uri = device_data.get("verification_uri")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	        user_code = device_data.get("user_code")
501	        verification_uri = device_data.get("verification_uri")
502	        verification_uri_complete = device_data.get("verification_uri_complete")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
501	        verification_uri = device_data.get("verification_uri")
502	        verification_uri_complete = device_data.get("verification_uri_complete")
503	        expires_in = device_data.get("expires_in")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
502	        verification_uri_complete = device_data.get("verification_uri_complete")
503	        expires_in = device_data.get("expires_in")
504	        interval = device_data.get("interval", 5)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
503	        expires_in = device_data.get("expires_in")
504	        interval = device_data.get("interval", 5)
505	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
560	                    # NO RETRY on polling loop itself: The spec defines specific errors for polling status
561	                    token_response = requests.post(
562	                        token_endpoint,
563	                        data=token_payload,
564	                        timeout=10,  # Shorter timeout for polling requests
565	                        verify=ssl_verify,
566	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
580	                        error_data = token_response.json()
581	                        error_code = error_data.get("error")
582	                        logger.debug(f"Polling error response: {error_data}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
675	        if tokens:
676	            access_token = tokens.get("access_token")
677	            id_token = tokens.get("id_token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	            access_token = tokens.get("access_token")
677	            id_token = tokens.get("id_token")
678	            if not access_token or not id_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/src/novactl/auth.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
746	    cfg = config.load_config()
747	    logout_endpoint = cfg.get("oidc_logout_endpoint")
748	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
80	    # Mock the sequence: pending -> success
81	    rmock.post(
82	        helpers["token_url"],
83	        [
84	            {
85	                "json": {"error": "authorization_pending"},
86	                "status_code": 400,
87	            },  # First poll: pending
88	            {
89	                "json": helpers["generate_token_response"](),
90	                "status_code": 200,
91	            },  # Second poll: success

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	    # Verify tokens saved in keyring
113	    saved_token_str = mock_keyring.get((TEST_SERVICE_NAME, TEST_KEYRING_USERNAME))
114	    assert saved_token_str is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	    # Ensure tokens were not saved
173	    assert mock_keyring.get((TEST_SERVICE_NAME, TEST_KEYRING_USERNAME)) is None
174	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
180	    # Arrange: Mock the device auth endpoint to return an error
181	    rmock.post(helpers["device_auth_url"], status_code=500, text="Server Error")
182	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	    assert "Login process failed or was cancelled." in result.stdout
191	    assert mock_keyring.get((TEST_SERVICE_NAME, TEST_KEYRING_USERNAME)) is None
192	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	    valid_tokens, _ = logged_in_state
257	    refresh_token = valid_tokens.get("refresh_token")
258	    assert refresh_token is not None, "Test setup error: No refresh token generated"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
270	    cfg = config.load_config()  # Load mocked config
271	    logout_url_expected = cfg.get("oidc_logout_endpoint")
272	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
282	    # Verify tokens cleared from keyring
283	    assert mock_keyring.get((TEST_SERVICE_NAME, TEST_KEYRING_USERNAME)) is None
284	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	    cfg = config.load_config()  # Load mocked config for URL
290	    logout_url_expected = cfg.get("oidc_logout_endpoint")
291	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
335	    # Match only the refresh grant for the specific token
336	    rmock.post(
337	        helpers["token_url"],
338	        additional_matcher=lambda req: f"refresh_token={valid_refresh_token}"
339	        in req.text
340	        and "grant_type=refresh_token" in req.text,
341	        json=refreshed_token_response,
342	        status_code=200,
343	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
362	    # Verify NEW tokens are stored
363	    final_tokens_str = mock_keyring.get((TEST_SERVICE_NAME, TEST_KEYRING_USERNAME))
364	    assert final_tokens_str is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/novactl/novactl-0.1.0/tests/test_main.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	    # Verify tokens were cleared by the failed refresh handler
400	    assert mock_keyring.get((TEST_SERVICE_NAME, TEST_KEYRING_USERNAME)) is None
401	

--------------------------------------------------

Code scanned:
	Total lines of code: 1592
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 44.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 44.0
		High: 0.0
Files skipped (0):
