Run started:2025-05-25 16:03:16.325672

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	    port: int,
25	    host: str = "127.0.0.1",
26	    timeout: float = 2.0,
27	    max_retries: int = 3,
28	    protocol: str = "tcp",
29	    address_family: int = AF_INET,
30	    total_timeout: float = None,
31	) -> Tuple[bool, str]:
32	    start_time = time.time()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:64
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
63	            try:
64	                s = socket.socket(family=address_family, type=socket.SOCK_DGRAM)
65	                s.settimeout(timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
64	                s = socket.socket(family=address_family, type=socket.SOCK_DGRAM)
65	                s.settimeout(timeout)
66	                s.bind((host, port))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
66	                s.bind((host, port))
67	                s.close()  # 立即关闭可用端口
68	                logger.info(f"尝试 {attempt}/{max_retries}: UDP端口 {port} 可用")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
72	                if "s" in locals():
73	                    s.close()
74	                logger.warning(

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
89	            try:
90	                with socket.socket(family=address_family, type=socket_type) as s:
91	                    s.settimeout(timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
90	                with socket.socket(family=address_family, type=socket_type) as s:
91	                    s.settimeout(timeout)
92	                    result = s.connect_ex((host, port))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
127	    end_port: int,
128	    host: str = "127.0.0.1",
129	    timeout: float = 2.0,
130	    max_retries: int = 3,
131	    protocol: str = "tcp",
132	    address_family: int = AF_INET,
133	    total_timeout: float = None,
134	) -> dict:
135	    result = {}
136	    start_time = time.time()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
153	
154	    with ThreadPoolExecutor() as executor:
155	        try:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/port_checker.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
179	    parser.add_argument(
180	        "--host", default=default_config.get("host", "127.0.0.1"), help="目标主机地址"
181	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/new-port-checker/new_port_checker-1.0.1/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    },
24	    url='https://github.com/yourusername/new_port_checker',  # 替换为实际项目地址
25	    classifiers=[

--------------------------------------------------

Code scanned:
	Total lines of code: 333
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 2.0
Files skipped (0):
