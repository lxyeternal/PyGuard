Run started:2025-05-25 16:00:49.432974

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/client/cli.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	            with open(args.requirement_file, 'r', encoding='utf-8') as file:
117	                return file.read()
118	        except IOError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/code_engineer.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	                with open(system_prompt_path, "r", encoding="utf-8") as f:
66	                    return f.read()
67	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/diff.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
226	                        with open(full_path_pre, "r", encoding="utf-8") as f:
227	                            original_content = f.read()
228	                        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/diff.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
280	            with open(file_path, "w", encoding="utf-8") as f:
281	                f.write(content)
282	            return f"文件已更新: {file_path}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/file_memory.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
257	            with open(full_path, "r", encoding="utf-8") as f:
258	                return f.read()
259	        except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/file_memory.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
324	        with open(self.git_id_path, "r") as f:
325	            return f.read().strip()
326	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/file_memory.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
329	        with open(self.git_id_path, "w") as f:
330	            f.write(git_id)
331	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/file_memory.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
348	            for filename, description in sorted(details.items()):
349	                f.write(f"{filename}:{description}\n")
350	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/git_manager.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
150	            if os.path.exists(self.config.repo_path):
151	                shutil.rmtree(self.config.repo_path)
152	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/git_manager.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
178	            if os.path.exists(self.config.repo_path):
179	                shutil.rmtree(self.config.repo_path)
180	            raise

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/git_manager.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
416	            # 删除本地仓库目录
417	            shutil.rmtree(self.config.repo_path)
418	            logger.info(f"成功删除本地仓库: {self.config.repo_path}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	        with open(os.path.join(round_dir, self.SYS_PROMPT_FILE), "w", encoding="utf-8") as f:
86	            f.write(sys_prompt)
87	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	        with open(os.path.join(round_dir, self.USER_PROMPT_FILE), "w", encoding="utf-8") as f:
90	            f.write(prompt)
91	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	        with open(os.path.join(round_dir, self.AI_RESPONSE_FILE), "w", encoding="utf-8") as f:
94	            f.write(response)
95	            

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	        with open(os.path.join(round_dir, self.TIMESTAMP_FILE), "w", encoding="utf-8") as f:
98	            f.write(timestamp)
99	        

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	                with open(sys_prompt_path, "r", encoding="utf-8") as f:
151	                    sys_prompt = f.read()
152	                

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
155	                with open(user_prompt_path, "r", encoding="utf-8") as f:
156	                    prompt = f.read()
157	                

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	                with open(ai_response_path, "r", encoding="utf-8") as f:
161	                    response = f.read()
162	                    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/log_manager.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
168	                        with open(timestamp_path, "r", encoding="utf-8") as f:
169	                            timestamp = f.read().strip()
170	                    except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/prompt_generator.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	                with open(path, "r", encoding="utf-8") as f:
91	                    content = f.read()
92	                

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/prompt_generator.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
165	            with open(file_path, "r", encoding="utf-8") as f:
166	                content = f.read()
167	            

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bella-issues-bot/bella_issues_bot-0.1.0/core/workflow_engine.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
201	                # 删除临时目录
202	                shutil.rmtree(self.temp_dir, ignore_errors=True)
203	                logger.info(f"已清理临时工作目录: {self.temp_dir}")

--------------------------------------------------

Code scanned:
	Total lines of code: 2626
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 0.0
Files skipped (0):
