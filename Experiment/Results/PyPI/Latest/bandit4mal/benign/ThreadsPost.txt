Run started:2025-05-25 15:50:10.149067

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    description='This is Python library to just post to Threads',
14	    long_description=open('README.md', encoding='utf-8').read(),
15	    long_description_content_type='text/markdown',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    long_description_content_type='text/markdown',
16	    url='https://github.com/Mr-SuperInsane/ThreadsPost',
17	    classifiers=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	THREADS_GRAPH_API_URL = "https://graph.threads.net/v1.0"
13	MAX_MEDIA_NUM = 10

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	        url = f"{THREADS_GRAPH_API_URL}/me?access_token={self.access_token}"
48	        response = requests.get(url, timeout=30)
49	        return response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        """
72	        if not (main_post.get("content") or main_post.get("media")):
73	            raise ValueError("main_post must have either 'content' or 'media'.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        """
72	        if not (main_post.get("content") or main_post.get("media")):
73	            raise ValueError("main_post must have either 'content' or 'media'.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	        # ------------------------------------------------------------------
84	        media: List[str] = main_post.get("media", [])
85	        if len(media) <= 1:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
85	        if len(media) <= 1:
86	            status = self._single_post(main_post.get("content"), media, status)
87	        elif len(media) <= MAX_MEDIA_NUM:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	        if len(media) <= 1:
86	            status = self._single_post(main_post.get("content"), media, status)
87	        elif len(media) <= MAX_MEDIA_NUM:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
87	        elif len(media) <= MAX_MEDIA_NUM:
88	            status = self._carousel_post(main_post.get("content"), media, status)
89	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	        elif len(media) <= MAX_MEDIA_NUM:
88	            status = self._carousel_post(main_post.get("content"), media, status)
89	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
96	            root_post_id = status["post-ID"]
97	            reply_status = self._reply_post(reply_posts, root_post_id)
98	            status["reply"] = reply_status

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	        url = f"{THREADS_GRAPH_API_URL}/me?access_token={self.access_token}"
107	        response = requests.get(url, timeout=30)
108	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	        while elapsed < timeout_seconds:
119	            resp = requests.get(lookup, timeout=30)
120	            if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	            if resp.status_code == 200:
121	                status = resp.json().get("status")
122	                if status == "FINISHED":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	        for idx, reply in enumerate(reply_posts, 1):
206	            content = reply.get("content")
207	            media: List[str] = reply.get("media", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	            content = reply.get("content")
207	            media: List[str] = reply.get("media", [])
208	            if len(media) <= 1:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	            status.update(post_status)
213	            reply_id = post_status.get(f"reply-{idx}-ID", reply_id)
214	        return status

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
225	        now = datetime.now(JST).strftime("%Y/%m/%d-%H:%M:%S.%f")
226	        response = requests.post(url, json=payload, headers={"Content-Type": "application/json"}, timeout=60)
227	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
240	        for _ in range(attempts):
241	            resp = requests.post(url, json=publish_payload, headers={"Content-Type": "application/json"}, timeout=60)
242	            if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	    def _build_permalink(self, post_id: str) -> str:
326	        permalink_resp = requests.get(
327	            f"{THREADS_GRAPH_API_URL}/{post_id}?fields=permalink&access_token={self.access_token}",
328	            timeout=30,
329	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
331	        slug = permalink_resp.json()["permalink"].rstrip("/").split("/")[-1]
332	        return f"https://www.threads.net/@{self.user_id}/post/{slug}"
333	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
353	    client = ThreadsPost(access_token=args.access_token, user_id=args.user_id)
354	    result = client.post(data["mainPost"], data.get("replyPost"))
355	    print(json.dumps(result, ensure_ascii=False, indent=2))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/ThreadsPost/threadspost-0.0.1/threads_post/threads_post.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	    client = ThreadsPost(access_token=args.access_token, user_id=args.user_id)
354	    result = client.post(data["mainPost"], data.get("replyPost"))
355	    print(json.dumps(result, ensure_ascii=False, indent=2))

--------------------------------------------------

Code scanned:
	Total lines of code: 314
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 0.0
Files skipped (0):
