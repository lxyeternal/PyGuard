Run started:2025-05-25 16:08:50.985794

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/client/websocket.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
50	    # Connect using websockets, requesting the "mcp" subprotocol
51	    async with ws_connect(url, subprotocols=[Subprotocol("mcp")]) as ws:
52	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/client/websocket.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
61	                        message = types.JSONRPCMessage.model_validate_json(raw_text)
62	                        await read_stream_writer.send(message)
63	                    except ValidationError as exc:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/client/websocket.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
64	                        # If JSON parse or model validation fails, send the exception
65	                        await read_stream_writer.send(exc)
66	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/client/websocket.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
77	                    )
78	                    await ws.send(json.dumps(msg_dict))
79	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/fastmcp/server.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
71	    # HTTP settings
72	    host: str = "0.0.0.0"
73	    port: int = 8000

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/fastmcp/utilities/types.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
47	            with open(self.path, "rb") as f:
48	                data = base64.b64encode(f.read()).decode()
49	        elif self.data is not None:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/fastmcp/utilities/types.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
47	            with open(self.path, "rb") as f:
48	                data = base64.b64encode(f.read()).decode()
49	        elif self.data is not None:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/fastmcp/utilities/types.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
49	        elif self.data is not None:
50	            data = base64.b64encode(self.data).decode()
51	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/fastmcp/utilities/types.py:50
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
49	        elif self.data is not None:
50	            data = base64.b64encode(self.data).decode()
51	        else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/lowlevel/server.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
303	                                uri=req.params.uri,
304	                                blob=base64.b64encode(data).decode(),
305	                                mimeType=mime_type or "application/octet-stream",

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/lowlevel/server.py:304
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
303	                                uri=req.params.uri,
304	                                blob=base64.b64encode(data).decode(),
305	                                mimeType=mime_type or "application/octet-stream",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/sse.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	
139	        session_id_param = request.query_params.get("session_id")
140	        if session_id_param is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/sse.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	
153	        writer = self._read_stream_writers.get(session_id)
154	        if not writer:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/websocket.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
40	                    except ValidationError as exc:
41	                        await read_stream_writer.send(exc)
42	                        continue

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/websocket.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
43	
44	                    await read_stream_writer.send(client_message)
45	        except anyio.ClosedResourceError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/websocket.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
45	        except anyio.ClosedResourceError:
46	            await websocket.close()
47	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/server/websocket.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
54	        except anyio.ClosedResourceError:
55	            await websocket.close()
56	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/mcp-custom/mcp/shared/session.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
323	                    self._in_flight[responder.request_id] = responder
324	                    await self._received_request(responder)
325	

--------------------------------------------------

Code scanned:
	Total lines of code: 5346
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 3.0
Files skipped (0):
