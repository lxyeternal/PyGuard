Run started:2025-05-25 16:11:33.395952

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        cluster: str = "default",
45	        config_server_url: str = "http://localhost:8090",
46	        env: str = "DEV",
47	        # namespaces: List[str] = None,
48	        ip: str = None,
49	        timeout: int = 60,
50	        cycle_time: int = 300,
51	        cache_file_path: str = None,
52	        authorization: str = None
53	        # request_model: Optional[Any] = None,
54	    ):
55	        """
56	        init method

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	        url = f"{self.host}:{self.port}/apps/{self.app_id}/clusters"
105	        r = self._http_get(url)
106	        if r.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	        url = f"{self.host}:{self.port}/apps/{self.app_id}/clusters/{self.cluster}/namespaces"
117	        r = self._http_get(url)
118	        if r.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	            namespaces = r.json()
120	            return {_.get("namespaceName"): _.get("id") for _ in namespaces}
121	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	            namespaces = r.json()
120	            return {_.get("namespaceName"): _.get("id") for _ in namespaces}
121	        else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:135
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
134	
135	                s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
136	                s.connect(("8.8.8.8", 53))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
135	                s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
136	                s.connect(("8.8.8.8", 53))
137	                ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
135	                s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
136	                s.connect(("8.8.8.8", 53))
137	                ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
137	                ip = s.getsockname()[0]
138	                s.close()
139	            except BaseException:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
139	            except BaseException:
140	                return "127.0.0.1"
141	        return ip

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	            if namespace in self._cache:
156	                return self._cache[namespace].get(key, default_val)
157	            return default_val

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	        # start the thread to get config server with schedule
170	        t = threading.Thread(target=self._listener)
171	        t.setDaemon(True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	        if self._request_model is None:
181	            return self._request_get(url, params=params)
182	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
193	            if self._authorization:
194	                return requests.get(
195	                    url=url,
196	                    params=params,
197	                    timeout=self.timeout // 2,
198	                    headers={"Authorization": self._authorization},
199	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	            else:
201	                return requests.get(url=url, params=params, timeout=self.timeout // 2)
202	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
206	                tn = Telnet(host=self.host, port=self.port, timeout=self.timeout // 2)
207	                tn.close()
208	                # if connect server succeed, raise the exception that namespace not found

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	        # trans the config map to md5 string, and check it's been updated or not
236	        if self._hash.get(namespace) != release_key:
237	            # if it's updated, update the local cache file

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
245	                new_string = json.dumps(data)
246	                f.write(new_string)
247	            self._hash[namespace] = release_key

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	        try:
273	            r = self._http_get(url)
274	            if r.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	                data = r.json()
276	                self._cache[namespace] = json.loads(data.get("configurations", "{}"))
277	                logging.getLogger(__name__).info(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
283	                self._update_local_cache(
284	                    data.get("releaseKey", str(time.time())),
285	                    data.get("configurations", {}),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	                    data.get("releaseKey", str(time.time())),
285	                    data.get("configurations", {}),
286	                    namespace,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/pyapollo/apollo_client.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
323	                with open(file_path) as f:
324	                    self._cache[namespace] = json.loads(f.read())["configurations"]
325	        return True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/apollo-client3/apollo-client3-1.0.1/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    license="MIT",  # 许可证类型  
16	    url="https://pypi.org/project/apollo-client3/",  # 项目主页或GitHub仓库地址  
17	    classifiers=[  # 包的分类信息  

--------------------------------------------------

Code scanned:
	Total lines of code: 324
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 1.0
Files skipped (0):
