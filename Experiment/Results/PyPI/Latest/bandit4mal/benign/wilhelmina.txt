Run started:2025-05-25 15:51:42.697310

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/client.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
261	
262	        response = await self._authenticated_request("{user_id}/messages/list")
263	        data = await response.json()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/client.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
318	
319	        response = await self._authenticated_request(url, params={"format": "json"})
320	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/conftest.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    """Create an authenticated client instance."""
29	    client = WilmaClient("https://test.inschool.fi", debug=False)
30	    client.user_id = "!12345"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    # Test with default parameters (no session provided)
21	    client = WilmaClient("https://test.inschool.fi", debug=True, headless=False)
22	    assert client.base_url == "https://test.inschool.fi"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    client = WilmaClient("https://test.inschool.fi", debug=True, headless=False)
22	    assert client.base_url == "https://test.inschool.fi"
23	    assert client.debug is True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    existing_session = aiohttp.ClientSession()
39	    client_with_session = WilmaClient("https://test.inschool.fi", session=existing_session)
40	    assert client_with_session.session is existing_session

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    # We need to use a real session for this test
55	    async with WilmaClient("https://test.inschool.fi") as client:
56	        assert isinstance(client.session, aiohttp.ClientSession)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    # Initialize client
72	    client = WilmaClient("https://test.inschool.fi")
73	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    # Create client with patched session
91	    client = WilmaClient("https://test.inschool.fi", debug=False)
92	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	    login_resp.cookies.get = MagicMock(return_value=sid_cookie)
112	    login_resp.headers = {"Location": "https://test.inschool.fi/!12345?checkcookie"}
113	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	    # Verify requests
132	    client.session.get.assert_called_once_with("https://test.inschool.fi/token")
133	    client.session.post.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	    client.session.post.assert_called_once_with(
134	        "https://test.inschool.fi/login",
135	        data={"Login": "testuser", "Password": "testpass", "SESSIONID": "test_login_id"},
136	        allow_redirects=False,
137	    )
138	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	    """Test login failure."""
143	    client = WilmaClient("https://test.inschool.fi", debug=False)
144	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	    # Test login with token failure
180	    client = WilmaClient("https://test.inschool.fi")
181	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
223	    """Test various error conditions during login."""
224	    client = WilmaClient("https://test.inschool.fi")
225	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
279	    # Create client with debug=True
280	    WilmaClient("https://test.inschool.fi", debug=True)
281	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
287	    # Create client with debug=False
288	    WilmaClient("https://test.inschool.fi", debug=False)
289	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	    # Initialize client
303	    client = WilmaClient("https://test.inschool.fi")
304	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
322	        # Call the method
323	        await client._authenticated_request("path/to/resource")
324	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
326	        mock_session.get.assert_called_with(
327	            "https://test.inschool.fi/path/to/resource", headers={"Wilma2SID": "test_sid"}
328	        )
329	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
331	        mock_session.get.reset_mock()
332	        await client._authenticated_request("{user_id}/messages")
333	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
335	        mock_session.get.assert_called_with(
336	            "https://test.inschool.fi/!12345/messages", headers={"Wilma2SID": "test_sid"}
337	        )
338	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
341	        params = {"format": "json", "id": 123}
342	        await client._authenticated_request("{user_id}/messages", params=params)
343	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
344	        mock_session.get.assert_called_with(
345	            "https://test.inschool.fi/!12345/messages",
346	            headers={"Wilma2SID": "test_sid"},
347	            params=params,
348	        )
349	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
352	        data = {"key": "value"}
353	        await client._authenticated_request("{user_id}/messages", method="POST", data=data)
354	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
355	        mock_session.post.assert_called_with(
356	            "https://test.inschool.fi/!12345/messages", headers={"Wilma2SID": "test_sid"}, data=data
357	        )
358	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
362	    """Test HTTP error handling in authenticated request."""
363	    client = WilmaClient("https://test.inschool.fi")
364	    client.user_id = "!12345"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
378	        with pytest.raises(WilmaError) as exc_info:
379	            await client._authenticated_request("path/to/resource")
380	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_client.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
601	    """Test handling of invalid message content."""
602	    client = WilmaClient("https://test.inschool.fi")
603	    client.user_id = "!12345"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_error_handling.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    """Test that methods requiring authentication raise errors when not authenticated."""
14	    client = WilmaClient("https://test.inschool.fi")
15	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_unread_messages.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    # Initialize client
16	    client = WilmaClient("https://test.inschool.fi")
17	    client.user_id = "!12345"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_unread_messages.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	    mock_context.new_page.assert_called_once()
83	    mock_page.goto.assert_called_once_with("https://test.inschool.fi/!12345/messages")
84	    mock_page.wait_for_selector.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_unread_messages.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	    # Initialize client
97	    client = WilmaClient("https://test.inschool.fi")
98	    client.user_id = "!12345"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_unread_messages.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	    # Initialize client
131	    client = WilmaClient("https://test.inschool.fi")
132	    client.user_id = "!12345"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_unread_messages.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	    # Initialize client
146	    client = WilmaClient("https://test.inschool.fi")
147	    client.user_id = "!12345"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_utils.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    # Test with links
13	    html = "<p>Check out <a href='https://example.com'>this link</a></p>"
14	    assert html_to_markdown(html) == "Check out [this link](<https://example.com>)"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/wilhelmina/wilhelmina-0.1.0/wilhelmina/tests/test_utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    html = "<p>Check out <a href='https://example.com'>this link</a></p>"
14	    assert html_to_markdown(html) == "Check out [this link](<https://example.com>)"
15	

--------------------------------------------------

Code scanned:
	Total lines of code: 1305
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 0.0
Files skipped (0):
