Run started:2025-05-25 15:55:06.815910

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/admin.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
164	    port = int(os.environ.get('CDC_GATEWAY_ADMIN_PORT', config.get('admin', {}).get('port', 8085)))
165	    app.run(host='0.0.0.0', port=port, debug=False)
166	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/app.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
190	    port = int(os.environ.get('CDC_GATEWAY_PORT', config.get('api', {}).get('port', 8084)))
191	    app.run(host='0.0.0.0', port=port, debug=False)
192	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	        self.config = config
18	        self.rest_port = config.get('restPort', 8081)
19	        # תיקון הנתיב הבסיסי ל-REST API - שינוי /v1 ל-/

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
31	        try:
32	            response = requests.request(method, url, timeout=timeout, **kwargs)
33	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
40	        """Get all jobs"""
41	        return self._make_request('GET', '/jobs')
42	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
44	        """Get details for a specific job"""
45	        return self._make_request('GET', f'/jobs/{job_id}')
46	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
48	        """Get status of a job"""
49	        response = self._make_request('GET', f'/jobs/{job_id}')
50	        return response.get('state', 'UNKNOWN')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	        response = self._make_request('GET', f'/jobs/{job_id}')
50	        return response.get('state', 'UNKNOWN')
51	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	            # Cancel with savepoint
56	            data = {"targetDirectory": self.config.get('savepointDir', "s3://flink-savepoints/")}
57	            response = self._make_request('POST', f'/jobs/{job_id}/stop', json=data)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
56	            data = {"targetDirectory": self.config.get('savepointDir', "s3://flink-savepoints/")}
57	            response = self._make_request('POST', f'/jobs/{job_id}/stop', json=data)
58	            logger.info(f"Cancelled job {job_id} with savepoint at {response.get('location')}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	            response = self._make_request('POST', f'/jobs/{job_id}/stop', json=data)
58	            logger.info(f"Cancelled job {job_id} with savepoint at {response.get('location')}")
59	            return response

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
61	            # Cancel without savepoint
62	            response = self._make_request('DELETE', f'/jobs/{job_id}')
63	            logger.info(f"Cancelled job {job_id} without savepoint")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
78	            session_data = {"sessionName": job_name}
79	            session_response = self._make_request('POST', '/v1/sessions', json=session_data)
80	            session_handle = session_response.get('session_handle')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	            session_response = self._make_request('POST', '/v1/sessions', json=session_data)
80	            session_handle = session_response.get('session_handle')
81	            logger.info(f"Created SQL session with handle: {session_handle}")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
86	                execute_data = {"statement": sql}
87	                operation_response = self._make_request(
88	                    'POST', 
89	                    f'/v1/sessions/{session_handle}/statements',
90	                    json=execute_data
91	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	                )
92	                operation_handle = operation_response.get('operation_handle')
93	                

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
98	            final_operation_handle = operation_handle
99	            status_response = self._make_request(
100	                'GET',
101	                f'/v1/sessions/{session_handle}/operations/{final_operation_handle}/status'
102	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	            # Extract job ID from result
105	            if status_response.get('status') == 'RUNNING':
106	                # This is a bit of a hack - in a real implementation we would extract the job ID properly

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	                jobs = self.get_jobs()
109	                running_jobs = jobs.get('jobs', [])
110	                # Find the most recently started job

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	                    latest_job = sorted(
114	                        [job for job in running_jobs if job.get('status') == 'RUNNING'],
115	                        key=lambda j: j.get('start-time', 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	                        [job for job in running_jobs if job.get('status') == 'RUNNING'],
115	                        key=lambda j: j.get('start-time', 0),
116	                        reverse=True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	                    if latest_job:
119	                        job_id = latest_job[0].get('id')
120	                        logger.info(f"Deployed job {job_name} with job ID: {job_id}")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
128	                if session_handle:
129	                    self._make_request('DELETE', f'/v1/sessions/{session_handle}')
130	            except:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
138	            try:
139	                status_response = self._make_request(
140	                    'GET',
141	                    f'/v1/sessions/{session_handle}/operations/{operation_handle}/status'
142	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	                
144	                status = status_response.get('status')
145	                

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/flink_client.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	                    if status == 'ERROR':
148	                        error = status_response.get('error', 'Unknown error')
149	                        raise ValueError(f"SQL operation failed: {error}")

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/monitor.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
27	    # Register signal handlers
28	    signal.signal(signal.SIGINT, signal_handler)
29	    signal.signal(signal.SIGTERM, signal_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/monitor.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
27	    # Register signal handlers
28	    signal.signal(signal.SIGINT, signal_handler)
29	    signal.signal(signal.SIGTERM, signal_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/monitor.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
28	    signal.signal(signal.SIGINT, signal_handler)
29	    signal.signal(signal.SIGTERM, signal_handler)
30	    

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/cdc_gateway/monitor.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
28	    signal.signal(signal.SIGINT, signal_handler)
29	    signal.signal(signal.SIGTERM, signal_handler)
30	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	with open("README.md", "r", encoding="utf-8") as fh:
15	    long_description = fh.read()
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/setup.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    long_description_content_type="text/markdown",
40	    url="https://github.com/mosiko1234/flink-cdc-gateway",
41	    packages=find_packages(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/tests/test_flink_client.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	            'GET', 
32	            'http://localhost:8081/jobs', 
33	            timeout=30
34	        )
35	    
36	    @patch('cdc_gateway.flink_client.requests.request')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/tests/test_flink_client.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	            'GET', 
53	            'http://localhost:8081/jobs/job-1', 
54	            timeout=30
55	        )
56	    
57	    @patch('cdc_gateway.flink_client.requests.request')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/tests/test_flink_client.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	            'POST', 
74	            'http://localhost:8081/jobs/job-1/stop', 
75	            json={"targetDirectory": "s3://test-bucket/savepoints"},
76	            timeout=30
77	        )
78	    
79	    @patch('cdc_gateway.flink_client.requests.request')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/tests/test_flink_client.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	            'DELETE', 
96	            'http://localhost:8081/jobs/job-1', 
97	            timeout=30
98	        )
99	    
100	    @patch('cdc_gateway.flink_client.requests.request')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/flink-cdc-gateway/flink_cdc_gateway-1.0.2/tests/test_pipeline_manager.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
17	        # Clean up after tests
18	        shutil.rmtree(temp_dir)
19	

--------------------------------------------------

Code scanned:
	Total lines of code: 1187
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 2.0
Files skipped (0):
