Run started:2025-05-25 16:08:22.296610

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	# Define long description directly
14	long_description = """
15	# bsky2llm
16	
17	A Python module for analyzing Bluesky posts and threads using AI models.
18	
19	## Installation
20	
21	```bash
22	pip install bsky2llm
23	```
24	
25	## Usage
26	
27	```python
28	from bsky2llm import process_post
29	
30	# Process a Bluesky post and get AI analysis
31	result = process_post("at://did:plc:12345/app.bsky.feed.post/12345")
32	print(result)
33	```
34	
35	See GitHub repository for more details: https://github.com/circularmachines/bsky2llm
36	"""
37	
38	setup(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/setup.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    author_email="laagrrluv@gmail.com",  # Replace with your actual email
44	    url="https://github.com/circularmachines/bsky2llm",
45	    packages=find_packages(where="src"),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/ai_api_call.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
203	                with open(output_file, 'w') as f:
204	                    f.write(response)
205	                logger.info(f"Response saved to {output_file}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    
35	    api_url = "https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread"
36	    params = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	    try:
42	        response = requests.get(api_url, params=params, timeout=10)
43	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	        # Check if this post is a reply and has a root
47	        thread = data.get("thread", {})
48	        if not isinstance(thread, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	            
52	        post = thread.get("post", {})
53	        if not isinstance(post, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	            
57	        record = post.get("record", {})
58	        if not isinstance(record, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	        # Check for root in reply field
63	        reply = record.get("reply", {})
64	        if isinstance(reply, dict) and "root" in reply and isinstance(reply["root"], dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	        if isinstance(reply, dict) and "root" in reply and isinstance(reply["root"], dict):
65	            root_uri = reply["root"].get("uri")
66	            if root_uri:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	    # Now fetch the thread for the target URI
105	    api_url = "https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread"
106	    params = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	        logging.debug(f"Making API request to: {api_url} with params: {params}")
113	        response = requests.get(api_url, params=params, timeout=10)
114	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	            # Get the actual post URI of what we fetched (may be root or original)
153	            thread_post_uri = raw_thread_data.get("thread", {}).get("post", {}).get("uri", "")
154	            if thread_post_uri:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	            # Get the actual post URI of what we fetched (may be root or original)
153	            thread_post_uri = raw_thread_data.get("thread", {}).get("post", {}).get("uri", "")
154	            if thread_post_uri:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/get_raw_thread.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	            # Get the actual post URI of what we fetched (may be root or original)
153	            thread_post_uri = raw_thread_data.get("thread", {}).get("post", {}).get("uri", "")
154	            if thread_post_uri:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/markdown_creator.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
370	        with open(output_file, 'w', encoding='utf-8') as f:
371	            f.write(markdown)
372	        print(f"\nMarkdown saved to: {output_file}")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/md_to_openai.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	        with open(image_path, "rb") as image_file:
36	            return base64.b64encode(image_file.read()).decode("utf-8")
37	    except Exception as e:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/md_to_openai.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
35	        with open(image_path, "rb") as image_file:
36	            return base64.b64encode(image_file.read()).decode("utf-8")
37	    except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/md_to_openai.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	        with open(image_path, "rb") as image_file:
36	            return base64.b64encode(image_file.read()).decode("utf-8")
37	    except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	    logging.info(f"Fetching raw thread data for: {post_uri}")
103	    raw_thread_data = get_raw_thread(post_uri, get_root=get_root, debug=debug)
104	    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	        with open(md_path, 'w', encoding='utf-8') as f:
157	            f.write(markdown)
158	        logging.info(f"Markdown saved to: {md_path}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
207	        with open(response_path, 'w', encoding='utf-8') as f:
208	            f.write(response)
209	        logging.info(f"AI response saved to: {response_path}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	    # Example post URL (instead of URI)
222	    post_url = "https://bsky.app/profile/atproto.com/post/3jwgckq72jp2d"
223	    
224	    # Process post with AI response
225	    print(f"\nProcessing post: {post_url}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
246	                with open(md_path, 'r', encoding='utf-8') as f:
247	                    content = f.read()
248	                    preview_length = min(300, len(content))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
263	                with open(result, 'r', encoding='utf-8') as f:
264	                    content = f.read()
265	                    preview_length = min(300, len(content))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	    try:
43	        response = requests.get(f'https://bsky.social/xrpc/com.atproto.identity.resolveHandle?handle={handle}')
44	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    try:
43	        response = requests.get(f'https://bsky.social/xrpc/com.atproto.identity.resolveHandle?handle={handle}')
44	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    # Check first in the embed view (processed data)
75	    embed_view = safe_get(post_data, 'embed')
76	    if isinstance(embed_view, dict) and embed_view.get('$type', '').endswith('images#view'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	    embed_view = safe_get(post_data, 'embed')
76	    if isinstance(embed_view, dict) and embed_view.get('$type', '').endswith('images#view'):
77	        image_list = embed_view.get('images', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	    if isinstance(embed_view, dict) and embed_view.get('$type', '').endswith('images#view'):
77	        image_list = embed_view.get('images', [])
78	        if isinstance(image_list, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	                    image_data = {
82	                        'fullsize': img.get('fullsize', ''),
83	                        'thumb': img.get('thumb', ''),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	                        'fullsize': img.get('fullsize', ''),
83	                        'thumb': img.get('thumb', ''),
84	                        'alt': img.get('alt', ''),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	                        'thumb': img.get('thumb', ''),
84	                        'alt': img.get('alt', ''),
85	                        'aspectRatio': img.get('aspectRatio', {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	                        'alt': img.get('alt', ''),
85	                        'aspectRatio': img.get('aspectRatio', {})
86	                    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	    if not images:
91	        embed_record = safe_get(post_data, 'record', 'embed')
92	        if isinstance(embed_record, dict) and embed_record.get('$type', '').endswith('images'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	        embed_record = safe_get(post_data, 'record', 'embed')
92	        if isinstance(embed_record, dict) and embed_record.get('$type', '').endswith('images'):
93	            image_list = embed_record.get('images', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	        if isinstance(embed_record, dict) and embed_record.get('$type', '').endswith('images'):
93	            image_list = embed_record.get('images', [])
94	            if isinstance(image_list, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	                        image_data = {
100	                            'blob_cid': safe_get(img, 'image', 'ref', '$link'),
101	                            'alt': img.get('alt', ''),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	                            'blob_cid': safe_get(img, 'image', 'ref', '$link'),
101	                            'alt': img.get('alt', ''),
102	                            'aspectRatio': img.get('aspectRatio', {}),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	                            'alt': img.get('alt', ''),
102	                            'aspectRatio': img.get('aspectRatio', {}),
103	                            'mimeType': safe_get(img, 'image', 'mimeType')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	                            'aspectRatio': img.get('aspectRatio', {}),
103	                            'mimeType': safe_get(img, 'image', 'mimeType')
104	                        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	                        # We need to construct full URLs for blobs
107	                        if image_data['blob_cid'] and safe_get(post_data, 'author', 'did'):
108	                            did = safe_get(post_data, 'author', 'did')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	                        if image_data['blob_cid'] and safe_get(post_data, 'author', 'did'):
108	                            did = safe_get(post_data, 'author', 'did')
109	                            image_data['fullsize'] = f"https://cdn.bsky.app/img/feed_fullsize/plain/{did}/{image_data['blob_cid']}@{image_data['mimeType'].split('/')[1]}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	                            did = safe_get(post_data, 'author', 'did')
109	                            image_data['fullsize'] = f"https://cdn.bsky.app/img/feed_fullsize/plain/{did}/{image_data['blob_cid']}@{image_data['mimeType'].split('/')[1]}"
110	                            image_data['thumb'] = f"https://cdn.bsky.app/img/feed_thumbnail/plain/{did}/{image_data['blob_cid']}@{image_data['mimeType'].split('/')[1]}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	                            image_data['fullsize'] = f"https://cdn.bsky.app/img/feed_fullsize/plain/{did}/{image_data['blob_cid']}@{image_data['mimeType'].split('/')[1]}"
110	                            image_data['thumb'] = f"https://cdn.bsky.app/img/feed_thumbnail/plain/{did}/{image_data['blob_cid']}@{image_data['mimeType'].split('/')[1]}"
111	                        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	    for i, img in enumerate(images):
117	        logger.debug(f"Image {i+1}: fullsize={img.get('fullsize', 'N/A')}, alt={img.get('alt', 'N/A')}")
118	    

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	    for i, img in enumerate(images):
117	        logger.debug(f"Image {i+1}: fullsize={img.get('fullsize', 'N/A')}, alt={img.get('alt', 'N/A')}")
118	    

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	    try:
135	        response = requests.get(image_url)
136	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	        # Check if we got an image
139	        content_type = response.headers.get('Content-Type', '')
140	        if 'image/' not in content_type:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
145	        with open(output_path, 'wb') as f:
146	            f.write(response.content)
147	            

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	    
192	    if result.get("error"):
193	        logger.warning(f"Image processing failed: {result['error']}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	    # Include each downloaded image in the markdown
199	    for i, image_info in enumerate(result.get("images", [])):
200	        local_path = image_info.get("local_path")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
199	    for i, image_info in enumerate(result.get("images", [])):
200	        local_path = image_info.get("local_path")
201	        alt_text = image_info.get("alt_text", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	        local_path = image_info.get("local_path")
201	        alt_text = image_info.get("alt_text", "")
202	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	            # Get the URL to download (prefer fullsize)
255	            image_url = image_data.get('fullsize') or image_data.get('thumb')
256	            

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	            # Get the URL to download (prefer fullsize)
255	            image_url = image_data.get('fullsize') or image_data.get('thumb')
256	            

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	                "url": image_url,
274	                "alt_text": image_data.get('alt', ''),
275	                "local_path": local_path if success else None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	                "local_path": local_path if success else None,
276	                "aspectRatio": image_data.get('aspectRatio', {})
277	            })

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	            
301	            api_url = "https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread"
302	            params = {"uri": post_uri, "depth": 0}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
303	            
304	            response = requests.get(api_url, params=params)
305	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
312	                
313	            post_data = thread_data.get("thread", {}).get("post", {})
314	            logger.info(f"Loaded post data from: {example_file}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
312	                
313	            post_data = thread_data.get("thread", {}).get("post", {})
314	            logger.info(f"Loaded post data from: {example_file}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_image.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
329	                with open(md_file, 'w', encoding='utf-8') as f:
330	                    f.write(markdown)
331	                logger.info(f"\nMarkdown saved to: {md_file}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	    try:
52	        response = requests.get(f'https://bsky.social/xrpc/com.atproto.identity.resolveHandle?handle={handle}')
53	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    try:
52	        response = requests.get(f'https://bsky.social/xrpc/com.atproto.identity.resolveHandle?handle={handle}')
53	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    # Check for HLS playlist first
85	    playlist_url = safe_get(post_data, 'embed', 'playlist')
86	    if playlist_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	    # Check for blob reference
91	    blob_cid = safe_get(post_data, 'record', 'embed', 'video', 'ref', '$link') or \
92	              safe_get(post_data, 'record', 'embed', 'video', 'ref', 'link')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	    blob_cid = safe_get(post_data, 'record', 'embed', 'video', 'ref', '$link') or \
92	              safe_get(post_data, 'record', 'embed', 'video', 'ref', 'link')
93	    

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	        # Will need to get DID to download blob
96	        did = safe_get(post_data, 'author', 'did')
97	        if did:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	            logger.debug(f"Found blob reference: {blob_cid} for DID: {did}")
99	            blob_url = f"https://bsky.social/xrpc/com.atproto.sync.getBlob?did={did}&cid={blob_cid}"
100	            return blob_url, "blob", blob_cid

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	    for path in video_url_paths:
112	        url = safe_get(post_data, *path)
113	        if url and isinstance(url, str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	        streams = streamlink.streams(hls_url)
140	        best_stream = streams.get('best')
141	        

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
147	            with best_stream.open() as stream:
148	                for data in iter(lambda: stream.read(4096), b""):
149	                    f.write(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	                for data in iter(lambda: stream.read(4096), b""):
149	                    f.write(data)
150	                    

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	                for data in iter(lambda: stream.read(4096), b""):
149	                    f.write(data)
150	                    

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	    try:
223	        response = requests.get(blob_url)
224	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	        # Verify we received a video
227	        content_type = response.headers.get('Content-Type', '')
228	        if 'video' not in content_type:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
233	        with open(output_path, 'wb') as f:
234	            f.write(response.content)
235	            

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
233	        with open(output_path, 'wb') as f:
234	            f.write(response.content)
235	            

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
433	        # Get video properties
434	        fps = cap.get(cv2.CAP_PROP_FPS)
435	        frame_count = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	        fps = cap.get(cv2.CAP_PROP_FPS)
435	        frame_count = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
436	        duration = frame_count / fps if fps > 0 else 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
456	                    # Read the frame
457	                    success, frame = cap.read()
458	                    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
461	                        frame_path = os.path.join(output_dir, f"frame_{i:03d}_{middle_time:.2f}s.jpg")
462	                        cv2.imwrite(frame_path, frame)
463	                        frame_paths.append(frame_path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
461	                        frame_path = os.path.join(output_dir, f"frame_{i:03d}_{middle_time:.2f}s.jpg")
462	                        cv2.imwrite(frame_path, frame)
463	                        frame_paths.append(frame_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
491	                # Read the frame
492	                success, frame = cap.read()
493	                

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
496	                    frame_path = os.path.join(output_dir, f"frame_{i:03d}_{time_sec:.2f}s.jpg")
497	                    cv2.imwrite(frame_path, frame)
498	                    frame_paths.append(frame_path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
496	                    frame_path = os.path.join(output_dir, f"frame_{i:03d}_{time_sec:.2f}s.jpg")
497	                    cv2.imwrite(frame_path, frame)
498	                    frame_paths.append(frame_path)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
551	    
552	    if result.get("error"):
553	        logger.warning(f"Video processing failed: {result['error']}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	    # Check if we have transcript data with segments and frames
560	    if result.get("transcript_data") and result.get("transcript_data").get("segments"):
561	        segments = result.get("transcript_data").get("segments")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	    # Check if we have transcript data with segments and frames
560	    if result.get("transcript_data") and result.get("transcript_data").get("segments"):
561	        segments = result.get("transcript_data").get("segments")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	    # Check if we have transcript data with segments and frames
560	    if result.get("transcript_data") and result.get("transcript_data").get("segments"):
561	        segments = result.get("transcript_data").get("segments")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	    if result.get("transcript_data") and result.get("transcript_data").get("segments"):
561	        segments = result.get("transcript_data").get("segments")
562	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	    if result.get("transcript_data") and result.get("transcript_data").get("segments"):
561	        segments = result.get("transcript_data").get("segments")
562	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
564	        for i, segment in enumerate(segments):
565	            if segment.get("text"):
566	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
567	                # Add timestamps if available
568	                if segment.get("start") is not None and segment.get("end") is not None:
569	                    start_time = segment.get("start")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
567	                # Add timestamps if available
568	                if segment.get("start") is not None and segment.get("end") is not None:
569	                    start_time = segment.get("start")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	                if segment.get("start") is not None and segment.get("end") is not None:
569	                    start_time = segment.get("start")
570	                    end_time = segment.get("end")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	                    start_time = segment.get("start")
570	                    end_time = segment.get("end")
571	                    timestamp = f"[{start_time:.2f}s - {end_time:.2f}s]"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	                # Add segment text
575	                markdown_lines.append(f"{segment.get('text')}\n")
576	                

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
579	                # Add frames for this segment if available
580	                if segment.get("frames"):
581	                    for frame_info in segment.get("frames"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
580	                if segment.get("frames"):
581	                    for frame_info in segment.get("frames"):
582	                        frame_path = frame_info.get("path")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
581	                    for frame_info in segment.get("frames"):
582	                        frame_path = frame_info.get("path")
583	                        if frame_path:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
584	                            frame_filename = os.path.basename(frame_path)
585	                            markdown_lines.append(f"![Frame at {frame_info.get('time', 0):.2f}s](media/frames/{frame_filename})\n") #ToDo proper path for frames
586	                

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
588	    # If we don't have segment-specific frames, fall back to showing all frames then transcript
589	    elif result.get("frames") or result.get("transcript"):
590	        if result.get("frames"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
588	    # If we don't have segment-specific frames, fall back to showing all frames then transcript
589	    elif result.get("frames") or result.get("transcript"):
590	        if result.get("frames"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
589	    elif result.get("frames") or result.get("transcript"):
590	        if result.get("frames"):
591	            frames = result["frames"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
597	        
598	        if result.get("transcript"):
599	            markdown_lines.append("**Transcription:**\n")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
679	                result["transcript_data"] = transcript_data
680	                result["transcript"] = transcript_data.get("text", "")
681	                

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
712	            
713	            api_url = "https://public.api.bsky.app/xrpc/app.bsky.feed.getPostThread"
714	            params = {"uri": post_uri, "depth": 0}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
715	            
716	            response = requests.get(api_url, params=params)
717	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
724	                
725	            post_data = thread_data.get("thread", {}).get("post", {})
726	            logger.info(f"Loaded post data from: {example_file}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
724	                
725	            post_data = thread_data.get("thread", {}).get("post", {})
726	            logger.info(f"Loaded post data from: {example_file}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
742	                with open(md_file, 'w', encoding='utf-8') as f:
743	                    f.write(markdown)
744	                logger.info(f"\nMarkdown saved to: {md_file}")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/process_video.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
742	                with open(md_file, 'w', encoding='utf-8') as f:
743	                    f.write(markdown)
744	                logger.info(f"\nMarkdown saved to: {md_file}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/url_converter.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	    try:
32	        response = requests.get(f'https://public.api.bsky.app/xrpc/com.atproto.identity.resolveHandle?handle={handle}')
33	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/url_converter.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    try:
32	        response = requests.get(f'https://public.api.bsky.app/xrpc/com.atproto.identity.resolveHandle?handle={handle}')
33	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/url_converter.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	        response.raise_for_status()
34	        return response.json().get('did')
35	    except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/bsky2llm/bsky2llm-0.1.0/src/bsky2llm/url_converter.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	    # Example URL
89	    url="https://bsky.app/profile/bsky.app/post/3l6oveex3ii2l"
90	    
91	    # Convert URL to URI
92	    print(f"\nConverting URL to URI:")

--------------------------------------------------

Code scanned:
	Total lines of code: 1863
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 103.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 117.0
		High: 1.0
Files skipped (0):
