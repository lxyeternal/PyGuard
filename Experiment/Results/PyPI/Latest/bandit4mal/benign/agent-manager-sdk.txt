Run started:2025-05-25 16:14:09.094071

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/app.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
60	    
61	    flask_app.run(host='0.0.0.0', port=5000, debug=True)
62	    

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	print(jina_api_key)
26	API_URL = "https://api-inference.huggingface.co/pipeline/feature-extraction/sentence-transformers/all-MiniLM-L6-v2"
27	
28	
29	def encode_queries(terms):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
39	        
40	        response = requests.post(API_URL, headers=headers, json=payload)
41	        response = response.json()[0]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
134	            }
135	            test = session.post('http://localhost:5000/miniapps/michael_scott_package_manager', json=data)
136	            print(test.json())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	            }
135	            test = session.post('http://localhost:5000/miniapps/michael_scott_package_manager', json=data)
136	            print(test.json())

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
164	        with requests.session() as s:
165	            r = s.post('http://localhost:5000/miniapps/workflow', json=data)
166	        print(r.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	        with requests.session() as s:
165	            r = s.post('http://localhost:5000/miniapps/workflow', json=data)
166	        print(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	        
168	        return {'workflow_id': r.json().get('workflow_id'),
169	                'workflow': data,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	                'workflow': data,
170	                'inputs': data.get('graph').get('nodes')[0].get('data').get('variables')}
171	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	                'workflow': data,
170	                'inputs': data.get('graph').get('nodes')[0].get('data').get('variables')}
171	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	                'workflow': data,
170	                'inputs': data.get('graph').get('nodes')[0].get('data').get('variables')}
171	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	                'workflow': data,
170	                'inputs': data.get('graph').get('nodes')[0].get('data').get('variables')}
171	        

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	    # Azure OpenAI setup
184	    api_base = "https://nextpy-gpt4.openai.azure.com/"
185	    # api_key = "*"  # Replace with your OpenAI API key
186	    deployment_id = "gpt-omni"  # Add your deployment ID here

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	    # Azure AI Search setup
190	    search_endpoint = "https://agentpackagesearch783656841527.search.windows.net"  # Add your Azure AI Search endpoint here
191	    # search_key = "*"  # Replace with your Azure AI Search admin key
192	    search_index_name = "subagent-vector-1720327816935"  # Add your Azure AI Search index name here

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/controllers/console/app/search.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
249	    # Send the POST request
250	    response = requests.post(
251	        f"{api_base}openai/deployments/{deployment_id}/extensions/chat/completions?api-version={api_version}",
252	        headers=headers,
253	        data=json.dumps(data)
254	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/file/upload_file_parser.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
34	
35	            encoded_string = base64.b64encode(data).decode('utf-8')
36	            return f'data:{upload_file.mime_type};base64,{encoded_string}'

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/file/upload_file_parser.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
34	
35	            encoded_string = base64.b64encode(data).decode('utf-8')
36	            return f'data:{upload_file.mime_type};base64,{encoded_string}'

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/file/upload_file_parser.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
53	        sign = hmac.new(secret_key, data_to_sign.encode(), hashlib.sha256).digest()
54	        encoded_sign = base64.urlsafe_b64encode(sign).decode()
55	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/file/upload_file_parser.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
71	        recalculated_sign = hmac.new(secret_key, data_to_sign.encode(), hashlib.sha256).digest()
72	        recalculated_encoded_sign = base64.urlsafe_b64encode(recalculated_sign).decode()
73	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/helper/code_executor/template_transformer.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
67	        inputs_json_str = json.dumps(inputs, ensure_ascii=False).encode()
68	        input_base64_encoded = b64encode(inputs_json_str).decode('utf-8')
69	        return input_base64_encoded

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/helper/code_executor/template_transformer.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
67	        inputs_json_str = json.dumps(inputs, ensure_ascii=False).encode()
68	        input_base64_encoded = b64encode(inputs_json_str).decode('utf-8')
69	        return input_base64_encoded

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/helper/ssrf_proxy.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	def get(url, *args, **kwargs):
29	    return _get(url=url, *args, proxies=httpx_proxies, **kwargs)
30	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/helper/ssrf_proxy.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
31	def post(url, *args, **kwargs):
32	    return _post(url=url, *args, proxies=httpx_proxies, **kwargs)
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/__base/tts_model.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	            else:
149	                raise InvokeBadRequestError("ffmpeg is not installed, "
150	                                            "details: https://docs.dify.ai/getting-started/install-self-hosted"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/__base/tts_model.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	        except Exception:
153	            raise InvokeBadRequestError("ffmpeg is not installed, "
154	                                        "details: https://docs.dify.ai/getting-started/install-self-hosted"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
148	        """
149	        if model_parameters.get('response_format'):
150	            stop = stop or []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
334	                    if isinstance(content_block, dict):
335	                        if content_block.get('type') == 'tool_use':
336	                            tool_call = AssistantPromptMessage.ToolCall(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
336	                            tool_call = AssistantPromptMessage.ToolCall(
337	                                id=content_block.get('id'),
338	                                type='function',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	                                function=AssistantPromptMessage.ToolCall.ToolCallFunction(
340	                                    name=content_block.get('name'),
341	                                    arguments=''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	                    if isinstance(delta, dict) and len(tool_calls) > 0:
348	                        if delta.get('type') == 'input_json_delta':
349	                            tool_calls[-1].function.arguments += delta.get('partial_json', '')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
348	                        if delta.get('type') == 'input_json_delta':
349	                            tool_calls[-1].function.arguments += delta.get('partial_json', '')
350	                elif chunk.message:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
410	
411	        if credentials.get('anthropic_api_url'):
412	            credentials['anthropic_api_url'] = credentials['anthropic_api_url'].rstrip('/')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	                                    try:
456	                                        image_content = requests.get(message_content.data).content
457	                                        mime_type, _ = mimetypes.guess_type(message_content.data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
457	                                        mime_type, _ = mimetypes.guess_type(message_content.data)
458	                                        base64_data = base64.b64encode(image_content).decode('utf-8')
459	                                    except Exception as ex:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/anthropic/llm/llm.py:458
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
457	                                        mime_type, _ = mimetypes.guess_type(message_content.data)
458	                                        base64_data = base64.b64encode(image_content).decode('utf-8')
459	                                    except Exception as ex:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/azure_openai/llm/llm.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
568	            raise NotImplementedError(
569	                f"get_num_tokens_from_messages() is not presently implemented "
570	                f"for model {model}."
571	                "See https://github.com/openai/openai-python/blob/main/chatml.md for "

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/azure_openai/text_embedding/text_embedding.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
160	            # decode base64 embedding
161	            return ([list(np.frombuffer(base64.b64decode(data.embedding), dtype="float32")) for data in response.data],
162	                    response.usage.total_tokens)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/azure_openai/text_embedding/text_embedding.py:161
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
160	            # decode base64 embedding
161	            return ([list(np.frombuffer(base64.b64decode(data.embedding), dtype="float32")) for data in response.data],
162	                    response.usage.total_tokens)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/azure_openai/tts/tts.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
88	            # Create a thread pool and map the function to the list of sentences
89	            with concurrent.futures.ThreadPoolExecutor(max_workers=max_workers) as executor:
90	                futures = [executor.submit(self._process_sentence, sentence=sentence, model=model, voice=voice,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/baichuan/llm/baichuan_turbo.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	        resp = response.json()
61	        choices = resp.get('choices', [])
62	        message = BaichuanMessage(content='', role='assistant')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/baichuan/llm/baichuan_turbo.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	                    return
91	            choices = data.get('choices', [])
92	            # save stop reason temporarily

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/baichuan/llm/baichuan_turbo.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	            for choice in choices:
95	                if choice.get('finish_reason'):
96	                    stop_reason = choice['finish_reason']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/baichuan/llm/baichuan_turbo.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	                or model == 'baichuan3-turbo' or model == 'baichuan3-turbo-128k'  or model == 'baichuan4'):
170	            api_base = 'https://api.baichuan-ai.com/v1/chat/completions'
171	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/baichuan/llm/baichuan_turbo.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
180	        try:
181	            response = post(
182	                url=api_base,
183	                headers=headers,
184	                data=dumps(data),
185	                timeout=timeout,
186	                stream=stream
187	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/baichuan/text_embedding/text_embedding.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    """
34	    api_base: str = 'http://api.baichuan-ai.com/v1/embeddings'
35	
36	    def _invoke(self, model: str, credentials: dict,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/baichuan/text_embedding/text_embedding.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
108	        try:
109	            response = post(url, headers=headers, data=dumps(data))
110	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
324	                            try:
325	                                image_content = requests.get(message_content.data).content
326	                                mime_type, _ = mimetypes.guess_type(message_content.data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
326	                                mime_type, _ = mimetypes.guess_type(message_content.data)
327	                                base64_data = base64.b64encode(image_content).decode('utf-8')
328	                            except Exception as ex:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:327
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
326	                                mime_type, _ = mimetypes.guess_type(message_content.data)
327	                                base64_data = base64.b64encode(image_content).decode('utf-8')
328	                            except Exception as ex:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
509	        elif model_prefix == "ai21":
510	            payload["temperature"] = model_parameters.get("temperature")
511	            payload["topP"] = model_parameters.get("topP")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
510	            payload["temperature"] = model_parameters.get("temperature")
511	            payload["topP"] = model_parameters.get("topP")
512	            payload["maxTokens"] = model_parameters.get("maxTokens")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
511	            payload["topP"] = model_parameters.get("topP")
512	            payload["maxTokens"] = model_parameters.get("maxTokens")
513	            payload["prompt"] = self._convert_messages_to_prompt(prompt_messages, model_prefix)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	
515	            if model_parameters.get("presencePenalty"):
516	                payload["presencePenalty"] = {model_parameters.get("presencePenalty")}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
515	            if model_parameters.get("presencePenalty"):
516	                payload["presencePenalty"] = {model_parameters.get("presencePenalty")}
517	            if model_parameters.get("frequencyPenalty"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
516	                payload["presencePenalty"] = {model_parameters.get("presencePenalty")}
517	            if model_parameters.get("frequencyPenalty"):
518	                payload["frequencyPenalty"] = {model_parameters.get("frequencyPenalty")}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	            if model_parameters.get("frequencyPenalty"):
518	                payload["frequencyPenalty"] = {model_parameters.get("frequencyPenalty")}
519	            if model_parameters.get("countPenalty"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	                payload["frequencyPenalty"] = {model_parameters.get("frequencyPenalty")}
519	            if model_parameters.get("countPenalty"):
520	                payload["countPenalty"] = {model_parameters.get("countPenalty")}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	            if model_parameters.get("countPenalty"):
520	                payload["countPenalty"] = {model_parameters.get("countPenalty")}
521	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
522	        elif model_prefix == "mistral":
523	            payload["temperature"] = model_parameters.get("temperature")
524	            payload["top_p"] = model_parameters.get("top_p")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
523	            payload["temperature"] = model_parameters.get("temperature")
524	            payload["top_p"] = model_parameters.get("top_p")
525	            payload["max_tokens"] = model_parameters.get("max_tokens")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
524	            payload["top_p"] = model_parameters.get("top_p")
525	            payload["max_tokens"] = model_parameters.get("max_tokens")
526	            payload["prompt"] = self._convert_messages_to_prompt(prompt_messages, model_prefix)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
622	        """
623	        response_body = json.loads(response.get('body').read().decode('utf-8'))
624	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
624	
625	        finish_reason = response_body.get("error")
626	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
633	        if model_prefix == "amazon":
634	            output = response_body.get("results")[0].get("outputText").strip('\n')
635	            prompt_tokens = response_body.get("inputTextTokenCount")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
633	        if model_prefix == "amazon":
634	            output = response_body.get("results")[0].get("outputText").strip('\n')
635	            prompt_tokens = response_body.get("inputTextTokenCount")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
634	            output = response_body.get("results")[0].get("outputText").strip('\n')
635	            prompt_tokens = response_body.get("inputTextTokenCount")
636	            completion_tokens = response_body.get("results")[0].get("tokenCount")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
635	            prompt_tokens = response_body.get("inputTextTokenCount")
636	            completion_tokens = response_body.get("results")[0].get("tokenCount")
637	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
635	            prompt_tokens = response_body.get("inputTextTokenCount")
636	            completion_tokens = response_body.get("results")[0].get("tokenCount")
637	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
638	        elif model_prefix == "ai21":
639	            output = response_body.get('completions')[0].get('data').get('text')
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
638	        elif model_prefix == "ai21":
639	            output = response_body.get('completions')[0].get('data').get('text')
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
638	        elif model_prefix == "ai21":
639	            output = response_body.get('completions')[0].get('data').get('text')
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	            output = response_body.get('completions')[0].get('data').get('text')
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
641	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	            output = response_body.get('completions')[0].get('data').get('text')
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
641	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
641	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))
642	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
641	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))
642	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
640	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
641	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))
642	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	        elif model_prefix == "anthropic":
644	            output = response_body.get("completion")
645	            prompt_tokens = self.get_num_tokens(model, credentials, prompt_messages)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
648	        elif model_prefix == "cohere":
649	            output = response_body.get("generations")[0].get("text")
650	            prompt_tokens = self.get_num_tokens(model, credentials, prompt_messages)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
648	        elif model_prefix == "cohere":
649	            output = response_body.get("generations")[0].get("text")
650	            prompt_tokens = self.get_num_tokens(model, credentials, prompt_messages)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
653	        elif model_prefix == "meta":
654	            output = response_body.get("generation").strip('\n')
655	            prompt_tokens = response_body.get("prompt_token_count")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
654	            output = response_body.get("generation").strip('\n')
655	            prompt_tokens = response_body.get("prompt_token_count")
656	            completion_tokens = response_body.get("generation_token_count")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
655	            prompt_tokens = response_body.get("prompt_token_count")
656	            completion_tokens = response_body.get("generation_token_count")
657	        

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
658	        elif model_prefix == "mistral":
659	            output = response_body.get("outputs")[0].get("text")
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
658	        elif model_prefix == "mistral":
659	            output = response_body.get("outputs")[0].get("text")
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
659	            output = response_body.get("outputs")[0].get("text")
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')
661	            completion_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-output-token-count')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
659	            output = response_body.get("outputs")[0].get("text")
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')
661	            completion_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-output-token-count')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
659	            output = response_body.get("outputs")[0].get("text")
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')
661	            completion_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-output-token-count')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')
661	            completion_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-output-token-count')
662	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')
661	            completion_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-output-token-count')
662	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
660	            prompt_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-input-token-count')
661	            completion_tokens = response.get('ResponseMetadata').get('HTTPHeaders').get('x-amzn-bedrock-output-token-count')
662	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
696	        if model_prefix == "ai21":
697	            response_body = json.loads(response.get('body').read().decode('utf-8'))
698	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
698	
699	            content = response_body.get('completions')[0].get('data').get('text')
700	            finish_reason = response_body.get('completions')[0].get('finish_reason')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
698	
699	            content = response_body.get('completions')[0].get('data').get('text')
700	            finish_reason = response_body.get('completions')[0].get('finish_reason')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
698	
699	            content = response_body.get('completions')[0].get('data').get('text')
700	            finish_reason = response_body.get('completions')[0].get('finish_reason')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
699	            content = response_body.get('completions')[0].get('data').get('text')
700	            finish_reason = response_body.get('completions')[0].get('finish_reason')
701	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
699	            content = response_body.get('completions')[0].get('data').get('text')
700	            finish_reason = response_body.get('completions')[0].get('finish_reason')
701	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
701	
702	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
703	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
701	
702	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
703	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
702	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
703	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))
704	            usage = self._calc_response_usage(model, credentials, prompt_tokens, completion_tokens)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
702	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
703	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))
704	            usage = self._calc_response_usage(model, credentials, prompt_tokens, completion_tokens)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
702	            prompt_tokens = len(response_body.get("prompt").get("tokens"))
703	            completion_tokens = len(response_body.get('completions')[0].get('data').get('tokens'))
704	            usage = self._calc_response_usage(model, credentials, prompt_tokens, completion_tokens)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
716	        
717	        stream = response.get('body')
718	        if not stream:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
722	        for event in stream:
723	            chunk = event.get('chunk')
724	            

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
729	
730	            payload = json.loads(chunk.get('bytes').decode())
731	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
733	            if model_prefix == "amazon":
734	                content_delta = payload.get("outputText").strip('\n')
735	                finish_reason = payload.get("completion_reason")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
734	                content_delta = payload.get("outputText").strip('\n')
735	                finish_reason = payload.get("completion_reason")
736	 

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
737	            elif model_prefix == "anthropic":
738	                content_delta = payload.get("completion")
739	                finish_reason = payload.get("stop_reason")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
738	                content_delta = payload.get("completion")
739	                finish_reason = payload.get("stop_reason")
740	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
741	            elif model_prefix == "cohere":
742	                content_delta = payload.get("text")
743	                finish_reason = payload.get("finish_reason")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	                content_delta = payload.get("text")
743	                finish_reason = payload.get("finish_reason")
744	            

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
745	            elif model_prefix == "mistral":
746	                content_delta = payload.get('outputs')[0].get("text")
747	                finish_reason = payload.get('outputs')[0].get("stop_reason")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
745	            elif model_prefix == "mistral":
746	                content_delta = payload.get('outputs')[0].get("text")
747	                finish_reason = payload.get('outputs')[0].get("stop_reason")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
746	                content_delta = payload.get('outputs')[0].get("text")
747	                finish_reason = payload.get('outputs')[0].get("stop_reason")
748	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
746	                content_delta = payload.get('outputs')[0].get("text")
747	                finish_reason = payload.get('outputs')[0].get("stop_reason")
748	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
749	            elif model_prefix == "meta":
750	                content_delta = payload.get("generation").strip('\n')
751	                finish_reason = payload.get("stop_reason")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/bedrock/llm/llm.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
750	                content_delta = payload.get("generation").strip('\n')
751	                finish_reason = payload.get("stop_reason")
752	            

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/deepseek/llm/llm.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	        if 'endpoint_url' not in credentials or credentials['endpoint_url'] == "":
109	            credentials['openai_api_base']='https://api.deepseek.com'
110	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	                            key: {
119	                                'type_': value.get('type', 'string').upper(),
120	                                'description': value.get('description', ''),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	                                'type_': value.get('type', 'string').upper(),
120	                                'description': value.get('description', ''),
121	                                'enum': value.get('enum', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	                                'description': value.get('description', ''),
121	                                'enum': value.get('enum', [])
122	                            } for key, value in tool.parameters.get('properties', {}).items()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	                                'enum': value.get('enum', [])
122	                            } for key, value in tool.parameters.get('properties', {}).items()
123	                        },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	                        },
124	                        required=tool.parameters.get('required', [])
125	                    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
375	                            try:
376	                                image_content = requests.get(message_content.data).content
377	                                mime_type, _ = mimetypes.guess_type(message_content.data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
377	                                mime_type, _ = mimetypes.guess_type(message_content.data)
378	                                base64_data = base64.b64encode(image_content).decode('utf-8')
379	                            except Exception as ex:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/google/llm/llm.py:378
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
377	                                mime_type, _ = mimetypes.guess_type(message_content.data)
378	                                base64_data = base64.b64encode(image_content).decode('utf-8')
379	                            except Exception as ex:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/groq/llm/llm.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        credentials['mode'] = 'chat'
25	        credentials['endpoint_url'] = 'https://api.groq.com/openai/v1'
26	    

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/llm/llm.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	            except BadRequestError as e:
98	                raise CredentialsValidateFailedError('Only available for models running on with the `text-generation-inference`. '
99	                                                     'To learn more about the TGI project, please refer to https://github.com/huggingface/text-generation-inference.')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	
16	HUGGINGFACE_ENDPOINT_API = 'https://api.endpoints.huggingface.cloud/v2/endpoint/'
17	
18	
19	class HuggingfaceHubTextEmbeddingModel(_CommonHuggingfaceHub, TextEmbeddingModel):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
29	
30	        output = client.post(
31	            json={
32	                "inputs": texts,
33	                "options": {
34	                    "wait_for_model": False,
35	                    "use_cache": False
36	                }
37	            },
38	            model=execute_model)
39	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	
173	            response = requests.get(url=url, headers=headers)
174	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	
180	            for item in response.json().get("items", []):
181	                if item.get("status", {}).get("url") == credentials['huggingfacehub_endpoint_url']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	            for item in response.json().get("items", []):
181	                if item.get("status", {}).get("url") == credentials['huggingfacehub_endpoint_url']:
182	                    model_repository_name = item.get("model", {}).get("repository")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	            for item in response.json().get("items", []):
181	                if item.get("status", {}).get("url") == credentials['huggingfacehub_endpoint_url']:
182	                    model_repository_name = item.get("model", {}).get("repository")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	                if item.get("status", {}).get("url") == credentials['huggingfacehub_endpoint_url']:
182	                    model_repository_name = item.get("model", {}).get("repository")
183	                    break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/huggingface_hub/text_embedding/text_embedding.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	                if item.get("status", {}).get("url") == credentials['huggingfacehub_endpoint_url']:
182	                    model_repository_name = item.get("model", {}).get("repository")
183	                    break

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/jina/rerank/rerank.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	        base_url = credentials.get('base_url', 'https://api.jina.ai/v1')
44	        if base_url.endswith('/'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/jina/text_embedding/text_embedding.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    """
27	    api_base: str = 'https://api.jina.ai/v1'
28	
29	    def _invoke(self, model: str, credentials: dict,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/jina/text_embedding/text_embedding.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	
45	        base_url = credentials.get('base_url', self.api_base)
46	        if base_url.endswith('/'):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/jina/text_embedding/text_embedding.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
65	        try:
66	            response = post(url, headers=headers, data=dumps(data))
67	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/jina/text_embedding/text_embedding.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	                ModelPropertyKey.CONTEXT_SIZE: int(
198	                    credentials.get('context_size'))
199	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/localai/rerank/rerank.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	        headers = {
56	            'Authorization': f"Bearer {credentials.get('api_key')}",
57	            'Content-Type': 'application/json'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/localai/rerank/rerank.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
67	        try:
68	            response = post(str(URL(url) / 'rerank'), headers=headers, data=dumps(data), timeout=10)
69	            response.raise_for_status() 

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/localai/speech2text/speech2text.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
41	        request = Request("POST", url, data=data, files=files)
42	        prepared_request = session.prepare_request(request)
43	        response = session.send(prepared_request)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/localai/text_embedding/text_embedding.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
60	        try:
61	            response = post(str(URL(url) / 'embeddings'), headers=headers, data=dumps(data), timeout=10)
62	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/localai/text_embedding/text_embedding.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	            model_properties={
133	                ModelPropertyKey.CONTEXT_SIZE: int(credentials.get('context_size', '512')),
134	                ModelPropertyKey.MAX_CHUNKS: 1,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        
32	        url = f'https://api.minimax.chat/v1/text/chatcompletion?GroupId={group_id}'
33	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
84	        try:
85	            response = post(
86	                url=url, data=dumps(body), headers=headers, stream=stream, timeout=(10, 300))
87	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	
165	            choices = data.get('choices', [])
166	            if len(choices) == 0:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion_pro.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	        url = f'https://api.minimax.chat/v1/text/chatcompletion_pro?GroupId={group_id}'
34	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion_pro.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        
49	        if model_parameters.get('plugin_web_search'):
50	            extra_kwargs['plugins'] = [

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion_pro.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
97	        try:
98	            response = post(
99	                url=url, data=dumps(body), headers=headers, stream=stream, timeout=(10, 300))
100	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion_pro.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	            # final chunk
164	            if data['reply'] or data.get('usage'):
165	                total_tokens = data['usage']['total_tokens']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion_pro.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	
177	                choices = data.get('choices', [])
178	                if len(choices) > 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/llm/chat_completion_pro.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	            # partial chunk
191	            choices = data.get('choices', [])
192	            if len(choices) == 0:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/text_embedding/text_embedding.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    """
33	    api_base: str = 'https://api.minimax.chat/v1/embeddings'
34	
35	    def _invoke(self, model: str, credentials: dict,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/minimax/text_embedding/text_embedding.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
65	        try:
66	            response = post(url, headers=headers, data=dumps(data))
67	        except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/mistralai/llm/llm.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	        credentials['mode'] = 'chat'
31	        credentials['endpoint_url'] = 'https://api.mistral.ai/v1'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	            features=[ModelFeature.TOOL_CALL, ModelFeature.MULTI_TOOL_CALL, ModelFeature.STREAM_TOOL_CALL] 
53	                if credentials.get('function_calling_type') == 'tool_call' 
54	                else [],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	            model_properties={
57	                ModelPropertyKey.CONTEXT_SIZE: int(credentials.get('context_size', 4096)),
58	                ModelPropertyKey.MODE: LLMMode.CHAT.value,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	                    min=1,
72	                    max=int(credentials.get('max_tokens', 4096)),
73	                    label=I18nObject(en_US='Max Tokens', zh_Hans=''),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	        credentials['mode'] = 'chat'
87	        credentials['endpoint_url'] = 'https://api.moonshot.cn/v1'
88	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	                function = AssistantPromptMessage.ToolCall.ToolCallFunction(
164	                    name=response_tool_call["function"]["name"] if response_tool_call.get("function", {}).get("name") else "",
165	                    arguments=response_tool_call["function"]["arguments"] if response_tool_call.get("function", {}).get("arguments") else ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	                function = AssistantPromptMessage.ToolCall.ToolCallFunction(
164	                    name=response_tool_call["function"]["name"] if response_tool_call.get("function", {}).get("name") else "",
165	                    arguments=response_tool_call["function"]["arguments"] if response_tool_call.get("function", {}).get("arguments") else ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	                    name=response_tool_call["function"]["name"] if response_tool_call.get("function", {}).get("name") else "",
165	                    arguments=response_tool_call["function"]["arguments"] if response_tool_call.get("function", {}).get("arguments") else ""
166	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	                    name=response_tool_call["function"]["name"] if response_tool_call.get("function", {}).get("name") else "",
165	                    arguments=response_tool_call["function"]["arguments"] if response_tool_call.get("function", {}).get("arguments") else ""
166	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	                tool_call = AssistantPromptMessage.ToolCall(
169	                    id=response_tool_call["id"] if response_tool_call.get("id") else "",
170	                    type=response_tool_call["type"] if response_tool_call.get("type") else "",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	                    id=response_tool_call["id"] if response_tool_call.get("id") else "",
170	                    type=response_tool_call["type"] if response_tool_call.get("type") else "",
171	                    function=function

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	                choice = chunk_json['choices'][0]
264	                finish_reason = chunk_json['choices'][0].get('finish_reason')
265	                chunk_index += 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	                    delta = choice['delta']
269	                    delta_content = delta.get('content')
270	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
270	
271	                    assistant_message_tool_calls = delta.get('tool_calls', None)
272	                    # assistant_message_function_call = delta.delta.function_call

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/moonshot/llm/llm.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	                elif 'text' in choice:
290	                    choice_text = choice.get('text', '')
291	                    if choice_text == '':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/llm/llm.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        if self.MODEL_SUFFIX_MAP[model]:
79	            credentials['server_url'] = f'https://ai.api.nvidia.com/v1/{self.MODEL_SUFFIX_MAP[model]}'
80	            credentials.pop('endpoint_url')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/llm/llm.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        else:
82	            credentials['endpoint_url'] = 'https://integrate.api.nvidia.com/v1'
83	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/llm/llm.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	
99	            api_key = credentials.get('api_key')
100	            if api_key:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/llm/llm.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
136	            # send a post request to validate the credentials
137	            response = requests.post(
138	                endpoint_url,
139	                headers=headers,
140	                json=data,
141	                timeout=(10, 300)
142	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/llm/llm.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	
178	        api_key = credentials.get('api_key')
179	        if api_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/llm/llm.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        # annotate tools with names, descriptions, etc.
215	        function_calling_type = credentials.get('function_calling_type', 'no_call')
216	        formatted_tools = []

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/llm/llm.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
237	
238	        response = requests.post(
239	            endpoint_url,
240	            headers=headers,
241	            json=data,
242	            timeout=(10, 300),
243	            stream=stream
244	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/rerank/rerank.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        try:
46	            invoke_url = "https://ai.api.nvidia.com/v1/retrieval/nvidia/reranking"
47	
48	            headers = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/rerank/rerank.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	            headers = {
49	                "Authorization": f"Bearer {credentials.get('api_key')}",
50	                "Accept": "application/json",

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/rerank/rerank.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
58	            session = requests.Session()
59	            response = session.post(invoke_url, headers=headers, json=payload)
60	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/text_embedding/text_embedding.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    """
25	    api_base: str = 'https://ai.api.nvidia.com/v1/retrieval/nvidia/embeddings'
26	    models: list[str] = ['NV-Embed-QA']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/nvidia/text_embedding/text_embedding.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
57	        try:
58	            response = post(url, headers=headers, data=dumps(data))
59	        except Exception as e:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
237	        # send a post request to validate the credentials
238	        response = requests.post(
239	            endpoint_url, headers=headers, json=data, timeout=(10, 300), stream=stream
240	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	        if completion_type is LLMMode.CHAT:
278	            message = response_json.get("message", {})
279	            response_content = message.get("content", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	            message = response_json.get("message", {})
279	            response_content = message.get("content", "")
280	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
376	                else:
377	                    text = chunk_json.get("message").get("content", "")
378	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
376	                else:
377	                    text = chunk_json.get("message").get("content", "")
378	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
503	            model_properties={
504	                ModelPropertyKey.MODE: credentials.get("mode"),
505	                ModelPropertyKey.CONTEXT_SIZE: int(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
505	                ModelPropertyKey.CONTEXT_SIZE: int(
506	                    credentials.get("context_size", 4096)
507	                ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
571	                    default=(
572	                        512 if int(credentials.get("max_tokens", 4096)) >= 768 else 128
573	                    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	                    min=-2,
575	                    max=int(credentials.get("max_tokens", 4096)),
576	                ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
697	            pricing=PriceConfig(
698	                input=Decimal(credentials.get("input_price", 0)),
699	                output=Decimal(credentials.get("output_price", 0)),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
698	                input=Decimal(credentials.get("input_price", 0)),
699	                output=Decimal(credentials.get("output_price", 0)),
700	                unit=Decimal(credentials.get("unit", 0)),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
699	                output=Decimal(credentials.get("output_price", 0)),
700	                unit=Decimal(credentials.get("unit", 0)),
701	                currency=credentials.get("currency", "USD"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/llm/llm.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
700	                unit=Decimal(credentials.get("unit", 0)),
701	                currency=credentials.get("currency", "USD"),
702	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/text_embedding/text_embedding.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	
58	        endpoint_url = credentials.get('base_url')
59	        if not endpoint_url.endswith('/'):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/text_embedding/text_embedding.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
90	            # Make the request to the OpenAI API
91	            response = requests.post(
92	                endpoint_url,
93	                headers=headers,
94	                data=json.dumps(payload),
95	                timeout=(10, 300)
96	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/text_embedding/text_embedding.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	            model_properties={
161	                ModelPropertyKey.CONTEXT_SIZE: int(credentials.get('context_size')),
162	                ModelPropertyKey.MAX_CHUNKS: 1,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/text_embedding/text_embedding.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	            pricing=PriceConfig(
166	                input=Decimal(credentials.get('input_price', 0)),
167	                unit=Decimal(credentials.get('unit', 0)),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/text_embedding/text_embedding.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	                input=Decimal(credentials.get('input_price', 0)),
167	                unit=Decimal(credentials.get('unit', 0)),
168	                currency=credentials.get('currency', "USD")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/ollama/text_embedding/text_embedding.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	                unit=Decimal(credentials.get('unit', 0)),
168	                currency=credentials.get('currency', "USD")
169	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai/llm/llm.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
946	            raise NotImplementedError(
947	                f"get_num_tokens_from_messages() is not presently implemented "
948	                f"for model {model}."
949	                "See https://github.com/openai/openai-python/blob/main/chatml.md for "

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai/text_embedding/text_embedding.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
183	            # decode base64 embedding
184	            return ([list(np.frombuffer(base64.b64decode(data.embedding), dtype="float32")) for data in response.data],
185	                    response.usage.total_tokens)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai/text_embedding/text_embedding.py:184
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
183	            # decode base64 embedding
184	            return ([list(np.frombuffer(base64.b64decode(data.embedding), dtype="float32")) for data in response.data],
185	                    response.usage.total_tokens)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai/tts/tts.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
85	            # Create a thread pool and map the function to the list of sentences
86	            with concurrent.futures.ThreadPoolExecutor(max_workers=max_workers) as executor:
87	                futures = [executor.submit(self._process_sentence, sentence=sentence, model=model, voice=voice,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	
106	            api_key = credentials.get('api_key')
107	            if api_key:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
136	            # send a post request to validate the credentials
137	            response = requests.post(
138	                endpoint_url,
139	                headers=headers,
140	                json=data,
141	                timeout=(10, 300)
142	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	
177	        function_calling_type = credentials.get('function_calling_type', 'no_call')
178	        if function_calling_type in ['function_call']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	
183	        stream_function_calling = credentials.get('stream_function_calling', 'supported')
184	        if stream_function_calling == 'supported':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	
187	        vision_support = credentials.get('vision_support', 'not_support')
188	        if vision_support == 'support':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	            model_properties={
198	                ModelPropertyKey.CONTEXT_SIZE: int(credentials.get('context_size', "4096")),
199	                ModelPropertyKey.MODE: credentials.get('mode'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	                ModelPropertyKey.CONTEXT_SIZE: int(credentials.get('context_size', "4096")),
199	                ModelPropertyKey.MODE: credentials.get('mode'),
200	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	                    type=ParameterType.FLOAT,
206	                    default=float(credentials.get('temperature', 0.7)),
207	                    min=0,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	                    type=ParameterType.FLOAT,
215	                    default=float(credentials.get('top_p', 1)),
216	                    min=0,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	                    type=ParameterType.FLOAT,
224	                    default=float(credentials.get('frequency_penalty', 0)),
225	                    min=-2,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	                    type=ParameterType.FLOAT,
232	                    default=float(credentials.get('presence_penalty', 0)),
233	                    min=-2,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	                    min=1,
242	                    max=int(credentials.get('max_tokens_to_sample', 4096)),
243	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	            pricing=PriceConfig(
246	                input=Decimal(credentials.get('input_price', 0)),
247	                output=Decimal(credentials.get('output_price', 0)),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	                input=Decimal(credentials.get('input_price', 0)),
247	                output=Decimal(credentials.get('output_price', 0)),
248	                unit=Decimal(credentials.get('unit', 0)),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	                output=Decimal(credentials.get('output_price', 0)),
248	                unit=Decimal(credentials.get('unit', 0)),
249	                currency=credentials.get('currency', "USD")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	                unit=Decimal(credentials.get('unit', 0)),
249	                currency=credentials.get('currency', "USD")
250	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
283	
284	        api_key = credentials.get('api_key')
285	        if api_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	        # annotate tools with names, descriptions, etc.
310	        function_calling_type = credentials.get('function_calling_type', 'no_call')
311	        formatted_tools = []

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
332	
333	        response = requests.post(
334	            endpoint_url,
335	            headers=headers,
336	            json=data,
337	            timeout=(10, 300),
338	            stream=stream
339	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
387	        import codecs
388	        delimiter = credentials.get("stream_mode_delimiter", "\n\n")
389	        delimiter = codecs.decode(delimiter, "unicode_escape")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	                choice = chunk_json['choices'][0]
449	                finish_reason = chunk_json['choices'][0].get('finish_reason')
450	                chunk_index += 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
453	                    delta = choice['delta']
454	                    delta_content = delta.get('content')
455	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
457	
458	                    if 'tool_calls' in delta and credentials.get('function_calling_type', 'no_call') == 'tool_call':
459	                        assistant_message_tool_calls = delta.get('tool_calls', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
458	                    if 'tool_calls' in delta and credentials.get('function_calling_type', 'no_call') == 'tool_call':
459	                        assistant_message_tool_calls = delta.get('tool_calls', None)
460	                    elif 'function_call' in delta and credentials.get('function_calling_type', 'no_call') == 'function_call':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
459	                        assistant_message_tool_calls = delta.get('tool_calls', None)
460	                    elif 'function_call' in delta and credentials.get('function_calling_type', 'no_call') == 'function_call':
461	                        assistant_message_tool_calls = [{

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
463	                            'type': 'function',
464	                            'function': delta.get('function_call', {})
465	                        }]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
485	                elif 'text' in choice:
486	                    choice_text = choice.get('text', '')
487	                    if choice_text == '':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
536	        tool_calls = None
537	        function_calling_type = credentials.get('function_calling_type', 'no_call')
538	        if completion_type is LLMMode.CHAT:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
538	        if completion_type is LLMMode.CHAT:
539	            response_content = output.get('message', {})['content']
540	            if function_calling_type == 'tool_call':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	            if function_calling_type == 'tool_call':
541	                tool_calls = output.get('message', {}).get('tool_calls')
542	            elif function_calling_type == 'function_call':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	            if function_calling_type == 'tool_call':
541	                tool_calls = output.get('message', {}).get('tool_calls')
542	            elif function_calling_type == 'function_call':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
542	            elif function_calling_type == 'function_call':
543	                tool_calls = output.get('message', {}).get('function_call')
544	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
542	            elif function_calling_type == 'function_call':
543	                tool_calls = output.get('message', {}).get('function_call')
544	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
555	
556	        usage = response_json.get("usage")
557	        if usage:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
744	                num_tokens += self._get_num_tokens_by_gpt2('title')
745	                num_tokens += self._get_num_tokens_by_gpt2(parameters.get("title"))
746	            num_tokens += self._get_num_tokens_by_gpt2('type')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
746	            num_tokens += self._get_num_tokens_by_gpt2('type')
747	            num_tokens += self._get_num_tokens_by_gpt2(parameters.get("type"))
748	            if 'properties' in parameters:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
749	                num_tokens += self._get_num_tokens_by_gpt2('properties')
750	                for key, value in parameters.get('properties').items():
751	                    num_tokens += self._get_num_tokens_by_gpt2(key)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
781	                function = AssistantPromptMessage.ToolCall.ToolCallFunction(
782	                    name=response_tool_call.get("function", {}).get("name", ""),
783	                    arguments=response_tool_call.get("function", {}).get("arguments", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
781	                function = AssistantPromptMessage.ToolCall.ToolCallFunction(
782	                    name=response_tool_call.get("function", {}).get("name", ""),
783	                    arguments=response_tool_call.get("function", {}).get("arguments", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
782	                    name=response_tool_call.get("function", {}).get("name", ""),
783	                    arguments=response_tool_call.get("function", {}).get("arguments", "")
784	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
782	                    name=response_tool_call.get("function", {}).get("name", ""),
783	                    arguments=response_tool_call.get("function", {}).get("arguments", "")
784	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
786	                tool_call = AssistantPromptMessage.ToolCall(
787	                    id=response_tool_call.get("id", ""),
788	                    type=response_tool_call.get("type", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
787	                    id=response_tool_call.get("id", ""),
788	                    type=response_tool_call.get("type", ""),
789	                    function=function

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
805	            function = AssistantPromptMessage.ToolCall.ToolCallFunction(
806	                name=response_function_call.get('name', ''),
807	                arguments=response_function_call.get('arguments', '')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
806	                name=response_function_call.get('name', ''),
807	                arguments=response_function_call.get('arguments', '')
808	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/llm/llm.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
810	            tool_call = AssistantPromptMessage.ToolCall(
811	                id=response_function_call.get('id', ''),
812	                type="function",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	
48	        api_key = credentials.get('api_key')
49	        if api_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	
52	        endpoint_url = credentials.get('endpoint_url')
53	        if not endpoint_url.endswith('/'):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
97	            # Make the request to the OpenAI API
98	            response = requests.post(
99	                endpoint_url,
100	                headers=headers,
101	                data=json.dumps(payload),
102	                timeout=(10, 300)
103	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	
152	            api_key = credentials.get('api_key')
153	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	
157	            endpoint_url = credentials.get('endpoint_url')
158	            if not endpoint_url.endswith('/'):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
167	
168	            response = requests.post(
169	                url=endpoint_url,
170	                headers=headers,
171	                data=json.dumps(payload),
172	                timeout=(10, 300)
173	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	            model_properties={
202	                ModelPropertyKey.CONTEXT_SIZE: int(credentials.get('context_size')),
203	                ModelPropertyKey.MAX_CHUNKS: 1,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	            pricing=PriceConfig(
207	                input=Decimal(credentials.get('input_price', 0)),
208	                unit=Decimal(credentials.get('unit', 0)),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	                input=Decimal(credentials.get('input_price', 0)),
208	                unit=Decimal(credentials.get('unit', 0)),
209	                currency=credentials.get('currency', "USD")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openai_api_compatible/text_embedding/text_embedding.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	                unit=Decimal(credentials.get('unit', 0)),
209	                currency=credentials.get('currency', "USD")
210	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openllm/llm/openllm_generate.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
111	        try:
112	            response = post(url=url, data=dumps(data), timeout=timeout, stream=stream, headers=headers)
113	        except (ConnectionError, InvalidSchema, MissingSchema) as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openllm/llm/openllm_generate.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	
183	                if choice.get('finish_reason'):
184	                    finish_reason = choice['finish_reason']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openllm/text_embedding/text_embedding.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
50	        try:
51	            response = post(url, headers=headers, data=dumps(data))
52	        except (ConnectionError, InvalidSchema, MissingSchema) as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/openrouter/llm/llm.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    def _update_endpoint_url(self, credentials: dict):
13	        credentials['endpoint_url'] = "https://openrouter.ai/api/v1"
14	        return credentials

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/siliconflow/llm/llm.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        credentials['mode'] = 'chat'
25	        credentials['endpoint_url'] = 'https://api.siliconflow.cn/v1'

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
72	
73	        signature_sha_base64 = base64.b64encode(signature_sha).decode(encoding='utf-8')
74	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:73
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
72	
73	        signature_sha_base64 = base64.b64encode(signature_sha).decode(encoding='utf-8')
74	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
76	
77	        authorization = base64.b64encode(authorization_origin.encode('utf-8')).decode(encoding='utf-8')
78	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
76	
77	        authorization = base64.b64encode(authorization_origin.encode('utf-8')).decode(encoding='utf-8')
78	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
108	        })
109	        ws.close()
110	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
120	        ))
121	        ws.send(data)
122	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
120	        ))
121	        ws.send(data)
122	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
130	            })
131	            ws.close()
132	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/spark/llm/_client.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
143	                    self.queue.put({'data': self.blocking_message})
144	                ws.close()
145	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/togetherai/llm/llm.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    def _update_endpoint_url(self, credentials: dict):
27	        credentials['endpoint_url'] = "https://api.together.xyz/v1"
28	        return credentials

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/tongyi/llm/llm.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
533	        with open(file_path, "wb") as image_file:
534	            image_file.write(base64.b64decode(encoded_string))
535	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/tongyi/llm/llm.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
533	        with open(file_path, "wb") as image_file:
534	            image_file.write(base64.b64decode(encoded_string))
535	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/tongyi/llm/llm.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
533	        with open(file_path, "wb") as image_file:
534	            image_file.write(base64.b64decode(encoded_string))
535	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/tongyi/llm/llm.py:534
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
533	        with open(file_path, "wb") as image_file:
534	            image_file.write(base64.b64decode(encoded_string))
535	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/tongyi/tts/tts.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
85	            # Create a thread pool and map the function to the list of sentences
86	            with concurrent.futures.ThreadPoolExecutor(max_workers=max_workers) as executor:
87	                futures = [executor.submit(self._process_sentence, sentence=sentence,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/llm/llm.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
323	                                mime_type, _ = mimetypes.guess_type(message_content.data)
324	                                base64_data = base64.b64encode(image_content).decode('utf-8')
325	                            except Exception as ex:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/llm/llm.py:324
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
323	                                mime_type, _ = mimetypes.guess_type(message_content.data)
324	                                base64_data = base64.b64encode(image_content).decode('utf-8')
325	                            except Exception as ex:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/llm/llm.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
454	
455	        service_account_info = json.loads(base64.b64decode(credentials["vertex_service_account_key"]))
456	        project_id = credentials["vertex_project_id"]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/llm/llm.py:455
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
454	
455	        service_account_info = json.loads(base64.b64decode(credentials["vertex_service_account_key"]))
456	        project_id = credentials["vertex_project_id"]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/text_embedding/text_embedding.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
42	        """
43	        service_account_info = json.loads(base64.b64decode(credentials["vertex_service_account_key"]))
44	        project_id = credentials["vertex_project_id"]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/text_embedding/text_embedding.py:43
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
42	        """
43	        service_account_info = json.loads(base64.b64decode(credentials["vertex_service_account_key"]))
44	        project_id = credentials["vertex_project_id"]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/text_embedding/text_embedding.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
105	        try:
106	            service_account_info = json.loads(base64.b64decode(credentials["vertex_service_account_key"]))
107	            project_id = credentials["vertex_project_id"]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/vertex_ai/text_embedding/text_embedding.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
105	        try:
106	            service_account_info = json.loads(base64.b64decode(credentials["vertex_service_account_key"]))
107	            project_id = credentials["vertex_project_id"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/volcengine_maas/volc_sdk/base/service.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
37	
38	        r = self.prepare_request(api_info, params, doseq)
39	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/volcengine_maas/volc_sdk/base/service.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	        url = r.build(doseq)
43	        resp = self.session.get(url, headers=r.headers,
44	                                timeout=(self.service_info.connection_timeout, self.service_info.socket_timeout))
45	        if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/volcengine_maas/volc_sdk/base/service.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
53	        api_info = self.api_info[api]
54	        r = self.prepare_request(api_info, params)
55	        r.headers['Content-Type'] = 'application/x-www-form-urlencoded'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/volcengine_maas/volc_sdk/base/service.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
61	
62	        resp = self.session.post(url, headers=r.headers, data=r.form,
63	                                 timeout=(self.service_info.connection_timeout, self.service_info.socket_timeout))
64	        if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/volcengine_maas/volc_sdk/base/service.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
72	        api_info = self.api_info[api]
73	        r = self.prepare_request(api_info, params)
74	        r.headers['Content-Type'] = 'application/json'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/volcengine_maas/volc_sdk/base/service.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
79	        url = r.build()
80	        resp = self.session.post(url, headers=r.headers, data=r.body,
81	                                 timeout=(self.service_info.connection_timeout, self.service_info.socket_timeout))
82	        if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
37	        try:
38	            response = post(
39	                url=f'https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&client_id={api_key}&client_secret={secret_key}',
40	                headers={
41	                    'Content-Type': 'application/json',
42	                    'Accept': 'application/json'
43	                },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	            response = post(
39	                url=f'https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&client_id={api_key}&client_secret={secret_key}',
40	                headers={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	    api_bases = {
124	        'ernie-bot': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
125	        'ernie-bot-4': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
126	        'ernie-bot-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
127	        'ernie-bot-turbo': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
128	        'ernie-3.5-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
129	        'ernie-3.5-8k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205',
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	        'ernie-bot': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
125	        'ernie-bot-4': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
126	        'ernie-bot-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
127	        'ernie-bot-turbo': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
128	        'ernie-3.5-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
129	        'ernie-3.5-8k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205',
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	        'ernie-bot-4': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
126	        'ernie-bot-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
127	        'ernie-bot-turbo': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
128	        'ernie-3.5-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
129	        'ernie-3.5-8k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205',
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	        'ernie-bot-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
127	        'ernie-bot-turbo': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
128	        'ernie-3.5-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
129	        'ernie-3.5-8k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205',
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	        'ernie-bot-turbo': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
128	        'ernie-3.5-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
129	        'ernie-3.5-8k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205',
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	        'ernie-3.5-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions',
129	        'ernie-3.5-8k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205',
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	        'ernie-3.5-8k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205',
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	        'ernie-3.5-8k-1222': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-1222',
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	        'ernie-3.5-4k-0205': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-4k-0205',
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	        'ernie-3.5-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-128k',
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',
150	        'ernie-4.0-8k'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	        'ernie-4.0-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro',
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',
150	        'ernie-4.0-8k'
151	    ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	        'ernie-speed-8k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie_speed',
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',
150	        'ernie-4.0-8k'
151	    ]
152	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	        'ernie-speed-128k': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-speed-128k',
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',
150	        'ernie-4.0-8k'
151	    ]
152	
153	    api_key: str = ''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	        'ernie-speed-appbuilder': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ai_apaas',
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',
150	        'ernie-4.0-8k'
151	    ]
152	
153	    api_key: str = ''
154	    secret_key: str = ''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	        'ernie-lite-8k-0922': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/eb-instant',
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',
150	        'ernie-4.0-8k'
151	    ]
152	
153	    api_key: str = ''
154	    secret_key: str = ''
155	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138	        'ernie-lite-8k-0308': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-lite-8k',
139	        'ernie-character-8k-0321': 'https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-char-8k',
140	    }
141	
142	    function_calling_supports = [
143	        'ernie-bot',
144	        'ernie-bot-8k',
145	        'ernie-3.5-8k',
146	        'ernie-3.5-8k-0205',
147	        'ernie-3.5-8k-1222',
148	        'ernie-3.5-4k-0205',
149	        'ernie-3.5-128k',
150	        'ernie-4.0-8k'
151	    ]
152	
153	    api_key: str = ''
154	    secret_key: str = ''
155	
156	    def __init__(self, api_key: str, secret_key: str):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
183	
184	        resp = post(url=url, data=dumps(body), headers=headers, stream=stream)
185	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/wenxin/llm/ernie_bot.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
369	                usage = data['usage']
370	                finish_reason = data.get('finish_reason', None)
371	                message = ErnieMessage(content=result, role='assistant')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/xinference/xinference_helper.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        try:
71	            response = session.get(url, timeout=10)
72	        except (MissingSchema, ConnectionError, Timeout) as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/xinference/xinference_helper.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	
79	        model_format = response_json.get('model_format', 'ggmlv3')
80	        model_ability = response_json.get('model_ability', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/xinference/xinference_helper.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	        model_format = response_json.get('model_format', 'ggmlv3')
80	        model_ability = response_json.get('model_ability', [])
81	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/xinference/xinference_helper.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	
82	        if response_json.get('model_type') == 'embedding':
83	            model_handle_type = 'embedding'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/xinference/xinference_helper.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        support_vision = 'vision' in model_ability
95	        max_tokens = response_json.get('max_tokens', 512)
96	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/xinference/xinference_helper.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	
97	        context_length = response_json.get('context_length', 2048)
98	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/yi/llm/llm.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	        if 'endpoint_url' not in credentials or credentials['endpoint_url'] == "":
116	            credentials['openai_api_base']='https://api.lingyiwanwu.com'
117	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/_client.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        if base_url is None:
41	            base_url = "https://open.bigmodel.cn/api/paas/v4"
42	        from .__version__ import __version__

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/core/_http_client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
124	
125	        return self._client.build_request(
126	            headers=headers,
127	            timeout=self.timeout if isinstance(request_param.timeout, NotGiven) else request_param.timeout,
128	            method=request_param.method,
129	            url=url,
130	            json=json_data,
131	            files=request_param.files,
132	            params=request_param.params,
133	            **kwargs,
134	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/core/_http_client.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
231	    ) -> ResponseT | StreamResponse:
232	        request = self._prepare_request(params)
233	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/core/_http_client.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
266	        opts = ClientRequestParam.construct(method="get", url=path, **options)
267	        return self.request(
268	            cast_type=cast_type, params=opts,
269	            enable_stream=enable_stream
270	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/core/_http_client.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
285	
286	        return self.request(
287	            cast_type=cast_type, params=opts,
288	            enable_stream=enable_stream,
289	            stream_cls=stream_cls
290	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/core/_http_client.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
301	
302	        return self.request(
303	            cast_type=cast_type, params=opts,
304	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/core/_http_client.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
317	
318	        return self.request(
319	            cast_type=cast_type, params=opts,
320	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/model_runtime/model_providers/zhipuai/zhipuai_sdk/core/_http_client.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
331	
332	        return self.request(
333	            cast_type=cast_type, params=opts,
334	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/tools/tool_file_manager.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	        sign = hmac.new(secret_key, data_to_sign.encode(), hashlib.sha256).digest()
36	        encoded_sign = base64.urlsafe_b64encode(sign).decode()
37	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/tools/tool_file_manager.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
47	        recalculated_sign = hmac.new(secret_key, data_to_sign.encode(), hashlib.sha256).digest()
48	        recalculated_encoded_sign = base64.urlsafe_b64encode(recalculated_sign).decode()
49	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/http_request/http_executor.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
15	
16	MAX_BINARY_SIZE = int(os.environ.get('HTTP_REQUEST_NODE_MAX_BINARY_SIZE', 1024 * 1024 * 10))  # 10MB
17	READABLE_MAX_BINARY_SIZE = f'{MAX_BINARY_SIZE / 1024 / 1024:.2f}MB'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/http_request/http_executor.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	READABLE_MAX_BINARY_SIZE = f'{MAX_BINARY_SIZE / 1024 / 1024:.2f}MB'
18	MAX_TEXT_SIZE = int(os.environ.get('HTTP_REQUEST_NODE_MAX_TEXT_SIZE', 1024 * 1024))  # 1MB
19	READABLE_MAX_TEXT_SIZE = f'{MAX_TEXT_SIZE / 1024 / 1024:.2f}MB'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/http_request/http_executor.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    def get_content_type(self) -> str:
44	        return self.headers.get('content-type')
45	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/http_request/http_executor.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
288	        # do http request
289	        response = self._do_http_request(headers)
290	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/http_request/http_executor.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
288	        # do http request
289	        response = self._do_http_request(headers)
290	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/http_request/http_request_node.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
70	                process_data = {
71	                    'request': http_executor.to_raw_request(
72	                        mask_authorization_header=node_data.mask_authorization_header
73	                    ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/http_request/http_request_node.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
92	            process_data={
93	                'request': http_executor.to_raw_request(
94	                    mask_authorization_header=node_data.mask_authorization_header
95	                ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/core/workflow/nodes/workflow_node/workflow_node.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
72	            }
73	            r = s.post(workflow_endpoint, json=data)
74	            output = r.json()

--------------------------------------------------

Code scanned:
	Total lines of code: 35945
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 63.0
		High: 278.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 327.0
		High: 14.0
Files skipped (1):
	/home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_benign/agent-manager-sdk/agent_manager_sdk-0.1.1/agent_manager_sdk/cli/main.py (syntax error while parsing AST from file)
