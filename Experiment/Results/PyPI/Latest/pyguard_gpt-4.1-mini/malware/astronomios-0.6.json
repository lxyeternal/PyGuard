{
  "package_name": "astronomios-0.6",
  "is_malicious": true,
  "files_analyzed": 1,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/latest/unzip_malware/astronomios-0.6/astronomios-0.6/astronomios-0.6/setup.py",
      "relative_path": "astronomios-0.6/astronomios-0.6/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains multiple strong indicators of malicious behavior. It is embedded in the setup installation process, which is a known supply chain attack vector. The main function 'funcion_personalizada' is triggered only on Windows systems and performs extensive environment checks to detect debugging, virtual machines, or sandbox environments, which is typical malware anti-analysis behavior. The code uses multiple layers of obfuscation including double base64 decoding, dynamic string decoding, and cryptographic operations (PBKDF2 key derivation, ChaCha20 and AES decryption) on a large embedded payload. This payload is then decompressed with lzma and executed dynamically via exec(), enabling arbitrary code execution hidden from static analysis. The use of subprocess calls to check running processes for known analysis/debugging tools, checks on CPU count and memory size, and the presence of suspicious file existence checks further confirm evasion techniques. The code exits silently if suspicious conditions are detected, avoiding execution in analysis environments. The install command subclass triggers this malicious payload execution during package installation, without user consent or interaction. The obfuscated cryptographic keys and payload, combined with dynamic execution, are classic hallmarks of malware designed to evade detection and deliver a hidden payload. Overall, this code is a highly sophisticated malicious installer that executes encrypted and obfuscated code on Windows systems during package installation, consistent with supply chain malware attacks."
    }
  ],
  "true_label": "malware"
}