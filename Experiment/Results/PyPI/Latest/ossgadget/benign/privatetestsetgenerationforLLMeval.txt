[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/tools/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        return {**state, "D_synth": "No data to synthesize."}[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    # If user didn't specify a count, default to 10[0m
[30;1m215 | [0m[35m    qa_count = state.get("qa_count", 10)  # user may override this[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    # Prompt GPT to generate Q&A pairs[0m
[30;1m218 | [0m[35m    prompt_template = PromptTemplate.from_template(f"""[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/tools/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    2) Reads 'qa_count' from state to determine how many Q&A pairs to generate.[0m
[30;1m208 | [0m[35m    3) Generates Q&A pairs referencing the sanitized text, saves to CSV, returns final report.[0m
[30;1m209 | [0m[35m    """[0m
[30;1m210 | [0m[35m    D_priv = state.get("D_priv", "")[0m
[30;1m211 | [0m[35m    if not D_priv:[0m
[30;1m212 | [0m[35m        return {**state, "D_synth": "No data to synthesize."}[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/tools/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m        # Count and store the detected entities[0m
[30;1m173 | [0m[35m        for result in results:[0m
[30;1m174 | [0m[35m            entity_type = result.entity_type[0m
[30;1m175 | [0m[35m            sensitive_entities[entity_type] = sensitive_entities.get(entity_type, 0) + 1[0m
[30;1m176 | [0m[35m            total_entities += 1[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    # Generate the privacy analysis report[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/tools/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m    Analyzes the document to identify sensitive entities (PII) and flags them for pseudonymization.[0m
[30;1m141 | [0m[35m    Generates a privacy analysis report with the main sensitive entities and KPIs.[0m
[30;1m142 | [0m[35m    """[0m
[30;1m143 | [0m[35m    topic_vectorstore = state.get("topic_vectorstore", None)[0m
[30;1m144 | [0m[35m    if not topic_vectorstore:[0m
[30;1m145 | [0m[35m        print("No topic_vectorstore found. Skipping.")[0m
[30;1m146 | [0m[35m        return {**state, "privacy_analysis_report": "No topics to analyze."}[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/tools/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    2) Runs KMeans for 10 clusters, picks up to 5 samples each.[0m
[30;1m29 | [0m[35m    4) Returns 'topic_vectorstore' in the pipeline state.[0m
[30;1m30 | [0m[35m    """[0m
[30;1m31 | [0m[35m    embedded_data = state.get("D", [])[0m
[30;1m32 | [0m[35m    if not embedded_data:[0m
[30;1m33 | [0m[35m        print("No data found in state['D']. Skipping clustering.")[0m
[30;1m34 | [0m[35m        return {**state, "topic_vectorstore": None}[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        return {**state, "D_synth": "No data to synthesize."}[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    # If user didn't specify a count, default to 10[0m
[30;1m215 | [0m[35m    qa_count = state.get("qa_count", 10)  # user may override this[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    # Prompt GPT to generate Q&A pairs[0m
[30;1m218 | [0m[35m    prompt_template = PromptTemplate.from_template(f"""[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    2) Reads 'qa_count' from state to determine how many Q&A pairs to generate.[0m
[30;1m208 | [0m[35m    3) Generates Q&A pairs referencing the sanitized text, saves to CSV, returns final report.[0m
[30;1m209 | [0m[35m    """[0m
[30;1m210 | [0m[35m    D_priv = state.get("D_priv", "")[0m
[30;1m211 | [0m[35m    if not D_priv:[0m
[30;1m212 | [0m[35m        return {**state, "D_synth": "No data to synthesize."}[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m        # Count and store the detected entities[0m
[30;1m173 | [0m[35m        for result in results:[0m
[30;1m174 | [0m[35m            entity_type = result.entity_type[0m
[30;1m175 | [0m[35m            sensitive_entities[entity_type] = sensitive_entities.get(entity_type, 0) + 1[0m
[30;1m176 | [0m[35m            total_entities += 1[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    # Generate the privacy analysis report[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m    Analyzes the document to identify sensitive entities (PII) and flags them for pseudonymization.[0m
[30;1m141 | [0m[35m    Generates a privacy analysis report with the main sensitive entities and KPIs.[0m
[30;1m142 | [0m[35m    """[0m
[30;1m143 | [0m[35m    topic_vectorstore = state.get("topic_vectorstore", None)[0m
[30;1m144 | [0m[35m    if not topic_vectorstore:[0m
[30;1m145 | [0m[35m        print("No topic_vectorstore found. Skipping.")[0m
[30;1m146 | [0m[35m        return {**state, "privacy_analysis_report": "No topics to analyze."}[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/agents.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    2) Runs KMeans for 10 clusters, picks up to 5 samples each.[0m
[30;1m29 | [0m[35m    4) Returns 'topic_vectorstore' in the pipeline state.[0m
[30;1m30 | [0m[35m    """[0m
[30;1m31 | [0m[35m    embedded_data = state.get("D", [])[0m
[30;1m32 | [0m[35m    if not embedded_data:[0m
[30;1m33 | [0m[35m        print("No data found in state['D']. Skipping clustering.")[0m
[30;1m34 | [0m[35m        return {**state, "topic_vectorstore": None}[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/run.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    # 5) Print final synthetic dataset[0m
[30;1m140 | [0m[35m    print("\n--- Final Synthetic Dataset ---")[0m
[30;1m141 | [0m[35m    synthetic_data = final_state.get("D_synth", "<No synthetic data found>")[0m
[30;1m142 | [0m[35m    print(synthetic_data)[0m
[30;1m143 | [0m[35m    print(f"If the pipeline completed successfully, {qa_count} Q&A pairs have been saved to 'qa_pair[0m
[30;1m144 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m12[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/privatetestsetgenerationforllmeval-0.1.1/src/run/run.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    """[0m
[30;1m90 | [0m[35m    Prompts the user for a PDF path. Type 'q' or an empty line to quit.[0m
[30;1m91 | [0m[35m    """[0m
[30;1m92 | [0m[35m    if state.get("file_path") == "":[0m
[30;1m93 | [0m[35m        user_input = input("Enter the path to your PDF file (or 'q' to quit): ").strip()[0m
[30;1m94 | [0m[35m        if user_input.lower() == 'q' or user_input == '':[0m
[30;1m95 | [0m[35m            return {"file_path": "", "continue_pipeline": False}[0m

12 matches found.
