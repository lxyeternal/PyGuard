[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m42 | [0m[35m        if tool_id in catalog_tools:[0m
[30;1m43 | [0m[35m            tool_config = catalog_tools[tool_id][0m
[30;1m44 | [0m[35m            env_vars[f"TOOL_{i}_CMD"] = tool_config["command"][0m
[30;1m45 | [0m[35m            env_vars[f"TOOL_{i}_ARGS"] = json.dumps(tool_config.get("args", []))[0m
[30;1m46 | [0m[35m    [0m
[30;1m47 | [0m[35m    return env_vars[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# Default container image[0m
[30;1m21 | [0m[35mDEFAULT_IMAGE = os.environ.get("DEFAULT_AGENT_IMAGE", "agentfactory-agent:latest")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mdef _format_tool_env_vars(agent_row: AgentMeta, catalog_tools: Dict[str, Dict[str, Any]]) -> Dict[st[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m96 | [0m[35m    assert error is None[0m
[30;1m97 | [0m[35m    [0m
[30;1m98 | [0m[35m    # Verify Docker client calls[0m
[30;1m99 | [0m[35m    mock_docker.from_env.assert_called_once()[0m
[30;1m100 | [0m[35m    mock_client.ping.assert_called_once()[0m
[30;1m101 | [0m[35m    [0m
[30;1m102 | [0m[35m    # Verify container creation with correct parameters[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m299 | [0m[35menv file or helm values:[0m
[30;1m300 | [0m[35mSERVER_PORT=8000[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35mAPI_KEYS=csv_of_valid_keys[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35mMAX_CONCURRENT_AGENTS=20[0m
[30;1m305 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m        with:[0m
[30;1m25 | [0m[35m          registry: ghcr.io[0m
[30;1m26 | [0m[35m          username: ${{ github.actor }}[0m
[30;1m27 | [0m[35m          password: ${{ secrets.GITHUB_TOKEN }}[0m
[30;1m28 | [0m[35m      [0m
[30;1m29 | [0m[35m      - name: Docker meta[0m
[30;1m30 | [0m[35m        id: meta[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m37 | [0m[35m        print(f"Prompt: {prompt}")[0m
[30;1m38 | [0m[35m    [0m
[30;1m39 | [0m[35m    # Print context if available[0m
[30;1m40 | [0m[35m    context_json = os.environ.get("CONTEXT")[0m
[30;1m41 | [0m[35m    if context_json:[0m
[30;1m42 | [0m[35m        try:[0m
[30;1m43 | [0m[35m            context = json.loads(context_json)[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m32 | [0m[35m    print(f"Found {tool_count} tools")[0m
[30;1m33 | [0m[35m    [0m
[30;1m34 | [0m[35m    # Print prompt if available[0m
[30;1m35 | [0m[35m    prompt = os.environ.get("PROMPT")[0m
[30;1m36 | [0m[35m    if prompt:[0m
[30;1m37 | [0m[35m        print(f"Prompt: {prompt}")[0m
[30;1m38 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m19 | [0m[35m        print(f"Agent ID: {agent_id}")[0m
[30;1m20 | [0m[35m    [0m
[30;1m21 | [0m[35m    # Print model ID if available[0m
[30;1m22 | [0m[35m    model_id = os.environ.get("MODEL_ID")[0m
[30;1m23 | [0m[35m    if model_id:[0m
[30;1m24 | [0m[35m        print(f"Model ID: {model_id}")[0m
[30;1m25 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m14 | [0m[35m    print("Hello from the test runtime!")[0m
[30;1m15 | [0m[35m    [0m
[30;1m16 | [0m[35m    # Print agent ID if available[0m
[30;1m17 | [0m[35m    agent_id = os.environ.get("AGENT_ID")[0m
[30;1m18 | [0m[35m    if agent_id:[0m
[30;1m19 | [0m[35m        print(f"Agent ID: {agent_id}")[0m
[30;1m20 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m65 | [0m[35m        [0m
[30;1m66 | [0m[35m        # Get the arguments JSON string[0m
[30;1m67 | [0m[35m        args_key = f"TOOL_{tool_name}_ARGS"[0m
[30;1m68 | [0m[35m        args_json = os.environ.get(args_key, "[]")[0m
[30;1m69 | [0m[35m        [0m
[30;1m70 | [0m[35m        try:[0m
[30;1m71 | [0m[35m            args = json.loads(args_json)[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m34 | [0m[35m    Raises:[0m
[30;1m35 | [0m[35m        SystemExit: If the variable is required but not set[0m
[30;1m36 | [0m[35m    """[0m
[30;1m37 | [0m[35m    value = os.environ.get(name)[0m
[30;1m38 | [0m[35m    if required and not value:[0m
[30;1m39 | [0m[35m        print(f"ERROR: Required environment variable {name} not set", file=sys.stderr)[0m
[30;1m40 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000104[0m
       Tag: [34mSecurity.Backdoor.CurlBashing[0m
  Severity: [36mImportant[0m, Confidence: [36mMedium[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m(curl|wget).{1,50}\|\s*(sh|bash)[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m
[30;1m14 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \[0m
[30;1m15 | [0m[35m    apt-get install -y nodejs && \[0m
[30;1m16 | [0m[35m    apt-get clean && \[0m
[30;1m17 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000104[0m
       Tag: [34mSecurity.Backdoor.CurlBashing[0m
  Severity: [36mImportant[0m, Confidence: [36mMedium[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m(curl|wget).{1,50}\|\s*(sh|bash)[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Install Deno[0m
[30;1m9 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m10 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000104[0m
       Tag: [34mSecurity.Backdoor.CurlBashing[0m
  Severity: [36mImportant[0m, Confidence: [36mMedium[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m(curl|wget).{1,50}\|\s*(sh|bash)[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m
[30;1m210 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \[0m
[30;1m211 | [0m[35m && apt-get install -y nodejs[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m# python libs[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000104[0m
       Tag: [34mSecurity.Backdoor.CurlBashing[0m
  Severity: [36mImportant[0m, Confidence: [36mMedium[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m(curl|wget).{1,50}\|\s*(sh|bash)[0m
[30;1m202 | [0m[35mRUN apt-get update && apt-get install -y curl git[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m206 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m        # Sort tools by name for deterministic testing[0m
[30;1m68 | [0m[35m        tools.sort(key=lambda t: t["name"])[0m
[30;1m69 | [0m[35m        [0m
[30;1m70 | [0m[35m        # Find the tools by name[0m
[30;1m71 | [0m[35m        tool1 = next((t for t in tools if t["name"] == "TOOL1"), None)[0m
[30;1m72 | [0m[35m        tool2 = next((t for t in tools if t["name"] == "TOOL2"), None)[0m
[30;1m73 | [0m[35m        [0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m        # Should find 3 tools (TEST from fixture + TOOL1 and TOOL2)[0m
[30;1m65 | [0m[35m        assert len(tools) == 3[0m
[30;1m66 | [0m[35m        [0m
[30;1m67 | [0m[35m        # Sort tools by name for deterministic testing[0m
[30;1m68 | [0m[35m        tools.sort(key=lambda t: t["name"])[0m
[30;1m69 | [0m[35m        [0m
[30;1m70 | [0m[35m        # Find the tools by name[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m        "TOOL_TOOL2_ARGS": json.dumps(["arg2", "arg3"]),[0m
[30;1m62 | [0m[35m    }, clear=False):  # Do not clear existing env vars[0m
[30;1m63 | [0m[35m        tools = runtime_entry.build_tool_list_from_env()[0m
[30;1m64 | [0m[35m        # Should find 3 tools (TEST from fixture + TOOL1 and TOOL2)[0m
[30;1m65 | [0m[35m        assert len(tools) == 3[0m
[30;1m66 | [0m[35m        [0m
[30;1m67 | [0m[35m        # Sort tools by name for deterministic testing[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m        "TOOL_TOOL1_ARGS": json.dumps(["arg1"]),[0m
[30;1m60 | [0m[35m        "TOOL_TOOL2_CMD": "cmd2",[0m
[30;1m61 | [0m[35m        "TOOL_TOOL2_ARGS": json.dumps(["arg2", "arg3"]),[0m
[30;1m62 | [0m[35m    }, clear=False):  # Do not clear existing env vars[0m
[30;1m63 | [0m[35m        tools = runtime_entry.build_tool_list_from_env()[0m
[30;1m64 | [0m[35m        # Should find 3 tools (TEST from fixture + TOOL1 and TOOL2)[0m
[30;1m65 | [0m[35m        assert len(tools) == 3[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m    """Test building tool list from environment variables."""[0m
[30;1m48 | [0m[35m    tools = runtime_entry.build_tool_list_from_env()[0m
[30;1m49 | [0m[35m    [0m
[30;1m50 | [0m[35m    # We expect 1 tool from mock_env_vars fixture[0m
[30;1m51 | [0m[35m    assert len(tools) == 1[0m
[30;1m52 | [0m[35m    assert tools[0]["name"] == "TEST"[0m
[30;1m53 | [0m[35m    assert tools[0]["command"] == "echo"[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport pytest[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m# Import the runtime_entry script[0m
[30;1m11 | [0m[35msys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))[0m
[30;1m12 | [0m[35mimport runtime_entry[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        # Use a thread for container.wait() since it's a blocking call[0m
[30;1m157 | [0m[35m        loop = asyncio.get_event_loop()[0m
[30;1m158 | [0m[35m        status = await loop.run_in_executor(None, container.wait)[0m
[30;1m159 | [0m[35m        exit_code = status.get("StatusCode", 1)[0m
[30;1m160 | [0m[35m        [0m
[30;1m161 | [0m[35m        # Update agent state based on exit code[0m
[30;1m162 | [0m[35m        state = "succeeded" if exit_code == 0 else "failed"[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m        env_vars["CONTEXT"] = json.dumps(context)[0m
[30;1m96 | [0m[35m    [0m
[30;1m97 | [0m[35m    # Add optional prompt if available in tools[0m
[30;1m98 | [0m[35m    prompt = agent_row.tools.get("prompt")[0m
[30;1m99 | [0m[35m    if prompt:[0m
[30;1m100 | [0m[35m        env_vars["PROMPT"] = prompt[0m
[30;1m101 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m    env_vars.update(tool_env_vars)[0m
[30;1m91 | [0m[35m    [0m
[30;1m92 | [0m[35m    # Add optional context if available in tools[0m
[30;1m93 | [0m[35m    context = agent_row.tools.get("context")[0m
[30;1m94 | [0m[35m    if context:[0m
[30;1m95 | [0m[35m        env_vars["CONTEXT"] = json.dumps(context)[0m
[30;1m96 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        if tool_id in catalog_tools:[0m
[30;1m43 | [0m[35m            tool_config = catalog_tools[tool_id][0m
[30;1m44 | [0m[35m            env_vars[f"TOOL_{i}_CMD"] = tool_config["command"][0m
[30;1m45 | [0m[35m            env_vars[f"TOOL_{i}_ARGS"] = json.dumps(tool_config.get("args", []))[0m
[30;1m46 | [0m[35m    [0m
[30;1m47 | [0m[35m    return env_vars[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    env_vars = {}[0m
[30;1m36 | [0m[35m    [0m
[30;1m37 | [0m[35m    # Get the tool IDs from agent metadata[0m
[30;1m38 | [0m[35m    tool_ids = agent_row.tools.get("tool_ids", [])[0m
[30;1m39 | [0m[35m    [0m
[30;1m40 | [0m[35m    # For each requested tool, add environment variables[0m
[30;1m41 | [0m[35m    for i, tool_id in enumerate(tool_ids):[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# Default container image[0m
[30;1m21 | [0m[35mDEFAULT_IMAGE = os.environ.get("DEFAULT_AGENT_IMAGE", "agentfactory-agent:latest")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mdef _format_tool_env_vars(agent_row: AgentMeta, catalog_tools: Dict[str, Dict[str, Any]]) -> Dict[st[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m158 | [0m[35m        status = await loop.run_in_executor(None, container.wait)[0m
[30;1m159 | [0m[35m        exit_code = status.get("StatusCode", 1)[0m
[30;1m160 | [0m[35m        [0m
[30;1m161 | [0m[35m        # Update agent state based on exit code[0m
[30;1m162 | [0m[35m        state = "succeeded" if exit_code == 0 else "failed"[0m
[30;1m163 | [0m[35m        update_agent_state(agent_id, state, exit_code=exit_code)[0m
[30;1m164 | [0m[35m        [0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35masync def _monitor_container(container: Container, agent_id: str) -> None:[0m
[30;1m147 | [0m[35m    """[0m
[30;1m148 | [0m[35m    Monitor a container until it exits and update the agent state.[0m
[30;1m149 | [0m[35m    [0m
[30;1m150 | [0m[35m    Args:[0m
[30;1m151 | [0m[35m        container: The Docker container object[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m130 | [0m[35m        error_msg = f"Failed to launch container: {str(e)}"[0m
[30;1m131 | [0m[35m        logger.error(error_msg)[0m
[30;1m132 | [0m[35m        [0m
[30;1m133 | [0m[35m        # Update agent state to failed[0m
[30;1m134 | [0m[35m        update_agent_state(agent_row.id, "failed", exit_code=1)[0m
[30;1m135 | [0m[35m        [0m
[30;1m136 | [0m[35m        # Clean up container if it was created[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m            auto_remove=True,  # Auto-remove container when it exits[0m
[30;1m114 | [0m[35m        )[0m
[30;1m115 | [0m[35m        [0m
[30;1m116 | [0m[35m        # Update agent state to running[0m
[30;1m117 | [0m[35m        update_agent_state(agent_row.id, "running")[0m
[30;1m118 | [0m[35m        [0m
[30;1m119 | [0m[35m        # Start monitoring task to capture exit code[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m        agent_id: The agent ID[0m
[30;1m153 | [0m[35m    """[0m
[30;1m154 | [0m[35m    try:[0m
[30;1m155 | [0m[35m        # Wait for container to finish or time out[0m
[30;1m156 | [0m[35m        # Use a thread for container.wait() since it's a blocking call[0m
[30;1m157 | [0m[35m        loop = asyncio.get_event_loop()[0m
[30;1m158 | [0m[35m        status = await loop.run_in_executor(None, container.wait)[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m    Monitor a container until it exits and update the agent state.[0m
[30;1m149 | [0m[35m    [0m
[30;1m150 | [0m[35m    Args:[0m
[30;1m151 | [0m[35m        container: The Docker container object[0m
[30;1m152 | [0m[35m        agent_id: The agent ID[0m
[30;1m153 | [0m[35m    """[0m
[30;1m154 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m        update_agent_state(agent_row.id, "failed", exit_code=1)[0m
[30;1m69 | [0m[35m        return False, error_msg[0m
[30;1m70 | [0m[35m    [0m
[30;1m71 | [0m[35m    # Initialize Docker client[0m
[30;1m72 | [0m[35m    try:[0m
[30;1m73 | [0m[35m        client = docker.from_env()[0m
[30;1m74 | [0m[35m        # Simple ping to check connection[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom typing import Dict, List, Optional, Any, Tuple[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Using docker package for docker SDK[0m
[30;1m10 | [0m[35mimport docker[0m
[30;1m11 | [0m[35mfrom docker.errors import DockerException, APIError[0m
[30;1m12 | [0m[35mfrom docker.models.containers import Container[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom agentfactory_mcp_server.catalog import load_catalog[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mfrom typing import Dict, List, Optional, Any, Tuple[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Using docker package for docker SDK[0m
[30;1m10 | [0m[35mimport docker[0m
[30;1m11 | [0m[35mfrom docker.errors import DockerException, APIError[0m
[30;1m12 | [0m[35mfrom docker.models.containers import Container[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mfrom typing import Dict, List, Optional, Any, Tuple[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Using docker package for docker SDK[0m
[30;1m10 | [0m[35mimport docker[0m
[30;1m11 | [0m[35mfrom docker.errors import DockerException, APIError[0m
[30;1m12 | [0m[35mfrom docker.models.containers import Container[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m
[30;1m14 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \[0m
[30;1m15 | [0m[35m    apt-get install -y nodejs && \[0m
[30;1m16 | [0m[35m    apt-get clean && \[0m
[30;1m17 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mFROM ghcr.io/astral-sh/uv:python3.12-bookworm-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# System dependencies[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl git apt-transport-https ca-certificates p7zip-full && [0m
[30;1m5 | [0m[35m    apt-get clean && \[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m# Copy runtime entry point script[0m
[30;1m30 | [0m[35mCOPY runtime_entry.py .[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# Set environment variables[0m
[30;1m33 | [0m[35mENV PYTHONUNBUFFERED=1[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Entry point[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35mRUN uv init .[0m
[30;1m27 | [0m[35mRUN uv add pydantic-ai fastapi aiohttp[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m# Copy runtime entry point script[0m
[30;1m30 | [0m[35mCOPY runtime_entry.py .[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# Set environment variables[0m
[30;1m33 | [0m[35mENV PYTHONUNBUFFERED=1[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Verify installations[0m
[30;1m20 | [0m[35mRUN deno --version && node --version && npm --version[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m# Create app directory[0m
[30;1m23 | [0m[35mWORKDIR /app[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m
[30;1m14 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \[0m
[30;1m15 | [0m[35m    apt-get install -y nodejs && \[0m
[30;1m16 | [0m[35m    apt-get clean && \[0m
[30;1m17 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Verify installations[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m
[30;1m14 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \[0m
[30;1m15 | [0m[35m    apt-get install -y nodejs && \[0m
[30;1m16 | [0m[35m    apt-get clean && \[0m
[30;1m17 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m
[30;1m14 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \[0m
[30;1m15 | [0m[35m    apt-get install -y nodejs && \[0m
[30;1m16 | [0m[35m    apt-get clean && \[0m
[30;1m17 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m
[30;1m14 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \[0m
[30;1m15 | [0m[35m    apt-get install -y nodejs && \[0m
[30;1m16 | [0m[35m    apt-get clean && \[0m
[30;1m17 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Install Deno[0m
[30;1m9 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m10 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m
[30;1m14 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Install Deno[0m
[30;1m9 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m10 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Install Node.js + npm[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Install Deno[0m
[30;1m9 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m10 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m11 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# System dependencies[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl git apt-transport-https ca-certificates p7zip-full && [0m
[30;1m5 | [0m[35m    apt-get clean && \[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# Install Deno[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM ghcr.io/astral-sh/uv:python3.12-bookworm-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# System dependencies[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl git apt-transport-https ca-certificates p7zip-full && [0m
[30;1m5 | [0m[35m    apt-get clean && \[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM ghcr.io/astral-sh/uv:python3.12-bookworm-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# System dependencies[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl git apt-transport-https ca-certificates p7zip-full && [0m
[30;1m5 | [0m[35m    apt-get clean && \[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM ghcr.io/astral-sh/uv:python3.12-bookworm-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# System dependencies[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl git apt-transport-https ca-certificates p7zip-full && [0m
[30;1m5 | [0m[35m    apt-get clean && \[0m
[30;1m6 | [0m[35m    rm -rf /var/lib/apt/lists/*[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/database.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35mdef update_agent_state(agent_id: str, state: str, exit_code: Optional[int] = None) -> bool:[0m
[30;1m136 | [0m[35m    """[0m
[30;1m137 | [0m[35m    Update the state of an agent.[0m
[30;1m138 | [0m[35m    [0m
[30;1m139 | [0m[35m    Args:[0m
[30;1m140 | [0m[35m        agent_id: The ID of the agent to update.[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m    [0m
[30;1m153 | [0m[35m    # Verify container creation with correct environment variables[0m
[30;1m154 | [0m[35m    args, kwargs = mock_client.containers.run.call_args[0m
[30;1m155 | [0m[35m    env = kwargs["environment"][0m
[30;1m156 | [0m[35m    [0m
[30;1m157 | [0m[35m    # Check for prompt and context[0m
[30;1m158 | [0m[35m    assert env["PROMPT"] == "Hello, agent!"[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m    # Mock the catalog load[0m
[30;1m134 | [0m[35m    mock_load_catalog.return_value.tools = mock_catalog["tools"][0m
[30;1m135 | [0m[35m    [0m
[30;1m136 | [0m[35m    # Mock Docker client[0m
[30;1m137 | [0m[35m    mock_client = MagicMock()[0m
[30;1m138 | [0m[35m    mock_docker.from_env.return_value = mock_client[0m
[30;1m139 | [0m[35m    mock_client.ping.return_value = True[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m    assert env["MODEL_ID"] == "anthropic:claude-3-7-sonnet-latest"[0m
[30;1m112 | [0m[35m    assert env["AGENT_ID"] == "agt_test1234"[0m
[30;1m113 | [0m[35m    assert "TOOL_0_CMD" in env[0m
[30;1m114 | [0m[35m    assert "TOOL_0_ARGS" in env[0m
[30;1m115 | [0m[35m    [0m
[30;1m116 | [0m[35m    # Verify state updates[0m
[30;1m117 | [0m[35m    mock_update_state.assert_called_once_with(agent_row.id, "running")[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    env = kwargs["environment"][0m
[30;1m111 | [0m[35m    assert env["MODEL_ID"] == "anthropic:claude-3-7-sonnet-latest"[0m
[30;1m112 | [0m[35m    assert env["AGENT_ID"] == "agt_test1234"[0m
[30;1m113 | [0m[35m    assert "TOOL_0_CMD" in env[0m
[30;1m114 | [0m[35m    assert "TOOL_0_ARGS" in env[0m
[30;1m115 | [0m[35m    [0m
[30;1m116 | [0m[35m    # Verify state updates[0m
[30;1m117 | [0m[35m    mock_update_state.assert_called_once_with(agent_row.id, "running")[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m    assert kwargs["image"] == "agentfactory-agent:latest"[0m
[30;1m108 | [0m[35m    [0m
[30;1m109 | [0m[35m    # Check environment variables[0m
[30;1m110 | [0m[35m    env = kwargs["environment"][0m
[30;1m111 | [0m[35m    assert env["MODEL_ID"] == "anthropic:claude-3-7-sonnet-latest"[0m
[30;1m112 | [0m[35m    assert env["AGENT_ID"] == "agt_test1234"[0m
[30;1m113 | [0m[35m    assert "TOOL_0_CMD" in env[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m    assert success is True[0m
[30;1m96 | [0m[35m    assert error is None[0m
[30;1m97 | [0m[35m    [0m
[30;1m98 | [0m[35m    # Verify Docker client calls[0m
[30;1m99 | [0m[35m    mock_docker.from_env.assert_called_once()[0m
[30;1m100 | [0m[35m    mock_client.ping.assert_called_once()[0m
[30;1m101 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m    # Mock the catalog load[0m
[30;1m67 | [0m[35m    mock_load_catalog.return_value.tools = mock_catalog["tools"][0m
[30;1m68 | [0m[35m    [0m
[30;1m69 | [0m[35m    # Mock Docker client and container[0m
[30;1m70 | [0m[35m    mock_client = MagicMock()[0m
[30;1m71 | [0m[35m    mock_docker.from_env.return_value = mock_client[0m
[30;1m72 | [0m[35m    mock_client.ping.return_value = True[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m• Metrics: active_agents gauge, agent_duration histogram, agent_fail_total counter.[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m• Export Prometheus at /metrics.[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m────────────────────────────────────────[0m
[30;1m322 | [0m[35m11. Testing Plan[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m
[30;1m210 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \[0m
[30;1m211 | [0m[35m && apt-get install -y nodejs[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m# python libs[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m199 | [0m[35mFROM python:3.11-slim[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m# system deps[0m
[30;1m202 | [0m[35mRUN apt-get update && apt-get install -y curl git[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m– REST layer: FastAPI (async) + Pydantic v2.[0m
[30;1m188 | [0m[35m– Container engine: Docker with Python 3.11-slim image.[0m
[30;1m189 | [0m[35m– Deno runtime fetched at container build.[0m
[30;1m190 | [0m[35m– Async process orchestration: aio-docker or subprocess w/ timeouts.[0m
[30;1m191 | [0m[35m– DB (ephemeral metadata): SQLite (MVP) behind async-SQLModel.[0m
[30;1m192 | [0m[35m– Observability: structlog JSON → stdout, Prometheus metrics.[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mThis will send a DELETE request to the server which will terminate the agent's container and update [0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mThe agent status can be queried at any time:[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m```bash[0m
[30;1m70 | [0m[35mcurl http://localhost:8000/agents/agt_12345678/status[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35mcurl -X DELETE http://localhost:8000/agents/agt_12345678[0m
[30;1m63 | [0m[35m```[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mThis will send a DELETE request to the server which will terminate the agent's container and update [0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mThe agent status can be queried at any time:[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m26 | [0m[35m- `MODEL_ID`: The model ID to use for the agent (required)[0m
[30;1m27 | [0m[35m- `PROMPT`: Optional system/task prompt[0m
[30;1m28 | [0m[35m- `CONTEXT`: Optional JSON context for the agent[0m
[30;1m29 | [0m[35m- `TOOL_<n>_CMD`: Command to run for tool <n> (required for at least one tool)[0m
[30;1m30 | [0m[35m- `TOOL_<n>_ARGS`: JSON array of arguments for tool <n>[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mFor example, to run an agent with the execution environment and browser tools:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35m    REST skeleton & catalog loader … 1 week[0m
[30;1m360 | [0m[35m    Docker runtime & happy-path agent execution … 1 week[0m
[30;1m361 | [0m[35m    Streaming layer & TTL cleanup … 1 week[0m
[30;1m362 | [0m[35m    Metrics, quotas, docs, CI … 1 week[0m
[30;1m363 | [0m[35m    Hardening, load test, first deployment … 1 week[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m11.5 Security Tests[0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m– Attempt to mount host dir ⇒ expect denied.[0m
[30;1m348 | [0m[35m– Network egress test when network none.[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m11.6 CI Pipeline[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m11.5 Security Tests[0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m– Attempt to mount host dir ⇒ expect denied.[0m
[30;1m348 | [0m[35m– Network egress test when network none.[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m11.6 CI Pipeline[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m11.3 Failure Injection[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m– Force tool command not found ⇒ expect agent.state == failed.[0m
[30;1m339 | [0m[35m– Kill container mid-run ⇒ server surfaces "E_RUNTIME_CRASH".[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m11.4 Load / Concurrency[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m────────────────────────────────────────[0m
[30;1m299 | [0m[35m9. Configuration[0m
[30;1m300 | [0m[35m────────────────────────────────────────[0m
[30;1m301 | [0m[35menv file or helm values:[0m
[30;1m302 | [0m[35mSERVER_PORT=8000[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35mAPI_KEYS=csv_of_valid_keys[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m253 | [0m[35m────────────────────────────────────────[0m
[30;1m254 | [0m[35m7. Security[0m
[30;1m255 | [0m[35m────────────────────────────────────────[0m
[30;1m256 | [0m[35m• Docker run flags:[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m–‐cpus 1 –‐memory 1g –‐pids-limit 256 –‐network none (except if browser_server needs net: we create [0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m• 500  – Internal (logged w/ request_id)[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m• 503  – Capacity / docker spawn failure → "E_CAPACITY", Retry-After hdr.[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m────────────────────────────────────────[0m
[30;1m254 | [0m[35m7. Security[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35mprint(result.output)[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35mThe AgentController injects ENV vars:[0m
[30;1m234 | [0m[35mMODEL_ID, PROMPT_OR_CONTEXT, TOOL_x_CMD, TOOL_x_ARGSjson.[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m────────────────────────────────────────[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m && apt-get install -y nodejs[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m# python libs[0m
[30;1m214 | [0m[35mRUN pip install --no-cache-dir uv pydantic-ai fastapi aiohttp uvicorn[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35mWORKDIR /app[0m
[30;1m217 | [0m[35mCOPY runtime_entry.py .[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m
[30;1m210 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \[0m
[30;1m211 | [0m[35m && apt-get install -y nodejs[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m# python libs[0m
[30;1m214 | [0m[35mRUN pip install --no-cache-dir uv pydantic-ai fastapi aiohttp uvicorn[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m
[30;1m210 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \[0m
[30;1m211 | [0m[35m && apt-get install -y nodejs[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m# python libs[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m
[30;1m210 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \[0m
[30;1m211 | [0m[35m && apt-get install -y nodejs[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m# python libs[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m
[30;1m210 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \[0m
[30;1m211 | [0m[35m && apt-get install -y nodejs[0m
[30;1m212 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m206 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m
[30;1m210 | [0m[35mRUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35mRUN apt-get update && apt-get install -y curl git[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m206 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m# node + npx[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35mRUN apt-get update && apt-get install -y curl git[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m
[30;1m206 | [0m[35mENV DENO_INSTALL=/root/.deno[0m
[30;1m207 | [0m[35mENV PATH=$DENO_INSTALL/bin:$PATH[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35mFROM python:3.11-slim[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m# system deps[0m
[30;1m202 | [0m[35mRUN apt-get update && apt-get install -y curl git[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35mFROM python:3.11-slim[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m# system deps[0m
[30;1m202 | [0m[35mRUN apt-get update && apt-get install -y curl git[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35mFROM python:3.11-slim[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m# system deps[0m
[30;1m202 | [0m[35mRUN apt-get update && apt-get install -y curl git[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m# deno[0m
[30;1m205 | [0m[35mRUN curl -fsSL https://deno.land/x/install/install.sh | sh[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m4.1 Tech Choices[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m– REST layer: FastAPI (async) + Pydantic v2.[0m
[30;1m188 | [0m[35m– Container engine: Docker with Python 3.11-slim image.[0m
[30;1m189 | [0m[35m– Deno runtime fetched at container build.[0m
[30;1m190 | [0m[35m– Async process orchestration: aio-docker or subprocess w/ timeouts.[0m
[30;1m191 | [0m[35m– DB (ephemeral metadata): SQLite (MVP) behind async-SQLModel.[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m└───────────┘          │ • validates payload │[0m
[30;1m173 | [0m[35m│ • launches Docker   │[0m
[30;1m174 | [0m[35m└─────────▲───────────┘[0m
[30;1m175 | [0m[35m│[0m
[30;1m176 | [0m[35mdocker run --rm -e … agent-runtime[0m
[30;1m177 | [0m[35m│[0m
[30;1m178 | [0m[35m┌───────────┴──────────┐[0m
[30;1m179 | [0m[35m│  uv + pydantic-ai    │[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m┌───────────┐          ┌─────────────────────┐[0m
[30;1m171 | [0m[35mClient ─►  REST API ├────────►│AgentController (Py) │[0m
[30;1m172 | [0m[35m└───────────┘          │ • validates payload │[0m
[30;1m173 | [0m[35m│ • launches Docker   │[0m
[30;1m174 | [0m[35m└─────────▲───────────┘[0m
[30;1m175 | [0m[35m│[0m
[30;1m176 | [0m[35mdocker run --rm -e … agent-runtime[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m• The service exposes an MCP-compliant REST/streaming API.[0m
[30;1m91 | [0m[35m• Each agent executes inside an isolated Docker container that runs the uv+pydantic-ai command shown[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35mThis spec focuses on the MVP catalog agreed in chat; the design is extensible.[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m        - ONE + tool MCP servers injected into the agent's runtime.[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m• The service exposes an MCP-compliant REST/streaming API.[0m
[30;1m91 | [0m[35m• Each agent executes inside an isolated Docker container that runs the uv+pydantic-ai command shown[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35mThis spec focuses on the MVP catalog agreed in chat; the design is extensible.[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m────────────────────────────────────────[0m
[30;1m84 | [0m[35m    Purpose & Scope[0m
[30;1m85 | [0m[35m    • Deliver a "manufacturing" service that lets any Model-Context-Protocol (MCP) client spin up sh[0m
[30;1m86 | [0m[35m        – ONE LLM back-end chosen from a server-maintained catalog.[0m
[30;1m87 | [0m[35m        - ONE + tool MCP servers injected into the agent's runtime.[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mThe agent status can be queried at any time:[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m```bash[0m
[30;1m70 | [0m[35mcurl http://localhost:8000/agents/agt_12345678/status[0m
[30;1m71 | [0m[35m```[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35mWhich returns:[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mYou can manually terminate a running agent before its TTL expires:[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m```bash[0m
[30;1m62 | [0m[35mcurl -X DELETE http://localhost:8000/agents/agt_12345678[0m
[30;1m63 | [0m[35m```[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mThis will send a DELETE request to the server which will terminate the agent's container and update [0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mFor example, to run an agent with the execution environment and browser tools:[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m```bash[0m
[30;1m35 | [0m[35mdocker run --rm \[0m
[30;1m36 | [0m[35m  -e MODEL_ID=anthropic:claude-3-7-sonnet-latest \[0m
[30;1m37 | [0m[35m  -e PROMPT="Help the user with their task" \[0m
[30;1m38 | [0m[35m  -e 'CONTEXT={"user_request": "Find information about pandas in Python"}' \[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mThen run a test agent with:[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m```bash[0m
[30;1m21 | [0m[35mdocker run --rm -e MODEL_ID=test-model -e TOOL_TEST_CMD=echo -e 'TOOL_TEST_ARGS=["Hello, World!"]' a[0m
[30;1m22 | [0m[35m```[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m### Runtime Environment Variables[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mThe agent runtime is containerized to provide isolation and resource limits. You can build the Docke[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m```bash[0m
[30;1m15 | [0m[35mdocker build -t agentfactory-runtime .[0m
[30;1m16 | [0m[35m```[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mThen run a test agent with:[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m## Docker Runtime[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mThe agent runtime is containerized to provide isolation and resource limits. You can build the Docke[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m```bash[0m
[30;1m15 | [0m[35mdocker build -t agentfactory-runtime .[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/readme.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m```bash[0m
[30;1m8 | [0m[35m```[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m## Docker Runtime[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mThe agent runtime is containerized to provide isolation and resource limits. You can build the Docke[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        "TOOL_0_CMD": "deno",[0m
[30;1m119 | [0m[35m        "TOOL_0_ARGS": json.dumps(["run", "stdio"]),[0m
[30;1m120 | [0m[35m        "PROMPT": agent_meta.tools.get("prompt"),[0m
[30;1m121 | [0m[35m        "CONTEXT": json.dumps(agent_meta.tools.get("context"))[0m
[30;1m122 | [0m[35m    }[0m
[30;1m123 | [0m[35m    [0m
[30;1m124 | [0m[35m    # Start container with environment variables[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m        "MODEL_ID": agent_meta.model_id,[0m
[30;1m118 | [0m[35m        "TOOL_0_CMD": "deno",[0m
[30;1m119 | [0m[35m        "TOOL_0_ARGS": json.dumps(["run", "stdio"]),[0m
[30;1m120 | [0m[35m        "PROMPT": agent_meta.tools.get("prompt"),[0m
[30;1m121 | [0m[35m        "CONTEXT": json.dumps(agent_meta.tools.get("context"))[0m
[30;1m122 | [0m[35m    }[0m
[30;1m123 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35mdef test_container_with_agent_meta(docker_image, agent_meta):[0m
[30;1m113 | [0m[35m    """Test running a container with agent metadata."""[0m
[30;1m114 | [0m[35m    # Format environment variables from agent metadata[0m
[30;1m115 | [0m[35m    env = {[0m
[30;1m116 | [0m[35m        "AGENT_ID": agent_meta.id,[0m
[30;1m117 | [0m[35m        "MODEL_ID": agent_meta.model_id,[0m
[30;1m118 | [0m[35m        "TOOL_0_CMD": "deno",[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35mdef test_container_runs_with_environment(docker_image):[0m
[30;1m55 | [0m[35m    """Test that the container runs with the provided environment variables."""[0m
[30;1m56 | [0m[35m    # Create test environment variables[0m
[30;1m57 | [0m[35m    env = {[0m
[30;1m58 | [0m[35m        "AGENT_ID": "agt_test1234",[0m
[30;1m59 | [0m[35m        "MODEL_ID": "test-model",[0m
[30;1m60 | [0m[35m        "TOOL_0_CMD": "deno",[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m        with open(dockerfile_path, "w") as f:[0m
[30;1m33 | [0m[35m            f.write("""FROM python:3.12-slim[0m
[30;1m34 | [0m[35mWORKDIR /app[0m
[30;1m35 | [0m[35mCOPY hello_runtime.py .[0m
[30;1m36 | [0m[35mENV PYTHONUNBUFFERED=1[0m
[30;1m37 | [0m[35mENTRYPOINT ["python", "hello_runtime.py"][0m
[30;1m38 | [0m[35m""")[0m
[30;1m39 | [0m[35m        [0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m@pytest.fixture(scope="module")[0m
[30;1m19 | [0m[35mdef docker_image():[0m
[30;1m20 | [0m[35m    """Build a test Docker image for the tests."""[0m
[30;1m21 | [0m[35m    # Create a temporary directory for the Dockerfile[0m
[30;1m22 | [0m[35m    temp_dir = tempfile.mkdtemp()[0m
[30;1m23 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport tempfile[0m
[30;1m7 | [0m[35mfrom pathlib import Path[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom testcontainers.core.container import DockerContainer[0m
[30;1m12 | [0m[35mfrom testcontainers.core.waiting_utils import wait_for_logs[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_cleanup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m157 | [0m[35m@patch('agentfactory_mcp_server.cleanup.datetime')[0m
[30;1m158 | [0m[35m@patch('agentfactory_mcp_server.cleanup.get_db_session')[0m
[30;1m159 | [0m[35masync def test_cleanup_with_mocked_time(mock_get_db_session, mock_datetime, mock_docker_client):[0m
[30;1m160 | [0m[35m    """Test cleanup with a mocked clock to control time."""[0m
[30;1m161 | [0m[35m    # Set up the mock time[0m
[30;1m162 | [0m[35m    fixed_time = datetime.datetime(2025, 4, 30, 12, 0, 0, tzinfo=datetime.timezone.utc)[0m
[30;1m163 | [0m[35m    mock_datetime.datetime.now.return_value = fixed_time[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_cleanup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m    await cleanup.start()[0m
[30;1m145 | [0m[35m    [0m
[30;1m146 | [0m[35m    # Let it run for a moment[0m
[30;1m147 | [0m[35m    await asyncio.sleep(0.3)  # Should run at least 2-3 times[0m
[30;1m148 | [0m[35m    [0m
[30;1m149 | [0m[35m    # Stop the task[0m
[30;1m150 | [0m[35m    await cleanup.stop()[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m    fixed_time = datetime.datetime(2025, 4, 30, 12, 0, 0, tzinfo=datetime.timezone.utc)[0m
[30;1m163 | [0m[35m    mock_datetime.datetime.now.return_value = fixed_time[0m
[30;1m164 | [0m[35m    [0m
[30;1m165 | [0m[35m    # Create an agent that expires 5 minutes before the fixed time[0m
[30;1m166 | [0m[35m    expired_time = fixed_time - datetime.timedelta(minutes=5)[0m
[30;1m167 | [0m[35m    expired_agent = AgentMeta([0m
[30;1m168 | [0m[35m        id="agt_expired_time",[0m
[30;1m169 | [0m[35m        model_id="test-model",[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m@patch('agentfactory_mcp_server.cleanup.get_db_session')[0m
[30;1m159 | [0m[35masync def test_cleanup_with_mocked_time(mock_get_db_session, mock_datetime, mock_docker_client):[0m
[30;1m160 | [0m[35m    """Test cleanup with a mocked clock to control time."""[0m
[30;1m161 | [0m[35m    # Set up the mock time[0m
[30;1m162 | [0m[35m    fixed_time = datetime.datetime(2025, 4, 30, 12, 0, 0, tzinfo=datetime.timezone.utc)[0m
[30;1m163 | [0m[35m    mock_datetime.datetime.now.return_value = fixed_time[0m
[30;1m164 | [0m[35m    [0m
[30;1m165 | [0m[35m    # Create an agent that expires 5 minutes before the fixed time[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m    # Create the cleanup task with the mock client[0m
[30;1m117 | [0m[35m    cleanup = CleanupTask(docker_client=mock_docker_client)[0m
[30;1m118 | [0m[35m    [0m
[30;1m119 | [0m[35m    # Mock time to a fixed value for testing[0m
[30;1m120 | [0m[35m    fixed_time = datetime.datetime(2025, 4, 30, 12, 0, 0, tzinfo=datetime.timezone.utc)[0m
[30;1m121 | [0m[35m    [0m
[30;1m122 | [0m[35m    # Run the get_expired_agents method[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m@pytest.fixture[0m
[30;1m13 | [0m[35mdef mock_docker_client():[0m
[30;1m14 | [0m[35m    """Create a mock Docker client for testing."""[0m
[30;1m15 | [0m[35m    client = MagicMock()[0m
[30;1m16 | [0m[35m    containers = MagicMock()[0m
[30;1m17 | [0m[35m    client.containers = containers[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m                [0m
[30;1m163 | [0m[35m                # Get container[0m
[30;1m164 | [0m[35m                container = await loop.run_in_executor([0m
[30;1m165 | [0m[35m                    None, lambda: client.containers.get(container_name)[0m
[30;1m166 | [0m[35m                )[0m
[30;1m167 | [0m[35m                [0m
[30;1m168 | [0m[35m                # Kill container[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m65 | [0m[35m        logger.info("Stopped agent cleanup task")[0m
[30;1m66 | [0m[35m    [0m
[30;1m67 | [0m[35m    async def _run_cleanup_loop(self) -> None:[0m
[30;1m68 | [0m[35m        """Main cleanup loop that runs at regular intervals."""[0m
[30;1m69 | [0m[35m        while self.is_running:[0m
[30;1m70 | [0m[35m            try:[0m
[30;1m71 | [0m[35m                expired_count = await self.cleanup_expired_agents()[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m            bool: True if the container was killed or not found[0m
[30;1m152 | [0m[35m        """[0m
[30;1m153 | [0m[35m        try:[0m
[30;1m154 | [0m[35m            # Get or create Docker client[0m
[30;1m155 | [0m[35m            client = self._docker_client or docker.from_env()[0m
[30;1m156 | [0m[35m            [0m
[30;1m157 | [0m[35m            # Try to get and kill the container[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m            List of expired agent metadata[0m
[30;1m110 | [0m[35m        """[0m
[30;1m111 | [0m[35m        with get_db_session() as session:[0m
[30;1m112 | [0m[35m            # Find agents that have expired but aren't marked as expired yet[0m
[30;1m113 | [0m[35m            query = select(AgentMeta).where([0m
[30;1m114 | [0m[35m                (AgentMeta.expires_at < now) & [0m
[30;1m115 | [0m[35m                (AgentMeta.state.notin_(["expired", "succeeded", "failed"]))[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m        Get a list of expired agents from the database.[0m
[30;1m104 | [0m[35m        [0m
[30;1m105 | [0m[35m        Args:[0m
[30;1m106 | [0m[35m            now: Current time for comparison[0m
[30;1m107 | [0m[35m            [0m
[30;1m108 | [0m[35m        Returns:[0m
[30;1m109 | [0m[35m            List of expired agent metadata[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m        Returns:[0m
[30;1m85 | [0m[35m            int: Number of agents cleaned up[0m
[30;1m86 | [0m[35m        """[0m
[30;1m87 | [0m[35m        # Get current time in UTC[0m
[30;1m88 | [0m[35m        now = datetime.datetime.now(datetime.timezone.utc)[0m
[30;1m89 | [0m[35m        [0m
[30;1m90 | [0m[35m        # Get expired agents from the database[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m    [0m
[30;1m80 | [0m[35m    async def cleanup_expired_agents(self) -> int:[0m
[30;1m81 | [0m[35m        """[0m
[30;1m82 | [0m[35m        Find and clean up expired agents.[0m
[30;1m83 | [0m[35m        [0m
[30;1m84 | [0m[35m        Returns:[0m
[30;1m85 | [0m[35m            int: Number of agents cleaned up[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m        [0m
[30;1m33 | [0m[35m        Args:[0m
[30;1m34 | [0m[35m            cleanup_interval: Interval in seconds between cleanup runs[0m
[30;1m35 | [0m[35m            docker_client: Optional Docker client for testing with mocks[0m
[30;1m36 | [0m[35m        """[0m
[30;1m37 | [0m[35m        self.cleanup_interval = cleanup_interval[0m
[30;1m38 | [0m[35m        self.is_running = False[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom typing import List, Optional[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport docker[0m
[30;1m10 | [0m[35mfrom docker.errors import DockerException, NotFound[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom agentfactory_mcp_server.database import AgentMeta, get_db_session, update_agent_state[0m
[30;1m13 | [0m[35mfrom sqlmodel import select[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/agentfactory_mcp_server/cleanup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport datetime[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom typing import List, Optional[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport docker[0m
[30;1m10 | [0m[35mfrom docker.errors import DockerException, NotFound[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/implementation_notes.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m### Benefits[0m
[30;1m57 | [0m[35m- Ensures resources are properly cleaned up and not leaked[0m
[30;1m58 | [0m[35m- Provides control over agent lifecycle for users[0m
[30;1m59 | [0m[35m- Maintains system stability under load by enforcing resource limits[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/implementation_notes.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35m### Implementation Details[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m1. **CleanupTask Class**[0m
[30;1m41 | [0m[35m   - Asynchronous background task that runs at configurable intervals[0m
[30;1m42 | [0m[35m   - Uses Docker SDK to kill containers for expired agents[0m
[30;1m43 | [0m[35m   - Updates agent state to "expired" when TTL is reached[0m
[30;1m44 | [0m[35m   - Proper error handling for Docker connections and container operations[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/implementation_notes.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m3. **Integration with FastAPI**[0m
[30;1m52 | [0m[35m   - Task started during application startup[0m
[30;1m53 | [0m[35m   - Task gracefully stopped during application shutdown[0m
[30;1m54 | [0m[35m   - Efficient database queries to find expired agents[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m### Benefits[0m
[30;1m57 | [0m[35m- Ensures resources are properly cleaned up and not leaked[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/implementation_notes.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m   - Asynchronous background task that runs at configurable intervals[0m
[30;1m42 | [0m[35m   - Uses Docker SDK to kill containers for expired agents[0m
[30;1m43 | [0m[35m   - Updates agent state to "expired" when TTL is reached[0m
[30;1m44 | [0m[35m   - Proper error handling for Docker connections and container operations[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m2. **Agent Termination Logic**[0m
[30;1m47 | [0m[35m   - Asynchronous container termination to avoid blocking the API[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/implementation_notes.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m1. **CleanupTask Class**[0m
[30;1m41 | [0m[35m   - Asynchronous background task that runs at configurable intervals[0m
[30;1m42 | [0m[35m   - Uses Docker SDK to kill containers for expired agents[0m
[30;1m43 | [0m[35m   - Updates agent state to "expired" when TTL is reached[0m
[30;1m44 | [0m[35m   - Proper error handling for Docker connections and container operations[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.dockerignore[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Git[0m
[30;1m2 | [0m[35m.git/[0m
[30;1m3 | [0m[35m.gitignore[0m
[30;1m4 | [0m[35m.github/[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m          # Verify that required tools are installed[0m
[30;1m75 | [0m[35m          docker run --rm $IMAGE deno --version[0m
[30;1m76 | [0m[35m          docker run --rm $IMAGE node --version[0m
[30;1m77 | [0m[35m          docker run --rm $IMAGE npm --version[0m
[30;1m78 | [0m[35m          [0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m          [0m
[30;1m74 | [0m[35m          # Verify that required tools are installed[0m
[30;1m75 | [0m[35m          docker run --rm $IMAGE deno --version[0m
[30;1m76 | [0m[35m          docker run --rm $IMAGE node --version[0m
[30;1m77 | [0m[35m          docker run --rm $IMAGE npm --version[0m
[30;1m78 | [0m[35m          [0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m          [0m
[30;1m74 | [0m[35m          # Verify that required tools are installed[0m
[30;1m75 | [0m[35m          docker run --rm $IMAGE deno --version[0m
[30;1m76 | [0m[35m          docker run --rm $IMAGE node --version[0m
[30;1m77 | [0m[35m          docker run --rm $IMAGE npm --version[0m
[30;1m78 | [0m[35m          [0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m            $IMAGE[0m
[30;1m73 | [0m[35m          [0m
[30;1m74 | [0m[35m          # Verify that required tools are installed[0m
[30;1m75 | [0m[35m          docker run --rm $IMAGE deno --version[0m
[30;1m76 | [0m[35m          docker run --rm $IMAGE node --version[0m
[30;1m77 | [0m[35m          docker run --rm $IMAGE npm --version[0m
[30;1m78 | [0m[35m          [0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m          fi[0m
[30;1m66 | [0m[35m          [0m
[30;1m67 | [0m[35m          # Run a simple test to ensure the image runs properly[0m
[30;1m68 | [0m[35m          docker run --rm \[0m
[30;1m69 | [0m[35m            -e MODEL_ID=test-model \[0m
[30;1m70 | [0m[35m            -e TOOL_TEST_CMD=echo \[0m
[30;1m71 | [0m[35m            -e "TOOL_TEST_ARGS=[\"Hello, World!\"]" \[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m            IMAGE=ghcr.io/${{ github.repository }}/agent-runtime:sha-${{ github.sha }}[0m
[30;1m61 | [0m[35m          else[0m
[30;1m62 | [0m[35m            # For PRs we use the locally built image[0m
[30;1m63 | [0m[35m            docker build -t agent-runtime-test .[0m
[30;1m64 | [0m[35m            IMAGE=agent-runtime-test[0m
[30;1m65 | [0m[35m          fi[0m
[30;1m66 | [0m[35m          [0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m        run: |[0m
[30;1m57 | [0m[35m          # Pull the image we just built[0m
[30;1m58 | [0m[35m          if [ "${{ github.event_name }}" != "pull_request" ]; then[0m
[30;1m59 | [0m[35m            docker pull ghcr.io/${{ github.repository }}/agent-runtime:sha-${{ github.sha }}[0m
[30;1m60 | [0m[35m            IMAGE=ghcr.io/${{ github.repository }}/agent-runtime:sha-${{ github.sha }}[0m
[30;1m61 | [0m[35m          else[0m
[30;1m62 | [0m[35m            # For PRs we use the locally built image[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m          username: ${{ github.actor }}[0m
[30;1m27 | [0m[35m          password: ${{ secrets.GITHUB_TOKEN }}[0m
[30;1m28 | [0m[35m      [0m
[30;1m29 | [0m[35m      - name: Docker meta[0m
[30;1m30 | [0m[35m        id: meta[0m
[30;1m31 | [0m[35m        uses: docker/metadata-action@v5[0m
[30;1m32 | [0m[35m        with:[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m      - name: Checkout repository[0m
[30;1m16 | [0m[35m        uses: actions/checkout@v4[0m
[30;1m17 | [0m[35m      [0m
[30;1m18 | [0m[35m      - name: Set up Docker Buildx[0m
[30;1m19 | [0m[35m        uses: docker/setup-buildx-action@v3[0m
[30;1m20 | [0m[35m      [0m
[30;1m21 | [0m[35m      - name: Login to GitHub Container Registry[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mname: Docker Build & Push[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mon:[0m
[30;1m4 | [0m[35m  push:[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/roadmap.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m• Each atomic step is ≤ ~150 lines diff; introduces one concept.[0m
[30;1m92 | [0m[35m• Every iteration ends in green CI; nothing is half-wired.[0m
[30;1m93 | [0m[35m• First external dependency (Docker) appears only at Phase C after core API is solid.[0m
[30;1m94 | [0m[35m• Failure modes & tests added the same iteration where feature lands (mirrors practices recommended [0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mResult: safe, incremental, yet forward-moving.[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/roadmap.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35m| Iter | Atomic Steps |[0m
[30;1m62 | [0m[35m|------|--------------|[0m
[30;1m63 | [0m[35m|C1 Docker Base Image|C1-1 Create Dockerfile per spec.<br>C1-2 GitHub Action builds & pushes image.<[0m
[30;1m64 | [0m[35m|C2 Container Launcher|C2-1 Implement `runner.launch_agent(agent_row)` using python-docker sdk.<br>C[0m
[30;1m65 | [0m[35m|C3 TTL & Cleanup|C3-1 Background task scans DB for expired agents and kills containers.<br>C3-2 Uni[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m### Phase D — UX & Streaming[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/roadmap.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35mB2-3 Return 201 + agent_id.<br>B2-4 Unit + integration tests.|[0m
[30;1m58 | [0m[35m|B3 Metadata Access|B3-1 Implement GET /agents/{id}/status (reads DB).<br>B3-2 404 & E_SCHEMA error [0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m### Phase C — Agent Runtime <- *Currently Here*[0m
[30;1m61 | [0m[35m| Iter | Atomic Steps |[0m
[30;1m62 | [0m[35m|------|--------------|[0m
[30;1m63 | [0m[35m|C1 Docker Base Image|C1-1 Create Dockerfile per spec.<br>C1-2 GitHub Action builds & pushes image.<[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/roadmap.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m### Phase A — Foundation[0m
[30;1m47 | [0m[35m| Iter | Atomic Steps |[0m
[30;1m48 | [0m[35m|------|--------------|[0m
[30;1m49 | [0m[35m|A1 Repo & Tooling|A1-1 Init git repo, add README + LICENSE.<br>A1-2 Add pyproject (Poetry) + requir[0m
[30;1m50 | [0m[35m|A2 Catalog Loader|A2-1 Define catalog.json (models & tools).<br>A2-2 Implement `agentfactory.catalo[0m
[30;1m51 | [0m[35m|A3 Health Endpoint|A3-1 Scaffold FastAPI app.<br>A3-2 Implement GET /health return 200 OK JSON.<br>[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/roadmap.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m• Persistent metadata store[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mPHASE C — Agent Runtime[0m
[30;1m26 | [0m[35m• Docker image build[0m
[30;1m27 | [0m[35m• Container launcher + TTL cleanup[0m
[30;1m28 | [0m[35m• stdout capture[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35mdef test_validation_error(client):[0m
[30;1m115 | [0m[35m    """Test that validation errors return the correct error format."""[0m
[30;1m116 | [0m[35m    response = client.post("/test-validation", json={"value": -1})[0m
[30;1m117 | [0m[35m    assert response.status_code == status.HTTP_422_UNPROCESSABLE_ENTITY  # FastAPI defaults to 422[0m
[30;1m118 | [0m[35m    data = response.json()[0m
[30;1m119 | [0m[35m    assert "detail" in data  # Standard FastAPI validation error format[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m# def test_internal_error(client):[0m
[30;1m102 | [0m[35m#     """Test that internal errors return the correct error format."""[0m
[30;1m103 | [0m[35m#     response = client.get("/test-500")[0m
[30;1m104 | [0m[35m#     # Verify we get a 500 error[0m
[30;1m105 | [0m[35m#     assert response.status_code == status.HTTP_500_INTERNAL_SERVER_ERROR[0m
[30;1m106 | [0m[35m#     # Parse the response body[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef test_service_unavailable_error(client):[0m
[30;1m93 | [0m[35m    """Test that 503 errors return the correct error format."""[0m
[30;1m94 | [0m[35m    response = client.get("/test-503")[0m
[30;1m95 | [0m[35m    assert response.status_code == status.HTTP_503_SERVICE_UNAVAILABLE[0m
[30;1m96 | [0m[35m    data = response.json()[0m
[30;1m97 | [0m[35m    assert data["error_code"] == "E_CAPACITY"[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35mdef test_unprocessable_entity_error(client):[0m
[30;1m84 | [0m[35m    """Test that 422 errors return the correct error format."""[0m
[30;1m85 | [0m[35m    response = client.get("/test-422")[0m
[30;1m86 | [0m[35m    assert response.status_code == status.HTTP_422_UNPROCESSABLE_ENTITY[0m
[30;1m87 | [0m[35m    data = response.json()[0m
[30;1m88 | [0m[35m    assert data["error_code"] == "E_PARAM"[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35mdef test_conflict_error(client):[0m
[30;1m75 | [0m[35m    """Test that 409 errors return the correct error format."""[0m
[30;1m76 | [0m[35m    response = client.get("/test-409")[0m
[30;1m77 | [0m[35m    assert response.status_code == status.HTTP_409_CONFLICT[0m
[30;1m78 | [0m[35m    data = response.json()[0m
[30;1m79 | [0m[35m    assert data["error_code"] == "E_CATALOG"[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mdef test_not_found_error(client):[0m
[30;1m66 | [0m[35m    """Test that 404 errors return the correct error format."""[0m
[30;1m67 | [0m[35m    response = client.get("/test-404")[0m
[30;1m68 | [0m[35m    assert response.status_code == status.HTTP_404_NOT_FOUND[0m
[30;1m69 | [0m[35m    data = response.json()[0m
[30;1m70 | [0m[35m    assert data["error_code"] == "E_NOT_FOUND"[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m        # Deliberately raise an exception to trigger the error middleware[0m
[30;1m49 | [0m[35m        raise RuntimeError("Test internal error")[0m
[30;1m50 | [0m[35m    [0m
[30;1m51 | [0m[35m    @app.post("/test-validation")[0m
[30;1m52 | [0m[35m    def test_validation(model: TestModel):[0m
[30;1m53 | [0m[35m        return {"result": model.value}[0m
[30;1m54 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    def test_503():[0m
[30;1m44 | [0m[35m        raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Service unavail[0m
[30;1m45 | [0m[35m    [0m
[30;1m46 | [0m[35m    @app.get("/test-500")[0m
[30;1m47 | [0m[35m    def test_500():[0m
[30;1m48 | [0m[35m        # Deliberately raise an exception to trigger the error middleware[0m
[30;1m49 | [0m[35m        raise RuntimeError("Test internal error")[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m    def test_422():[0m
[30;1m40 | [0m[35m        raise HTTPException(status_code=status.HTTP_422_UNPROCESSABLE_ENTITY, detail="Invalid parame[0m
[30;1m41 | [0m[35m    [0m
[30;1m42 | [0m[35m    @app.get("/test-503")[0m
[30;1m43 | [0m[35m    def test_503():[0m
[30;1m44 | [0m[35m        raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Service unavail[0m
[30;1m45 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    def test_409():[0m
[30;1m36 | [0m[35m        raise HTTPException(status_code=status.HTTP_409_CONFLICT, detail="Catalog conflict")[0m
[30;1m37 | [0m[35m    [0m
[30;1m38 | [0m[35m    @app.get("/test-422")[0m
[30;1m39 | [0m[35m    def test_422():[0m
[30;1m40 | [0m[35m        raise HTTPException(status_code=status.HTTP_422_UNPROCESSABLE_ENTITY, detail="Invalid parame[0m
[30;1m41 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    def test_404():[0m
[30;1m32 | [0m[35m        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail="Resource not found")[0m
[30;1m33 | [0m[35m    [0m
[30;1m34 | [0m[35m    @app.get("/test-409")[0m
[30;1m35 | [0m[35m    def test_409():[0m
[30;1m36 | [0m[35m        raise HTTPException(status_code=status.HTTP_409_CONFLICT, detail="Catalog conflict")[0m
[30;1m37 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/test_middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m                raise ValueError("Value must be positive")[0m
[30;1m28 | [0m[35m            return v[0m
[30;1m29 | [0m[35m    [0m
[30;1m30 | [0m[35m    @app.get("/test-404")[0m
[30;1m31 | [0m[35m    def test_404():[0m
[30;1m32 | [0m[35m        raise HTTPException(status_code=status.HTTP_404_NOT_FOUND, detail="Resource not found")[0m
[30;1m33 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        print(f"Prompt: {prompt}")[0m
[30;1m38 | [0m[35m    [0m
[30;1m39 | [0m[35m    # Print context if available[0m
[30;1m40 | [0m[35m    context_json = os.environ.get("CONTEXT")[0m
[30;1m41 | [0m[35m    if context_json:[0m
[30;1m42 | [0m[35m        try:[0m
[30;1m43 | [0m[35m            context = json.loads(context_json)[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    print(f"Found {tool_count} tools")[0m
[30;1m33 | [0m[35m    [0m
[30;1m34 | [0m[35m    # Print prompt if available[0m
[30;1m35 | [0m[35m    prompt = os.environ.get("PROMPT")[0m
[30;1m36 | [0m[35m    if prompt:[0m
[30;1m37 | [0m[35m        print(f"Prompt: {prompt}")[0m
[30;1m38 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m        print(f"Agent ID: {agent_id}")[0m
[30;1m20 | [0m[35m    [0m
[30;1m21 | [0m[35m    # Print model ID if available[0m
[30;1m22 | [0m[35m    model_id = os.environ.get("MODEL_ID")[0m
[30;1m23 | [0m[35m    if model_id:[0m
[30;1m24 | [0m[35m        print(f"Model ID: {model_id}")[0m
[30;1m25 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m    print("Hello from the test runtime!")[0m
[30;1m15 | [0m[35m    [0m
[30;1m16 | [0m[35m    # Print agent ID if available[0m
[30;1m17 | [0m[35m    agent_id = os.environ.get("AGENT_ID")[0m
[30;1m18 | [0m[35m    if agent_id:[0m
[30;1m19 | [0m[35m        print(f"Agent ID: {agent_id}")[0m
[30;1m20 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/tests/hello_runtime.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env python3[0m
[30;1m2 | [0m[35m"""[0m
[30;1m3 | [0m[35mMinimal "hello world" runtime for testing purposes.[0m
[30;1m4 | [0m[35mThis script prints a simple message and environment variables.[0m
[30;1m5 | [0m[35m"""[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m        [0m
[30;1m66 | [0m[35m        # Get the arguments JSON string[0m
[30;1m67 | [0m[35m        args_key = f"TOOL_{tool_name}_ARGS"[0m
[30;1m68 | [0m[35m        args_json = os.environ.get(args_key, "[]")[0m
[30;1m69 | [0m[35m        [0m
[30;1m70 | [0m[35m        try:[0m
[30;1m71 | [0m[35m            args = json.loads(args_json)[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m    Raises:[0m
[30;1m35 | [0m[35m        SystemExit: If the variable is required but not set[0m
[30;1m36 | [0m[35m    """[0m
[30;1m37 | [0m[35m    value = os.environ.get(name)[0m
[30;1m38 | [0m[35m    if required and not value:[0m
[30;1m39 | [0m[35m        print(f"ERROR: Required environment variable {name} not set", file=sys.stderr)[0m
[30;1m40 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35m            [0m
[30;1m62 | [0m[35m        # Extract the tool name from the environment variable[0m
[30;1m63 | [0m[35m        tool_name = key[5:-4]  # Remove TOOL_ prefix and _CMD suffix[0m
[30;1m64 | [0m[35m        cmd = os.environ[key][0m
[30;1m65 | [0m[35m        [0m
[30;1m66 | [0m[35m        # Get the arguments JSON string[0m
[30;1m67 | [0m[35m        args_key = f"TOOL_{tool_name}_ARGS"[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m    """[0m
[30;1m55 | [0m[35m    tools = [][0m
[30;1m56 | [0m[35m    [0m
[30;1m57 | [0m[35m    # Find all TOOL_*_CMD environment variables[0m
[30;1m58 | [0m[35m    for key in os.environ:[0m
[30;1m59 | [0m[35m        if not key.startswith("TOOL_") or not key.endswith("_CMD"):[0m
[30;1m60 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mtry:[0m
[30;1m17 | [0m[35m    from pydantic_ai import Agent[0m
[30;1m18 | [0m[35mexcept ImportError:[0m
[30;1m19 | [0m[35m    print("ERROR: pydantic-ai package not found. Please install it with: pip install pydantic-ai", f[0m
[30;1m20 | [0m[35m    sys.exit(1)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/runtime_entry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m"""[0m
[30;1m3 | [0m[35mRuntime entry point for agent containers.[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mThis script is executed within the container and:[0m
[30;1m6 | [0m[35m1. Sets up MCP servers based on environment variables[0m
[30;1m7 | [0m[35m2. Creates an agent with the spcified model[0m
[30;1m8 | [0m[35m3. Runs the agent with the provided context[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/ci.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m          [0m
[30;1m25 | [0m[35m      - name: Install dependencies[0m
[30;1m26 | [0m[35m        run: |[0m
[30;1m27 | [0m[35m          python -m uv pip install -e ".[dev]"[0m
[30;1m28 | [0m[35m          [0m
[30;1m29 | [0m[35m      - name: Run pre-commit[0m
[30;1m30 | [0m[35m        uses: pre-commit/action@v3.0.0[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m169[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/agentfactory_mcp_server-0.1.0/.github/workflows/ci.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m      - name: Install uv[0m
[30;1m22 | [0m[35m        run: |[0m
[30;1m23 | [0m[35m          pip install uv[0m
[30;1m24 | [0m[35m          [0m
[30;1m25 | [0m[35m      - name: Install dependencies[0m
[30;1m26 | [0m[35m        run: |[0m

169 matches found.
