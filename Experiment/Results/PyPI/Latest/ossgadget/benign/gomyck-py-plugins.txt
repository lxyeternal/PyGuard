[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m163 | [0m[35m  auth_token = request.get_header('Authorization')[0m
[30;1m164 | [0m[35m  if auth_token is None:[0m
[30;1m165 | [0m[35m    auth_token = request.get_cookie('Authorization')[0m
[30;1m166 | [0m[35m  payload = ctoken.get_payload(auth_token, aes_key)[0m
[30;1m167 | [0m[35m  if payload:[0m
[30;1m168 | [0m[35m    return R.ok(to_json_str=False)[0m
[30;1m169 | [0m[35m  return R.error(resp=R.Code.cus_code(401, "Êú™ÊéàÊùÉ"), to_json_str=False)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m162 | [0m[35m    return R.ok(to_json_str=False)[0m
[30;1m163 | [0m[35m  auth_token = request.get_header('Authorization')[0m
[30;1m164 | [0m[35m  if auth_token is None:[0m
[30;1m165 | [0m[35m    auth_token = request.get_cookie('Authorization')[0m
[30;1m166 | [0m[35m  payload = ctoken.get_payload(auth_token, aes_key)[0m
[30;1m167 | [0m[35m  if payload:[0m
[30;1m168 | [0m[35m    return R.ok(to_json_str=False)[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m161 | [0m[35m  if request.path.startswith('/static') or request.path in GlobalState.withOutLoginURI:[0m
[30;1m162 | [0m[35m    return R.ok(to_json_str=False)[0m
[30;1m163 | [0m[35m  auth_token = request.get_header('Authorization')[0m
[30;1m164 | [0m[35m  if auth_token is None:[0m
[30;1m165 | [0m[35m    auth_token = request.get_cookie('Authorization')[0m
[30;1m166 | [0m[35m  payload = ctoken.get_payload(auth_token, aes_key)[0m
[30;1m167 | [0m[35m  if payload:[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m160 | [0m[35mdef common_auth_verify(aes_key):[0m
[30;1m161 | [0m[35m  if request.path.startswith('/static') or request.path in GlobalState.withOutLoginURI:[0m
[30;1m162 | [0m[35m    return R.ok(to_json_str=False)[0m
[30;1m163 | [0m[35m  auth_token = request.get_header('Authorization')[0m
[30;1m164 | [0m[35m  if auth_token is None:[0m
[30;1m165 | [0m[35m    auth_token = request.get_cookie('Authorization')[0m
[30;1m166 | [0m[35m  payload = ctoken.get_payload(auth_token, aes_key)[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m  def connect(self, username=None, password=None, timeout=10):[0m
[30;1m164 | [0m[35m    if username and password:[0m
[30;1m165 | [0m[35m      self.client.username_pw_set(username, password)[0m
[30;1m166 | [0m[35m    self.client.connect_async(host=self.broker_address, port=self.port, keepalive=self.keepalive)[0m
[30;1m167 | [0m[35m    self.client.loop_start()[0m
[30;1m168 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m161 | [0m[35m        sm_tools.decrypt_with_sm4(self.broker_encrypt_key, body)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m  def connect(self, username=None, password=None, timeout=10):[0m
[30;1m164 | [0m[35m    if username and password:[0m
[30;1m165 | [0m[35m      self.client.username_pw_set(username, password)[0m
[30;1m166 | [0m[35m    self.client.connect_async(host=self.broker_address, port=self.port, keepalive=self.keepalive)[0m
[30;1m167 | [0m[35m    self.client.loop_start()[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m160 | [0m[35m      except Exception:[0m
[30;1m161 | [0m[35m        sm_tools.decrypt_with_sm4(self.broker_encrypt_key, body)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m  def connect(self, username=None, password=None, timeout=10):[0m
[30;1m164 | [0m[35m    if username and password:[0m
[30;1m165 | [0m[35m      self.client.username_pw_set(username, password)[0m
[30;1m166 | [0m[35m    self.client.connect_async(host=self.broker_address, port=self.port, keepalive=self.keepalive)[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35mMQTTÊúçÂä°‰ΩøÁî®Á§∫‰æã:[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mmqtt_utils = MQTTUtils("192.168.3.100")[0m
[30;1m19 | [0m[35mmqtt_utils.connect(username="rpa", password="123")[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m# ËÆ¢ÈòÖ[0m
[30;1m22 | [0m[35mmqtt_utils.subscribe("test/topic1", "test/topic2")[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m  with open(work_path.get_app_path() + '/keys/resource_private_key.pem', 'r') as pri:[0m
[30;1m43 | [0m[35m    private_key = RSA.import_key(pri.read())[0m
[30;1m44 | [0m[35m    digest = MD5.new(data_layout(manifest).encode('utf-8'))[0m
[30;1m45 | [0m[35m    return b64encode(pkcs1_15.new(private_key).sign(digest)).decode()[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef sign_verify(manifest: dict, sign_val: str):[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m  :return:[0m
[30;1m41 | [0m[35m  """[0m
[30;1m42 | [0m[35m  with open(work_path.get_app_path() + '/keys/resource_private_key.pem', 'r') as pri:[0m
[30;1m43 | [0m[35m    private_key = RSA.import_key(pri.read())[0m
[30;1m44 | [0m[35m    digest = MD5.new(data_layout(manifest).encode('utf-8'))[0m
[30;1m45 | [0m[35m    return b64encode(pkcs1_15.new(private_key).sign(digest)).decode()[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m  :param manifest: ÂÖÉÊï∞ÊçÆÂ≠óÂÖ∏[0m
[30;1m40 | [0m[35m  :return:[0m
[30;1m41 | [0m[35m  """[0m
[30;1m42 | [0m[35m  with open(work_path.get_app_path() + '/keys/resource_private_key.pem', 'r') as pri:[0m
[30;1m43 | [0m[35m    private_key = RSA.import_key(pri.read())[0m
[30;1m44 | [0m[35m    digest = MD5.new(data_layout(manifest).encode('utf-8'))[0m
[30;1m45 | [0m[35m    return b64encode(pkcs1_15.new(private_key).sign(digest)).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport zipfile[0m
[30;1m7 | [0m[35mfrom base64 import b64decode[0m
[30;1m8 | [0m[35mfrom base64 import b64encode[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom Crypto.Hash import MD5[0m
[30;1m11 | [0m[35mfrom Crypto.PublicKey import RSA[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m4 | [0m[35mimport os[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport zipfile[0m
[30;1m7 | [0m[35mfrom base64 import b64decode[0m
[30;1m8 | [0m[35mfrom base64 import b64encode[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom Crypto.Hash import MD5[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/credis.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m        try:[0m
[30;1m16 | [0m[35m            r: Redis = redis.StrictRedis([0m
[30;1m17 | [0m[35m                host=host, port=port, db=db,[0m
[30;1m18 | [0m[35m                username=username, password=password,[0m
[30;1m19 | [0m[35m                retry_on_timeout=True,[0m
[30;1m20 | [0m[35m                max_connections=max_connections,[0m
[30;1m21 | [0m[35m                decode_responses=decode_responses,[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/credis.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m        try:[0m
[30;1m16 | [0m[35m            r: Redis = redis.StrictRedis([0m
[30;1m17 | [0m[35m                host=host, port=port, db=db,[0m
[30;1m18 | [0m[35m                username=username, password=password,[0m
[30;1m19 | [0m[35m                retry_on_timeout=True,[0m
[30;1m20 | [0m[35m                max_connections=max_connections,[0m
[30;1m21 | [0m[35m                decode_responses=decode_responses,[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/credis.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom ctools import date_utils, thread_pool, string_tools[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mdef init_pool(host: str = 'localhost', port: int = 6379, db: int = 0, password: str = None,[0m
[30;1m12 | [0m[35m              username: str = None, decode_responses: bool = True, max_connections: int = 75,[0m
[30;1m13 | [0m[35m              health_check_interval: int = 30, retry_count: int = 3) -> Redis:[0m
[30;1m14 | [0m[35m    for attempt in range(retry_count):[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m    print("No valid files found to compress.")[0m
[30;1m113 | [0m[35m    return[0m
[30;1m114 | [0m[35m  try:[0m
[30;1m115 | [0m[35m    zip_buffer = create_zip_with_files(file_dict, password)[0m
[30;1m116 | [0m[35m    timestamp = time.strftime('%Y%m%d_%H%M%S', time.localtime())[0m
[30;1m117 | [0m[35m    if zip_name:[0m
[30;1m118 | [0m[35m      base_name = f"{zip_name}_{timestamp}.zip"[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m  Args:[0m
[30;1m92 | [0m[35m      file_paths: List of absolute file paths to compress[0m
[30;1m93 | [0m[35m      output_dir: Directory where the ZIP file will be saved[0m
[30;1m94 | [0m[35m      password: Optional password for the ZIP file[0m
[30;1m95 | [0m[35m      zip_name: Base name for the ZIP file (without extension)[0m
[30;1m96 | [0m[35m  """[0m
[30;1m97 | [0m[35m  if not file_paths:[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m  Args:[0m
[30;1m92 | [0m[35m      file_paths: List of absolute file paths to compress[0m
[30;1m93 | [0m[35m      output_dir: Directory where the ZIP file will be saved[0m
[30;1m94 | [0m[35m      password: Optional password for the ZIP file[0m
[30;1m95 | [0m[35m      zip_name: Base name for the ZIP file (without extension)[0m
[30;1m96 | [0m[35m  """[0m
[30;1m97 | [0m[35m  if not file_paths:[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m86 | [0m[35m    if 'zip_buffer' in locals(): zip_buffer.close()[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mdef compress_specific_files(file_paths:[], output_dir:str, password=None, zip_name=None):[0m
[30;1m90 | [0m[35m  """Compress multiple specified files into a single ZIP archive.[0m
[30;1m91 | [0m[35m  Args:[0m
[30;1m92 | [0m[35m      file_paths: List of absolute file paths to compress[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m    return[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m  try:[0m
[30;1m73 | [0m[35m    zip_buffer = create_zip_with_files(file_dict, password)[0m
[30;1m74 | [0m[35m    timestamp = time.strftime('%Y%m%d_%H%M%S', time.localtime())[0m
[30;1m75 | [0m[35m    if zip_name:[0m
[30;1m76 | [0m[35m      base_name = f"{zip_name}_{timestamp}.zip"[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m  """Walk through directory and compress all files into a single ZIP.[0m
[30;1m53 | [0m[35m  Args:[0m
[30;1m54 | [0m[35m      root_dir: Root directory to scan for files[0m
[30;1m55 | [0m[35m      password: Optional password for the ZIP file[0m
[30;1m56 | [0m[35m      zip_name: Base name for the ZIP file (without extension)[0m
[30;1m57 | [0m[35m  """[0m
[30;1m58 | [0m[35m  file_dict = {}[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m  """Walk through directory and compress all files into a single ZIP.[0m
[30;1m53 | [0m[35m  Args:[0m
[30;1m54 | [0m[35m      root_dir: Root directory to scan for files[0m
[30;1m55 | [0m[35m      password: Optional password for the ZIP file[0m
[30;1m56 | [0m[35m      zip_name: Base name for the ZIP file (without extension)[0m
[30;1m57 | [0m[35m  """[0m
[30;1m58 | [0m[35m  file_dict = {}[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m    raise e[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35mdef process_directory_to_single_zip(root_dir, password=None, zip_name=None):[0m
[30;1m52 | [0m[35m  """Walk through directory and compress all files into a single ZIP.[0m
[30;1m53 | [0m[35m  Args:[0m
[30;1m54 | [0m[35m      root_dir: Root directory to scan for files[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m  try:[0m
[30;1m35 | [0m[35m    if password:[0m
[30;1m36 | [0m[35m      with pyzipper.AESZipFile(zip_buffer, 'w', compression=pyzipper.ZIP_DEFLATED, encryption=pyzipp[0m
[30;1m37 | [0m[35m        zipf.setpassword(password.encode('utf-8'))[0m
[30;1m38 | [0m[35m        for filename, content in file_dict.items():[0m
[30;1m39 | [0m[35m          zipf.writestr(filename, content)[0m
[30;1m40 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m  try:[0m
[30;1m35 | [0m[35m    if password:[0m
[30;1m36 | [0m[35m      with pyzipper.AESZipFile(zip_buffer, 'w', compression=pyzipper.ZIP_DEFLATED, encryption=pyzipp[0m
[30;1m37 | [0m[35m        zipf.setpassword(password.encode('utf-8'))[0m
[30;1m38 | [0m[35m        for filename, content in file_dict.items():[0m
[30;1m39 | [0m[35m          zipf.writestr(filename, content)[0m
[30;1m40 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m  """[0m
[30;1m33 | [0m[35m  zip_buffer = io.BytesIO()[0m
[30;1m34 | [0m[35m  try:[0m
[30;1m35 | [0m[35m    if password:[0m
[30;1m36 | [0m[35m      with pyzipper.AESZipFile(zip_buffer, 'w', compression=pyzipper.ZIP_DEFLATED, encryption=pyzipp[0m
[30;1m37 | [0m[35m        zipf.setpassword(password.encode('utf-8'))[0m
[30;1m38 | [0m[35m        for filename, content in file_dict.items():[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m  Args:[0m
[30;1m27 | [0m[35m      file_dict: Dictionary of {filename: file_content} pairs[0m
[30;1m28 | [0m[35m                 filename = os.path.relpath(file_path, start=root_dir) # Áõ∏ÂØπË∑ØÂæÑËé∑Âèñ, Áî®‰∫éÂú® zip ÂÜÖÁöÑË∑ØÂæÑÂÆö‰Ωç[0m
[30;1m29 | [0m[35m      password: Optional password for the ZIP file[0m
[30;1m30 | [0m[35m  Returns:[0m
[30;1m31 | [0m[35m      BytesIO object containing the ZIP file[0m
[30;1m32 | [0m[35m  """[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m  Args:[0m
[30;1m27 | [0m[35m      file_dict: Dictionary of {filename: file_content} pairs[0m
[30;1m28 | [0m[35m                 filename = os.path.relpath(file_path, start=root_dir) # Áõ∏ÂØπË∑ØÂæÑËé∑Âèñ, Áî®‰∫éÂú® zip ÂÜÖÁöÑË∑ØÂæÑÂÆö‰Ωç[0m
[30;1m29 | [0m[35m      password: Optional password for the ZIP file[0m
[30;1m30 | [0m[35m  Returns:[0m
[30;1m31 | [0m[35m      BytesIO object containing the ZIP file[0m
[30;1m32 | [0m[35m  """[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m  compress_specific_files(files_to_compress, output_directory, zip_password, "my_files")[0m
[30;1m23 | [0m[35m"""[0m
[30;1m24 | [0m[35mdef create_zip_with_files(file_dict, password=None) -> io.BytesIO:[0m
[30;1m25 | [0m[35m  """Compress multiple files into a single password-protected ZIP archive in memory.[0m
[30;1m26 | [0m[35m  Args:[0m
[30;1m27 | [0m[35m      file_dict: Dictionary of {filename: file_content} pairs[0m
[30;1m28 | [0m[35m                 filename = os.path.relpath(file_path, start=root_dir) # Áõ∏ÂØπË∑ØÂæÑËé∑Âèñ, Áî®‰∫éÂú® zip ÂÜÖÁöÑË∑ØÂæÑÂÆö‰Ωç[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m  output_directory = '/Users/haoyang/Desktop'[0m
[30;1m22 | [0m[35m  compress_specific_files(files_to_compress, output_directory, zip_password, "my_files")[0m
[30;1m23 | [0m[35m"""[0m
[30;1m24 | [0m[35mdef create_zip_with_files(file_dict, password=None) -> io.BytesIO:[0m
[30;1m25 | [0m[35m  """Compress multiple files into a single password-protected ZIP archive in memory.[0m
[30;1m26 | [0m[35m  Args:[0m
[30;1m27 | [0m[35m      file_dict: Dictionary of {filename: file_content} pairs[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m    '/path/to/file3.jpg'[0m
[30;1m20 | [0m[35m  ][0m
[30;1m21 | [0m[35m  output_directory = '/Users/haoyang/Desktop'[0m
[30;1m22 | [0m[35m  compress_specific_files(files_to_compress, output_directory, zip_password, "my_files")[0m
[30;1m23 | [0m[35m"""[0m
[30;1m24 | [0m[35mdef create_zip_with_files(file_dict, password=None) -> io.BytesIO:[0m
[30;1m25 | [0m[35m  """Compress multiple files into a single password-protected ZIP archive in memory.[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11 | [0m[35m"""[0m
[30;1m12 | [0m[35m  target_directory = '/Users/haoyang/Desktop/Áü•ËØÜÂ∫ìÊñá‰ª∂'[0m
[30;1m13 | [0m[35m  zip_password = None[0m
[30;1m14 | [0m[35m  process_directory_to_single_zip(target_directory, zip_password, "knowledge_base")[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m  files_to_compress = [[0m
[30;1m17 | [0m[35m    '/path/to/file1.txt',[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m"""[0m
[30;1m12 | [0m[35m  target_directory = '/Users/haoyang/Desktop/Áü•ËØÜÂ∫ìÊñá‰ª∂'[0m
[30;1m13 | [0m[35m  zip_password = None[0m
[30;1m14 | [0m[35m  process_directory_to_single_zip(target_directory, zip_password, "knowledge_base")[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m  files_to_compress = [[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m139 | [0m[35m            bootstrap_servers=self.kafka_url,[0m
[30;1m140 | [0m[35m            value_deserializer=lambda x: x.decode('utf-8'),[0m
[30;1m141 | [0m[35m            sasl_plain_username=self.username,[0m
[30;1m142 | [0m[35m            sasl_plain_password=self.password,[0m
[30;1m143 | [0m[35m            security_protocol='SASL_PLAINTEXT',[0m
[30;1m144 | [0m[35m            sasl_mechanism='PLAIN'[0m
[30;1m145 | [0m[35m          )[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m139 | [0m[35m            bootstrap_servers=self.kafka_url,[0m
[30;1m140 | [0m[35m            value_deserializer=lambda x: x.decode('utf-8'),[0m
[30;1m141 | [0m[35m            sasl_plain_username=self.username,[0m
[30;1m142 | [0m[35m            sasl_plain_password=self.password,[0m
[30;1m143 | [0m[35m            security_protocol='SASL_PLAINTEXT',[0m
[30;1m144 | [0m[35m            sasl_mechanism='PLAIN'[0m
[30;1m145 | [0m[35m          )[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m            bootstrap_servers=self.kafka_url,[0m
[30;1m111 | [0m[35m            value_serializer=lambda x: dumps(x).encode('utf-8'),[0m
[30;1m112 | [0m[35m            sasl_plain_username=self.username,[0m
[30;1m113 | [0m[35m            sasl_plain_password=self.password,[0m
[30;1m114 | [0m[35m            security_protocol='SASL_PLAINTEXT',[0m
[30;1m115 | [0m[35m            sasl_mechanism='PLAIN'[0m
[30;1m116 | [0m[35m          )[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m            bootstrap_servers=self.kafka_url,[0m
[30;1m111 | [0m[35m            value_serializer=lambda x: dumps(x).encode('utf-8'),[0m
[30;1m112 | [0m[35m            sasl_plain_username=self.username,[0m
[30;1m113 | [0m[35m            sasl_plain_password=self.password,[0m
[30;1m114 | [0m[35m            security_protocol='SASL_PLAINTEXT',[0m
[30;1m115 | [0m[35m            sasl_mechanism='PLAIN'[0m
[30;1m116 | [0m[35m          )[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m    self.kafka_url = kafka_url[0m
[30;1m99 | [0m[35m    self.secure = secure[0m
[30;1m100 | [0m[35m    self.username = username[0m
[30;1m101 | [0m[35m    self.password = password[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m  def init_producer(self, acks=1) -> KafkaInstance:[0m
[30;1m104 | [0m[35m    print("[ Producer ] Connecting to Kafka [{}]".format(self.kafka_url))[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m    self.kafka_url = kafka_url[0m
[30;1m99 | [0m[35m    self.secure = secure[0m
[30;1m100 | [0m[35m    self.username = username[0m
[30;1m101 | [0m[35m    self.password = password[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m  def init_producer(self, acks=1) -> KafkaInstance:[0m
[30;1m104 | [0m[35m    print("[ Producer ] Connecting to Kafka [{}]".format(self.kafka_url))[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mclass CKafka:[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m  def __init__(self, kafka_url: str = '127.0.0.1:9092', secure: bool = False, username: str = 'clien[0m
[30;1m98 | [0m[35m    self.kafka_url = kafka_url[0m
[30;1m99 | [0m[35m    self.secure = secure[0m
[30;1m100 | [0m[35m    self.username = username[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mclass CKafka:[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m  def __init__(self, kafka_url: str = '127.0.0.1:9092', secure: bool = False, username: str = 'clien[0m
[30;1m98 | [0m[35m    self.kafka_url = kafka_url[0m
[30;1m99 | [0m[35m    self.secure = secure[0m
[30;1m100 | [0m[35m    self.username = username[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m      try:[0m
[30;1m32 | [0m[35m        if not self.ftp:[0m
[30;1m33 | [0m[35m          ftp = FTP(self.host, timeout=self.timeout)[0m
[30;1m34 | [0m[35m          ftp.login(self.username, self.password)[0m
[30;1m35 | [0m[35m          ftp.set_pasv(True)[0m
[30;1m36 | [0m[35m          self.ftp = ftp[0m
[30;1m37 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m  def __init__(self, host, username, password, timeout=30, max_retries=3, retry_delay=5):[0m
[30;1m19 | [0m[35m    self.host = host[0m
[30;1m20 | [0m[35m    self.username = username[0m
[30;1m21 | [0m[35m    self.password = password[0m
[30;1m22 | [0m[35m    self.ftp:FTP = None[0m
[30;1m23 | [0m[35m    self.timeout = timeout[0m
[30;1m24 | [0m[35m    self.max_retries = max_retries[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m  def __init__(self, host, username, password, timeout=30, max_retries=3, retry_delay=5):[0m
[30;1m19 | [0m[35m    self.host = host[0m
[30;1m20 | [0m[35m    self.username = username[0m
[30;1m21 | [0m[35m    self.password = password[0m
[30;1m22 | [0m[35m    self.ftp:FTP = None[0m
[30;1m23 | [0m[35m    self.timeout = timeout[0m
[30;1m24 | [0m[35m    self.max_retries = max_retries[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m    ftp_password = 'x'[0m
[30;1m16 | [0m[35m    CFTP(ftp_host, ftp_username, ftp_password).upload_file_to_ftp('xx.md', file)[0m
[30;1m17 | [0m[35m  """[0m
[30;1m18 | [0m[35m  def __init__(self, host, username, password, timeout=30, max_retries=3, retry_delay=5):[0m
[30;1m19 | [0m[35m    self.host = host[0m
[30;1m20 | [0m[35m    self.username = username[0m
[30;1m21 | [0m[35m    self.password = password[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m    ftp_host = 'x.x.x.x'[0m
[30;1m14 | [0m[35m    ftp_username = 'x'[0m
[30;1m15 | [0m[35m    ftp_password = 'x'[0m
[30;1m16 | [0m[35m    CFTP(ftp_host, ftp_username, ftp_password).upload_file_to_ftp('xx.md', file)[0m
[30;1m17 | [0m[35m  """[0m
[30;1m18 | [0m[35m  def __init__(self, host, username, password, timeout=30, max_retries=3, retry_delay=5):[0m
[30;1m19 | [0m[35m    self.host = host[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35m  with open('xx/xx.md', 'rb') as file:[0m
[30;1m13 | [0m[35m    ftp_host = 'x.x.x.x'[0m
[30;1m14 | [0m[35m    ftp_username = 'x'[0m
[30;1m15 | [0m[35m    ftp_password = 'x'[0m
[30;1m16 | [0m[35m    CFTP(ftp_host, ftp_username, ftp_password).upload_file_to_ftp('xx.md', file)[0m
[30;1m17 | [0m[35m  """[0m
[30;1m18 | [0m[35m  def __init__(self, host, username, password, timeout=30, max_retries=3, retry_delay=5):[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m  return base64.b64encode(signature).decode()[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m# with open(work_path.get_current_path() + '/private_key.pem', 'r') as key:[0m
[30;1m67 | [0m[35m#   key = key.read()[0m
[30;1m68 | [0m[35m#   sign = sign_msg(key, key)[0m
[30;1m69 | [0m[35m#   with open(work_path.get_current_path() + '/public_key.pem', 'r') as pub:[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35mdef sign_msg(msg, private_key):[0m
[30;1m60 | [0m[35m  private_key = RSA.import_key(private_key)[0m
[30;1m61 | [0m[35m  hash_message = SHA256.new(msg.encode())[0m
[30;1m62 | [0m[35m  signature = pkcs1_15.new(private_key).sign(hash_message)[0m
[30;1m63 | [0m[35m  return base64.b64encode(signature).decode()[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m# Á≠æÂêç[0m
[30;1m59 | [0m[35mdef sign_msg(msg, private_key):[0m
[30;1m60 | [0m[35m  private_key = RSA.import_key(private_key)[0m
[30;1m61 | [0m[35m  hash_message = SHA256.new(msg.encode())[0m
[30;1m62 | [0m[35m  signature = pkcs1_15.new(private_key).sign(hash_message)[0m
[30;1m63 | [0m[35m  return base64.b64encode(signature).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m# Á≠æÂêç[0m
[30;1m59 | [0m[35mdef sign_msg(msg, private_key):[0m
[30;1m60 | [0m[35m  private_key = RSA.import_key(private_key)[0m
[30;1m61 | [0m[35m  hash_message = SHA256.new(msg.encode())[0m
[30;1m62 | [0m[35m  signature = pkcs1_15.new(private_key).sign(hash_message)[0m
[30;1m63 | [0m[35m  return base64.b64encode(signature).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m    return False[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m# Á≠æÂêç[0m
[30;1m59 | [0m[35mdef sign_msg(msg, private_key):[0m
[30;1m60 | [0m[35m  private_key = RSA.import_key(private_key)[0m
[30;1m61 | [0m[35m  hash_message = SHA256.new(msg.encode())[0m
[30;1m62 | [0m[35m  signature = pkcs1_15.new(private_key).sign(hash_message)[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35m# Ëß£ÂØÜÂáΩÊï∞[0m
[30;1m38 | [0m[35mdef decrypt(msg, private_key):[0m
[30;1m39 | [0m[35m  parts = b''[0m
[30;1m40 | [0m[35m  public_key = RSA.import_key(private_key)[0m
[30;1m41 | [0m[35m  cipher = PKCS1_OAEP.new(public_key)[0m
[30;1m42 | [0m[35m  encrypted_bytes = base64.b64decode(msg)[0m
[30;1m43 | [0m[35m  for i in range(0, len(encrypted_bytes), decrypt_CHUNK_SIZE):[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m  return encrypted_base64.decode()[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m# Ëß£ÂØÜÂáΩÊï∞[0m
[30;1m38 | [0m[35mdef decrypt(msg, private_key):[0m
[30;1m39 | [0m[35m  parts = b''[0m
[30;1m40 | [0m[35m  public_key = RSA.import_key(private_key)[0m
[30;1m41 | [0m[35m  cipher = PKCS1_OAEP.new(public_key)[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m  private_key = key.export_key()  # ÂØºÂá∫ÁßÅÈí•[0m
[30;1m16 | [0m[35m  public_key = key.publickey().export_key()  # ÂØºÂá∫ÂÖ¨Èí•[0m
[30;1m17 | [0m[35m  with open("private_key.pem", "wb") as f:[0m
[30;1m18 | [0m[35m    f.write(private_key)[0m
[30;1m19 | [0m[35m  with open("public_key.pem", "wb") as f:[0m
[30;1m20 | [0m[35m    f.write(public_key)[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35m  key = RSA.generate(bits)[0m
[30;1m15 | [0m[35m  private_key = key.export_key()  # ÂØºÂá∫ÁßÅÈí•[0m
[30;1m16 | [0m[35m  public_key = key.publickey().export_key()  # ÂØºÂá∫ÂÖ¨Èí•[0m
[30;1m17 | [0m[35m  with open("private_key.pem", "wb") as f:[0m
[30;1m18 | [0m[35m    f.write(private_key)[0m
[30;1m19 | [0m[35m  with open("public_key.pem", "wb") as f:[0m
[30;1m20 | [0m[35m    f.write(public_key)[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mdef generate_rsa_keypair(bits=2048):[0m
[30;1m14 | [0m[35m  key = RSA.generate(bits)[0m
[30;1m15 | [0m[35m  private_key = key.export_key()  # ÂØºÂá∫ÁßÅÈí•[0m
[30;1m16 | [0m[35m  public_key = key.publickey().export_key()  # ÂØºÂá∫ÂÖ¨Èí•[0m
[30;1m17 | [0m[35m  with open("private_key.pem", "wb") as f:[0m
[30;1m18 | [0m[35m    f.write(private_key)[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m60 | [0m[35m  private_key = RSA.import_key(private_key)[0m
[30;1m61 | [0m[35m  hash_message = SHA256.new(msg.encode())[0m
[30;1m62 | [0m[35m  signature = pkcs1_15.new(private_key).sign(hash_message)[0m
[30;1m63 | [0m[35m  return base64.b64encode(signature).decode()[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m# with open(work_path.get_current_path() + '/private_key.pem', 'r') as key:[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m49 | [0m[35m  public_key = RSA.import_key(public_key)[0m
[30;1m50 | [0m[35m  hash_message = SHA256.new(msg.encode())[0m
[30;1m51 | [0m[35m  try:[0m
[30;1m52 | [0m[35m    pkcs1_15.new(public_key).verify(hash_message, base64.b64decode(sign.encode()))[0m
[30;1m53 | [0m[35m    return True[0m
[30;1m54 | [0m[35m  except Exception as e:[0m
[30;1m55 | [0m[35m    print('Á≠æÂêçÈ™åËØÅÂ§±Ë¥•: {}'.format(e))[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m39 | [0m[35m  parts = b''[0m
[30;1m40 | [0m[35m  public_key = RSA.import_key(private_key)[0m
[30;1m41 | [0m[35m  cipher = PKCS1_OAEP.new(public_key)[0m
[30;1m42 | [0m[35m  encrypted_bytes = base64.b64decode(msg)[0m
[30;1m43 | [0m[35m  for i in range(0, len(encrypted_bytes), decrypt_CHUNK_SIZE):[0m
[30;1m44 | [0m[35m    parts += cipher.decrypt(encrypted_bytes[i:i + decrypt_CHUNK_SIZE])[0m
[30;1m45 | [0m[35m  return parts.decode()[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m31 | [0m[35m  cipher = PKCS1_OAEP.new(public_key)[0m
[30;1m32 | [0m[35m  for i in range(0, len(msg), ENCRYPT_CHUNK_SIZE):[0m
[30;1m33 | [0m[35m    parts += cipher.encrypt(msg[i:i + ENCRYPT_CHUNK_SIZE].encode())[0m
[30;1m34 | [0m[35m  encrypted_base64 = base64.b64encode(parts)[0m
[30;1m35 | [0m[35m  return encrypted_base64.decode()[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m# Ëß£ÂØÜÂáΩÊï∞[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom Crypto.Cipher import PKCS1_OAEP[0m
[30;1m4 | [0m[35mfrom Crypto.PublicKey import RSA[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/b64.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m4 | [0m[35m  return base64.b64encode(param.encode('UTF-8')).decode('UTF-8')[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef decode(param: str):[0m
[30;1m7 | [0m[35m  return base64.b64decode(param.encode('UTF-8')).decode('UTF-8')[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/b64.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mdef encode(param: str):[0m
[30;1m4 | [0m[35m  return base64.b64encode(param.encode('UTF-8')).decode('UTF-8')[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef decode(param: str):[0m
[30;1m7 | [0m[35m  return base64.b64decode(param.encode('UTF-8')).decode('UTF-8')[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/b64.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mdef encode(param: str):[0m
[30;1m4 | [0m[35m  return base64.b64encode(param.encode('UTF-8')).decode('UTF-8')[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m"""[0m
[30;1m41 | [0m[35mThe string form of the URL is[0m
[30;1m42 | [0m[35mdialect[+driver]://user:password@host/dbname[?key=value..][0m
[30;1m43 | [0m[35mwhere ``dialect`` is a database name such as ``mysql``, ``oracle``, ``postgresql``, etc.[0m
[30;1m44 | [0m[35mand ``driver`` the name of a DBAPI such as ``psycopg2``, ``pyodbc``, ``cx_oracle``, etc.  Alternativ[0m
[30;1m45 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/work_path.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m50 | [0m[35m  Ëé∑Âèñ‰∏¥Êó∂Êñá‰ª∂Â§πÊâÄÂú®Ë∑ØÂæÑ[0m
[30;1m51 | [0m[35m  :return: ‰∏¥Êó∂Êñá‰ª∂Â§πÊâÄÂú®Ë∑ØÂæÑ[0m
[30;1m52 | [0m[35m  """[0m
[30;1m53 | [0m[35m  return os.path.join(os.environ.get('TEMP'), subPath)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mdef get_Users_path(subPath: str = '') -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ctoken.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef get_payload(token, secret_key):[0m
[30;1m19 | [0m[35m  try:[0m
[30;1m20 | [0m[35m    payload = jwt.decode(token, secret_key, algorithms=['HS256'])[0m
[30;1m21 | [0m[35m    return DictWrapper(payload)[0m
[30;1m22 | [0m[35m  except Exception as e:[0m
[30;1m23 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ctoken.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m  payload.update({'exp': time.time() + expired})[0m
[30;1m16 | [0m[35m  return jwt.encode(payload, secret_key, algorithm='HS256')[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef get_payload(token, secret_key):[0m
[30;1m19 | [0m[35m  try:[0m
[30;1m20 | [0m[35m    payload = jwt.decode(token, secret_key, algorithms=['HS256'])[0m
[30;1m21 | [0m[35m    return DictWrapper(payload)[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ctoken.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mdef gen_token(payload: {}, secret_key, expired: int=3600) -> str:[0m
[30;1m15 | [0m[35m  payload.update({'exp': time.time() + expired})[0m
[30;1m16 | [0m[35m  return jwt.encode(payload, secret_key, algorithm='HS256')[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef get_payload(token, secret_key):[0m
[30;1m19 | [0m[35m  try:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/ctoken.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mtoken_header = 'Authorization'[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mdef gen_token(payload: {}, secret_key, expired: int=3600) -> str:[0m
[30;1m15 | [0m[35m  payload.update({'exp': time.time() + expired})[0m
[30;1m16 | [0m[35m  return jwt.encode(payload, secret_key, algorithm='HS256')[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35m  if sm2_crypt is not None:[0m
[30;1m11 | [0m[35m    print('sm2 is already init!!!')[0m
[30;1m12 | [0m[35m    return[0m
[30;1m13 | [0m[35m  sm2_crypt = sm2.CryptSM2(private_key=private_key, public_key=public_key, asn1=True, mode=1)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef sign_with_sm2(sign_data: str) -> str:[0m
[30;1m16 | [0m[35m  if sm2_crypt is None: raise Exception('sm2 is not init!!!')[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35m  if sm2_crypt is not None:[0m
[30;1m11 | [0m[35m    print('sm2 is already init!!!')[0m
[30;1m12 | [0m[35m    return[0m
[30;1m13 | [0m[35m  sm2_crypt = sm2.CryptSM2(private_key=private_key, public_key=public_key, asn1=True, mode=1)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef sign_with_sm2(sign_data: str) -> str:[0m
[30;1m16 | [0m[35m  if sm2_crypt is None: raise Exception('sm2 is not init!!!')[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35msm2_crypt: sm2.CryptSM2 = None[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdef init(private_key: str, public_key: str):[0m
[30;1m9 | [0m[35m  global sm2_crypt[0m
[30;1m10 | [0m[35m  if sm2_crypt is not None:[0m
[30;1m11 | [0m[35m    print('sm2 is already init!!!')[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m45 | [0m[35mdef decrypt_with_sm4(key: bytes, decrypt_text: str):[0m
[30;1m46 | [0m[35m  crypt_sm4 = CryptSM4()[0m
[30;1m47 | [0m[35m  crypt_sm4.set_key(key, SM4_DECRYPT)[0m
[30;1m48 | [0m[35m  decrypt_value = crypt_sm4.crypt_ecb(base64.b64decode(decrypt_text))[0m
[30;1m49 | [0m[35m  return decrypt_value.decode()[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m38 | [0m[35mdef encrypt_with_sm4(key: bytes, encrypt_text: str):[0m
[30;1m39 | [0m[35m  crypt_sm4 = CryptSM4()[0m
[30;1m40 | [0m[35m  crypt_sm4.set_key(key, SM4_ENCRYPT)[0m
[30;1m41 | [0m[35m  encrypt_value = base64.b64encode(crypt_sm4.crypt_ecb(encrypt_text.encode()))[0m
[30;1m42 | [0m[35m  return encrypt_value.decode()[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mdef decrypt_with_sm2(encrypt_data: str) -> str:[0m
[30;1m34 | [0m[35m  if sm2_crypt is None: raise Exception('sm2 is not init!!!')[0m
[30;1m35 | [0m[35m  return sm2_crypt.decrypt(base64.b64decode(encrypt_data.encode('UTF-8'))).decode('UTF-8')[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mdef encrypt_with_sm4(key: bytes, encrypt_text: str):[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef encrypt_with_sm2(encrypt_data: str) -> str:[0m
[30;1m29 | [0m[35m  if sm2_crypt is None: raise Exception('sm2 is not init!!!')[0m
[30;1m30 | [0m[35m  return base64.b64encode(sm2_crypt.encrypt(encrypt_data.encode('UTF-8'))).decode('UTF-8')[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mdef decrypt_with_sm2(encrypt_data: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom gmssl import sm2[0m
[30;1m4 | [0m[35mfrom gmssl.sm4 import CryptSM4, SM4_ENCRYPT, SM4_DECRYPT[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/metrics.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m# @app.before_request[0m
[30;1m18 | [0m[35m# def check_authentication():[0m
[30;1m19 | [0m[35m#   auth = request.authorization[0m
[30;1m20 | [0m[35m#   if not auth or auth.username != USERNAME or auth.password != PASSWORD:[0m
[30;1m21 | [0m[35m#     return Response([0m
[30;1m22 | [0m[35m#       "Unauthorized", 401, {"WWW-Authenticate": 'Basic realm="Login Required"'}[0m
[30;1m23 | [0m[35m#     )[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/metrics.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m# @app.before_request[0m
[30;1m18 | [0m[35m# def check_authentication():[0m
[30;1m19 | [0m[35m#   auth = request.authorization[0m
[30;1m20 | [0m[35m#   if not auth or auth.username != USERNAME or auth.password != PASSWORD:[0m
[30;1m21 | [0m[35m#     return Response([0m
[30;1m22 | [0m[35m#       "Unauthorized", 401, {"WWW-Authenticate": 'Basic realm="Login Required"'}[0m
[30;1m23 | [0m[35m#     )[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/bottle_webserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m@app.post('/login')[0m
[30;1m37 | [0m[35mdef login(params):[0m
[30;1m38 | [0m[35m  return R.ok(token.gen_token({'username': 'xxx'}, secret_key, 3600))[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m@app.get('/demo')[0m
[30;1m41 | [0m[35m@bottle_web_base.rule('DOC:DOWNLOAD')[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/bottle_webserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m# ÈÄöÁî®ÁöÑÈâ¥ÊùÉÊñπÊ≥ï[0m
[30;1m32 | [0m[35m@bottle_web_base.before_intercept(0)[0m
[30;1m33 | [0m[35mdef token_check():[0m
[30;1m34 | [0m[35m  return bottle_web_base.common_auth_verify(secret_key)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m@app.post('/login')[0m
[30;1m37 | [0m[35mdef login(params):[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ctools/bottle_webserver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35mfrom ctools import bottle_web_base, token, bottle_webserver[0m
[30;1m26 | [0m[35mfrom ctools.api_result import R[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35msecret_key = "xxx"[0m
[30;1m29 | [0m[35mapp = bottle_web_base.init_app('Â≠êÊ®°ÂùóÂÜô context_path, ‰∏ªÊ®°ÂùóÂ∞±‰∏çÁî®ÂÜô‰ªª‰Ωï‰∏úË•ø')[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m# ÈÄöÁî®ÁöÑÈâ¥ÊùÉÊñπÊ≥ï[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/win_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m    if control:[0m
[30;1m36 | [0m[35m      #ÂΩìÂâçÊéß‰ª∂‰ø°ÊÅØ[0m
[30;1m37 | [0m[35m      global current_control[0m
[30;1m38 | [0m[35m      current_control = control[0m
[30;1m39 | [0m[35m      #ÁªòÂà∂Áü©ÂΩ¢[0m
[30;1m40 | [0m[35m      canvas_info = win_canvas.CanvasInfo(control.Name, [[0m
[30;1m41 | [0m[35m        (control.BoundingRectangle.left, control.BoundingRectangle.top),[0m
[30;1m42 | [0m[35m        (control.BoundingRectangle.right, control.BoundingRectangle.top),[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/win_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m    try:[0m
[30;1m31 | [0m[35m      control = auto.ControlFromCursor()[0m
[30;1m32 | [0m[35m    except Exception as e:[0m
[30;1m33 | [0m[35m      print("No control found {}".format(e))[0m
[30;1m34 | [0m[35m      return[0m
[30;1m35 | [0m[35m    if control:[0m
[30;1m36 | [0m[35m      #ÂΩìÂâçÊéß‰ª∂‰ø°ÊÅØ[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/win_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m    win_canvas.data_queue.put(win_canvas.CanvasInfo(msg_type=win_canvas.MSGType.BOTTOM))[0m
[30;1m29 | [0m[35m    time.sleep(0.2)[0m
[30;1m30 | [0m[35m    try:[0m
[30;1m31 | [0m[35m      control = auto.ControlFromCursor()[0m
[30;1m32 | [0m[35m    except Exception as e:[0m
[30;1m33 | [0m[35m      print("No control found {}".format(e))[0m
[30;1m34 | [0m[35m      return[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/win_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport pyautogui[0m
[30;1m5 | [0m[35mimport uiautomation as auto[0m
[30;1m6 | [0m[35mfrom pynput import keyboard[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/call.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport sched[0m
[30;1m2 | [0m[35mimport threading[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom functools import wraps[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# annotation[0m
[30;1m7 | [0m[35mdef once(func):[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/date_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom datetime import datetime, timedelta[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdef get_date():[0m
[30;1m5 | [0m[35m  return time.strftime('%Y-%m-%d', time.localtime(time.time()))[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/pty_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    start_time = time.time()[0m
[30;1m47 | [0m[35m    while True:[0m
[30;1m48 | [0m[35m      if not self._read_queue.empty():[0m
[30;1m49 | [0m[35m        line = self._read_queue.get()[0m
[30;1m50 | [0m[35m        content += line[0m
[30;1m51 | [0m[35m        start_time = time.time()[0m
[30;1m52 | [0m[35m        if end_str is not None and end_str in line:[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/pty_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport _thread[0m
[30;1m2 | [0m[35mimport queue[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m# ‰º™ÁªàÁ´Ø‰∫§‰∫í[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom winpty import PtyProcess[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m      for td in table_data:[0m
[30;1m230 | [0m[35m        start_position = td.get('start_position')[0m
[30;1m231 | [0m[35m        data = td.get('data')[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        for r in range(0, len(data)):[0m
[30;1m234 | [0m[35m          for c in range(0, len(data[r])):[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m      border = Border(left=side, right=side, top=side, bottom=side)[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m      for td in table_data:[0m
[30;1m230 | [0m[35m        start_position = td.get('start_position')[0m
[30;1m231 | [0m[35m        data = td.get('data')[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        for r in range(0, len(data)):[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m      sheet = wb.get_sheet(0)[0m
[30;1m208 | [0m[35m      for td in table_data:[0m
[30;1m209 | [0m[35m        start_position = td.get('start_position')[0m
[30;1m210 | [0m[35m        data = td.get('data')[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        for r in range(0, len(data)):[0m
[30;1m213 | [0m[35m          for c in range(0, len(data[r])):[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m      sheet = wb.get_sheet(0)[0m
[30;1m208 | [0m[35m      for td in table_data:[0m
[30;1m209 | [0m[35m        start_position = td.get('start_position')[0m
[30;1m210 | [0m[35m        data = td.get('data')[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        for r in range(0, len(data)):[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m          t_cell._tc.get_or_add_tcPr().append(parse_xml(r'<w:shd {} w:fill="{bgColor}"/>'.format(nsd[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        paragraph.paragraph_format.alignment = EXCEL_WORD_ALIGNMENT.get(style.alignment.horizontal)[0m
[30;1m168 | [0m[35m        t_cell.vertical_alignment = EXCEL_WORD_VERTICAL.get(style.alignment.vertical)[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    # ÂêàÂπ∂ÂçïÂÖÉÊ†º[0m
[30;1m171 | [0m[35m    for mc in merged_cells:[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        if style.bg_color:[0m
[30;1m165 | [0m[35m          t_cell._tc.get_or_add_tcPr().append(parse_xml(r'<w:shd {} w:fill="{bgColor}"/>'.format(nsd[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        paragraph.paragraph_format.alignment = EXCEL_WORD_ALIGNMENT.get(style.alignment.horizontal)[0m
[30;1m168 | [0m[35m        t_cell.vertical_alignment = EXCEL_WORD_VERTICAL.get(style.alignment.vertical)[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    # ÂêàÂπ∂ÂçïÂÖÉÊ†º[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m    """[0m
[30;1m99 | [0m[35m    borders = OxmlElement('w:tblBorders')[0m
[30;1m100 | [0m[35m    for tag in ('bottom', 'top', 'left', 'right', 'insideV', 'insideH'):[0m
[30;1m101 | [0m[35m      edge_data = kwargs.get(tag)[0m
[30;1m102 | [0m[35m      if edge_data:[0m
[30;1m103 | [0m[35m        any_border = OxmlElement(f'w:{tag}')[0m
[30;1m104 | [0m[35m        for key in ["sz", "val", "color", "space", "shadow"]:[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        if index <= len(table_data) - 1:[0m
[30;1m56 | [0m[35m          td = table_data[index][0m
[30;1m57 | [0m[35m          start_position = td.get('start_position')[0m
[30;1m58 | [0m[35m          data = td.get('data')[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m          for r in range(0, len(data)):[0m
[30;1m61 | [0m[35m            for c in range(0, len(data[r])):[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/word_fill.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m      for index, table in enumerate(doc.tables):[0m
[30;1m55 | [0m[35m        if index <= len(table_data) - 1:[0m
[30;1m56 | [0m[35m          td = table_data[index][0m
[30;1m57 | [0m[35m          start_position = td.get('start_position')[0m
[30;1m58 | [0m[35m          data = td.get('data')[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m          for r in range(0, len(data)):[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/pacth.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m      print('start exec snapshot patch {}'.format(max_method_name))[0m
[30;1m36 | [0m[35m      method = getattr(self, max_method_name)[0m
[30;1m37 | [0m[35m      method()[0m
[30;1m38 | [0m[35m      print('snapshot patch {} update success'.format(max_method_name))[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m  def patch_V220(self):[0m
[30;1m41 | [0m[35m    pass[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/pacth.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m        method = getattr(self, method_name)[0m
[30;1m31 | [0m[35m        print('start exec patch {}'.format(method_name))[0m
[30;1m32 | [0m[35m        method()[0m
[30;1m33 | [0m[35m        print('patch {} update success'.format(method_name))[0m
[30;1m34 | [0m[35m    if self.snapshot and not exec_max_method:[0m
[30;1m35 | [0m[35m      print('start exec snapshot patch {}'.format(max_method_name))[0m
[30;1m36 | [0m[35m      method = getattr(self, max_method_name)[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/screenshot_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport tkinter as tk[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport pyautogui[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/dict_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35mclass DictWrapper(dict):[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m  def __getattr__(self, key):[0m
[30;1m9 | [0m[35m    res = self.get(key)[0m
[30;1m10 | [0m[35m    if res is None:[0m
[30;1m11 | [0m[35m      raise AttributeError(f" ==>> {key} <<== Not Found In This Entity!!!")[0m
[30;1m12 | [0m[35m    if isinstance(res, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m      queryStr = request.query.decode('utf-8')[0m
[30;1m119 | [0m[35m      page_info = PageInfo([0m
[30;1m120 | [0m[35m        page_size=10 if request.headers.get('page_size') is None else int(request.headers.get('page_[0m
[30;1m121 | [0m[35m        page_index=1 if request.headers.get('page_index') is None else int(request.headers.get('page[0m
[30;1m122 | [0m[35m      )[0m
[30;1m123 | [0m[35m      queryStr.page_info = page_info[0m
[30;1m124 | [0m[35m      return func(params=queryStr, *args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m      queryStr = request.query.decode('utf-8')[0m
[30;1m119 | [0m[35m      page_info = PageInfo([0m
[30;1m120 | [0m[35m        page_size=10 if request.headers.get('page_size') is None else int(request.headers.get('page_[0m
[30;1m121 | [0m[35m        page_index=1 if request.headers.get('page_index') is None else int(request.headers.get('page[0m
[30;1m122 | [0m[35m      )[0m
[30;1m123 | [0m[35m      queryStr.page_info = page_info[0m
[30;1m124 | [0m[35m      return func(params=queryStr, *args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m    if request.method == 'GET':[0m
[30;1m118 | [0m[35m      queryStr = request.query.decode('utf-8')[0m
[30;1m119 | [0m[35m      page_info = PageInfo([0m
[30;1m120 | [0m[35m        page_size=10 if request.headers.get('page_size') is None else int(request.headers.get('page_[0m
[30;1m121 | [0m[35m        page_index=1 if request.headers.get('page_index') is None else int(request.headers.get('page[0m
[30;1m122 | [0m[35m      )[0m
[30;1m123 | [0m[35m      queryStr.page_info = page_info[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m    if request.method == 'GET':[0m
[30;1m118 | [0m[35m      queryStr = request.query.decode('utf-8')[0m
[30;1m119 | [0m[35m      page_info = PageInfo([0m
[30;1m120 | [0m[35m        page_size=10 if request.headers.get('page_size') is None else int(request.headers.get('page_[0m
[30;1m121 | [0m[35m        page_index=1 if request.headers.get('page_index') is None else int(request.headers.get('page[0m
[30;1m122 | [0m[35m      )[0m
[30;1m123 | [0m[35m      queryStr.page_info = page_info[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m    if func_has_params.get(request.fullpath) is None:[0m
[30;1m110 | [0m[35m      sig = inspect.signature(func)[0m
[30;1m111 | [0m[35m      params = sig.parameters[0m
[30;1m112 | [0m[35m      if not params.get('params'):[0m
[30;1m113 | [0m[35m        func_has_params[request.fullpath] = False[0m
[30;1m114 | [0m[35m        return func(*args, **kwargs)[0m
[30;1m115 | [0m[35m      else:[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m  def decorated(*args, **kwargs):[0m
[30;1m107 | [0m[35m    if func_has_params.get(request.fullpath) is not None and not func_has_params.get(request.fullpat[0m
[30;1m108 | [0m[35m      return func(*args, **kwargs)[0m
[30;1m109 | [0m[35m    if func_has_params.get(request.fullpath) is None:[0m
[30;1m110 | [0m[35m      sig = inspect.signature(func)[0m
[30;1m111 | [0m[35m      params = sig.parameters[0m
[30;1m112 | [0m[35m      if not params.get('params'):[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35mdef params_resolve(func):[0m
[30;1m105 | [0m[35m  @wraps(func)[0m
[30;1m106 | [0m[35m  def decorated(*args, **kwargs):[0m
[30;1m107 | [0m[35m    if func_has_params.get(request.fullpath) is not None and not func_has_params.get(request.fullpat[0m
[30;1m108 | [0m[35m      return func(*args, **kwargs)[0m
[30;1m109 | [0m[35m    if func_has_params.get(request.fullpath) is None:[0m
[30;1m110 | [0m[35m      sig = inspect.signature(func)[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35mdef params_resolve(func):[0m
[30;1m105 | [0m[35m  @wraps(func)[0m
[30;1m106 | [0m[35m  def decorated(*args, **kwargs):[0m
[30;1m107 | [0m[35m    if func_has_params.get(request.fullpath) is not None and not func_has_params.get(request.fullpat[0m
[30;1m108 | [0m[35m      return func(*args, **kwargs)[0m
[30;1m109 | [0m[35m    if func_has_params.get(request.fullpath) is None:[0m
[30;1m110 | [0m[35m      sig = inspect.signature(func)[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_web_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35mdef enable_cors():[0m
[30;1m77 | [0m[35m  response.headers['Access-Control-Allow-Origin'] = '*'[0m
[30;1m78 | [0m[35m  response.headers['Access-Control-Allow-Methods'] = 'GET, POST, PUT, DELETE, OPTIONS'[0m
[30;1m79 | [0m[35m  request_headers = request.headers.get('Access-Control-Request-Headers')[0m
[30;1m80 | [0m[35m  response.headers['Access-Control-Allow-Headers'] = request_headers if request_headers else ''[0m
[30;1m81 | [0m[35m  response.headers['Access-Control-Expose-Headers'] = '*'[0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    # try:[0m
[30;1m117 | [0m[35m    if message.topic != self.publish_topic and message.payload:[0m
[30;1m118 | [0m[35m      mqtt_msg = cjson.loads(message.payload.decode())[0m
[30;1m119 | [0m[35m      trace_id = mqtt_msg.get('trace_id')[0m
[30;1m120 | [0m[35m      if trace_id in self._publish_trace_id:[0m
[30;1m121 | [0m[35m        mqtt_resp = MQTTResponse(**mqtt_msg)[0m
[30;1m122 | [0m[35m        self._received_message[trace_id] = mqtt_resp[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    self.status: int = kwargs.get('status')[0m
[30;1m62 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m63 | [0m[35m    self.msg: str = kwargs.get('msg')[0m
[30;1m64 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m  def __str__(self):[0m
[30;1m67 | [0m[35m    res_str = ""[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    self.trace_id: str = kwargs.get('trace_id')[0m
[30;1m61 | [0m[35m    self.status: int = kwargs.get('status')[0m
[30;1m62 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m63 | [0m[35m    self.msg: str = kwargs.get('msg')[0m
[30;1m64 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m  def __str__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m60 | [0m[35m    self.trace_id: str = kwargs.get('trace_id')[0m
[30;1m61 | [0m[35m    self.status: int = kwargs.get('status')[0m
[30;1m62 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m63 | [0m[35m    self.msg: str = kwargs.get('msg')[0m
[30;1m64 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m60 | [0m[35m    self.trace_id: str = kwargs.get('trace_id')[0m
[30;1m61 | [0m[35m    self.status: int = kwargs.get('status')[0m
[30;1m62 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m63 | [0m[35m    self.msg: str = kwargs.get('msg')[0m
[30;1m64 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m  def __init__(self, **kwargs):[0m
[30;1m59 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m60 | [0m[35m    self.trace_id: str = kwargs.get('trace_id')[0m
[30;1m61 | [0m[35m    self.status: int = kwargs.get('status')[0m
[30;1m62 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m63 | [0m[35m    self.msg: str = kwargs.get('msg')[0m
[30;1m64 | [0m[35m    self.body = kwargs.get('body')[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m  def __init__(self, **kwargs):[0m
[30;1m59 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m60 | [0m[35m    self.trace_id: str = kwargs.get('trace_id')[0m
[30;1m61 | [0m[35m    self.status: int = kwargs.get('status')[0m
[30;1m62 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m63 | [0m[35m    self.msg: str = kwargs.get('msg')[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35mclass MQTTResponse:[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m  def __init__(self, **kwargs):[0m
[30;1m59 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m60 | [0m[35m    self.trace_id: str = kwargs.get('trace_id')[0m
[30;1m61 | [0m[35m    self.status: int = kwargs.get('status')[0m
[30;1m62 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m    self.trace_id: str = kwargs.get('trace_id') if kwargs.get('trace_id') else string_tools.get_uuid[0m
[30;1m45 | [0m[35m    self.client_id: str = kwargs.get('client_id')[0m
[30;1m46 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m47 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m  def __str__(self):[0m
[30;1m50 | [0m[35m    res_str = ""[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m44 | [0m[35m    self.trace_id: str = kwargs.get('trace_id') if kwargs.get('trace_id') else string_tools.get_uuid[0m
[30;1m45 | [0m[35m    self.client_id: str = kwargs.get('client_id')[0m
[30;1m46 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m47 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m  def __str__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m44 | [0m[35m    self.trace_id: str = kwargs.get('trace_id') if kwargs.get('trace_id') else string_tools.get_uuid[0m
[30;1m45 | [0m[35m    self.client_id: str = kwargs.get('client_id')[0m
[30;1m46 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m47 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m  def __str__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m  def __init__(self, **kwargs):[0m
[30;1m43 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m44 | [0m[35m    self.trace_id: str = kwargs.get('trace_id') if kwargs.get('trace_id') else string_tools.get_uuid[0m
[30;1m45 | [0m[35m    self.client_id: str = kwargs.get('client_id')[0m
[30;1m46 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m47 | [0m[35m    self.body = kwargs.get('body')[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m  def __init__(self, **kwargs):[0m
[30;1m43 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m44 | [0m[35m    self.trace_id: str = kwargs.get('trace_id') if kwargs.get('trace_id') else string_tools.get_uuid[0m
[30;1m45 | [0m[35m    self.client_id: str = kwargs.get('client_id')[0m
[30;1m46 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m47 | [0m[35m    self.body = kwargs.get('body')[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m  def __init__(self, **kwargs):[0m
[30;1m43 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m44 | [0m[35m    self.trace_id: str = kwargs.get('trace_id') if kwargs.get('trace_id') else string_tools.get_uuid[0m
[30;1m45 | [0m[35m    self.client_id: str = kwargs.get('client_id')[0m
[30;1m46 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m
[30;1m47 | [0m[35m    self.body = kwargs.get('body')[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35mclass MQTTRequest:[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m  def __init__(self, **kwargs):[0m
[30;1m43 | [0m[35m    self.event: str = kwargs.get('event')[0m
[30;1m44 | [0m[35m    self.trace_id: str = kwargs.get('trace_id') if kwargs.get('trace_id') else string_tools.get_uuid[0m
[30;1m45 | [0m[35m    self.client_id: str = kwargs.get('client_id')[0m
[30;1m46 | [0m[35m    self.time: str = kwargs.get('time') if kwargs.get('time') else date_utils.get_date_time()[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/mqtt_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom enum import Enum[0m
[30;1m3 | [0m[35mfrom typing import Dict[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom ctools.dict_wrapper import DictWrapper as DictToObj[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport sys[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport traceback[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom ctools import call, work_path[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m248 | [0m[35m          installed = "%s-%s" % (m_name[0], m_name[1]) in freeze_msg or "%s==%s" % (m_name[0], m_nam[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        if not installed:[0m
[30;1m251 | [0m[35m          cmd = [pip_path, "install", "--no-dependencies", m_path][0m
[30;1m252 | [0m[35m          proc = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE,[0m
[30;1m253 | [0m[35m                                  stderr=subprocess.PIPE, close_fds=True)[0m
[30;1m254 | [0m[35m          if proc:[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    freeze_msg = ""[0m
[30;1m234 | [0m[35m    pip_path = os.path.join(Server.pythonHome, 'Scripts/pip.exe')[0m
[30;1m235 | [0m[35m    cmd = [pip_path, "freeze"][0m
[30;1m236 | [0m[35m    proc = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE,[0m
[30;1m237 | [0m[35m                            stderr=subprocess.PIPE, close_fds=True)[0m
[30;1m238 | [0m[35m    if proc:[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m  enhancePath = os.path.join(work_path.get_Users_path(), "Public/enhance", 'enhance-{}.zip'.format(g[0m
[30;1m272 | [0m[35m  originPath = os.path.join(work_path.get_Users_path(), "Public/enhance", 'origin-{}.zip'.format(get[0m
[30;1m273 | [0m[35m  initFlag = os.path.join(work_path.get_Users_path(), "Public/enhance", 'init')[0m
[30;1m274 | [0m[35m  flagValue = 'can not find dest dir'[0m
[30;1m275 | [0m[35m  os.makedirs(os.path.join(work_path.get_Users_path(), "Public/enhance"), exist_ok=True)[0m
[30;1m276 | [0m[35m  if not os.path.exists(initFlag):[0m
[30;1m277 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport shutil[0m
[30;1m3 | [0m[35mimport socket[0m
[30;1m4 | [0m[35mimport subprocess[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport zipfile[0m
[30;1m7 | [0m[35mfrom configparser import ConfigParser[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom PIL import Image[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/console.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m  def send(self):[0m
[30;1m48 | [0m[35m    # Ëé∑ÂèñËæìÂÖ•Ê°Ü‰∏≠ÁöÑÊñáÊú¨Âπ∂ÊâìÂç∞Âà∞ÊéßÂà∂Âè∞[0m
[30;1m49 | [0m[35m    text = self.entry.get()[0m
[30;1m50 | [0m[35m    print(text)[0m
[30;1m51 | [0m[35m    self.entry.delete(0, tk.END)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/gomyck_py_plugins-1.3.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mThis package need python version >= 3.9[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m```shell[0m
[30;1m48 | [0m[35mpip install gomyck-tools[0m
[30;1m49 | [0m[35m```[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m## usage[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m          manifest = json.loads(zf.read(file.filename))[0m
[30;1m82 | [0m[35m          break[0m
[30;1m83 | [0m[35m      # Ê†°È™åÁ≠æÂêç[0m
[30;1m84 | [0m[35m      if sign_verify(manifest, manifest.get('signature')):[0m
[30;1m85 | [0m[35m        resource_path = os.path.join(application.Upload.source_pkg_path, manifest['name'])[0m
[30;1m86 | [0m[35m        shutil.rmtree(resource_path, ignore_errors=True)[0m
[30;1m87 | [0m[35m        zf.extractall(resource_path)[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport zipfile[0m
[30;1m7 | [0m[35mfrom base64 import b64decode[0m
[30;1m8 | [0m[35mfrom base64 import b64encode[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom Crypto.Hash import MD5[0m
[30;1m11 | [0m[35mfrom Crypto.PublicKey import RSA[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/resource_bundle_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport os[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport zipfile[0m
[30;1m7 | [0m[35mfrom base64 import b64decode[0m
[30;1m8 | [0m[35mfrom base64 import b64encode[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom Crypto.Hash import MD5[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/credis.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mdef add_lock(r: Redis, key: str, timeout: int = 30):[0m
[30;1m35 | [0m[35m  if r.exists(key):[0m
[30;1m36 | [0m[35m    expire_time = r.get(key)[0m
[30;1m37 | [0m[35m    if date_utils.time_diff_in_seconds(expire_time, date_utils.get_date_time()) > 0:[0m
[30;1m38 | [0m[35m      return True[0m
[30;1m39 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/http_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mdef post(url, data=None, json=None, headers=None, files=None):[0m
[30;1m18 | [0m[35m  result = ""[0m
[30;1m19 | [0m[35m  response = requests.post(url, data=data, json=json, files=files, headers=headers, timeout=60, veri[0m
[30;1m20 | [0m[35m  response.raise_for_status()[0m
[30;1m21 | [0m[35m  if response.status_code == 200:[0m
[30;1m22 | [0m[35m    result = response.content[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/http_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35mdef get(url, params=None, headers=None):[0m
[30;1m5 | [0m[35m  result = ""[0m
[30;1m6 | [0m[35m  try:[0m
[30;1m7 | [0m[35m    response = requests.get(url, params=params, headers=headers, timeout=60, verify=False)[0m
[30;1m8 | [0m[35m    response.raise_for_status()[0m
[30;1m9 | [0m[35m    if response.status_code == 200:[0m
[30;1m10 | [0m[35m      result = response.content[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/czip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport io[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mimport pyzipper[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m"""[0m
[30;1m12 | [0m[35m  target_directory = '/Users/haoyang/Desktop/Áü•ËØÜÂ∫ìÊñá‰ª∂'[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/browser_element_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m  g_driver = explore.init()[0m
[30;1m29 | [0m[35m  driver = g_driver[0m
[30;1m30 | [0m[35m  driver.maximize_window()[0m
[30;1m31 | [0m[35m  driver.get(url)[0m
[30;1m32 | [0m[35m  start_keyboard_listener()[0m
[30;1m33 | [0m[35m  handle_arr = [driver.current_window_handle][0m
[30;1m34 | [0m[35m  close_page_flag = False[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/browser_element_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m237 | [0m[35m  def init():[0m
[30;1m238 | [0m[35m    option = Options()[0m
[30;1m239 | [0m[35m    option.binary_location = Scheduler.CHROME_PATH[0m
[30;1m240 | [0m[35m    service = Service(Scheduler.CHROME_DRIVER_PATH)[0m
[30;1m241 | [0m[35m    return webdriver.Chrome(options=option, service=service)[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m  listen_script = """[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/browser_element_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mfrom selenium import webdriver[0m
[30;1m9 | [0m[35mfrom selenium.common import NoSuchElementException, WebDriverException, NoSuchWindowException[0m
[30;1m10 | [0m[35mfrom selenium.webdriver.chrome.options import Options[0m
[30;1m11 | [0m[35mfrom selenium.webdriver.chrome.service import Service[0m
[30;1m12 | [0m[35mfrom selenium.webdriver.common.by import By[0m
[30;1m13 | [0m[35mfrom urllib3.exceptions import MaxRetryError[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mfrom ctools import application, string_tools[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/browser_element_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom business.common.constant import Scheduler[0m
[30;1m5 | [0m[35mfrom lxml import etree[0m
[30;1m6 | [0m[35mfrom lxml import html[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m  if _time_zone:[0m
[30;1m188 | [0m[35m    cron_obj.set_current(datetime.now(tz=_time_zone))[0m
[30;1m189 | [0m[35m  next_time = int(cron_obj.get_next())[0m
[30;1m190 | [0m[35m  if scheduler_map.get(timer_task_name) is None:[0m
[30;1m191 | [0m[35m    scheduler_meta = SchedulerMeta()[0m
[30;1m192 | [0m[35m    scheduler_meta.timer_task_name = timer_task_name[0m
[30;1m193 | [0m[35m    scheduler_meta.switch = True[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m  :return:[0m
[30;1m178 | [0m[35m  """[0m
[30;1m179 | [0m[35m  for timer_task_name in scheduler_map:[0m
[30;1m180 | [0m[35m    scheduler_map.get(timer_task_name).switch = False[0m
[30;1m181 | [0m[35m  if wait_thread:[0m
[30;1m182 | [0m[35m    wait_thread.join()[0m
[30;1m183 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35mdef stop(timer_task_name):[0m
[30;1m167 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m168 | [0m[35m    scheduler_map.get(timer_task_name).switch = False[0m
[30;1m169 | [0m[35m    time.sleep(1)[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m161 | [0m[35m    scheduler_map.get(timer_task_name).status = False[0m
[30;1m162 | [0m[35m    if not scheduler_map.get(timer_task_name).switch:[0m
[30;1m163 | [0m[35m      scheduler_map.get(timer_task_name).scheduler.cancel(scheduler_map[timer_task_name].event)[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35mdef stop(timer_task_name):[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35mdef inactive(timer_task_name):[0m
[30;1m160 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m161 | [0m[35m    scheduler_map.get(timer_task_name).status = False[0m
[30;1m162 | [0m[35m    if not scheduler_map.get(timer_task_name).switch:[0m
[30;1m163 | [0m[35m      scheduler_map.get(timer_task_name).scheduler.cancel(scheduler_map[timer_task_name].event)[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35mdef inactive(timer_task_name):[0m
[30;1m160 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m161 | [0m[35m    scheduler_map.get(timer_task_name).status = False[0m
[30;1m162 | [0m[35m    if not scheduler_map.get(timer_task_name).switch:[0m
[30;1m163 | [0m[35m      scheduler_map.get(timer_task_name).scheduler.cancel(scheduler_map[timer_task_name].event)[0m
[30;1m164 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35mdef get_switch(timer_task_name):[0m
[30;1m153 | [0m[35m  switch = True[0m
[30;1m154 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m155 | [0m[35m    switch = scheduler_map.get(timer_task_name).switch[0m
[30;1m156 | [0m[35m  return switch[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35mdef active(timer_task_name):[0m
[30;1m149 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m150 | [0m[35m    scheduler_map.get(timer_task_name).status = True[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35mdef get_switch(timer_task_name):[0m
[30;1m153 | [0m[35m  switch = True[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35mdef is_active(timer_task_name):[0m
[30;1m142 | [0m[35m  res = False[0m
[30;1m143 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m144 | [0m[35m    res = scheduler_map.get(timer_task_name).switch or scheduler_map.get(timer_task_name).status[0m
[30;1m145 | [0m[35m  return res[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35mdef is_active(timer_task_name):[0m
[30;1m142 | [0m[35m  res = False[0m
[30;1m143 | [0m[35m  if timer_task_name in scheduler_map:[0m
[30;1m144 | [0m[35m    res = scheduler_map.get(timer_task_name).switch or scheduler_map.get(timer_task_name).status[0m
[30;1m145 | [0m[35m  return res[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m  """[0m
[30;1m125 | [0m[35m  global _switch, _info_handler, _error_handler[0m
[30;1m126 | [0m[35m  if _switch:[0m
[30;1m127 | [0m[35m    raise RuntimeError("the crontab was already started...")[0m
[30;1m128 | [0m[35m  if info_handler:[0m
[30;1m129 | [0m[35m    _info_handler = info_handler[0m
[30;1m130 | [0m[35m  if error_handler:[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mdef apply_cron_task(cron_expr, func, params, timer_task_name=None, till_time_stamp=None):[0m
[30;1m83 | [0m[35m  """[0m
[30;1m84 | [0m[35m  cron_task decorator to register a function as crontab task[0m
[30;1m85 | [0m[35m  :param func: task callback function[0m
[30;1m86 | [0m[35m  :param params: transparent parameters[0m
[30;1m87 | [0m[35m  :param cron_expr: the croniter accepted cron_expression. NOTICE: the default timezone is UTC and c[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m# @annotation[0m
[30;1m52 | [0m[35mdef cron_task(cron_expr: str, task_name: str = None, till_time_stamp: int = None):[0m
[30;1m53 | [0m[35m  """[0m
[30;1m54 | [0m[35m  cron_task decorator to register a function as crontab task[0m
[30;1m55 | [0m[35m  :param cron_expr: the croniter accepted cron_expression. NOTICE: the default timezone is UTC and c[0m
[30;1m56 | [0m[35m  `set_time_zone`. The format is `min hour day month weekday [sec]`[0m
[30;1m57 | [0m[35m  :param till_time_stamp: run this jog till when. None means forever[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cron_lite.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m# coding: utf-8[0m
[30;1m3 | [0m[35mimport sched[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport traceback[0m
[30;1m7 | [0m[35mfrom datetime import datetime[0m
[30;1m8 | [0m[35mfrom functools import wraps[0m
[30;1m9 | [0m[35mfrom typing import Optional, Dict[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m  # FutureRecordMetadata ÂèØ‰ª•Ê∑ªÂä†ÂõûË∞É, Êù•ÁõëÂê¨ÊòØÂê¶ÂèëÈÄÅÊàêÂäü[0m
[30;1m54 | [0m[35m  # r.add_callback(lambda x: print(x))[0m
[30;1m55 | [0m[35m  # r.get() ÂèØ‰ª•ÂêåÊ≠•Ëé∑ÂèñÁªìÊûú[0m
[30;1m56 | [0m[35m  def send_msg(self, topic, msg, key: str=None, partition:int=None) -> FutureRecordMetadata:[0m
[30;1m57 | [0m[35m    if self.producer is None: raise RuntimeError("Producer is not initialized")[0m
[30;1m58 | [0m[35m    if self.quited: return[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        if not self.consumer.config['enable_auto_commit'] and res: self.consumer.commit()[0m
[30;1m82 | [0m[35m        funcList.append(func.__name__)[0m
[30;1m83 | [0m[35m      end_time = time.time()[0m
[30;1m84 | [0m[35m      if end_time - begin_time > 1: print(f"kafka consume too slow!!! {funcList} time cost: ", f'{ro[0m
[30;1m85 | [0m[35m      funcList.clear()[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m  def shutdown(self):[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mfrom ctools.cjson import dumps[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m"""[0m
[30;1m16 | [0m[35mimport time[0m
[30;1m17 | [0m[35mfrom datetime import datetime[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mfrom ctools import thread_pool, string_tools[0m
[30;1m20 | [0m[35mfrom ctools.ckafka import CKafka[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/ckafka.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m__author__ = 'haoyang'[0m
[30;1m4 | [0m[35m__date__ = '2024/9/5 10:39'[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom threading import Thread, Lock[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom kafka import KafkaProducer, errors, KafkaConsumer[0m
[30;1m10 | [0m[35mfrom kafka.producer.future import FutureRecordMetadata[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35mdef get_public_ip():[0m
[30;1m77 | [0m[35m  import requests[0m
[30;1m78 | [0m[35m  try:[0m
[30;1m79 | [0m[35m    response = requests.get("https://api.ipify.org?format=json")[0m
[30;1m80 | [0m[35m    ip = response.json()["ip"][0m
[30;1m81 | [0m[35m    return ip[0m
[30;1m82 | [0m[35m  except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m        dec_code = cjson.loads(sm_tools.decrypt_with_sm4(MACHINE_KEY, file_code))[0m
[30;1m27 | [0m[35m        origin_code = dec_code.get("origin_code")[0m
[30;1m28 | [0m[35m        if origin_code == origin_machine_code:[0m
[30;1m29 | [0m[35m          MachineInfo.machine_code = dec_code.get("hash_code")[0m
[30;1m30 | [0m[35m          print("use current machine code {}".format(MachineInfo.machine_code))[0m
[30;1m31 | [0m[35m          return MachineInfo.machine_code[0m
[30;1m32 | [0m[35m      except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m      dec_code = ''[0m
[30;1m25 | [0m[35m      try:[0m
[30;1m26 | [0m[35m        dec_code = cjson.loads(sm_tools.decrypt_with_sm4(MACHINE_KEY, file_code))[0m
[30;1m27 | [0m[35m        origin_code = dec_code.get("origin_code")[0m
[30;1m28 | [0m[35m        if origin_code == origin_machine_code:[0m
[30;1m29 | [0m[35m          MachineInfo.machine_code = dec_code.get("hash_code")[0m
[30;1m30 | [0m[35m          print("use current machine code {}".format(MachineInfo.machine_code))[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m    ip = '127.0.0.1'[0m
[30;1m100 | [0m[35m  finally:[0m
[30;1m101 | [0m[35m    s.close()[0m
[30;1m102 | [0m[35m  return ip[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef get_remote_ipv4():[0m
[30;1m105 | [0m[35m  from bottle import request[0m
[30;1m106 | [0m[35m  try:[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m    s.connect(("8.8.8.8", 80))[0m
[30;1m97 | [0m[35m    ip = s.getsockname()[0][0m
[30;1m98 | [0m[35m  except Exception:[0m
[30;1m99 | [0m[35m    ip = '127.0.0.1'[0m
[30;1m100 | [0m[35m  finally:[0m
[30;1m101 | [0m[35m    s.close()[0m
[30;1m102 | [0m[35m  return ip[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m  s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)[0m
[30;1m95 | [0m[35m  try:[0m
[30;1m96 | [0m[35m    s.connect(("8.8.8.8", 80))[0m
[30;1m97 | [0m[35m    ip = s.getsockname()[0][0m
[30;1m98 | [0m[35m  except Exception:[0m
[30;1m99 | [0m[35m    ip = '127.0.0.1'[0m
[30;1m100 | [0m[35m  finally:[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m  try:[0m
[30;1m79 | [0m[35m    response = requests.get("https://api.ipify.org?format=json")[0m
[30;1m80 | [0m[35m    ip = response.json()["ip"][0m
[30;1m81 | [0m[35m    return ip[0m
[30;1m82 | [0m[35m  except Exception as e:[0m
[30;1m83 | [0m[35m    return f"Failed to get public IP: {e}"[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mdef get_local_ipv4():[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sys_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m  import requests[0m
[30;1m78 | [0m[35m  try:[0m
[30;1m79 | [0m[35m    response = requests.get("https://api.ipify.org?format=json")[0m
[30;1m80 | [0m[35m    ip = response.json()["ip"][0m
[30;1m81 | [0m[35m    return ip[0m
[30;1m82 | [0m[35m  except Exception as e:[0m
[30;1m83 | [0m[35m    return f"Failed to get public IP: {e}"[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m          ftp = FTP(self.host, timeout=self.timeout)[0m
[30;1m34 | [0m[35m          ftp.login(self.username, self.password)[0m
[30;1m35 | [0m[35m          ftp.set_pasv(True)[0m
[30;1m36 | [0m[35m          self.ftp = ftp[0m
[30;1m37 | [0m[35m        try:[0m
[30;1m38 | [0m[35m          self.ftp.cwd(ftp_directory)[0m
[30;1m39 | [0m[35m        except error_perm:[0m
[30;1m40 | [0m[35m          print(f"FTP ÁõÆÂΩï‰∏çÂ≠òÂú®Ôºö{ftp_directory}")[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m    for attempt in range(self.max_retries):[0m
[30;1m31 | [0m[35m      try:[0m
[30;1m32 | [0m[35m        if not self.ftp:[0m
[30;1m33 | [0m[35m          ftp = FTP(self.host, timeout=self.timeout)[0m
[30;1m34 | [0m[35m          ftp.login(self.username, self.password)[0m
[30;1m35 | [0m[35m          ftp.set_pasv(True)[0m
[30;1m36 | [0m[35m          self.ftp = ftp[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m          ftp = FTP(self.host, timeout=self.timeout)[0m
[30;1m34 | [0m[35m          ftp.login(self.username, self.password)[0m
[30;1m35 | [0m[35m          ftp.set_pasv(True)[0m
[30;1m36 | [0m[35m          self.ftp = ftp[0m
[30;1m37 | [0m[35m        try:[0m
[30;1m38 | [0m[35m          self.ftp.cwd(ftp_directory)[0m
[30;1m39 | [0m[35m        except error_perm:[0m
[30;1m40 | [0m[35m          print(f"FTP ÁõÆÂΩï‰∏çÂ≠òÂú®Ôºö{ftp_directory}")[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m    for attempt in range(self.max_retries):[0m
[30;1m31 | [0m[35m      try:[0m
[30;1m32 | [0m[35m        if not self.ftp:[0m
[30;1m33 | [0m[35m          ftp = FTP(self.host, timeout=self.timeout)[0m
[30;1m34 | [0m[35m          ftp.login(self.username, self.password)[0m
[30;1m35 | [0m[35m          ftp.set_pasv(True)[0m
[30;1m36 | [0m[35m          self.ftp = ftp[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m    self.username = username[0m
[30;1m21 | [0m[35m    self.password = password[0m
[30;1m22 | [0m[35m    self.ftp:FTP = None[0m
[30;1m23 | [0m[35m    self.timeout = timeout[0m
[30;1m24 | [0m[35m    self.max_retries = max_retries[0m
[30;1m25 | [0m[35m    self.retry_delay = retry_delay[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m  def upload_file_to_ftp(self, file_name, file:io.BytesIO, ftp_directory='/'):[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/cftp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m__date__ = '2025/1/24 08:53'[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport io[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom ftplib import FTP, error_perm, error_temp[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mclass CFTP:[0m
[30;1m11 | [0m[35m  """[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/rsa.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom Crypto.Cipher import PKCS1_OAEP[0m
[30;1m4 | [0m[35mfrom Crypto.PublicKey import RSA[0m
[30;1m5 | [0m[35mfrom Crypto.Signature import pkcs1_15[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/b64.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mdef encode(param: str):[0m
[30;1m4 | [0m[35m  return base64.b64encode(param.encode('UTF-8')).decode('UTF-8')[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m@contextlib.contextmanager[0m
[30;1m115 | [0m[35mdef get_session(db_key: str='default') -> Session:[0m
[30;1m116 | [0m[35m  thread_local.db_key = db_key[0m
[30;1m117 | [0m[35m  if sm:=sessionMakers.get(db_key):[0m
[30;1m118 | [0m[35m    s = sm()[0m
[30;1m119 | [0m[35m  else:[0m
[30;1m120 | [0m[35m    raise ValueError("Invalid db_key: {}".format(db_key))[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m  if db_url.startswith('mysql'):[0m
[30;1m57 | [0m[35m    import pymysql[0m
[30;1m58 | [0m[35m    pymysql.install_as_MySQLdb()[0m
[30;1m59 | [0m[35m  if inited_db.get(db_key): raise Exception('db {} already init!!!'.format(db_key))[0m
[30;1m60 | [0m[35m  global engines, sessionMakers[0m
[30;1m61 | [0m[35m  engine, sessionMaker = _create_connection(db_url=db_url, connect_args=connect_args, pool_size=pool[0m
[30;1m62 | [0m[35m  engines[db_key] = engine[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/database.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m# sqlite connect_args={"check_same_thread": False}  db_url=sqlite:///{}.format(db_url)[0m
[30;1m50 | [0m[35m# sqlite Êï∞ÊçÆÂ∫ì, ÂàùÂßãÂåñ‰πãÂêé, ‰ºòÂåñ‰∏Ä‰∏ãÈÖçÁΩÆ[0m
[30;1m51 | [0m[35m# $ sqlite3 app.db[0m
[30;1m52 | [0m[35m# > PRAGMA journal_mode=WAL; ËÆæÁΩÆ‰∫ãÂä°ÁöÑÊ®°Âºè, wal ÂÖÅËÆ∏ËØªÂÜôÂπ∂Âèë, ‰ΩÜÊòØ‰ºöÈ¢ùÂ§ñÂàõÂª∫‰ø©Êñá‰ª∂[0m
[30;1m53 | [0m[35m# > PRAGMA synchronous=NORMAL; ËÆæÁΩÆÂÜôÁõòÁ≠ñÁï•, ÈªòËÆ§ÊòØ FULL, Êó•Âøó,Êï∞ÊçÆÈÉΩËêΩ, ËÆæÁΩÆÊàê NORMAL, Êó•ÂøóÂÜôÂÆåÂ∞±ÁÆó‰∫ãÂä°ÂÆåÊàê[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/work_path.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m  Ëé∑Âèñ‰∏¥Êó∂Êñá‰ª∂Â§πÊâÄÂú®Ë∑ØÂæÑ[0m
[30;1m51 | [0m[35m  :return: ‰∏¥Êó∂Êñá‰ª∂Â§πÊâÄÂú®Ë∑ØÂæÑ[0m
[30;1m52 | [0m[35m  """[0m
[30;1m53 | [0m[35m  return os.path.join(os.environ.get('TEMP'), subPath)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mdef get_Users_path(subPath: str = '') -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/imgDialog.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m  window.title(title)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m  # ÂàõÂª∫‰∏Ä‰∏™LabelÊéß‰ª∂Áî®‰∫éÊòæÁ§∫ÂõæÁâá[0m
[30;1m28 | [0m[35m  resp = requests.get(imagePath)[0m
[30;1m29 | [0m[35m  image = Image.open(BytesIO(resp.content))  # ÊõøÊç¢‰Ω†Ëá™Â∑±ÁöÑÂõæÁâáË∑ØÂæÑ[0m
[30;1m30 | [0m[35m  image = image.resize((400, 400))[0m
[30;1m31 | [0m[35m  photo = ImageTk.PhotoImage(image)[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/ctoken.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m__author__ = 'haoyang'[0m
[30;1m4 | [0m[35m__date__ = '2025/1/21 16:01'[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mimport jwt[0m
[30;1m8 | [0m[35mfrom bottle import request[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom ctools.dict_wrapper import DictWrapper[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/process_pool.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m__author__ = 'haoyang'[0m
[30;1m4 | [0m[35m__date__ = '2024/9/20 12:00'[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom concurrent.futures import ProcessPoolExecutor[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom ctools import call[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/thread_pool.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport threading[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom ctools import call[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/ex.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport traceback[0m
[30;1m3 | [0m[35mfrom functools import wraps[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m# annotation[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/sm_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom gmssl import sm2[0m
[30;1m4 | [0m[35mfrom gmssl.sm4 import CryptSM4, SM4_ENCRYPT, SM4_DECRYPT[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/string_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m      try:[0m
[30;1m31 | [0m[35m        if confidence <= 0.95 or chardet_error:[0m
[30;1m32 | [0m[35m          encoding = "utf-8" if detect.get('encoding') == "utf-8" else "gbk"[0m
[30;1m33 | [0m[35m          res_str = bytes_str.decode(encoding=encoding)[0m
[30;1m34 | [0m[35m      except Exception:[0m
[30;1m35 | [0m[35m        res_str = str(bytes_str)[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/string_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m      chardet_error = False[0m
[30;1m24 | [0m[35m      try:[0m
[30;1m25 | [0m[35m        confidence = float(detect.get('confidence'))[0m
[30;1m26 | [0m[35m        res_str = bytes_str.decode(encoding=detect.get('encoding'))[0m
[30;1m27 | [0m[35m      except Exception:[0m
[30;1m28 | [0m[35m        chardet_error = True[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/string_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m      confidence = 0[0m
[30;1m23 | [0m[35m      chardet_error = False[0m
[30;1m24 | [0m[35m      try:[0m
[30;1m25 | [0m[35m        confidence = float(detect.get('confidence'))[0m
[30;1m26 | [0m[35m        res_str = bytes_str.decode(encoding=detect.get('encoding'))[0m
[30;1m27 | [0m[35m      except Exception:[0m
[30;1m28 | [0m[35m        chardet_error = True[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/compile_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport importlib[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef code_to_pyc(code: str, out_file_path: str):[0m
[30;1m7 | [0m[35m  file_name = os.path.split(out_file_path)[-1][0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/download_tools.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mdef download_url(url: str, save_path: str):[0m
[30;1m53 | [0m[35m  content = http_utils.get(url)[0m
[30;1m54 | [0m[35m  if content:[0m
[30;1m55 | [0m[35m    with open(save_path, "wb") as f:[0m
[30;1m56 | [0m[35m      f.write(content)[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_webserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35mdef login(params):[0m
[30;1m38 | [0m[35m  return R.ok(token.gen_token({'username': 'xxx'}, secret_key, 3600))[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m@app.get('/demo')[0m
[30;1m41 | [0m[35m@bottle_web_base.rule('DOC:DOWNLOAD')[0m
[30;1m42 | [0m[35mdef demo(params):[0m
[30;1m43 | [0m[35m  print(params)[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_webserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35mdef token_check():[0m
[30;1m34 | [0m[35m  return bottle_web_base.common_auth_verify(secret_key)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m@app.post('/login')[0m
[30;1m37 | [0m[35mdef login(params):[0m
[30;1m38 | [0m[35m  return R.ok(token.gen_token({'username': 'xxx'}, secret_key, 3600))[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/bottle_webserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m  def run(self):[0m
[30;1m100 | [0m[35m    http_server = WSGIRefServer(port=self.port)[0m
[30;1m101 | [0m[35m    print('Click the link below to open the service homepage %s' % '\n \t\t http://localhost:%s \n \[0m
[30;1m102 | [0m[35m    self.bottle.run(server=http_server, quiet=self.quiet)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m  def set_index(self, filename='index.html', root='./', is_tpl=False, redirect_url=None, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m202[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ctools/snow_id.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# 64‰ΩçIDÁöÑÂàíÂàÜ[0m
[30;1m4 | [0m[35mWORKER_ID_BITS = 5[0m
[30;1m5 | [0m[35mDATACENTER_ID_BITS = 5[0m

202 matches found.
