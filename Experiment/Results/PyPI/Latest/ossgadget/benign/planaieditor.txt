[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m325 | [0m[35m# Helper function to process execution results - extracted from validate_code_in_venv to avoid code [0m
[30;1m326 | [0m[35mdef process_execution_results(process, module_name):[0m
[30;1m327 | [0m[35m    """Processes the results of a subprocess execution, parsing output for structured JSON or errors[0m
[30;1m328 | [0m[35m    print(f"Execution in venv completed with exit code: {process.returncode}")[0m
[30;1m329 | [0m[35m    if process.stdout:[0m
[30;1m330 | [0m[35m        # Print label and output separately[0m
[30;1m331 | [0m[35m        print("stdout:")[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m92 | [0m[35m    return jsonify({"success": True, "path": app.config["SELECTED_VENV_PATH"]})[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m@app.route("/api/set-venv", methods=["POST"])[0m
[30;1m96 | [0m[35mdef set_venv():[0m
[30;1m97 | [0m[35m    """Set the Python environment to use for validation."""[0m
[30;1m98 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m86 | [0m[35m        return jsonify({"success": False, "error": str(e)}), 500[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m@app.route("/api/current-venv", methods=["GET"])[0m
[30;1m90 | [0m[35mdef get_current_venv():[0m
[30;1m91 | [0m[35m    """Get the currently selected Python environment."""[0m
[30;1m92 | [0m[35m    return jsonify({"success": True, "path": app.config["SELECTED_VENV_PATH"]})[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m# API endpoints for Python interpreter selection[0m
[30;1m79 | [0m[35m@app.route("/api/venvs", methods=["GET"])[0m
[30;1m80 | [0m[35mdef get_venvs():[0m
[30;1m81 | [0m[35m    """Get available Python environments."""[0m
[30;1m82 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m39 | [0m[35mfrom planaieditor import lsp_handler[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# Determine mode and configure paths/CORS[0m
[30;1m42 | [0m[35mFLASK_ENV = os.environ.get("FLASK_ENV", "production")  # Default to production[0m
[30;1m43 | [0m[35mis_development = FLASK_ENV == "development"[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m# Define the build directory *within the package* for production[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m        app = Flask(__name__, static_folder=package_static_dir, static_url_path="/")[0m
[30;1m70 | [0m[35m    socketio = SocketIO(app)  # No CORS needed when served from same origin[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35mapp.config["SECRET_KEY"] = "secret!"  # Change this in production![0m
[30;1m73 | [0m[35mapp.config["SELECTED_VENV_PATH"] = ([0m
[30;1m74 | [0m[35m    sys.executable  # Will store the selected Python interpreter path[0m
[30;1m75 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m338 | [0m[35m        # Check environment variable[0m
[30;1m339 | [0m[35m        import os[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m        port = os.environ.get("DEBUG_PORT")[0m
[30;1m342 | [0m[35m        if not port:[0m
[30;1m343 | [0m[35m            logger.warning("DEBUG_PORT not set, cannot send debug event")[0m
[30;1m344 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m222 | [0m[35m    Example usage:[0m
[30;1m223 | [0m[35m    ```python[0m
[30;1m224 | [0m[35m    # In subprocess[0m
[30;1m225 | [0m[35m    client = SocketClient(port=os.environ.get('DEBUG_PORT'))[0m
[30;1m226 | [0m[35m    client.send({"event": "task_scheduled", "data": {...}})[0m
[30;1m227 | [0m[35m    ```[0m
[30;1m228 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/debug_monitor.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m14 | [0m[35m) -> bool:[0m
[30;1m15 | [0m[35m    """Send a debug event to the socket server."""[0m
[30;1m16 | [0m[35m    if not port:[0m
[30;1m17 | [0m[35m        port = os.environ.get("DEBUG_PORT")[0m
[30;1m18 | [0m[35m        if not port:[0m
[30;1m19 | [0m[35m            raise ValueError([0m
[30;1m20 | [0m[35m                "WARNING: DEBUG_PORT environment variable not set, cannot send debug events"[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/filesystem.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m        data = request.get_json()[0m
[30;1m155 | [0m[35m        requested_path_str = data.get("path")[0m
[30;1m156 | [0m[35m        content = data.get("content")[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        if ([0m
[30;1m159 | [0m[35m            not requested_path_str or content is None[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/filesystem.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m            return jsonify({"message": "Request must be JSON."}), 400[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m        data = request.get_json()[0m
[30;1m155 | [0m[35m        requested_path_str = data.get("path")[0m
[30;1m156 | [0m[35m        content = data.get("content")[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        if ([0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/filesystem.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    @app.route("/api/filesystem/read", methods=["GET"])[0m
[30;1m93 | [0m[35m    def read_filesystem():[0m
[30;1m94 | [0m[35m        requested_path_str = request.args.get("path", type=str)[0m
[30;1m95 | [0m[35m        if not requested_path_str:[0m
[30;1m96 | [0m[35m            return jsonify({"message": "Missing 'path' query parameter."}), 400[0m
[30;1m97 | [0m[35m        app.logger.debug(f"Received read request for path: {requested_path_str}")[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/filesystem.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    @app.route("/api/filesystem/list", methods=["GET"])[0m
[30;1m27 | [0m[35m    def list_filesystem():[0m
[30;1m28 | [0m[35m        requested_path_str = request.args.get("path", default="/", type=str)[0m
[30;1m29 | [0m[35m        app.logger.debug(f"Received list request for path: {requested_path_str}")[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/build.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m    print("Frontend assets copied successfully.")[0m
[30;1m29 | [0m[35melse:[0m
[30;1m30 | [0m[35m    print([0m
[30;1m31 | [0m[35m        f"WARNING: Frontend build directory not found at {frontend_build_dir}. Skipping copy. The pa[0m
[30;1m32 | [0m[35m    )[0m
[30;1m33 | [0m[35m    # If the frontend is absolutely mandatory, you might want to raise an error:[0m
[30;1m34 | [0m[35m    # raise FileNotFoundError(f"Required frontend build directory not found: {frontend_build_dir}")[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m919 | [0m[35m    if not result.get("success"):[0m
[30;1m920 | [0m[35m        # convert the error output to a string[0m
[30;1m921 | [0m[35m        error_output = result.get("error")[0m
[30;1m922 | [0m[35m        result["error"] = error_output.get("message")[0m
[30;1m923 | [0m[35m[0m
[30;1m924 | [0m[35m    # Return the validation result directly to the frontend[0m
[30;1m925 | [0m[35m    status_code = 200[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m    if not result.get("success"):[0m
[30;1m920 | [0m[35m        # convert the error output to a string[0m
[30;1m921 | [0m[35m        error_output = result.get("error")[0m
[30;1m922 | [0m[35m        result["error"] = error_output.get("message")[0m
[30;1m923 | [0m[35m[0m
[30;1m924 | [0m[35m    # Return the validation result directly to the frontend[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m916 | [0m[35m    # Execute the validation script in the selected Python environment[0m
[30;1m917 | [0m[35m    result = validate_code_in_venv("pydantic_validation", validation_script)[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m    if not result.get("success"):[0m
[30;1m920 | [0m[35m        # convert the error output to a string[0m
[30;1m921 | [0m[35m        error_output = result.get("error")[0m
[30;1m922 | [0m[35m        result["error"] = error_output.get("message")[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m853 | [0m[35m        }[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m    task_import_state = {}[0m
[30;1m856 | [0m[35m    node_type = node.get("type")[0m
[30;1m857 | [0m[35m    task_class = ""[0m
[30;1m858 | [0m[35m    import_code = ""[0m
[30;1m859 | [0m[35m    match node_type:[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m843 | [0m[35m            400,[0m
[30;1m844 | [0m[35m        )[0m
[30;1m845 | [0m[35m[0m
[30;1m846 | [0m[35m    python_executable = app.config.get("SELECTED_VENV_PATH")[0m
[30;1m847 | [0m[35m    if not python_executable:[0m
[30;1m848 | [0m[35m        return {"success": False, "error": "No Python interpreter selected."}[0m
[30;1m849 | [0m[35m    if not os.path.exists(python_executable):[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m836 | [0m[35m            400,[0m
[30;1m837 | [0m[35m        )[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m    className = node.get("data", {}).get("className")[0m
[30;1m840 | [0m[35m    if not className:[0m
[30;1m841 | [0m[35m        return ([0m
[30;1m842 | [0m[35m            jsonify({"success": False, "error": "Missing 'className' in request"}),[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m836 | [0m[35m            400,[0m
[30;1m837 | [0m[35m        )[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m    className = node.get("data", {}).get("className")[0m
[30;1m840 | [0m[35m    if not className:[0m
[30;1m841 | [0m[35m        return ([0m
[30;1m842 | [0m[35m            jsonify({"success": False, "error": "Missing 'className' in request"}),[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m826 | [0m[35m    """Validates JSON data against a Pydantic model."""[0m
[30;1m827 | [0m[35m    data = request.get_json()[0m
[30;1m828 | [0m[35m    node = data.get("node")[0m
[30;1m829 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35m    if not node or not json_data:[0m
[30;1m832 | [0m[35m        return ([0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m825 | [0m[35mdef validate_pydantic_data():[0m
[30;1m826 | [0m[35m    """Validates JSON data against a Pydantic model."""[0m
[30;1m827 | [0m[35m    data = request.get_json()[0m
[30;1m828 | [0m[35m    node = data.get("node")[0m
[30;1m829 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35m    if not node or not json_data:[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m817 | [0m[35m    result = run_inspection_script([0m
[30;1m818 | [0m[35m        module_path, action="get_fields", class_name=class_name[0m
[30;1m819 | [0m[35m    )[0m
[30;1m820 | [0m[35m    status_code = 200 if result.get("success") else 400  # Or 500?[0m
[30;1m821 | [0m[35m    return jsonify(result), status_code[0m
[30;1m822 | [0m[35m[0m
[30;1m823 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m    data = request.get_json()[0m
[30;1m804 | [0m[35m    module_path = data.get("module_path")[0m
[30;1m805 | [0m[35m    class_name = data.get("class_name")[0m
[30;1m806 | [0m[35m    if not module_path or not class_name:[0m
[30;1m807 | [0m[35m        return ([0m
[30;1m808 | [0m[35m            jsonify([0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m801 | [0m[35m        return jsonify({"success": False, "error": "Request must be JSON"}), 400[0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m    data = request.get_json()[0m
[30;1m804 | [0m[35m    module_path = data.get("module_path")[0m
[30;1m805 | [0m[35m    class_name = data.get("class_name")[0m
[30;1m806 | [0m[35m    if not module_path or not class_name:[0m
[30;1m807 | [0m[35m        return ([0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m790 | [0m[35m        )[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m    result = run_inspection_script(module_path, action="list_classes")[0m
[30;1m793 | [0m[35m    status_code = 200 if result.get("success") else 400  # Or 500 for internal errors?[0m
[30;1m794 | [0m[35m    return jsonify(result), status_code[0m
[30;1m795 | [0m[35m[0m
[30;1m796 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m782 | [0m[35m        return jsonify({"success": False, "error": "Request must be JSON"}), 400[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m    data = request.get_json()[0m
[30;1m785 | [0m[35m    module_path = data.get("module_path")[0m
[30;1m786 | [0m[35m    if not module_path:[0m
[30;1m787 | [0m[35m        return ([0m
[30;1m788 | [0m[35m            jsonify({"success": False, "error": "Missing 'module_path' in request"}),[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m708 | [0m[35m    module_path: str, action: str, class_name: Optional[str] = None[0m
[30;1m709 | [0m[35m) -> dict:[0m
[30;1m710 | [0m[35m    """Runs the inspect_module.py script in the selected venv and returns parsed JSON output."""[0m
[30;1m711 | [0m[35m    python_executable = app.config.get("SELECTED_VENV_PATH")[0m
[30;1m712 | [0m[35m    if not python_executable:[0m
[30;1m713 | [0m[35m        return {"success": False, "error": "No Python interpreter selected."}[0m
[30;1m714 | [0m[35m    if not os.path.exists(python_executable):[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m667 | [0m[35m# --- New Endpoint for LLM Model Listing ---[0m
[30;1m668 | [0m[35m@app.route("/api/llm/list-models", methods=["GET"])[0m
[30;1m669 | [0m[35mdef get_llm_models():[0m
[30;1m670 | [0m[35m    provider = request.args.get("provider")[0m
[30;1m671 | [0m[35m    if not provider:[0m
[30;1m672 | [0m[35m        return ([0m
[30;1m673 | [0m[35m            jsonify({"success": False, "error": "Missing 'provider' query parameter"}),[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m617 | [0m[35m        return jsonify({"success": False, "error": "Request must be JSON"}), 400[0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m    data = request.get_json()[0m
[30;1m620 | [0m[35m    python_code = data.get("python_code")[0m
[30;1m621 | [0m[35m[0m
[30;1m622 | [0m[35m    if not python_code:[0m
[30;1m623 | [0m[35m        return ([0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m    }[0m
[30;1m603 | [0m[35m    # Add error details to the main level if validation failed[0m
[30;1m604 | [0m[35m    if not response_data["success"]:[0m
[30;1m605 | [0m[35m        response_data["error"] = validation_result.get("error", "Validation failed.")[0m
[30;1m606 | [0m[35m    else:[0m
[30;1m607 | [0m[35m        response_data["message"] = "Execution successful!"[0m
[30;1m608 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m595 | [0m[35m[0m
[30;1m596 | [0m[35m    # Construct the final response[0m
[30;1m597 | [0m[35m    response_data = {[0m
[30;1m598 | [0m[35m        "success": validation_result.get("success", False),[0m
[30;1m599 | [0m[35m        "mode": "execute",[0m
[30;1m600 | [0m[35m        "python_code": python_code,[0m
[30;1m601 | [0m[35m        "validation_result": validation_result,  # Include the validation details[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m576 | [0m[35m        )[0m
[30;1m577 | [0m[35m        return[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m    if data.get("mode") == "export":[0m
[30;1m580 | [0m[35m        emit([0m
[30;1m581 | [0m[35m            "export_result",[0m
[30;1m582 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m    print(f"[{sid}] Received start_lsp request.")[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m    # Use the currently selected Python executable or fallback to the system one[0m
[30;1m511 | [0m[35m    python_executable = app.config.get("SELECTED_VENV_PATH", sys.executable)[0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m    # Define the emit function to be passed to the handler[0m
[30;1m514 | [0m[35m    # This uses the correct context for emitting back to the specific client[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m490 | [0m[35m    # Store any client preferences[0m
[30;1m491 | [0m[35m    app.debug_sessions[request.sid] = {[0m
[30;1m492 | [0m[35m        "registered": True,[0m
[30;1m493 | [0m[35m        "preferences": data.get("preferences", {}),[0m
[30;1m494 | [0m[35m    }[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m    # Acknowledge registration[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m        def handle_debug_event(event):[0m
[30;1m189 | [0m[35m            """Handle debug events received from the subprocess"""[0m
[30;1m190 | [0m[35m            event_type = event.get("type", "unknown")[0m
[30;1m191 | [0m[35m            event_data = event.get("data", {})[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m            print(f"Received debug event: {event_type} - {event_data}")[0m
[30;1m194 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m        # Define the debug event handler[0m
[30;1m188 | [0m[35m        def handle_debug_event(event):[0m
[30;1m189 | [0m[35m            """Handle debug events received from the subprocess"""[0m
[30;1m190 | [0m[35m            event_type = event.get("type", "unknown")[0m
[30;1m191 | [0m[35m            event_data = event.get("data", {})[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m            print(f"Received debug event: {event_type} - {event_data}")[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35mdef validate_code_in_venv(module_name, code_string, inject_debug_events=False):[0m
[30;1m147 | [0m[35m    """Executes Python code in a venv, parses structured JSON output, and returns the result."""[0m
[30;1m148 | [0m[35m    # Get the selected Python executable path[0m
[30;1m149 | [0m[35m    python_executable = app.config.get("SELECTED_VENV_PATH")[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    # If no path is selected, return an error[0m
[30;1m152 | [0m[35m    if not python_executable:[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35mfrom planaieditor import lsp_handler[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# Determine mode and configure paths/CORS[0m
[30;1m42 | [0m[35mFLASK_ENV = os.environ.get("FLASK_ENV", "production")  # Default to production[0m
[30;1m43 | [0m[35mis_development = FLASK_ENV == "development"[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m# Define the build directory *within the package* for production[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m                with tempfile.NamedTemporaryFile([0m
[30;1m208 | [0m[35m                    mode="w", suffix=".py", delete=False, encoding="utf-8"[0m
[30;1m209 | [0m[35m                ) as tmp_file:[0m
[30;1m210 | [0m[35m                    # Inject debug monitor import at the top of the code[0m
[30;1m211 | [0m[35m                    debug_monitor_path = os.path.join([0m
[30;1m212 | [0m[35m                        os.path.dirname(__file__),[0m
[30;1m213 | [0m[35m                        "planaieditor",[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    # Verify the path still exists[0m
[30;1m163 | [0m[35m    if not os.path.exists(python_executable):[0m
[30;1m164 | [0m[35m        error_message = f"Python executable not found at {python_executable}. Please select another [0m
[30;1m165 | [0m[35m        print(error_message)[0m
[30;1m166 | [0m[35m        # Return structured error[0m
[30;1m167 | [0m[35m        return {[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35m    # Ensure the static folder exists, otherwise Flask might error or serve incorrectly[0m
[30;1m62 | [0m[35m    if not os.path.exists(package_static_dir):[0m
[30;1m63 | [0m[35m        print([0m
[30;1m64 | [0m[35m            f"WARNING: Static file directory not found at {package_static_dir}. Frontend might not l[0m
[30;1m65 | [0m[35m        )[0m
[30;1m66 | [0m[35m        # Initialize without static serving if dir is missing, API might still work[0m
[30;1m67 | [0m[35m        app = Flask(__name__)[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m    print(validation_script)[0m
[30;1m915 | [0m[35m[0m
[30;1m916 | [0m[35m    # Execute the validation script in the selected Python environment[0m
[30;1m917 | [0m[35m    result = validate_code_in_venv("pydantic_validation", validation_script)[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m    if not result.get("success"):[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m867 | [0m[35m        case _:[0m
[30;1m868 | [0m[35m            return (jsonify({"success": False, "error": "Invalid node type"}), 400)[0m
[30;1m869 | [0m[35m[0m
[30;1m870 | [0m[35m    # Create a validation script with proper JSON output markers[0m
[30;1m871 | [0m[35m    validation_script = f"""[0m
[30;1m872 | [0m[35mimport sys[0m
[30;1m873 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m865 | [0m[35m            for module_path, classes in task_import_state.items():[0m
[30;1m866 | [0m[35m                import_code += f"from {module_path} import {', '.join(classes)}\n"[0m
[30;1m867 | [0m[35m        case _:[0m
[30;1m868 | [0m[35m            return (jsonify({"success": False, "error": "Invalid node type"}), 400)[0m
[30;1m869 | [0m[35m[0m
[30;1m870 | [0m[35m    # Create a validation script with proper JSON output markers[0m
[30;1m871 | [0m[35m    validation_script = f"""[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m828 | [0m[35m    node = data.get("node")[0m
[30;1m829 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35m    if not node or not json_data:[0m
[30;1m832 | [0m[35m        return ([0m
[30;1m833 | [0m[35m            jsonify([0m
[30;1m834 | [0m[35m                {"success": False, "error": "Missing 'node' or 'jsonData' in request"}[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m825 | [0m[35mdef validate_pydantic_data():[0m
[30;1m826 | [0m[35m    """Validates JSON data against a Pydantic model."""[0m
[30;1m827 | [0m[35m    data = request.get_json()[0m
[30;1m828 | [0m[35m    node = data.get("node")[0m
[30;1m829 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35m    if not node or not json_data:[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m750 | [0m[35m            print(f"stdout:\n{process.stdout.strip()}")[0m
[30;1m751 | [0m[35m        if process.stderr:[0m
[30;1m752 | [0m[35m            print(f"stderr:\n{process.stderr.strip()}")[0m
[30;1m753 | [0m[35m        print("--- Inspect Script End ---")[0m
[30;1m754 | [0m[35m[0m
[30;1m755 | [0m[35m        # Attempt to parse JSON from stdout first (expected output)[0m
[30;1m756 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m743 | [0m[35m        )[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m        # Debugging output[0m
[30;1m746 | [0m[35m        print("--- Inspect Script Start ---")[0m
[30;1m747 | [0m[35m        print(f"Command: {' '.join(command)}")[0m
[30;1m748 | [0m[35m        print(f"Return Code: {process.returncode}")[0m
[30;1m749 | [0m[35m        if process.stdout:[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m738 | [0m[35m            capture_output=True,[0m
[30;1m739 | [0m[35m            text=True,[0m
[30;1m740 | [0m[35m            check=False,  # Check return code manually[0m
[30;1m741 | [0m[35m            timeout=30,  # Timeout for inspection[0m
[30;1m742 | [0m[35m            # cwd= # Consider setting cwd if relative imports are an issue[0m
[30;1m743 | [0m[35m        )[0m
[30;1m744 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m707 | [0m[35mdef run_inspection_script([0m
[30;1m708 | [0m[35m    module_path: str, action: str, class_name: Optional[str] = None[0m
[30;1m709 | [0m[35m) -> dict:[0m
[30;1m710 | [0m[35m    """Runs the inspect_module.py script in the selected venv and returns parsed JSON output."""[0m
[30;1m711 | [0m[35m    python_executable = app.config.get("SELECTED_VENV_PATH")[0m
[30;1m712 | [0m[35m    if not python_executable:[0m
[30;1m713 | [0m[35m        return {"success": False, "error": "No Python interpreter selected."}[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m703 | [0m[35m        )[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m# --- Helper function to run the inspection script --- #[0m
[30;1m707 | [0m[35mdef run_inspection_script([0m
[30;1m708 | [0m[35m    module_path: str, action: str, class_name: Optional[str] = None[0m
[30;1m709 | [0m[35m) -> dict:[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m676 | [0m[35m[0m
[30;1m677 | [0m[35m    # Note: Ideally, this should run within the selected venv context.[0m
[30;1m678 | [0m[35m    # For simplicity now, it runs in the backend env. This requires PlanAI & keys there.[0m
[30;1m679 | [0m[35m    # A more robust solution would use a helper script + run_inspection_script.[0m
[30;1m680 | [0m[35m    print([0m
[30;1m681 | [0m[35m        f"Attempting to list models for provider: {provider} (using backend environment)"[0m
[30;1m682 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m443 | [0m[35m                found_node_name = found_node_name[1:][0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35m        print([0m
[30;1m446 | [0m[35m            f"Fallback Error: Node found: {found_node_name}, Error: {core_error_message}"[0m
[30;1m447 | [0m[35m        )[0m
[30;1m448 | [0m[35m        return {[0m
[30;1m449 | [0m[35m            "success": False,[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m429 | [0m[35m        lines = error_output.strip().split("\n")[0m
[30;1m430 | [0m[35m        core_error_message = lines[-1] if lines else "Unknown execution error line."[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m        # Use the simpler regex fallback for node name from raw output[0m
[30;1m433 | [0m[35m        name_regex = r"\b([A-Za-z_][A-Za-z0-9_]*?)(?:Task|Worker)\d+\b(?:\s*=|\s*\()"[0m
[30;1m434 | [0m[35m        found_node_name = None[0m
[30;1m435 | [0m[35m        matches = re.findall(name_regex, error_output)[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m421 | [0m[35m            "message": "Script validation finished without explicit success confirmation.",[0m
[30;1m422 | [0m[35m        }  # Assume success?[0m
[30;1m423 | [0m[35m    else:[0m
[30;1m424 | [0m[35m        # Script failed before printing JSON markers (e.g., syntax error)[0m
[30;1m425 | [0m[35m        print([0m
[30;1m426 | [0m[35m            f"Script failed with exit code {process.returncode} before printing JSON markers."[0m
[30;1m427 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m412 | [0m[35m    )[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m    if process.returncode == 0:[0m
[30;1m415 | [0m[35m        # Script finished with exit code 0 but didn't print success JSON[0m
[30;1m416 | [0m[35m        print([0m
[30;1m417 | [0m[35m            f"Script '{module_name}' completed with exit code 0 but no success JSON marker."[0m
[30;1m418 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m    # --- Fallback Logic (if no JSON markers found) ---[0m
[30;1m410 | [0m[35m    print([0m
[30;1m411 | [0m[35m        "No structured JSON markers found in script output. Falling back to exit code check."[0m
[30;1m412 | [0m[35m    )[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m    if process.returncode == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m398 | [0m[35m            return success_data  # Return the structured success info[0m
[30;1m399 | [0m[35m        except json.JSONDecodeError as e:[0m
[30;1m400 | [0m[35m            print([0m
[30;1m401 | [0m[35m                f"Error decoding JSON from script success output: {e}\nJSON string: {json_str}"[0m
[30;1m402 | [0m[35m            )[0m
[30;1m403 | [0m[35m            # Fallback, but assume success if marker was present[0m
[30;1m404 | [0m[35m            return {[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m394 | [0m[35m        json_str = success_match.group(1)[0m
[30;1m395 | [0m[35m        try:[0m
[30;1m396 | [0m[35m            success_data = json.loads(json_str)[0m
[30;1m397 | [0m[35m            print(f"Parsed success JSON from script output: {success_data}")[0m
[30;1m398 | [0m[35m            return success_data  # Return the structured success info[0m
[30;1m399 | [0m[35m        except json.JSONDecodeError as e:[0m
[30;1m400 | [0m[35m            print([0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m            return error_data  # Return the structured error from the script[0m
[30;1m353 | [0m[35m        except json.JSONDecodeError as e:[0m
[30;1m354 | [0m[35m            print([0m
[30;1m355 | [0m[35m                f"Error decoding JSON from script error output: {e}\nJSON string: {json_str}"[0m
[30;1m356 | [0m[35m            )[0m
[30;1m357 | [0m[35m            # Fallback to generic error if JSON parsing fails[0m
[30;1m358 | [0m[35m            return {[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m349 | [0m[35m        try:[0m
[30;1m350 | [0m[35m            error_data = json.loads(json_str)[0m
[30;1m351 | [0m[35m            print(f"Parsed error JSON from script output: {error_data}")[0m
[30;1m352 | [0m[35m            return error_data  # Return the structured error from the script[0m
[30;1m353 | [0m[35m        except json.JSONDecodeError as e:[0m
[30;1m354 | [0m[35m            print([0m
[30;1m355 | [0m[35m                f"Error decoding JSON from script error output: {e}\nJSON string: {json_str}"[0m
[30;1m356 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m348 | [0m[35m        json_str = error_match.group(1)[0m
[30;1m349 | [0m[35m        try:[0m
[30;1m350 | [0m[35m            error_data = json.loads(json_str)[0m
[30;1m351 | [0m[35m            print(f"Parsed error JSON from script output: {error_data}")[0m
[30;1m352 | [0m[35m            return error_data  # Return the structured error from the script[0m
[30;1m353 | [0m[35m        except json.JSONDecodeError as e:[0m
[30;1m354 | [0m[35m            print([0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m                tmp_file.write(code_string)[0m
[30;1m280 | [0m[35m                module_path = tmp_file.name[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m            # Execute the script using the venv's Python interpreter[0m
[30;1m283 | [0m[35m            process = subprocess.run([0m
[30;1m284 | [0m[35m                [python_executable, module_path],[0m
[30;1m285 | [0m[35m                capture_output=True,[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m                print(f"Starting execution with debug server on port {server.port}")[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m                # Execute the script using the venv's Python interpreter[0m
[30;1m232 | [0m[35m                process = subprocess.run([0m
[30;1m233 | [0m[35m                    [python_executable, module_path],[0m
[30;1m234 | [0m[35m                    capture_output=True,[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m                with tempfile.NamedTemporaryFile([0m
[30;1m208 | [0m[35m                    mode="w", suffix=".py", delete=False, encoding="utf-8"[0m
[30;1m209 | [0m[35m                ) as tmp_file:[0m
[30;1m210 | [0m[35m                    # Inject debug monitor import at the top of the code[0m
[30;1m211 | [0m[35m                    debug_monitor_path = os.path.join([0m
[30;1m212 | [0m[35m                        os.path.dirname(__file__),[0m
[30;1m213 | [0m[35m                        "planaieditor",[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/llm_interface_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        if not llm or not hasattr(llm, "list"):[0m
[30;1m58 | [0m[35m            raise ValueError([0m
[30;1m59 | [0m[35m                f"Could not instantiate or find list method for provider: {provider_name}"[0m
[30;1m60 | [0m[35m            )[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        list_response = llm.list()[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m184 | [0m[35m    )[0m
[30;1m185 | [0m[35m    parser.add_argument("--provider", default="openai", help="LLM provider")[0m
[30;1m186 | [0m[35m    parser.add_argument("--model", default="gpt-4", help="LLM model name")[0m
[30;1m187 | [0m[35m    parser.add_argument("--repo", default=".", help="Path to git repository")[0m
[30;1m188 | [0m[35m    parser.add_argument("--ollama-host", default="localhost:11434", help="Ollama host")[0m
[30;1m189 | [0m[35m    args = parser.parse_args()[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35mdef main():[0m
[30;1m176 | [0m[35m    parser = argparse.ArgumentParser([0m
[30;1m177 | [0m[35m        description="Generate release notes from git commits"[0m
[30;1m178 | [0m[35m    )[0m
[30;1m179 | [0m[35m    parser.add_argument([0m
[30;1m180 | [0m[35m        "--tag",[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m    use_xml: bool = False[0m
[30;1m123 | [0m[35m    prompt: str = dedent([0m
[30;1m124 | [0m[35m        """[0m
[30;1m125 | [0m[35m        Analyze the provided git diff and produce a 1-2 sentence description that clearly explains w[0m
[30;1m126 | [0m[35m        Focus on the component affected and the primary purpose of the change, ensuring that the des[0m
[30;1m127 | [0m[35m        Do not include file statistics or non-functional details.[0m
[30;1m128 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35mclass DiffAnalyzer(CachedLLMTaskWorker):[0m
[30;1m118 | [0m[35m    """Worker that analyzes each diff and describes the changes"""[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    output_types: List[Type[Task]] = [DiffAnalysis][0m
[30;1m121 | [0m[35m    llm_input_type: Type[Task] = CommitDiff[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m            )[0m
[30;1m100 | [0m[35m            return show_output[0m
[30;1m101 | [0m[35m        except Exception as e:[0m
[30;1m102 | [0m[35m            print(f"Error getting diff for {commit_hash}: {e}")[0m
[30;1m103 | [0m[35m            return ""[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def consume_work(self, task: CommitDiff):[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        # Use git.show() directly which gives us the complete diff output[0m
[30;1m91 | [0m[35m        try:[0m
[30;1m92 | [0m[35m            # The -U option ensures we get the full unified diff[0m
[30;1m93 | [0m[35m            # --no-prefix removes a/ and b/ prefixes from filenames[0m
[30;1m94 | [0m[35m            show_output = repo.git.show([0m
[30;1m95 | [0m[35m                commit_hash,[0m
[30;1m96 | [0m[35m                "--no-prefix",[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m        """Generate git-show like output for a commit"""[0m
[30;1m88 | [0m[35m        repo = Repo(self.repo_path)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        # Use git.show() directly which gives us the complete diff output[0m
[30;1m91 | [0m[35m        try:[0m
[30;1m92 | [0m[35m            # The -U option ensures we get the full unified diff[0m
[30;1m93 | [0m[35m            # --no-prefix removes a/ and b/ prefixes from filenames[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    def __init__(self, **data):[0m
[30;1m81 | [0m[35m        super().__init__(**data)[0m
[30;1m82 | [0m[35m        # Generate the empty tree hash using git[0m
[30;1m83 | [0m[35m        repo = Repo(self.repo_path)[0m
[30;1m84 | [0m[35m        self._empty_tree_hash = repo.git.hash_object("-t", "tree", "/dev/null")[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def show_commit(self, commit_hash: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m    """Worker that gets the diff for each commit"""[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    output_types: List[Type[Task]] = [CommitDiff][0m
[30;1m77 | [0m[35m    repo_path: str = Field(description="Path to the git repository")[0m
[30;1m78 | [0m[35m    _empty_tree_hash: str = PrivateAttr()[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    def __init__(self, **data):[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35mclass DiffWorker(CachedTaskWorker):[0m
[30;1m74 | [0m[35m    """Worker that gets the diff for each commit"""[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    output_types: List[Type[Task]] = [CommitDiff][0m
[30;1m77 | [0m[35m    repo_path: str = Field(description="Path to the git repository")[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    """Task containing the diff for a commit"""[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    commit_hash: str = Field(description="The commit hash")[0m
[30;1m32 | [0m[35m    diff: str = Field(description="The complete git show output")[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mclass DiffAnalysis(Task):[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mclass CommitDiff(Task):[0m
[30;1m29 | [0m[35m    """Task containing the diff for a commit"""[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    commit_hash: str = Field(description="The commit hash")[0m
[30;1m32 | [0m[35m    diff: str = Field(description="The complete git show output")[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mclass InitialCommit(Task):[0m
[30;1m22 | [0m[35m    """Task containing the initial repository information"""[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    repo_path: str = Field(description="Path to the git repository")[0m
[30;1m25 | [0m[35m    from_tag: Optional[str] = Field(None, description="Starting tag for commit range")[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/releasenotes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mfrom textwrap import dedent[0m
[30;1m4 | [0m[35mfrom typing import List, Optional, Type[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom git import Repo[0m
[30;1m7 | [0m[35mfrom planai import ([0m
[30;1m8 | [0m[35m    CachedLLMTaskWorker,[0m
[30;1m9 | [0m[35m    CachedTaskWorker,[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/export_execute.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m    except SystemExit:  # Don't catch sys.exit(1) from inner blocks[0m
[30;1m94 | [0m[35m        # Errors should have already been printed with JSON markers[0m
[30;1m95 | [0m[35m        print("Exiting due to error during setup.", file=sys.stderr)[0m
[30;1m96 | [0m[35m        pass  # Allow the script to terminate[0m
[30;1m97 | [0m[35m    except Exception as e:  # Catch unexpected errors during the setup_graph call itself[0m
[30;1m98 | [0m[35m        error_info_dict = {[0m
[30;1m99 | [0m[35m            "success": False,[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m        # Check environment variable[0m
[30;1m339 | [0m[35m        import os[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m        port = os.environ.get("DEBUG_PORT")[0m
[30;1m342 | [0m[35m        if not port:[0m
[30;1m343 | [0m[35m            logger.warning("DEBUG_PORT not set, cannot send debug event")[0m
[30;1m344 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m    Example usage:[0m
[30;1m223 | [0m[35m    ```python[0m
[30;1m224 | [0m[35m    # In subprocess[0m
[30;1m225 | [0m[35m    client = SocketClient(port=os.environ.get('DEBUG_PORT'))[0m
[30;1m226 | [0m[35m    client.send({"event": "task_scheduled", "data": {...}})[0m
[30;1m227 | [0m[35m    ```[0m
[30;1m228 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m                    # Process complete messages[0m
[30;1m179 | [0m[35m                    while self.delimiter.encode(self.encoding) in buffer:[0m
[30;1m180 | [0m[35m                        # Split at the delimiter[0m
[30;1m181 | [0m[35m                        message_bytes, buffer = buffer.split([0m
[30;1m182 | [0m[35m                            self.delimiter.encode(self.encoding), 1[0m
[30;1m183 | [0m[35m                        )[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m            port: Port to connect to (can be string or int)[0m
[30;1m244 | [0m[35m            encoding: Character encoding for messages[0m
[30;1m245 | [0m[35m            delimiter: Message delimiter[0m
[30;1m246 | [0m[35m            connect_timeout: Connection timeout in seconds[0m
[30;1m247 | [0m[35m        """[0m
[30;1m248 | [0m[35m        self.host = host[0m
[30;1m249 | [0m[35m        self.port = int(port) if port else 0[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        self.buffer_size = buffer_size[0m
[30;1m55 | [0m[35m        self.encoding = encoding[0m
[30;1m56 | [0m[35m        self.delimiter = delimiter[0m
[30;1m57 | [0m[35m        self.timeout = timeout[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        self._server_socket = None[0m
[30;1m60 | [0m[35m        self._running = False[0m
[30;1m61 | [0m[35m        self._thread = None[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m            buffer_size: Size of the receive buffer[0m
[30;1m47 | [0m[35m            encoding: Character encoding for messages[0m
[30;1m48 | [0m[35m            delimiter: Message delimiter (default: newline)[0m
[30;1m49 | [0m[35m            timeout: Socket timeout in seconds[0m
[30;1m50 | [0m[35m        """[0m
[30;1m51 | [0m[35m        self.callback = callback[0m
[30;1m52 | [0m[35m        self.host = host[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/socket_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport socket[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom typing import Any, Callable, Dict, Optional, Union[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1406 | [0m[35m        seen_entry_edges = set()[0m
[30;1m1407 | [0m[35m        for edge in entry_edges:[0m
[30;1m1408 | [0m[35m            # Create a tuple representation for checking uniqueness[0m
[30;1m1409 | [0m[35m            edge_tuple = (edge.get("sourceTask"), edge.get("targetWorker"))[0m
[30;1m1410 | [0m[35m            if edge_tuple not in seen_entry_edges:[0m
[30;1m1411 | [0m[35m                unique_entry_edges.append(edge)[0m
[30;1m1412 | [0m[35m                seen_entry_edges.add(edge_tuple)[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1406 | [0m[35m        seen_entry_edges = set()[0m
[30;1m1407 | [0m[35m        for edge in entry_edges:[0m
[30;1m1408 | [0m[35m            # Create a tuple representation for checking uniqueness[0m
[30;1m1409 | [0m[35m            edge_tuple = (edge.get("sourceTask"), edge.get("targetWorker"))[0m
[30;1m1410 | [0m[35m            if edge_tuple not in seen_entry_edges:[0m
[30;1m1411 | [0m[35m                unique_entry_edges.append(edge)[0m
[30;1m1412 | [0m[35m                seen_entry_edges.add(edge_tuple)[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1364 | [0m[35m                        "variableName": var_name,[0m
[30;1m1365 | [0m[35m                        "workerType": "subgraphworker",[0m
[30;1m1366 | [0m[35m                        "inputTypes": factory_config.get("inputTypes", []),[0m
[30;1m1367 | [0m[35m                        "classVars": factory_config.get("classVars", {}),[0m
[30;1m1368 | [0m[35m                        "factoryFunction": factory_name,[0m
[30;1m1369 | [0m[35m                        "factoryInvocation": factory_invocation_string,  # Store combined invocation[0m
[30;1m1370 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1363 | [0m[35m                        "className": factory_class_name,  # Use this as the primary identifier[0m
[30;1m1364 | [0m[35m                        "variableName": var_name,[0m
[30;1m1365 | [0m[35m                        "workerType": "subgraphworker",[0m
[30;1m1366 | [0m[35m                        "inputTypes": factory_config.get("inputTypes", []),[0m
[30;1m1367 | [0m[35m                        "classVars": factory_config.get("classVars", {}),[0m
[30;1m1368 | [0m[35m                        "factoryFunction": factory_name,[0m
[30;1m1369 | [0m[35m                        "factoryInvocation": factory_invocation_string,  # Store combined invocation[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1332 | [0m[35m                    # Determine className - priority to explicit name provided in factory call[0m
[30;1m1333 | [0m[35m                    factory_class_name = ([0m
[30;1m1334 | [0m[35m                        explicit_name[0m
[30;1m1335 | [0m[35m                        or factory_config.get("defaultClassName")[0m
[30;1m1336 | [0m[35m                        or f"{factory_name}_worker"[0m
[30;1m1337 | [0m[35m                    )[0m
[30;1m1338 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1322 | [0m[35m                factory_config = SUBGRAPH_FACTORIES.get(factory_name)[0m
[30;1m1323 | [0m[35m                if factory_config:[0m
[30;1m1324 | [0m[35m                    # Extract 'name' keyword argument if present[0m
[30;1m1325 | [0m[35m                    name_kw_node = instance_info["keywords"].get("name")[0m
[30;1m1326 | [0m[35m                    explicit_name = None[0m
[30;1m1327 | [0m[35m                    if isinstance(name_kw_node, ast.Constant) and isinstance([0m
[30;1m1328 | [0m[35m                        name_kw_node.value, str[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1319 | [0m[35m[0m
[30;1m1320 | [0m[35m            elif instance_info["type"] == "factory":[0m
[30;1m1321 | [0m[35m                factory_name = instance_info["factory_name"][0m
[30;1m1322 | [0m[35m                factory_config = SUBGRAPH_FACTORIES.get(factory_name)[0m
[30;1m1323 | [0m[35m                if factory_config:[0m
[30;1m1324 | [0m[35m                    # Extract 'name' keyword argument if present[0m
[30;1m1325 | [0m[35m                    name_kw_node = instance_info["keywords"].get("name")[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1296 | [0m[35m                    worker_entry["variableName"] = var_name[0m
[30;1m1297 | [0m[35m[0m
[30;1m1298 | [0m[35m                # Check for standard LLM variable reference[0m
[30;1m1299 | [0m[35m                llm_var = instance_info.get("llm_variable_name")[0m
[30;1m1300 | [0m[35m                if not llm_var:[0m
[30;1m1301 | [0m[35m                    # check if there is an inline llm assignment for this worker[0m
[30;1m1302 | [0m[35m                    llm_var = f"inline_{var_name}"[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1291 | [0m[35m[0m
[30;1m1292 | [0m[35m                # Also set variableName on the worker details for completeness[0m
[30;1m1293 | [0m[35m                # (but className remains the primary identifier)[0m
[30;1m1294 | [0m[35m                worker_entry = worker_details_map.get(class_name)[0m
[30;1m1295 | [0m[35m                if worker_entry:[0m
[30;1m1296 | [0m[35m                    worker_entry["variableName"] = var_name[0m
[30;1m1297 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1155 | [0m[35m            task_class_name = task_call_node.func.id[0m
[30;1m1156 | [0m[35m[0m
[30;1m1157 | [0m[35m        if worker_var_name and task_class_name:[0m
[30;1m1158 | [0m[35m            worker_class_name = worker_assignments.get(worker_var_name)[0m
[30;1m1159 | [0m[35m            if worker_class_name:[0m
[30;1m1160 | [0m[35m                entry_edges.append([0m
[30;1m1161 | [0m[35m                    {"sourceTask": task_class_name, "targetWorker": worker_class_name}[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1071 | [0m[35m            if entry_worker_class:[0m
[30;1m1072 | [0m[35m                worker_details = worker_details_map.get(entry_worker_class)[0m
[30;1m1073 | [0m[35m                # Use the already determined input type for this worker[0m
[30;1m1074 | [0m[35m                if worker_details and worker_details.get("inputTypes"):[0m
[30;1m1075 | [0m[35m                    input_type = worker_details["inputTypes"][0][0m
[30;1m1076 | [0m[35m                    return {[0m
[30;1m1077 | [0m[35m                        "sourceTask": input_type,[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1069 | [0m[35m            entry_worker_var = call_node.args[0].id[0m
[30;1m1070 | [0m[35m            entry_worker_class = worker_assignments.get(entry_worker_var)[0m
[30;1m1071 | [0m[35m            if entry_worker_class:[0m
[30;1m1072 | [0m[35m                worker_details = worker_details_map.get(entry_worker_class)[0m
[30;1m1073 | [0m[35m                # Use the already determined input type for this worker[0m
[30;1m1074 | [0m[35m                if worker_details and worker_details.get("inputTypes"):[0m
[30;1m1075 | [0m[35m                    input_type = worker_details["inputTypes"][0][0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1067 | [0m[35m        ):[0m
[30;1m1068 | [0m[35m[0m
[30;1m1069 | [0m[35m            entry_worker_var = call_node.args[0].id[0m
[30;1m1070 | [0m[35m            entry_worker_class = worker_assignments.get(entry_worker_var)[0m
[30;1m1071 | [0m[35m            if entry_worker_class:[0m
[30;1m1072 | [0m[35m                worker_details = worker_details_map.get(entry_worker_class)[0m
[30;1m1073 | [0m[35m                # Use the already determined input type for this worker[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1033 | [0m[35m                    edge_info = {"source": source_class, "target": target_class}[0m
[30;1m1034 | [0m[35m                    # Add target input type if available[0m
[30;1m1035 | [0m[35m                    target_details = worker_details_map.get(target_class)[0m
[30;1m1036 | [0m[35m                    if target_details and target_details.get("inputTypes"):[0m
[30;1m1037 | [0m[35m                        edge_info["targetInputType"] = target_details["inputTypes"][0][0m
[30;1m1038 | [0m[35m                    edges.append(edge_info)[0m
[30;1m1039 | [0m[35m                last_node_var = target_var  # next result flows from its argument[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1032 | [0m[35m                if source_class and target_class:[0m
[30;1m1033 | [0m[35m                    edge_info = {"source": source_class, "target": target_class}[0m
[30;1m1034 | [0m[35m                    # Add target input type if available[0m
[30;1m1035 | [0m[35m                    target_details = worker_details_map.get(target_class)[0m
[30;1m1036 | [0m[35m                    if target_details and target_details.get("inputTypes"):[0m
[30;1m1037 | [0m[35m                        edge_info["targetInputType"] = target_details["inputTypes"][0][0m
[30;1m1038 | [0m[35m                    edges.append(edge_info)[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1028 | [0m[35m                source_var = last_node_var[0m
[30;1m1029 | [0m[35m                target_var = args[0].id[0m
[30;1m1030 | [0m[35m                source_class = worker_assignments.get(source_var)[0m
[30;1m1031 | [0m[35m                target_class = worker_assignments.get(target_var)[0m
[30;1m1032 | [0m[35m                if source_class and target_class:[0m
[30;1m1033 | [0m[35m                    edge_info = {"source": source_class, "target": target_class}[0m
[30;1m1034 | [0m[35m                    # Add target input type if available[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1027 | [0m[35m            if last_node_var:  # Ensure we have a source from the previous chain link[0m
[30;1m1028 | [0m[35m                source_var = last_node_var[0m
[30;1m1029 | [0m[35m                target_var = args[0].id[0m
[30;1m1030 | [0m[35m                source_class = worker_assignments.get(source_var)[0m
[30;1m1031 | [0m[35m                target_class = worker_assignments.get(target_var)[0m
[30;1m1032 | [0m[35m                if source_class and target_class:[0m
[30;1m1033 | [0m[35m                    edge_info = {"source": source_class, "target": target_class}[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1018 | [0m[35m                edge_info = {"source": source_class, "target": target_class}[0m
[30;1m1019 | [0m[35m                # Add target input type if available[0m
[30;1m1020 | [0m[35m                target_details = worker_details_map.get(target_class)[0m
[30;1m1021 | [0m[35m                if target_details and target_details.get("inputTypes"):[0m
[30;1m1022 | [0m[35m                    edge_info["targetInputType"] = target_details["inputTypes"][0][0m
[30;1m1023 | [0m[35m                edges.append(edge_info)[0m
[30;1m1024 | [0m[35m            last_node_var = target_var  # set_dependency result flows from target[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1017 | [0m[35m            if source_class and target_class:[0m
[30;1m1018 | [0m[35m                edge_info = {"source": source_class, "target": target_class}[0m
[30;1m1019 | [0m[35m                # Add target input type if available[0m
[30;1m1020 | [0m[35m                target_details = worker_details_map.get(target_class)[0m
[30;1m1021 | [0m[35m                if target_details and target_details.get("inputTypes"):[0m
[30;1m1022 | [0m[35m                    edge_info["targetInputType"] = target_details["inputTypes"][0][0m
[30;1m1023 | [0m[35m                edges.append(edge_info)[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1013 | [0m[35m            source_var = args[0].id[0m
[30;1m1014 | [0m[35m            target_var = args[1].id[0m
[30;1m1015 | [0m[35m            source_class = worker_assignments.get(source_var)[0m
[30;1m1016 | [0m[35m            target_class = worker_assignments.get(target_var)[0m
[30;1m1017 | [0m[35m            if source_class and target_class:[0m
[30;1m1018 | [0m[35m                edge_info = {"source": source_class, "target": target_class}[0m
[30;1m1019 | [0m[35m                # Add target input type if available[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1012 | [0m[35m        ):[0m
[30;1m1013 | [0m[35m            source_var = args[0].id[0m
[30;1m1014 | [0m[35m            target_var = args[1].id[0m
[30;1m1015 | [0m[35m            source_class = worker_assignments.get(source_var)[0m
[30;1m1016 | [0m[35m            target_class = worker_assignments.get(target_var)[0m
[30;1m1017 | [0m[35m            if source_class and target_class:[0m
[30;1m1018 | [0m[35m                edge_info = {"source": source_class, "target": target_class}[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1001 | [0m[35m        args = call_info.get("args", [])[0m
[30;1m1002 | [0m[35m[0m
[30;1m1003 | [0m[35m        if method == "start":[0m
[30;1m1004 | [0m[35m            last_node_var = call_info.get("var_name")[0m
[30;1m1005 | [0m[35m            continue[0m
[30;1m1006 | [0m[35m[0m
[30;1m1007 | [0m[35m        if ([0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m998 | [0m[35m    last_node_var = None[0m
[30;1m999 | [0m[35m    for call_info in chain:[0m
[30;1m1000 | [0m[35m        method = call_info["method"][0m
[30;1m1001 | [0m[35m        args = call_info.get("args", [])[0m
[30;1m1002 | [0m[35m[0m
[30;1m1003 | [0m[35m        if method == "start":[0m
[30;1m1004 | [0m[35m            last_node_var = call_info.get("var_name")[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m708 | [0m[35m                target_name = stmt.targets[0].id[0m
[30;1m709 | [0m[35m                assignments_in_scope[target_name] = stmt.value[0m
[30;1m710 | [0m[35m[0m
[30;1m711 | [0m[35m    return assignments_in_scope.get(var_name)[0m
[30;1m712 | [0m[35m[0m
[30;1m713 | [0m[35m[0m
[30;1m714 | [0m[35mdef find_graph_builder_function(parsed_ast: ast.Module) -> Optional[ast.FunctionDef]:[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m644 | [0m[35m        if ([0m
[30;1m645 | [0m[35m            isinstance(llm_input_type_val, dict)[0m
[30;1m646 | [0m[35m            and llm_input_type_val.get("isField")[0m
[30;1m647 | [0m[35m            and llm_input_type_val.get("type")[0m
[30;1m648 | [0m[35m        ):[0m
[30;1m649 | [0m[35m            llm_input_type_val = llm_input_type_val["type"][0m
[30;1m650 | [0m[35m        elif not isinstance(llm_input_type_val, str):[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m643 | [0m[35m        # Handle string or Field dict[0m
[30;1m644 | [0m[35m        if ([0m
[30;1m645 | [0m[35m            isinstance(llm_input_type_val, dict)[0m
[30;1m646 | [0m[35m            and llm_input_type_val.get("isField")[0m
[30;1m647 | [0m[35m            and llm_input_type_val.get("type")[0m
[30;1m648 | [0m[35m        ):[0m
[30;1m649 | [0m[35m            llm_input_type_val = llm_input_type_val["type"][0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m        )[0m
[30;1m640 | [0m[35m[0m
[30;1m641 | [0m[35m    if worker_type in ("llmtaskworker", "cachedllmtaskworker"):[0m
[30;1m642 | [0m[35m        llm_input_type_val = details["classVars"].get("llm_input_type")[0m
[30;1m643 | [0m[35m        # Handle string or Field dict[0m
[30;1m644 | [0m[35m        if ([0m
[30;1m645 | [0m[35m            isinstance(llm_input_type_val, dict)[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m        # Check against known worker bases in order of specificity[0m
[30;1m367 | [0m[35m        for base in WORKER_BASE_CLASSES:[0m
[30;1m368 | [0m[35m            if base in resolved_bases:[0m
[30;1m369 | [0m[35m                found_worker_type = WORKER_TYPE_MAP.get([0m
[30;1m370 | [0m[35m                    base, "taskworker"[0m
[30;1m371 | [0m[35m                )  # Default fallback[0m
[30;1m372 | [0m[35m                break  # Found the most specific type[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m                # Add other mappings if needed[0m
[30;1m264 | [0m[35m            }[0m
[30;1m265 | [0m[35m            # Default to the original base_type_str if not a primitive, could be Any or complex[0m
[30;1m266 | [0m[35m            frontend_type = type_mapping.get(base_type_str, base_type_str)[0m
[30;1m267 | [0m[35m    else:[0m
[30;1m268 | [0m[35m        frontend_type = "literal"  # Keep our special type[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1421 | [0m[35m    imported_tasks = [][0m
[30;1m1422 | [0m[35m    imported_task_names: Set[str] = set()  # Keep track of names found via import[0m
[30;1m1423 | [0m[35m[0m
[30;1m1424 | [0m[35m    for node in parsed_ast.body:[0m
[30;1m1425 | [0m[35m        if isinstance(node, ast.ImportFrom):[0m
[30;1m1426 | [0m[35m            module_path = node.module[0m
[30;1m1427 | [0m[35m            if module_path and module_path in ALLOWED_TASK_IMPORTS:[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1415 | [0m[35m        print(f"Extracted edges: {edges}")[0m
[30;1m1416 | [0m[35m        print(f"Extracted entry edges: {entry_edges}")[0m
[30;1m1417 | [0m[35m    else:[0m
[30;1m1418 | [0m[35m        print("Warning: Could not find a graph builder function.")[0m
[30;1m1419 | [0m[35m[0m
[30;1m1420 | [0m[35m    # --- Extract Imported Tasks (Based on Allow List) ---[0m
[30;1m1421 | [0m[35m    imported_tasks = [][0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1272 | [0m[35m        # Get all worker class names defined in the file (needed for get_worker_assignments)[0m
[30;1m1273 | [0m[35m        directly_defined_worker_classes = {w["className"] for w in worker_results}[0m
[30;1m1274 | [0m[35m[0m
[30;1m1275 | [0m[35m        # Find all relevant assignments (direct instantiations and factory calls)[0m
[30;1m1276 | [0m[35m        worker_instances = get_worker_assignments([0m
[30;1m1277 | [0m[35m            graph_func_node, directly_defined_worker_classes[0m
[30;1m1278 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1119 | [0m[35m        # Direct list literal[0m
[30;1m1120 | [0m[35m        initial_tasks_list_node = initial_tasks_arg_value[0m
[30;1m1121 | [0m[35m    elif isinstance(initial_tasks_arg_value, ast.Name):[0m
[30;1m1122 | [0m[35m        # Variable name, find its assignment in the current function scope[0m
[30;1m1123 | [0m[35m        var_name = initial_tasks_arg_value.id[0m
[30;1m1124 | [0m[35m        assigned_value_node = find_assignment_in_scope(var_name, stmt, func_node)[0m
[30;1m1125 | [0m[35m        if isinstance(assigned_value_node, ast.List):[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1104 | [0m[35m    ):[0m
[30;1m1105 | [0m[35m        return entry_edges[0m
[30;1m1106 | [0m[35m[0m
[30;1m1107 | [0m[35m    # Find the initial_tasks keyword argument[0m
[30;1m1108 | [0m[35m    initial_tasks_arg_value = None[0m
[30;1m1109 | [0m[35m    for keyword in call_node.keywords:[0m
[30;1m1110 | [0m[35m        if keyword.arg == "initial_tasks":[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1083 | [0m[35mdef parse_graph_run_entry_points([0m
[30;1m1084 | [0m[35m    stmt: ast.stmt,[0m
[30;1m1085 | [0m[35m    worker_assignments: Dict[str, str],[0m
[30;1m1086 | [0m[35m    func_node: ast.FunctionDef,  # Pass the function node for scope lookup[0m
[30;1m1087 | [0m[35m) -> List[Dict[str, str]]:[0m
[30;1m1088 | [0m[35m    """Parses a graph.run(initial_tasks=[...]) call to extract entry points.[0m
[30;1m1089 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m793 | [0m[35m                    if is_literal:[0m
[30;1m794 | [0m[35m                        llm_args[kw.arg] = {"value": value, "is_literal": True}[0m
[30;1m795 | [0m[35m                    else:[0m
[30;1m796 | [0m[35m                        # If not a literal, unparse the node to get the variable/expression string[0m
[30;1m797 | [0m[35m                        try:[0m
[30;1m798 | [0m[35m                            unparsed_value = ast.unparse(kw.value)[0m
[30;1m799 | [0m[35m                            llm_args[kw.arg] = {[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m754 | [0m[35m                                break  # Found a relevant graph method call[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m            if graph_assigned and calls_graph_methods:[0m
[30;1m757 | [0m[35m                return node  # Found a likely candidate[0m
[30;1m758 | [0m[35m[0m
[30;1m759 | [0m[35m    return None  # Function not found[0m
[30;1m760 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m713 | [0m[35m[0m
[30;1m714 | [0m[35mdef find_graph_builder_function(parsed_ast: ast.Module) -> Optional[ast.FunctionDef]:[0m
[30;1m715 | [0m[35m    """Finds a function likely responsible for building the PlanAI graph."""[0m
[30;1m716 | [0m[35m    for node in ast.walk(parsed_ast):[0m
[30;1m717 | [0m[35m        if isinstance(node, ast.FunctionDef):[0m
[30;1m718 | [0m[35m            # Look for graph instantiation or specific method calls[0m
[30;1m719 | [0m[35m            # More robust check: look for graph = Graph(...) assignment specifically[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m698 | [0m[35m    var_name: str, start_node: ast.AST, scope_node: ast.FunctionDef[0m
[30;1m699 | [0m[35m) -> Optional[ast.expr]:[0m
[30;1m700 | [0m[35m    """Finds the value assigned to var_name before start_node within the scope_node."""[0m
[30;1m701 | [0m[35m    # Simple approach: find the last assignment in the function scope.[0m
[30;1m702 | [0m[35m    # A more robust approach might consider line numbers or control flow.[0m
[30;1m703 | [0m[35m    assignments_in_scope = {}[0m
[30;1m704 | [0m[35m    for stmt in ast.walk(scope_node):[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m    Returns:[0m
[30;1m685 | [0m[35m        Tuple[Any, bool]: (evaluated_value, is_literal)[0m
[30;1m686 | [0m[35m        is_literal is True if the node is a Constant, False otherwise.[0m
[30;1m687 | [0m[35m        evaluated_value is the constant value if is_literal is True, else None.[0m
[30;1m688 | [0m[35m    """[0m
[30;1m689 | [0m[35m    if isinstance(node, ast.Constant):[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m679 | [0m[35m# Helper to evaluate constant AST nodes and determine if literal[0m
[30;1m680 | [0m[35mdef _evaluate_ast_node(node: Optional[ast.expr]) -> Tuple[Any, bool]:[0m
[30;1m681 | [0m[35m    """[0m
[30;1m682 | [0m[35m    Evaluates an AST node if it's a simple literal constant.[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m    Returns:[0m
[30;1m685 | [0m[35m        Tuple[Any, bool]: (evaluated_value, is_literal)[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m585 | [0m[35m                details["methods"][method_name] = method_source[0m
[30;1m586 | [0m[35m            else:  # Not a specifically handled method, add to consolidated source[0m
[30;1m587 | [0m[35m                details["otherMembersSource"] += dedent(method_source) + "\n"[0m
[30;1m588 | [0m[35m        # Could add handling for other node types like Import, If, etc. if needed[0m
[30;1m589 | [0m[35m[0m
[30;1m590 | [0m[35m    # Clean up trailing newlines from the consolidated source[0m
[30;1m591 | [0m[35m    details["otherMembersSource"] = details["otherMembersSource"].strip()[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m538 | [0m[35m        except Exception:[0m
[30;1m539 | [0m[35m            return f"<Error unparsing value for {var_name}>"[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m    for node in class_def.body:[0m
[30;1m542 | [0m[35m        if isinstance(node, ast.Assign) or isinstance(node, ast.AnnAssign):[0m
[30;1m543 | [0m[35m            var_name = None[0m
[30;1m544 | [0m[35m            # Simple assignment: var = value[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m532 | [0m[35m                field_info["type"] = _parse_type_annotation_name(node.annotation)[0m
[30;1m533 | [0m[35m            # Could add default value parsing here if needed[0m
[30;1m534 | [0m[35m            return field_info[0m
[30;1m535 | [0m[35m        # Fallback: unparse the node[0m
[30;1m536 | [0m[35m        try:[0m
[30;1m537 | [0m[35m            return ast.unparse(value_node)[0m
[30;1m538 | [0m[35m        except Exception:[0m
[30;1m539 | [0m[35m            return f"<Error unparsing value for {var_name}>"[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m412 | [0m[35m        if len(method_node.args.args) > 1:  # Check if there is an arg after self[0m
[30;1m413 | [0m[35m            task_arg = method_node.args.args[1][0m
[30;1m414 | [0m[35m            if task_arg.annotation:[0m
[30;1m415 | [0m[35m                # Use the existing helper to parse the annotation node[0m
[30;1m416 | [0m[35m                # We don't need known_task_types here, just the basic name[0m
[30;1m417 | [0m[35m                input_type_name, _, _, _ = _parse_annotation(task_arg.annotation, set())[0m
[30;1m418 | [0m[35m                if input_type_name != "Any":[0m
[30;1m419 | [0m[35m                    return input_type_name[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m386 | [0m[35m        elif isinstance(elt, ast.Attribute):  # Handle potential module.Type references[0m
[30;1m387 | [0m[35m            types.append(ast.unparse(elt))  # Store full name like module.Type[0m
[30;1m388 | [0m[35m        else:[0m
[30;1m389 | [0m[35m            # Fallback for complex elements: unparse the node[0m
[30;1m390 | [0m[35m            types.append(ast.unparse(elt))[0m
[30;1m391 | [0m[35m    return types[0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35mdef _parse_list_of_types(node: ast.List) -> List[str]:[0m
[30;1m381 | [0m[35m    """Parses an AST List node expected to contain type names (e.g., [Type1, Type2])."""[0m
[30;1m382 | [0m[35m    types = [][0m
[30;1m383 | [0m[35m    for elt in node.elts:[0m
[30;1m384 | [0m[35m        if isinstance(elt, ast.Name):[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m    """Extracts field definitions (AnnAssign) from a Task class AST node."""[0m
[30;1m291 | [0m[35m    fields = [][0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m    for node in class_def.body:[0m
[30;1m294 | [0m[35m        if isinstance(node, ast.AnnAssign):[0m
[30;1m295 | [0m[35m            field_name = node.target.id if isinstance(node.target, ast.Name) else None[0m
[30;1m296 | [0m[35m            if not field_name:[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m            elif isinstance(annotation_node.slice, ast.Subscript):[0m
[30;1m159 | [0m[35m                return ([0m
[30;1m160 | [0m[35m                    annotation_node.slice[0m
[30;1m161 | [0m[35m                )  # Return inner type node (could be List[str], etc.)[0m
[30;1m162 | [0m[35m            else:[0m
[30;1m163 | [0m[35m                # Fallback for other versions[0m
[30;1m164 | [0m[35m                return annotation_node.slice[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m            is_optional = True[0m
[30;1m155 | [0m[35m            # Extract the inner type[0m
[30;1m156 | [0m[35m            if isinstance(annotation_node.slice, ast.Name):[0m
[30;1m157 | [0m[35m                return annotation_node.slice  # Return inner type node[0m
[30;1m158 | [0m[35m            elif isinstance(annotation_node.slice, ast.Subscript):[0m
[30;1m159 | [0m[35m                return ([0m
[30;1m160 | [0m[35m                    annotation_node.slice[0m
[30;1m161 | [0m[35m                )  # Return inner type node (could be List[str], etc.)[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35mdef _parse_annotation([0m
[30;1m130 | [0m[35m    annotation: ast.expr, known_task_types: Set[str][0m
[30;1m131 | [0m[35m) -> Tuple[str, bool, Optional[List[str]], bool]:[0m
[30;1m132 | [0m[35m    """Parses a type annotation AST node into a type string, list status, and literal values.[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    Recognizes basic types, List[...], Optional[...], known custom Task types, and Literal types.[0m
[30;1m135 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35mdef filter_derived_classes([0m
[30;1m115 | [0m[35m    class_definitions: List[ast.ClassDef], target_base_class: str[0m
[30;1m116 | [0m[35m) -> List[ast.ClassDef]:[0m
[30;1m117 | [0m[35m    """Filters class definitions to find those inheriting from a specific base class."""[0m
[30;1m118 | [0m[35m    all_classes_map = {cls.name: cls for cls in class_definitions}[0m
[30;1m119 | [0m[35m    derived_classes = [][0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m        if isinstance(base, ast.Name):[0m
[30;1m103 | [0m[35m            base_name = base.id[0m
[30;1m104 | [0m[35m            base_names.add(base_name)[0m
[30;1m105 | [0m[35m            # Recursively find bases of the base class if it's in the current AST[0m
[30;1m106 | [0m[35m            if base_name in all_classes:[0m
[30;1m107 | [0m[35m                base_names.update([0m
[30;1m108 | [0m[35m                    _resolve_base_classes(all_classes[base_name], all_classes)[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35mdef get_class_definitions(parsed_ast: ast.Module) -> List[ast.ClassDef]:[0m
[30;1m92 | [0m[35m    """Extracts all class definitions from an AST module."""[0m
[30;1m93 | [0m[35m    return [node for node in parsed_ast.body if isinstance(node, ast.ClassDef)][0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef _resolve_base_classes([0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m699 | [0m[35m) -> Optional[ast.expr]:[0m
[30;1m700 | [0m[35m    """Finds the value assigned to var_name before start_node within the scope_node."""[0m
[30;1m701 | [0m[35m    # Simple approach: find the last assignment in the function scope.[0m
[30;1m702 | [0m[35m    # A more robust approach might consider line numbers or control flow.[0m
[30;1m703 | [0m[35m    assignments_in_scope = {}[0m
[30;1m704 | [0m[35m    for stmt in ast.walk(scope_node):[0m
[30;1m705 | [0m[35m        if isinstance(stmt, ast.Assign):[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m.hostname[0m
[30;1m580 | [0m[35m    key_map = {[0m
[30;1m581 | [0m[35m        "modelId": "model_name",[0m
[30;1m582 | [0m[35m        "baseUrl": "host",[0m
[30;1m583 | [0m[35m        "remoteHostname": "hostname",[0m
[30;1m584 | [0m[35m        "remoteUsername": "username",[0m
[30;1m585 | [0m[35m    }[0m
[30;1m586 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m832 | [0m[35m    data = node.get("data", {})[0m
[30;1m833 | [0m[35m    if data.get("variableName"):[0m
[30;1m834 | [0m[35m        return data.get("variableName")[0m
[30;1m835 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m836 | [0m[35m    return worker_class_name.lower() + "_worker"[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m831 | [0m[35mdef worker_to_instance_name(node: Dict[str, Any]) -> str:[0m
[30;1m832 | [0m[35m    data = node.get("data", {})[0m
[30;1m833 | [0m[35m    if data.get("variableName"):[0m
[30;1m834 | [0m[35m        return data.get("variableName")[0m
[30;1m835 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m836 | [0m[35m    return worker_class_name.lower() + "_worker"[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35mdef worker_to_instance_name(node: Dict[str, Any]) -> str:[0m
[30;1m832 | [0m[35m    data = node.get("data", {})[0m
[30;1m833 | [0m[35m    if data.get("variableName"):[0m
[30;1m834 | [0m[35m        return data.get("variableName")[0m
[30;1m835 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m836 | [0m[35m    return worker_class_name.lower() + "_worker"[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m829 | [0m[35m[0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35mdef worker_to_instance_name(node: Dict[str, Any]) -> str:[0m
[30;1m832 | [0m[35m    data = node.get("data", {})[0m
[30;1m833 | [0m[35m    if data.get("variableName"):[0m
[30;1m834 | [0m[35m        return data.get("variableName")[0m
[30;1m835 | [0m[35m    worker_class_name = data.get("className")[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m765 | [0m[35m        dep_code_lines.append("# No dependencies defined in the graph data.")[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m    # 5. Initial Tasks[0m
[30;1m768 | [0m[35m    datainput_nodes = [n for n in nodes if n.get("type") == "datainput"][0m
[30;1m769 | [0m[35m    initial_tasks = [][0m
[30;1m770 | [0m[35m    for node in datainput_nodes:[0m
[30;1m771 | [0m[35m        inital_task = create_initial_tasks(node, worker_nodes, edges)[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m753 | [0m[35m        worker_setup.append("# No workers instantiated.")[0m
[30;1m754 | [0m[35m[0m
[30;1m755 | [0m[35m    # --- Generate Code for Dependencies and Entry Point *inside* create_graph ---[0m
[30;1m756 | [0m[35m    output_nodes = [n for n in nodes if n.get("type") == "dataoutput"][0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35m    dep_code_lines = [][0m
[30;1m759 | [0m[35m    dep_code_lines.append([0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m725 | [0m[35m            )[0m
[30;1m726 | [0m[35m        else:  # Only process regular workers here[0m
[30;1m727 | [0m[35m            llm_config = data.get("llmConfig")[0m
[30;1m728 | [0m[35m            llm_name = data.get("llmConfigVar")[0m
[30;1m729 | [0m[35m            if llm_config and llm_name and llm_name not in llm_names_used:[0m
[30;1m730 | [0m[35m                llm_configs.append([0m
[30;1m731 | [0m[35m                    f"    {llm_name} = llm_from_config({', '.join(create_llm_args(llm_config))})"[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m724 | [0m[35m                )[0m
[30;1m725 | [0m[35m            )[0m
[30;1m726 | [0m[35m        else:  # Only process regular workers here[0m
[30;1m727 | [0m[35m            llm_config = data.get("llmConfig")[0m
[30;1m728 | [0m[35m            llm_name = data.get("llmConfigVar")[0m
[30;1m729 | [0m[35m            if llm_config and llm_name and llm_name not in llm_names_used:[0m
[30;1m730 | [0m[35m                llm_configs.append([0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m706 | [0m[35m        node_id = node["id"][0m
[30;1m707 | [0m[35m        data = node.get("data", {})[0m
[30;1m708 | [0m[35m        worker_class_name = data.get("className")[0m
[30;1m709 | [0m[35m        factory_function = data.get("factoryFunction")[0m
[30;1m710 | [0m[35m[0m
[30;1m711 | [0m[35m        if not worker_class_name:[0m
[30;1m712 | [0m[35m            print(f"Warning: Skipping node {node_id} due to missing className.")[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m705 | [0m[35m    for node in worker_nodes:[0m
[30;1m706 | [0m[35m        node_id = node["id"][0m
[30;1m707 | [0m[35m        data = node.get("data", {})[0m
[30;1m708 | [0m[35m        worker_class_name = data.get("className")[0m
[30;1m709 | [0m[35m        factory_function = data.get("factoryFunction")[0m
[30;1m710 | [0m[35m[0m
[30;1m711 | [0m[35m        if not worker_class_name:[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m    for node in worker_nodes:[0m
[30;1m706 | [0m[35m        node_id = node["id"][0m
[30;1m707 | [0m[35m        data = node.get("data", {})[0m
[30;1m708 | [0m[35m        worker_class_name = data.get("className")[0m
[30;1m709 | [0m[35m        factory_function = data.get("factoryFunction")[0m
[30;1m710 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m671 | [0m[35m    worker_nodes = [[0m
[30;1m672 | [0m[35m        n[0m
[30;1m673 | [0m[35m        for n in nodes[0m
[30;1m674 | [0m[35m        if n.get("type")[0m
[30;1m675 | [0m[35m        in ([0m
[30;1m676 | [0m[35m            "taskworker",[0m
[30;1m677 | [0m[35m            "llmtaskworker",[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m659 | [0m[35m            )[0m
[30;1m660 | [0m[35m    # 2. Task Definitions (from 'task' nodes)[0m
[30;1m661 | [0m[35m    tasks_code = [][0m
[30;1m662 | [0m[35m    task_nodes = [n for n in nodes if n.get("type") == "task"][0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    # Add locally defined Task nodes[0m
[30;1m665 | [0m[35m    for node in task_nodes:[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m643 | [0m[35m    )[0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m    imported_tasks = {}  # Store details of imported tasks: {className: modulePath}[0m
[30;1m646 | [0m[35m    task_import_nodes = [n for n in nodes if n.get("type") == "taskimport"][0m
[30;1m647 | [0m[35m[0m
[30;1m648 | [0m[35m    # Add imports for TaskImportNodes first[0m
[30;1m649 | [0m[35m    import_statements = [][0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m637 | [0m[35m    # --- Code Generation Start ---[0m
[30;1m638 | [0m[35m[0m
[30;1m639 | [0m[35m    # 1. Imports[0m
[30;1m640 | [0m[35m    mode = graph_data.get("mode", "export")[0m
[30;1m641 | [0m[35m    code_to_format = return_code_snippet([0m
[30;1m642 | [0m[35m        "export_execute" if mode == "execute" else "export_clean"[0m
[30;1m643 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m629 | [0m[35m    print("Generating PlanAI Python module from graph data...")[0m
[30;1m630 | [0m[35m    module_name = "generated_plan"[0m
[30;1m631 | [0m[35m    nodes = graph_data.get("nodes", [])[0m
[30;1m632 | [0m[35m    edges = graph_data.get("edges", [])[0m
[30;1m633 | [0m[35m[0m
[30;1m634 | [0m[35m    print("--------------------------------")[0m
[30;1m635 | [0m[35m    print(json.dumps(graph_data, indent=4))[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m628 | [0m[35m    """[0m
[30;1m629 | [0m[35m    print("Generating PlanAI Python module from graph data...")[0m
[30;1m630 | [0m[35m    module_name = "generated_plan"[0m
[30;1m631 | [0m[35m    nodes = graph_data.get("nodes", [])[0m
[30;1m632 | [0m[35m    edges = graph_data.get("edges", [])[0m
[30;1m633 | [0m[35m[0m
[30;1m634 | [0m[35m    print("--------------------------------")[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m592 | [0m[35m        arg_info = llm_config[arg_name][0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m        value = arg_info["value"][0m
[30;1m595 | [0m[35m        is_literal = arg_info.get([0m
[30;1m596 | [0m[35m            "is_literal", True[0m
[30;1m597 | [0m[35m        )  # Default to literal if flag missing?[0m
[30;1m598 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m            llm_arg = f"llm={llm_name}"[0m
[30;1m545 | [0m[35m        else:[0m
[30;1m546 | [0m[35m            llm_arg = "llm=None"[0m
[30;1m547 | [0m[35m            llm_config = data.get("llmConfig")[0m
[30;1m548 | [0m[35m[0m
[30;1m549 | [0m[35m            if llm_config:[0m
[30;1m550 | [0m[35m                llm_args_list = create_llm_args(llm_config)[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m532 | [0m[35m    data = node.get("data", {})[0m
[30;1m533 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m534 | [0m[35m    instance_name = worker_to_instance_name(node)[0m
[30;1m535 | [0m[35m    worker_type = node.get("type")[0m
[30;1m536 | [0m[35m[0m
[30;1m537 | [0m[35m    code = [][0m
[30;1m538 | [0m[35m    # Wrap instantiation in try-except[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m530 | [0m[35m    wrap_in_try_except: bool = True,[0m
[30;1m531 | [0m[35m) -> str:[0m
[30;1m532 | [0m[35m    data = node.get("data", {})[0m
[30;1m533 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m534 | [0m[35m    instance_name = worker_to_instance_name(node)[0m
[30;1m535 | [0m[35m    worker_type = node.get("type")[0m
[30;1m536 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m    llm_name: Optional[str] = None,[0m
[30;1m530 | [0m[35m    wrap_in_try_except: bool = True,[0m
[30;1m531 | [0m[35m) -> str:[0m
[30;1m532 | [0m[35m    data = node.get("data", {})[0m
[30;1m533 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m534 | [0m[35m    instance_name = worker_to_instance_name(node)[0m
[30;1m535 | [0m[35m    worker_type = node.get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m    data = node.get("data", {})[0m
[30;1m502 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m503 | [0m[35m    factory_function = data.get("factoryFunction")[0m
[30;1m504 | [0m[35m    factory_invocation = data.get("factoryInvocation", "")[0m
[30;1m505 | [0m[35m    instance_name = worker_to_instance_name(node)[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m    # Handle factory-created SubGraphWorker[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35m) -> str:[0m
[30;1m501 | [0m[35m    data = node.get("data", {})[0m
[30;1m502 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m503 | [0m[35m    factory_function = data.get("factoryFunction")[0m
[30;1m504 | [0m[35m    factory_invocation = data.get("factoryInvocation", "")[0m
[30;1m505 | [0m[35m    instance_name = worker_to_instance_name(node)[0m
[30;1m506 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m499 | [0m[35m    node: Dict[str, Any], factories_used: Set[str], wrap_in_try_except: bool = True[0m
[30;1m500 | [0m[35m) -> str:[0m
[30;1m501 | [0m[35m    data = node.get("data", {})[0m
[30;1m502 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m503 | [0m[35m    factory_function = data.get("factoryFunction")[0m
[30;1m504 | [0m[35m    factory_invocation = data.get("factoryInvocation", "")[0m
[30;1m505 | [0m[35m    instance_name = worker_to_instance_name(node)[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m498 | [0m[35mdef create_factory_worker_instance([0m
[30;1m499 | [0m[35m    node: Dict[str, Any], factories_used: Set[str], wrap_in_try_except: bool = True[0m
[30;1m500 | [0m[35m) -> str:[0m
[30;1m501 | [0m[35m    data = node.get("data", {})[0m
[30;1m502 | [0m[35m    worker_class_name = data.get("className")[0m
[30;1m503 | [0m[35m    factory_function = data.get("factoryFunction")[0m
[30;1m504 | [0m[35m    factory_invocation = data.get("factoryInvocation", "")[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m                raise ValueError(f"Failed to parse method: {method_name}")[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m    # --- Process Other Members Source ---[0m
[30;1m464 | [0m[35m    other_source = data.get("otherMembersSource", None)[0m
[30;1m465 | [0m[35m    if other_source:[0m
[30;1m466 | [0m[35m        dedented_other = dedent(other_source).strip()[0m
[30;1m467 | [0m[35m        if dedented_other:[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m428 | [0m[35m                output_type_hint = "Task"  # Default[0m
[30;1m429 | [0m[35m                if base_class == "LLMTaskWorker" or base_class == "CachedLLMTaskWorker":[0m
[30;1m430 | [0m[35m                    # Try to get llm_output_type[0m
[30;1m431 | [0m[35m                    llm_output_type_name = class_vars.get("llm_output_type")[0m
[30;1m432 | [0m[35m                    if llm_output_type_name and isinstance(llm_output_type_name, str):[0m
[30;1m433 | [0m[35m                        output_type_hint = get_task_class_name(llm_output_type_name)[0m
[30;1m434 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m409 | [0m[35m    if methods:[0m
[30;1m410 | [0m[35m        # Determine input type hint for consume_work/consume_work_joined[0m
[30;1m411 | [0m[35m        input_type_hint = "Task"  # Default[0m
[30;1m412 | [0m[35m        input_types = data.get("inputTypes", [])[0m
[30;1m413 | [0m[35m        if input_types:[0m
[30;1m414 | [0m[35m            input_type_hint = get_task_class_name(input_types[0])[0m
[30;1m415 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m        class_body.append("    debug_mode: bool = True")[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m    # --- Process Methods ---[0m
[30;1m408 | [0m[35m    methods = data.get("methods", {})[0m
[30;1m409 | [0m[35m    if methods:[0m
[30;1m410 | [0m[35m        # Determine input type hint for consume_work/consume_work_joined[0m
[30;1m411 | [0m[35m        input_type_hint = "Task"  # Default[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m    elif class_vars.get("use_xml") is False:[0m
[30;1m402 | [0m[35m        class_body.append("    use_xml: bool = False")[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    if class_vars.get("debug_mode") is True:[0m
[30;1m405 | [0m[35m        class_body.append("    debug_mode: bool = True")[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m    # --- Process Methods ---[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m    # Handle Boolean Flags (use_xml, debug_mode)[0m
[30;1m399 | [0m[35m    if class_vars.get("use_xml") is True:[0m
[30;1m400 | [0m[35m        class_body.append("    use_xml: bool = True")[0m
[30;1m401 | [0m[35m    elif class_vars.get("use_xml") is False:[0m
[30;1m402 | [0m[35m        class_body.append("    use_xml: bool = False")[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    if class_vars.get("debug_mode") is True:[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m        class_body.append(f'    system_prompt: str = """{dedented_sys_prompt}"""')[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35m    # Handle Boolean Flags (use_xml, debug_mode)[0m
[30;1m399 | [0m[35m    if class_vars.get("use_xml") is True:[0m
[30;1m400 | [0m[35m        class_body.append("    use_xml: bool = True")[0m
[30;1m401 | [0m[35m    elif class_vars.get("use_xml") is False:[0m
[30;1m402 | [0m[35m        class_body.append("    use_xml: bool = False")[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m        input_type_class = get_task_class_name(llm_input_type)[0m
[30;1m374 | [0m[35m        class_body.append(f"    llm_input_type: Type[Task] = {input_type_class}")[0m
[30;1m375 | [0m[35m    elif node_type == "llmtaskworker":[0m
[30;1m376 | [0m[35m        input_type = data.get("inputTypes", [])[0m
[30;1m377 | [0m[35m        if input_type:[0m
[30;1m378 | [0m[35m            input_type_class = get_task_class_name(input_type[0])[0m
[30;1m379 | [0m[35m            class_body.append(f"    llm_input_type: Type[Task] = {input_type_class}")[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m    llm_output_type = class_vars.get("llm_output_type")[0m
[30;1m362 | [0m[35m    join_type = class_vars.get("join_type")[0m
[30;1m363 | [0m[35m    prompt = class_vars.get("prompt")[0m
[30;1m364 | [0m[35m    system_prompt = class_vars.get("system_prompt")[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m    # Handle Output Types[0m
[30;1m367 | [0m[35m    if output_types and node_type != "chattaskworker":[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m    llm_input_type = class_vars.get("llm_input_type")[0m
[30;1m361 | [0m[35m    llm_output_type = class_vars.get("llm_output_type")[0m
[30;1m362 | [0m[35m    join_type = class_vars.get("join_type")[0m
[30;1m363 | [0m[35m    prompt = class_vars.get("prompt")[0m
[30;1m364 | [0m[35m    system_prompt = class_vars.get("system_prompt")[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m    # Handle Output Types[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35m    # Retrieve specific class variables from the classVars dict[0m
[30;1m360 | [0m[35m    llm_input_type = class_vars.get("llm_input_type")[0m
[30;1m361 | [0m[35m    llm_output_type = class_vars.get("llm_output_type")[0m
[30;1m362 | [0m[35m    join_type = class_vars.get("join_type")[0m
[30;1m363 | [0m[35m    prompt = class_vars.get("prompt")[0m
[30;1m364 | [0m[35m    system_prompt = class_vars.get("system_prompt")[0m
[30;1m365 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m    output_types = class_vars.get("output_types", [])[0m
[30;1m359 | [0m[35m    # Retrieve specific class variables from the classVars dict[0m
[30;1m360 | [0m[35m    llm_input_type = class_vars.get("llm_input_type")[0m
[30;1m361 | [0m[35m    llm_output_type = class_vars.get("llm_output_type")[0m
[30;1m362 | [0m[35m    join_type = class_vars.get("join_type")[0m
[30;1m363 | [0m[35m    prompt = class_vars.get("prompt")[0m
[30;1m364 | [0m[35m    system_prompt = class_vars.get("system_prompt")[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m    # Read output_types from class_vars, not the top-level data[0m
[30;1m358 | [0m[35m    output_types = class_vars.get("output_types", [])[0m
[30;1m359 | [0m[35m    # Retrieve specific class variables from the classVars dict[0m
[30;1m360 | [0m[35m    llm_input_type = class_vars.get("llm_input_type")[0m
[30;1m361 | [0m[35m    llm_output_type = class_vars.get("llm_output_type")[0m
[30;1m362 | [0m[35m    join_type = class_vars.get("join_type")[0m
[30;1m363 | [0m[35m    prompt = class_vars.get("prompt")[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m    # --- Process Class Variables ---[0m
[30;1m356 | [0m[35m    class_vars = data.get("classVars", {})[0m
[30;1m357 | [0m[35m    # Read output_types from class_vars, not the top-level data[0m
[30;1m358 | [0m[35m    output_types = class_vars.get("output_types", [])[0m
[30;1m359 | [0m[35m    # Retrieve specific class variables from the classVars dict[0m
[30;1m360 | [0m[35m    llm_input_type = class_vars.get("llm_input_type")[0m
[30;1m361 | [0m[35m    llm_output_type = class_vars.get("llm_output_type")[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m    class_body = []  # Store lines for the current class body[0m
[30;1m354 | [0m[35m[0m
[30;1m355 | [0m[35m    # --- Process Class Variables ---[0m
[30;1m356 | [0m[35m    class_vars = data.get("classVars", {})[0m
[30;1m357 | [0m[35m    # Read output_types from class_vars, not the top-level data[0m
[30;1m358 | [0m[35m    output_types = class_vars.get("output_types", [])[0m
[30;1m359 | [0m[35m    # Retrieve specific class variables from the classVars dict[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m    code = [][0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m    worker_name = data.get("className")[0m
[30;1m336 | [0m[35m    if not is_valid_python_class_name(worker_name):[0m
[30;1m337 | [0m[35m        raise ValueError(f"Invalid worker class name: {worker_name}")[0m
[30;1m338 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m    node_type = node.get("type")[0m
[30;1m328 | [0m[35m    data = node.get("data", {})[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m    if data.get("factoryFunction"):[0m
[30;1m331 | [0m[35m        return None[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m    code = [][0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35mdef create_worker_class(node: Dict[str, Any]) -> Optional[str]:[0m
[30;1m326 | [0m[35m    # Determine base class based on node type, including cached variants[0m
[30;1m327 | [0m[35m    node_type = node.get("type")[0m
[30;1m328 | [0m[35m    data = node.get("data", {})[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m    if data.get("factoryFunction"):[0m
[30;1m331 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35mdef create_worker_class(node: Dict[str, Any]) -> Optional[str]:[0m
[30;1m326 | [0m[35m    # Determine base class based on node type, including cached variants[0m
[30;1m327 | [0m[35m    node_type = node.get("type")[0m
[30;1m328 | [0m[35m    data = node.get("data", {})[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m    if data.get("factoryFunction"):[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m        description = field.get("description", "")[0m
[30;1m251 | [0m[35m        is_list = field.get("isList", False)[0m
[30;1m252 | [0m[35m        literal_values = field.get("literalValues", None)[0m
[30;1m253 | [0m[35m        is_required = field.get("required", True)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        # Handle Literal types[0m
[30;1m256 | [0m[35m        if field_type_frontend == "literal" and literal_values:[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        field_type_frontend = field.get("type", "Any")  # Type from frontend/import[0m
[30;1m250 | [0m[35m        description = field.get("description", "")[0m
[30;1m251 | [0m[35m        is_list = field.get("isList", False)[0m
[30;1m252 | [0m[35m        literal_values = field.get("literalValues", None)[0m
[30;1m253 | [0m[35m        is_required = field.get("required", True)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        # Handle Literal types[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m        field_name = field.get("name", "unnamed_field")[0m
[30;1m249 | [0m[35m        field_type_frontend = field.get("type", "Any")  # Type from frontend/import[0m
[30;1m250 | [0m[35m        description = field.get("description", "")[0m
[30;1m251 | [0m[35m        is_list = field.get("isList", False)[0m
[30;1m252 | [0m[35m        literal_values = field.get("literalValues", None)[0m
[30;1m253 | [0m[35m        is_required = field.get("required", True)[0m
[30;1m254 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m    for field in fields:[0m
[30;1m248 | [0m[35m        field_name = field.get("name", "unnamed_field")[0m
[30;1m249 | [0m[35m        field_type_frontend = field.get("type", "Any")  # Type from frontend/import[0m
[30;1m250 | [0m[35m        description = field.get("description", "")[0m
[30;1m251 | [0m[35m        is_list = field.get("isList", False)[0m
[30;1m252 | [0m[35m        literal_values = field.get("literalValues", None)[0m
[30;1m253 | [0m[35m        is_required = field.get("required", True)[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m    # code.append("    model_config = ConfigDict(arbitrary_types_allowed=True)")[0m
[30;1m247 | [0m[35m    for field in fields:[0m
[30;1m248 | [0m[35m        field_name = field.get("name", "unnamed_field")[0m
[30;1m249 | [0m[35m        field_type_frontend = field.get("type", "Any")  # Type from frontend/import[0m
[30;1m250 | [0m[35m        description = field.get("description", "")[0m
[30;1m251 | [0m[35m        is_list = field.get("isList", False)[0m
[30;1m252 | [0m[35m        literal_values = field.get("literalValues", None)[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m    # Add ConfigDict for arbitrary_types_allowed if needed later[0m
[30;1m246 | [0m[35m    # code.append("    model_config = ConfigDict(arbitrary_types_allowed=True)")[0m
[30;1m247 | [0m[35m    for field in fields:[0m
[30;1m248 | [0m[35m        field_name = field.get("name", "unnamed_field")[0m
[30;1m249 | [0m[35m        field_type_frontend = field.get("type", "Any")  # Type from frontend/import[0m
[30;1m250 | [0m[35m        description = field.get("description", "")[0m
[30;1m251 | [0m[35m        is_list = field.get("isList", False)[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    code = [][0m
[30;1m239 | [0m[35m    code.append(f"\nclass {class_name}(Task):")[0m
[30;1m240 | [0m[35m    fields = data.get("fields", [])[0m
[30;1m241 | [0m[35m    if not fields:[0m
[30;1m242 | [0m[35m        code.append("    pass # No fields defined")[0m
[30;1m243 | [0m[35m        return "\n".join(code)[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m    """[0m
[30;1m232 | [0m[35m    assert node.get("type") == "task"[0m
[30;1m233 | [0m[35m    data = node.get("data", {})[0m
[30;1m234 | [0m[35m    class_name = data.get("className")[0m
[30;1m235 | [0m[35m    if not is_valid_python_class_name(class_name):[0m
[30;1m236 | [0m[35m        raise ValueError(f"Invalid class name: {class_name}")[0m
[30;1m237 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m    Creates a Pydantic Task class from a node.[0m
[30;1m231 | [0m[35m    """[0m
[30;1m232 | [0m[35m    assert node.get("type") == "task"[0m
[30;1m233 | [0m[35m    data = node.get("data", {})[0m
[30;1m234 | [0m[35m    class_name = data.get("className")[0m
[30;1m235 | [0m[35m    if not is_valid_python_class_name(class_name):[0m
[30;1m236 | [0m[35m        raise ValueError(f"Invalid class name: {class_name}")[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    """[0m
[30;1m230 | [0m[35m    Creates a Pydantic Task class from a node.[0m
[30;1m231 | [0m[35m    """[0m
[30;1m232 | [0m[35m    assert node.get("type") == "task"[0m
[30;1m233 | [0m[35m    data = node.get("data", {})[0m
[30;1m234 | [0m[35m    class_name = data.get("className")[0m
[30;1m235 | [0m[35m    if not is_valid_python_class_name(class_name):[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    # Read modulePath and className directly from data for taskimport nodes[0m
[30;1m209 | [0m[35m    module_path = data.get("modulePath")[0m
[30;1m210 | [0m[35m    class_name = data.get("className")[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    if module_path and class_name and is_valid_python_class_name(class_name):[0m
[30;1m213 | [0m[35m        # Group imports by module path[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        return None[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    # Read modulePath and className directly from data for taskimport nodes[0m
[30;1m209 | [0m[35m    module_path = data.get("modulePath")[0m
[30;1m210 | [0m[35m    class_name = data.get("className")[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    if module_path and class_name and is_valid_python_class_name(class_name):[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m    data = node.get("data", {})[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    # Skip implicit imports[0m
[30;1m205 | [0m[35m    if data.get("isImplicit"):[0m
[30;1m206 | [0m[35m        return None[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    # Read modulePath and className directly from data for taskimport nodes[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m        imported_tasks: A dictionary of unique imported tasks.[0m
[30;1m200 | [0m[35m    """[0m
[30;1m201 | [0m[35m    assert node.get("type") == "taskimport"[0m
[30;1m202 | [0m[35m    data = node.get("data", {})[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    # Skip implicit imports[0m
[30;1m205 | [0m[35m    if data.get("isImplicit"):[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m        node: The node to create the task import state from.[0m
[30;1m199 | [0m[35m        imported_tasks: A dictionary of unique imported tasks.[0m
[30;1m200 | [0m[35m    """[0m
[30;1m201 | [0m[35m    assert node.get("type") == "taskimport"[0m
[30;1m202 | [0m[35m    data = node.get("data", {})[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    # Skip implicit imports[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m            node = output_nodes_by_class_name.get(target_class_name, {})[0m
[30;1m165 | [0m[35m            node_id = node.get("id")[0m
[30;1m166 | [0m[35m            class_name = node.get("data", {}).get("className")[0m
[30;1m167 | [0m[35m            input_types = node.get("data", {}).get("inputTypes", [])[0m
[30;1m168 | [0m[35m            if input_types:[0m
[30;1m169 | [0m[35m                # we know that class names are unique in the graph[0m
[30;1m170 | [0m[35m                sink_code = f"""[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m            node = output_nodes_by_class_name.get(target_class_name, {})[0m
[30;1m165 | [0m[35m            node_id = node.get("id")[0m
[30;1m166 | [0m[35m            class_name = node.get("data", {}).get("className")[0m
[30;1m167 | [0m[35m            input_types = node.get("data", {}).get("inputTypes", [])[0m
[30;1m168 | [0m[35m            if input_types:[0m
[30;1m169 | [0m[35m                # we know that class names are unique in the graph[0m
[30;1m170 | [0m[35m                sink_code = f"""[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        elif source_inst_name and target_type == "dataoutput":[0m
[30;1m164 | [0m[35m            node = output_nodes_by_class_name.get(target_class_name, {})[0m
[30;1m165 | [0m[35m            node_id = node.get("id")[0m
[30;1m166 | [0m[35m            class_name = node.get("data", {}).get("className")[0m
[30;1m167 | [0m[35m            input_types = node.get("data", {}).get("inputTypes", [])[0m
[30;1m168 | [0m[35m            if input_types:[0m
[30;1m169 | [0m[35m                # we know that class names are unique in the graph[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        elif source_inst_name and target_type == "dataoutput":[0m
[30;1m164 | [0m[35m            node = output_nodes_by_class_name.get(target_class_name, {})[0m
[30;1m165 | [0m[35m            node_id = node.get("id")[0m
[30;1m166 | [0m[35m            class_name = node.get("data", {}).get("className")[0m
[30;1m167 | [0m[35m            input_types = node.get("data", {}).get("inputTypes", [])[0m
[30;1m168 | [0m[35m            if input_types:[0m
[30;1m169 | [0m[35m                # we know that class names are unique in the graph[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m            code.append(f"    graph.set_entry({target_inst_name})")[0m
[30;1m163 | [0m[35m        elif source_inst_name and target_type == "dataoutput":[0m
[30;1m164 | [0m[35m            node = output_nodes_by_class_name.get(target_class_name, {})[0m
[30;1m165 | [0m[35m            node_id = node.get("id")[0m
[30;1m166 | [0m[35m            class_name = node.get("data", {}).get("className")[0m
[30;1m167 | [0m[35m            input_types = node.get("data", {}).get("inputTypes", [])[0m
[30;1m168 | [0m[35m            if input_types:[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        elif source_class_name in task_names and target_inst_name:[0m
[30;1m162 | [0m[35m            code.append(f"    graph.set_entry({target_inst_name})")[0m
[30;1m163 | [0m[35m        elif source_inst_name and target_type == "dataoutput":[0m
[30;1m164 | [0m[35m            node = output_nodes_by_class_name.get(target_class_name, {})[0m
[30;1m165 | [0m[35m            node_id = node.get("id")[0m
[30;1m166 | [0m[35m            class_name = node.get("data", {}).get("className")[0m
[30;1m167 | [0m[35m            input_types = node.get("data", {}).get("inputTypes", [])[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        source_inst_name = worker_instance_by_class_name.get(source_class_name)[0m
[30;1m153 | [0m[35m        target_inst_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        target_type = output_nodes_by_class_name.get(target_class_name, {}).get("type")[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        if source_inst_name and target_inst_name:[0m
[30;1m158 | [0m[35m            code.append([0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        source_inst_name = worker_instance_by_class_name.get(source_class_name)[0m
[30;1m153 | [0m[35m        target_inst_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        target_type = output_nodes_by_class_name.get(target_class_name, {}).get("type")[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        if source_inst_name and target_inst_name:[0m
[30;1m158 | [0m[35m            code.append([0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Use the lookup to find the instance names[0m
[30;1m152 | [0m[35m        source_inst_name = worker_instance_by_class_name.get(source_class_name)[0m
[30;1m153 | [0m[35m        target_inst_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        target_type = output_nodes_by_class_name.get(target_class_name, {}).get("type")[0m
[30;1m156 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m            continue[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Use the lookup to find the instance names[0m
[30;1m152 | [0m[35m        source_inst_name = worker_instance_by_class_name.get(source_class_name)[0m
[30;1m153 | [0m[35m        target_inst_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        target_type = output_nodes_by_class_name.get(target_class_name, {}).get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m    # Create the dependency setting code strings[0m
[30;1m144 | [0m[35m    for edge in edges:[0m
[30;1m145 | [0m[35m        source_class_name: str = edge.get("source")[0m
[30;1m146 | [0m[35m        target_class_name: str = edge.get("target")[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        if source_class_name.startswith("datainput-"):[0m
[30;1m149 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m    code = [][0m
[30;1m143 | [0m[35m    # Create the dependency setting code strings[0m
[30;1m144 | [0m[35m    for edge in edges:[0m
[30;1m145 | [0m[35m        source_class_name: str = edge.get("source")[0m
[30;1m146 | [0m[35m        target_class_name: str = edge.get("target")[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        if source_class_name.startswith("datainput-"):[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    worker_instance_by_class_name = create_worker_to_instance_mapping(worker_nodes)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    output_nodes_by_class_name = {[0m
[30;1m139 | [0m[35m        node.get("data", {}).get("className"): node for node in output_nodes[0m
[30;1m140 | [0m[35m    }[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    code = [][0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    worker_instance_by_class_name = create_worker_to_instance_mapping(worker_nodes)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    output_nodes_by_class_name = {[0m
[30;1m139 | [0m[35m        node.get("data", {}).get("className"): node for node in output_nodes[0m
[30;1m140 | [0m[35m    }[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    code = [][0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m    # Also add task names from taskimport nodes[0m
[30;1m129 | [0m[35m    for node in task_import_nodes:[0m
[30;1m130 | [0m[35m        data = node.get("data", {})[0m
[30;1m131 | [0m[35m        class_name = data.get("className")[0m
[30;1m132 | [0m[35m        if class_name:[0m
[30;1m133 | [0m[35m            task_names.add(class_name)[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # Also add task names from taskimport nodes[0m
[30;1m129 | [0m[35m    for node in task_import_nodes:[0m
[30;1m130 | [0m[35m        data = node.get("data", {})[0m
[30;1m131 | [0m[35m        class_name = data.get("className")[0m
[30;1m132 | [0m[35m        if class_name:[0m
[30;1m133 | [0m[35m            task_names.add(class_name)[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m    task_names = set()[0m
[30;1m122 | [0m[35m    for node in task_nodes:[0m
[30;1m123 | [0m[35m        data = node.get("data", {})[0m
[30;1m124 | [0m[35m        class_name = data.get("className")[0m
[30;1m125 | [0m[35m        if class_name:[0m
[30;1m126 | [0m[35m            task_names.add(class_name)[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m    # Map all the task names[0m
[30;1m121 | [0m[35m    task_names = set()[0m
[30;1m122 | [0m[35m    for node in task_nodes:[0m
[30;1m123 | [0m[35m        data = node.get("data", {})[0m
[30;1m124 | [0m[35m        class_name = data.get("className")[0m
[30;1m125 | [0m[35m        if class_name:[0m
[30;1m126 | [0m[35m            task_names.add(class_name)[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    worker_instance_by_class_name = create_worker_to_instance_mapping(worker_nodes)[0m
[30;1m99 | [0m[35m    target_class_name = edge.get("target")[0m
[30;1m100 | [0m[35m    target_instance_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m101 | [0m[35m    if not target_instance_name:[0m
[30;1m102 | [0m[35m        print([0m
[30;1m103 | [0m[35m            f"Warning: Could not find worker instance for {target_class_name}. Skipping initial task[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m        return None[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    worker_instance_by_class_name = create_worker_to_instance_mapping(worker_nodes)[0m
[30;1m99 | [0m[35m    target_class_name = edge.get("target")[0m
[30;1m100 | [0m[35m    target_instance_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m101 | [0m[35m    if not target_instance_name:[0m
[30;1m102 | [0m[35m        print([0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    edge = next([0m
[30;1m89 | [0m[35m        (e for e in edges if e.get("source") == "datainput-" + class_name),[0m
[30;1m90 | [0m[35m        None,[0m
[30;1m91 | [0m[35m    )[0m
[30;1m92 | [0m[35m    if not edge:[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    assert node.get("type") == "datainput"[0m
[30;1m84 | [0m[35m    data = node.get("data", {})[0m
[30;1m85 | [0m[35m    class_name = data.get("className")[0m
[30;1m86 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    edge = next([0m
[30;1m89 | [0m[35m        (e for e in edges if e.get("source") == "datainput-" + class_name),[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m    """[0m
[30;1m83 | [0m[35m    assert node.get("type") == "datainput"[0m
[30;1m84 | [0m[35m    data = node.get("data", {})[0m
[30;1m85 | [0m[35m    class_name = data.get("className")[0m
[30;1m86 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    edge = next([0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    Creates a datainput task from a node.[0m
[30;1m82 | [0m[35m    """[0m
[30;1m83 | [0m[35m    assert node.get("type") == "datainput"[0m
[30;1m84 | [0m[35m    data = node.get("data", {})[0m
[30;1m85 | [0m[35m    class_name = data.get("className")[0m
[30;1m86 | [0m[35m    json_data = data.get("jsonData")[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m    """[0m
[30;1m81 | [0m[35m    Creates a datainput task from a node.[0m
[30;1m82 | [0m[35m    """[0m
[30;1m83 | [0m[35m    assert node.get("type") == "datainput"[0m
[30;1m84 | [0m[35m    data = node.get("data", {})[0m
[30;1m85 | [0m[35m    class_name = data.get("className")[0m
[30;1m86 | [0m[35m    json_data = data.get("jsonData")[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m    # Populate lookup using all worker nodes (including factory)[0m
[30;1m64 | [0m[35m    for node in worker_nodes:[0m
[30;1m65 | [0m[35m        data = node.get("data", {})[0m
[30;1m66 | [0m[35m        class_name = data.get("className")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if class_name:[0m
[30;1m69 | [0m[35m            instance_name = worker_to_instance_name(node)[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m    worker_instance_by_class_name = {}[0m
[30;1m63 | [0m[35m    # Populate lookup using all worker nodes (including factory)[0m
[30;1m64 | [0m[35m    for node in worker_nodes:[0m
[30;1m65 | [0m[35m        data = node.get("data", {})[0m
[30;1m66 | [0m[35m        class_name = data.get("className")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if class_name:[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m767 | [0m[35m    # 5. Initial Tasks[0m
[30;1m768 | [0m[35m    datainput_nodes = [n for n in nodes if n.get("type") == "datainput"][0m
[30;1m769 | [0m[35m    initial_tasks = [][0m
[30;1m770 | [0m[35m    for node in datainput_nodes:[0m
[30;1m771 | [0m[35m        inital_task = create_initial_tasks(node, worker_nodes, edges)[0m
[30;1m772 | [0m[35m        if inital_task:[0m
[30;1m773 | [0m[35m            initial_tasks.append(inital_task)[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m709 | [0m[35m        factory_function = data.get("factoryFunction")[0m
[30;1m710 | [0m[35m[0m
[30;1m711 | [0m[35m        if not worker_class_name:[0m
[30;1m712 | [0m[35m            print(f"Warning: Skipping node {node_id} due to missing className.")[0m
[30;1m713 | [0m[35m            continue[0m
[30;1m714 | [0m[35m[0m
[30;1m715 | [0m[35m        instance_name = worker_to_instance_name(node)[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m702 | [0m[35m    # Track factory-created workers for special handling and imports[0m
[30;1m703 | [0m[35m    factories_used = set()  # Track factory function names used[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m    for node in worker_nodes:[0m
[30;1m706 | [0m[35m        node_id = node["id"][0m
[30;1m707 | [0m[35m        data = node.get("data", {})[0m
[30;1m708 | [0m[35m        worker_class_name = data.get("className")[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m685 | [0m[35m[0m
[30;1m686 | [0m[35m    # Instance names will be generated later[0m
[30;1m687 | [0m[35m    workers = [][0m
[30;1m688 | [0m[35m    for node in worker_nodes:[0m
[30;1m689 | [0m[35m        code = create_worker_class(node)[0m
[30;1m690 | [0m[35m        if code:[0m
[30;1m691 | [0m[35m            workers.append(code)[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m662 | [0m[35m    task_nodes = [n for n in nodes if n.get("type") == "task"][0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    # Add locally defined Task nodes[0m
[30;1m665 | [0m[35m    for node in task_nodes:[0m
[30;1m666 | [0m[35m        tasks_code.append(create_task_class(node))[0m
[30;1m667 | [0m[35m    if not task_nodes:[0m
[30;1m668 | [0m[35m        tasks_code.append("# No Task nodes defined in the graph.")[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m647 | [0m[35m[0m
[30;1m648 | [0m[35m    # Add imports for TaskImportNodes first[0m
[30;1m649 | [0m[35m    import_statements = [][0m
[30;1m650 | [0m[35m    for node in task_import_nodes:[0m
[30;1m651 | [0m[35m        add_to_task_import_state(node, imported_tasks)[0m
[30;1m652 | [0m[35m[0m
[30;1m653 | [0m[35m    # Generate the import statements from the grouped dictionary[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m538 | [0m[35m    # Wrap instantiation in try-except[0m
[30;1m539 | [0m[35m    code.append(f"# Instantiate: {worker_class_name}")[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m    # Basic LLM assignment - needs refinement based on node config/needs[0m
[30;1m542 | [0m[35m    if worker_type in ["llmtaskworker", "cachedllmtaskworker", "chattaskworker"]:[0m
[30;1m543 | [0m[35m        if llm_name:[0m
[30;1m544 | [0m[35m            llm_arg = f"llm={llm_name}"[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35mdef create_worker_class(node: Dict[str, Any]) -> Optional[str]:[0m
[30;1m326 | [0m[35m    # Determine base class based on node type, including cached variants[0m
[30;1m327 | [0m[35m    node_type = node.get("type")[0m
[30;1m328 | [0m[35m    data = node.get("data", {})[0m
[30;1m329 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m            )[0m
[30;1m222 | [0m[35m    else:[0m
[30;1m223 | [0m[35m        print([0m
[30;1m224 | [0m[35m            f"Warning: Invalid or missing import details for node {node['id']}. Module: '{module_pat[0m
[30;1m225 | [0m[35m        )[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m    Creates a task import state from a node.[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    Args:[0m
[30;1m198 | [0m[35m        node: The node to create the task import state from.[0m
[30;1m199 | [0m[35m        imported_tasks: A dictionary of unique imported tasks.[0m
[30;1m200 | [0m[35m    """[0m
[30;1m201 | [0m[35m    assert node.get("type") == "taskimport"[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m184 | [0m[35m                )[0m
[30;1m185 | [0m[35m        else:[0m
[30;1m186 | [0m[35m            print([0m
[30;1m187 | [0m[35m                f"Warning: Could not find worker instances for edge {source_class_name} -> {target_c[0m
[30;1m188 | [0m[35m            )[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    return "\n".join(code)[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m                code.append(indent(dedent(sink_code).strip(), "    "))[0m
[30;1m181 | [0m[35m            else:[0m
[30;1m182 | [0m[35m                print([0m
[30;1m183 | [0m[35m                    f"Warning: Could not find input type for dataoutput node {node_id}"[0m
[30;1m184 | [0m[35m                )[0m
[30;1m185 | [0m[35m        else:[0m
[30;1m186 | [0m[35m            print([0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m                code.append(indent(dedent(sink_code).strip(), "    "))[0m
[30;1m181 | [0m[35m            else:[0m
[30;1m182 | [0m[35m                print([0m
[30;1m183 | [0m[35m                    f"Warning: Could not find input type for dataoutput node {node_id}"[0m
[30;1m184 | [0m[35m                )[0m
[30;1m185 | [0m[35m        else:[0m
[30;1m186 | [0m[35m            print([0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m        elif source_class_name in task_names and target_inst_name:[0m
[30;1m162 | [0m[35m            code.append(f"    graph.set_entry({target_inst_name})")[0m
[30;1m163 | [0m[35m        elif source_inst_name and target_type == "dataoutput":[0m
[30;1m164 | [0m[35m            node = output_nodes_by_class_name.get(target_class_name, {})[0m
[30;1m165 | [0m[35m            node_id = node.get("id")[0m
[30;1m166 | [0m[35m            class_name = node.get("data", {}).get("className")[0m
[30;1m167 | [0m[35m            input_types = node.get("data", {}).get("inputTypes", [])[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m        if source_class_name.startswith("datainput-"):[0m
[30;1m149 | [0m[35m            continue[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Use the lookup to find the instance names[0m
[30;1m152 | [0m[35m        source_inst_name = worker_instance_by_class_name.get(source_class_name)[0m
[30;1m153 | [0m[35m        target_inst_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m154 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m    worker_instance_by_class_name = create_worker_to_instance_mapping(worker_nodes)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    output_nodes_by_class_name = {[0m
[30;1m139 | [0m[35m        node.get("data", {}).get("className"): node for node in output_nodes[0m
[30;1m140 | [0m[35m    }[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    code = [][0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m    worker_instance_by_class_name = create_worker_to_instance_mapping(worker_nodes)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    output_nodes_by_class_name = {[0m
[30;1m139 | [0m[35m        node.get("data", {}).get("className"): node for node in output_nodes[0m
[30;1m140 | [0m[35m    }[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    code = [][0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m            task_names.add(class_name)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # Also add task names from taskimport nodes[0m
[30;1m129 | [0m[35m    for node in task_import_nodes:[0m
[30;1m130 | [0m[35m        data = node.get("data", {})[0m
[30;1m131 | [0m[35m        class_name = data.get("className")[0m
[30;1m132 | [0m[35m        if class_name:[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m    # Map all the task names[0m
[30;1m121 | [0m[35m    task_names = set()[0m
[30;1m122 | [0m[35m    for node in task_nodes:[0m
[30;1m123 | [0m[35m        data = node.get("data", {})[0m
[30;1m124 | [0m[35m        class_name = data.get("className")[0m
[30;1m125 | [0m[35m        if class_name:[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m    target_instance_name = worker_instance_by_class_name.get(target_class_name)[0m
[30;1m101 | [0m[35m    if not target_instance_name:[0m
[30;1m102 | [0m[35m        print([0m
[30;1m103 | [0m[35m            f"Warning: Could not find worker instance for {target_class_name}. Skipping initial task[0m
[30;1m104 | [0m[35m        )[0m
[30;1m105 | [0m[35m        return None[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m    )[0m
[30;1m92 | [0m[35m    if not edge:[0m
[30;1m93 | [0m[35m        print([0m
[30;1m94 | [0m[35m            f"Warning: Could not find edge for datainput {class_name}. Skipping initial task creatio[0m
[30;1m95 | [0m[35m        )[0m
[30;1m96 | [0m[35m        return None[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/python.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m    # Create a lookup for worker instance names by className[0m
[30;1m62 | [0m[35m    worker_instance_by_class_name = {}[0m
[30;1m63 | [0m[35m    # Populate lookup using all worker nodes (including factory)[0m
[30;1m64 | [0m[35m    for node in worker_nodes:[0m
[30;1m65 | [0m[35m        data = node.get("data", {})[0m
[30;1m66 | [0m[35m        class_name = data.get("className")[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m        # If we never found the end of the signature, parsing failed[0m
[30;1m65 | [0m[35m        if in_signature:[0m
[30;1m66 | [0m[35m            raise ValueError([0m
[30;1m67 | [0m[35m                "Could not find end of signature (closing parenthesis and colon)"[0m
[30;1m68 | [0m[35m            )[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        # Join the signature lines[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m    )[0m
[30;1m271 | [0m[35m    proc = None[0m
[30;1m272 | [0m[35m    with _lsp_dict_lock:[0m
[30;1m273 | [0m[35m        proc = lsp_processes.get(sid)[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m    if proc and proc.stdin and not proc.stdin.closed:[0m
[30;1m276 | [0m[35m        formatted_message = _format_lsp_message(message)[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35mdef send_lsp_message(sid: str, message: dict):[0m
[30;1m267 | [0m[35m    """Sends a message to the LSP process for the given session."""[0m
[30;1m268 | [0m[35m    log.debug([0m
[30;1m269 | [0m[35m        f"[{sid}] Preparing to send LSP message: {message.get('method', message.get('id', ''))}"[0m
[30;1m270 | [0m[35m    )[0m
[30;1m271 | [0m[35m    proc = None[0m
[30;1m272 | [0m[35m    with _lsp_dict_lock:[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35mdef send_lsp_message(sid: str, message: dict):[0m
[30;1m267 | [0m[35m    """Sends a message to the LSP process for the given session."""[0m
[30;1m268 | [0m[35m    log.debug([0m
[30;1m269 | [0m[35m        f"[{sid}] Preparing to send LSP message: {message.get('method', message.get('id', ''))}"[0m
[30;1m270 | [0m[35m    )[0m
[30;1m271 | [0m[35m    proc = None[0m
[30;1m272 | [0m[35m    with _lsp_dict_lock:[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    # Wait for reader threads to finish (they should exit when pipes close)[0m
[30;1m248 | [0m[35m    stdout_thread = lsp_stdout_readers.get(sid)[0m
[30;1m249 | [0m[35m    stderr_thread = lsp_stderr_readers.get(sid)[0m
[30;1m250 | [0m[35m    if stdout_thread and stdout_thread.is_alive():[0m
[30;1m251 | [0m[35m        log.debug(f"[{sid}] Waiting for stdout reader thread to join...")[0m
[30;1m252 | [0m[35m        stdout_thread.join(timeout=1)[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        _cleanup_lsp_resources(sid)[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    # Wait for reader threads to finish (they should exit when pipes close)[0m
[30;1m248 | [0m[35m    stdout_thread = lsp_stdout_readers.get(sid)[0m
[30;1m249 | [0m[35m    stderr_thread = lsp_stderr_readers.get(sid)[0m
[30;1m250 | [0m[35m    if stdout_thread and stdout_thread.is_alive():[0m
[30;1m251 | [0m[35m        log.debug(f"[{sid}] Waiting for stdout reader thread to join...")[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35mdef _stop_lsp_process_internal(sid: str):[0m
[30;1m211 | [0m[35m    """Stops the LSP process without acquiring the lock (for internal use)."""[0m
[30;1m212 | [0m[35m    proc = lsp_processes.get(sid)[0m
[30;1m213 | [0m[35m    if proc:[0m
[30;1m214 | [0m[35m        log.info(f"[{sid}] Stopping LSP process (PID: {proc.pid}).")[0m
[30;1m215 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            try:[0m
[30;1m86 | [0m[35m                payload = json.loads(body.decode("utf-8"))[0m
[30;1m87 | [0m[35m                log.debug([0m
[30;1m88 | [0m[35m                    f"[{sid}] Received LSP Message: {payload.get('method', payload.get('id', ''))}"[0m
[30;1m89 | [0m[35m                )[0m
[30;1m90 | [0m[35m                # Emit the parsed JSON payload to the correct client[0m
[30;1m91 | [0m[35m                socketio_emit("lsp_response", payload, room=sid)[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            try:[0m
[30;1m86 | [0m[35m                payload = json.loads(body.decode("utf-8"))[0m
[30;1m87 | [0m[35m                log.debug([0m
[30;1m88 | [0m[35m                    f"[{sid}] Received LSP Message: {payload.get('method', payload.get('id', ''))}"[0m
[30;1m89 | [0m[35m                )[0m
[30;1m90 | [0m[35m                # Emit the parsed JSON payload to the correct client[0m
[30;1m91 | [0m[35m                socketio_emit("lsp_response", payload, room=sid)[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m        try:[0m
[30;1m223 | [0m[35m            # Terminate the process gracefully first[0m
[30;1m224 | [0m[35m            proc.terminate()[0m
[30;1m225 | [0m[35m            # Wait for a short time for graceful exit[0m
[30;1m226 | [0m[35m            try:[0m
[30;1m227 | [0m[35m                proc.wait(timeout=2)[0m
[30;1m228 | [0m[35m                log.info(f"[{sid}] LSP process terminated gracefully.")[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m            if content_length == -1:[0m
[30;1m72 | [0m[35m                log.warning([0m
[30;1m73 | [0m[35m                    f"[{sid}] Did not find Content-Length header before blank line."[0m
[30;1m74 | [0m[35m                )[0m
[30;1m75 | [0m[35m                continue  # Try reading next message block[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m# Structure: {sid: queue.Queue} - For sending messages *to* the LSP process thread-safely (Alternati[0m
[30;1m23 | [0m[35m# lsp_write_queues: Dict[str, queue.Queue] = {}[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m# Regex to find Content-Length header[0m
[30;1m26 | [0m[35mCONTENT_LENGTH_RE = re.compile(rb"^Content-Length: *(\d+)\r\n", re.IGNORECASE)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m# Lock for modifying the shared dictionaries[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/lsp_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m158 | [0m[35m        jedi_path = Path(python_executable).parent / "jedi-language-server"[0m
[30;1m159 | [0m[35m        log.info(f"[{sid}] Starting LSP process using: {jedi_path}")[0m
[30;1m160 | [0m[35m        try:[0m
[30;1m161 | [0m[35m            cmd = [jedi_path][0m
[30;1m162 | [0m[35m            proc = subprocess.Popen([0m
[30;1m163 | [0m[35m                cmd,[0m
[30;1m164 | [0m[35m                stdin=subprocess.PIPE,[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/inspect_module.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m                "float": "float",[0m
[30;1m109 | [0m[35m                "bool": "boolean",[0m
[30;1m110 | [0m[35m            }[0m
[30;1m111 | [0m[35m            type_name = type_mapping_reverse.get(type_name, type_name)[0m
[30;1m112 | [0m[35m        elif isinstance(field_type, type):[0m
[30;1m113 | [0m[35m            # Fallback for complex types not handled above[0m
[30;1m114 | [0m[35m            type_name = str(field_type)  # Use string representation[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/inspect_module.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m    action = sys.argv[2] if len(sys.argv) > 2 else "list_classes"[0m
[30;1m136 | [0m[35m    class_name_arg = sys.argv[3] if len(sys.argv) > 3 else None[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    # Attempt to import necessary types dynamically from the target env[0m
[30;1m139 | [0m[35m    try:[0m
[30;1m140 | [0m[35m        from typing import Any, List, Literal, Optional, Union  # noqa: F401[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        from pydantic import Field  # noqa: F401[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/inspect_module.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m    # This is a simplification and might not cover all package structures[0m
[30;1m16 | [0m[35m    current_dir = Path.cwd()  # Or a more relevant base path if needed[0m
[30;1m17 | [0m[35m    module_dir = current_dir[0m
[30;1m18 | [0m[35m    # Find the first part that is likely a directory[0m
[30;1m19 | [0m[35m    for i in range(len(parts)):[0m
[30;1m20 | [0m[35m        potential_path = current_dir / "/".join(parts[: i + 1])[0m
[30;1m21 | [0m[35m        if potential_path.is_dir():[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/inspect_module.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mdef add_module_path(module_path):[0m
[30;1m12 | [0m[35m    # Convert module path (e.g., my_package.my_module) to directory path[0m
[30;1m13 | [0m[35m    parts = module_path.split(".")[0m
[30;1m14 | [0m[35m    # Attempt to find the base directory of the module[0m
[30;1m15 | [0m[35m    # This is a simplification and might not cover all package structures[0m
[30;1m16 | [0m[35m    current_dir = Path.cwd()  # Or a more relevant base path if needed[0m
[30;1m17 | [0m[35m    module_dir = current_dir[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/inspect_module.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m87 | [0m[35m            is_list = True[0m
[30;1m88 | [0m[35m            if args:[0m
[30;1m89 | [0m[35m                field_type = args[0]  # Get the inner type[0m
[30;1m90 | [0m[35m                # Update origin and args again for potential Literal check inside List[0m
[30;1m91 | [0m[35m                origin = getattr(field_type, "__origin__", None)[0m
[30;1m92 | [0m[35m                args = getattr(field_type, "__args__", [])[0m
[30;1m93 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/inspect_module.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m            non_none_args = [t for t in args if t is not type(None)][0m
[30;1m75 | [0m[35m            if len(non_none_args) == 1:[0m
[30;1m76 | [0m[35m                field_type = non_none_args[0][0m
[30;1m77 | [0m[35m                # Update origin and args for potential List/Literal checks[0m
[30;1m78 | [0m[35m                origin = getattr(field_type, "__origin__", None)[0m
[30;1m79 | [0m[35m                args = getattr(field_type, "__args__", [])[0m
[30;1m80 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/venv.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m    # Filter out all duplicate paths[0m
[30;1m54 | [0m[35m    unique_environments = [][0m
[30;1m55 | [0m[35m    seen = set()[0m
[30;1m56 | [0m[35m    for env in environments:[0m
[30;1m57 | [0m[35m        env_path = env["path"][0m
[30;1m58 | [0m[35m        if env_path not in seen:[0m
[30;1m59 | [0m[35m            unique_environments.append(env)[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/pyproject.toml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35mbuild-backend = "poetry.core.masonry.api"[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m# Add configuration for the custom build script[0m
[30;1m39 | [0m[35m[tool.poetry.build][0m
[30;1m40 | [0m[35mscript = "build.py"[0m
[30;1m41 | [0m[35mgenerate-setup-file = false[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m# Keep dev dependencies if needed[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/pyproject.toml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35mrequires = ["poetry-core>=1.0.0"][0m
[30;1m36 | [0m[35mbuild-backend = "poetry.core.masonry.api"[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m# Add configuration for the custom build script[0m
[30;1m39 | [0m[35m[tool.poetry.build][0m
[30;1m40 | [0m[35mscript = "build.py"[0m
[30;1m41 | [0m[35mgenerate-setup-file = false[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/debug_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m) -> bool:[0m
[30;1m15 | [0m[35m    """Send a debug event to the socket server."""[0m
[30;1m16 | [0m[35m    if not port:[0m
[30;1m17 | [0m[35m        port = os.environ.get("DEBUG_PORT")[0m
[30;1m18 | [0m[35m        if not port:[0m
[30;1m19 | [0m[35m            raise ValueError([0m
[30;1m20 | [0m[35m                "WARNING: DEBUG_PORT environment variable not set, cannot send debug events"[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m279[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/planaieditor-0.1.0/planaieditor/codesnippets/debug_monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m    try:[0m
[30;1m27 | [0m[35m        # Create a socket and connect to the server[0m
[30;1m28 | [0m[35m        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:[0m
[30;1m29 | [0m[35m            s.settimeout(1.0)  # 1 second timeout[0m
[30;1m30 | [0m[35m            s.connect((host, int(port)))[0m
[30;1m31 | [0m[35m            s.sendall(message_str.encode("utf-8"))[0m
[30;1m32 | [0m[35m        return True[0m
[30;1m33 | [0m[35m    except Exception as e:[0m

279 matches found.
