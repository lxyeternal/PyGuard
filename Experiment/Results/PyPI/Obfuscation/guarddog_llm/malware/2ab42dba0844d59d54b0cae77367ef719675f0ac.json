{
  "package_name": "2ab42dba0844d59d54b0cae77367ef719675f0ac",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/2ab42dba0844d59d54b0cae77367ef719675f0ac/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is malicious. It defines a custom setuptools install command that, during installation, searches the /Library/Application Support directory for files matching a specific pattern. For each match, it generates a key and compares it to a hardcoded value. If matched, it downloads an executable payload from a remote server (with the URL obfuscated via XOR and per-architecture), decrypts it, writes it to ~/.local/bin/donothing, makes it executable, and then executes it in a subprocess. This is classic behavior for a trojan or backdoor: it hides its payload, only activates under certain conditions, downloads and executes code, and attempts to evade detection by obfuscating strings and logic. The use of setup.py and custom install hooks is a common method for supply chain attacks in Python packages.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "73",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(name='v20sfsklhn0hslnh', version='1.0.0', license='MIT', cmdclass={\n'install': ccYtPyLEAdNIDkvpfychKRbPdxmCSozJ})",
          "full_match": "* This package is overwriting the 'install' command in setup.py at setup.py:73",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/2ab42dba0844d59d54b0cae77367ef719675f0ac/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "54",
          "type_description": "download-executable: found 1 source code matches",
          "code_snippet": "with open(BhWkMKgkVhreukztkTTbkgtSlrzXxJVS, 'wb') as f:\nf.write(bytes(out))\nos.chmod(BhWkMKgkVhreukztkTTbkgtSlrzXxJVS, stat.S_IREAD | stat.S_IEXEC | stat.S_IRGRP | stat\n.S_IXGRP)",
          "full_match": "* This package is downloading making executable a remote binary at setup.py:54",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/2ab42dba0844d59d54b0cae77367ef719675f0ac/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "60",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "subprocess.Popen([BhWkMKgkVhreukztkTTbkgtSlrzXxJVS], stdout=subprocess.DEVNULL, stderr=\nsubprocess.STDOUT)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:60",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/2ab42dba0844d59d54b0cae77367ef719675f0ac/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}