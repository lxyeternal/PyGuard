Run started:2025-05-25 14:58:40.865680

Test results:
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
90	        using the token_request_data provided in the constructor."""
91	        return requests.post(
92	            f"https://login.microsoftonline.com/"
93	            f"{self.token_request_data['b2c_tenant_id']}/oauth2/v2.0/token",
94	            data=self.token_request_data,
95	            timeout=30).json()['access_token']
96	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        return requests.post(
92	            f"https://login.microsoftonline.com/"
93	            f"{self.token_request_data['b2c_tenant_id']}/oauth2/v2.0/token",
94	            data=self.token_request_data,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
106	        """Creates a user in Azure AD B2C using the provided item and authorization header."""
107	        return requests.post(
108	            "https://graph.microsoft.com/beta/users",
109	            headers=auth_header,
110	            data=json.dumps(item),
111	            timeout=30
112	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	        return requests.post(
108	            "https://graph.microsoft.com/beta/users",
109	            headers=auth_header,
110	            data=json.dumps(item),
111	            timeout=30
112	        )
113	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	        return requests.patch(
119	            f"https://graph.microsoft.com/beta/users/{item_id}",
120	            headers=auth_header,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	        return requests.delete(
129	            f"https://graph.microsoft.com/beta/users/{user_id}",
130	            headers=auth_header,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	        """Gets a user in Azure AD B2C using the provided user_id."""
136	        user = requests.get(
137	            f"https://graph.microsoft.com/beta/users/{user_id}", headers=self.get_auth_header(),
138	            timeout=30
139	        ).json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	        user = requests.get(
137	            f"https://graph.microsoft.com/beta/users/{user_id}", headers=self.get_auth_header(),
138	            timeout=30

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	
148	        return requests.get(
149	            f"https://graph.microsoft.com/beta/users?$filter=identities/any(c:c/issuerAssignedId eq '{email}' and c/issuer eq 'eightam72045b2ctenant.onmicrosoft.com')", headers=self.get_auth_header(),
150	            timeout=30
151	        ).json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	        return requests.get(
149	            f"https://graph.microsoft.com/beta/users?$filter=identities/any(c:c/issuerAssignedId eq '{email}' and c/issuer eq 'eightam72045b2ctenant.onmicrosoft.com')", headers=self.get_auth_header(),
150	            timeout=30

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	        """Compiles the entire list of users in Azure AD B2C using the provided filter_extension."""
155	        users = requests.get(
156	            f"https://graph.microsoft.com/beta/users{filter_extension}",
157	            headers=self.get_auth_header(),
158	            timeout=30
159	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	        users = requests.get(
156	            f"https://graph.microsoft.com/beta/users{filter_extension}",
157	            headers=self.get_auth_header(),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/src/eam_b2c_helper/b2c.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	        while next_link is not None:
167	            users_next = requests.get(
168	                next_link,
169	                headers=self.get_auth_header(),
170	                timeout=30
171	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	    if args[0] == 'https://login.microsoftonline.com/90/oauth2/v2.0/token':
24	        return MockResponse({"access_token": "eyJ"}, 200)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        return MockResponse({"access_token": "eyJ"}, 200)
25	    if args[0] == 'https://graph.microsoft.com/beta/users':
26	        return MockResponse(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	            {
28	                "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",
29	                "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
30	                "businessPhones": [],
31	                "displayName": "Adele Vance",
32	                "givenName": "Adele",
33	                "jobTitle": "Product Marketing Manager",
34	                "mail": "AdeleV@contoso.com",
35	                "mobilePhone": "+1 425 555 0109",
36	                "officeLocation": "18/2111",
37	                "preferredLanguage": "en-US",
38	                "surname": "Vance",
39	                "userPrincipalName": "AdeleV@contoso.com"
40	            },
41	            201
42	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	
59	    if args[0] == 'https://graph.microsoft.com/beta/users/test_id':
60	        return MockResponse("No Content", 204)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	
77	    if args[0] == 'https://graph.microsoft.com/beta/users/test_id':
78	        return MockResponse("No Content", 204)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	    mock_object = {
95	        'https://graph.microsoft.com/beta/users/test_id': MockResponse(
96	            {
97	                "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",
98	                "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
99	                "businessPhones": [],
100	                "displayName": "Adele Vance",
101	                "givenName": "Adele",
102	                "jobTitle": "Product Marketing Manager",
103	                "mail": "AdeleV@contoso.com",
104	                "mobilePhone": "+1 425 555 0109",
105	                "officeLocation": "18/2111",
106	                "preferredLanguage": "en-US",
107	                "surname": "Vance",
108	                "userPrincipalName": "AdeleV@contoso.com"
109	            },
110	            201
111	        ),
112	        'https://graph.microsoft.com/beta/users_filter_extension': MockResponse(
113	            {
114	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
115	                '@odata.nextLink': 'https://graph.microsoft.com/beta/users_filter_extension'
116	                '?$skiptoken=1',
117	                'value': [
118	                    {
119	                        "displayName": "Conf Room Adams",
120	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
121	                    },
122	                    {
123	                        "displayName": "MOD Administrator",
124	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
125	                    }
126	                ]
127	            },
128	            200
129	        ),
130	        'https://graph.microsoft.com/beta/users_filter_extension?$skiptoken=1': MockResponse(
131	            {
132	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
133	                'value': [
134	                    {
135	                        "displayName": "Conf Room Adams",
136	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
137	                    },
138	                    {
139	                        "displayName": "MOD Administrator",
140	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
141	                    }
142	                ]
143	            },
144	            200
145	        ),
146	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_OrganizationID"
147	        " eq '12345'": MockResponse(
148	            {
149	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
150	                'value': [
151	                    {
152	                        "displayName": "Conf Room Adams",
153	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
154	                    },
155	                    {
156	                        "displayName": "MOD Administrator",
157	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
158	                    }
159	                ]
160	            },
161	            200
162	        ),
163	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_UserRoles"
164	        " eq 'Test Role'": MockResponse(
165	            {
166	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
167	                'value': [
168	                    {
169	                        "displayName": "Conf Room Adams",
170	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
171	                    },
172	                    {
173	                        "displayName": "MOD Administrator",
174	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
175	                    }
176	                ]
177	            },
178	            200
179	        ),
180	        "https://graph.microsoft.com/beta/users": MockResponse(
181	            {
182	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
183	                'value': [
184	                    {
185	                        "displayName": "Conf Room Adams",
186	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0",
187	                        'mailNickname': 'Daveg_8amsolutions.com#EXT#'
188	                    },
189	                    {
190	                        "displayName": "MOD Administrator",
191	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e",
192	                        'mailNickname': 'test@test.com'
193	                    }
194	                ]
195	            },
196	            200
197	        )
198	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	        ),
112	        'https://graph.microsoft.com/beta/users_filter_extension': MockResponse(
113	            {
114	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
115	                '@odata.nextLink': 'https://graph.microsoft.com/beta/users_filter_extension'
116	                '?$skiptoken=1',
117	                'value': [
118	                    {
119	                        "displayName": "Conf Room Adams",
120	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
121	                    },
122	                    {
123	                        "displayName": "MOD Administrator",
124	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
125	                    }
126	                ]
127	            },
128	            200
129	        ),
130	        'https://graph.microsoft.com/beta/users_filter_extension?$skiptoken=1': MockResponse(
131	            {
132	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
133	                'value': [
134	                    {
135	                        "displayName": "Conf Room Adams",
136	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
137	                    },
138	                    {
139	                        "displayName": "MOD Administrator",
140	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
141	                    }
142	                ]
143	            },
144	            200
145	        ),
146	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_OrganizationID"
147	        " eq '12345'": MockResponse(
148	            {
149	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
150	                'value': [
151	                    {
152	                        "displayName": "Conf Room Adams",
153	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
154	                    },
155	                    {
156	                        "displayName": "MOD Administrator",
157	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
158	                    }
159	                ]
160	            },
161	            200
162	        ),
163	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_UserRoles"
164	        " eq 'Test Role'": MockResponse(
165	            {
166	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
167	                'value': [
168	                    {
169	                        "displayName": "Conf Room Adams",
170	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
171	                    },
172	                    {
173	                        "displayName": "MOD Administrator",
174	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
175	                    }
176	                ]
177	            },
178	            200
179	        ),
180	        "https://graph.microsoft.com/beta/users": MockResponse(
181	            {
182	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
183	                'value': [
184	                    {
185	                        "displayName": "Conf Room Adams",
186	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0",
187	                        'mailNickname': 'Daveg_8amsolutions.com#EXT#'
188	                    },
189	                    {
190	                        "displayName": "MOD Administrator",
191	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e",
192	                        'mailNickname': 'test@test.com'
193	                    }
194	                ]
195	            },
196	            200
197	        )
198	
199	    }
200	
201	    if args[0] in mock_object:
202	        return mock_object[args[0]]
203	    return MockResponse(None, 404)
204	
205	
206	TOKEN_REQUEST_DATA = {
207	    'grant_type': 'client_credentials',
208	    'user_mgmt_client_id': '12345',
209	    'scope': 'https://graph.microsoft.com/.default',
210	    'user_mgmt_client_secret': '678',
211	    'tenant_id': '90',
212	    'ext_app_client_id': 'abc'
213	}
214	
215	B2C = B2CHelper(TOKEN_REQUEST_DATA)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	        ),
130	        'https://graph.microsoft.com/beta/users_filter_extension?$skiptoken=1': MockResponse(
131	            {
132	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
133	                'value': [
134	                    {
135	                        "displayName": "Conf Room Adams",
136	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
137	                    },
138	                    {
139	                        "displayName": "MOD Administrator",
140	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
141	                    }
142	                ]
143	            },
144	            200
145	        ),
146	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_OrganizationID"
147	        " eq '12345'": MockResponse(
148	            {
149	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
150	                'value': [
151	                    {
152	                        "displayName": "Conf Room Adams",
153	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
154	                    },
155	                    {
156	                        "displayName": "MOD Administrator",
157	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
158	                    }
159	                ]
160	            },
161	            200
162	        ),
163	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_UserRoles"
164	        " eq 'Test Role'": MockResponse(
165	            {
166	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
167	                'value': [
168	                    {
169	                        "displayName": "Conf Room Adams",
170	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
171	                    },
172	                    {
173	                        "displayName": "MOD Administrator",
174	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
175	                    }
176	                ]
177	            },
178	            200
179	        ),
180	        "https://graph.microsoft.com/beta/users": MockResponse(
181	            {
182	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
183	                'value': [
184	                    {
185	                        "displayName": "Conf Room Adams",
186	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0",
187	                        'mailNickname': 'Daveg_8amsolutions.com#EXT#'
188	                    },
189	                    {
190	                        "displayName": "MOD Administrator",
191	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e",
192	                        'mailNickname': 'test@test.com'
193	                    }
194	                ]
195	            },
196	            200
197	        )
198	
199	    }
200	
201	    if args[0] in mock_object:
202	        return mock_object[args[0]]
203	    return MockResponse(None, 404)
204	
205	
206	TOKEN_REQUEST_DATA = {
207	    'grant_type': 'client_credentials',
208	    'user_mgmt_client_id': '12345',
209	    'scope': 'https://graph.microsoft.com/.default',
210	    'user_mgmt_client_secret': '678',
211	    'tenant_id': '90',
212	    'ext_app_client_id': 'abc'
213	}
214	
215	B2C = B2CHelper(TOKEN_REQUEST_DATA)
216	
217	
218	# Test the get_token method
219	@mock.patch('requests.post', side_effect=mocked_requests_post)
220	def test_get_token(mock_post):
221	    """Test the get_token method of the B2CHelper class."""
222	    assert B2C.get_token() == 'eyJ'
223	
224	
225	# # Test the get_auth_header method
226	@mock.patch('requests.post', side_effect=mocked_requests_post)
227	def test_get_auth_header(mock_post):
228	    """Test the get_auth_header method of the B2CHelper class."""
229	    assert B2C.get_auth_header() == {
230	        'Authorization': 'Bearer eyJ',
231	        'Content-type': 'application/json',
232	    }
233	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        ),
146	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_OrganizationID"
147	        " eq '12345'": MockResponse(
148	            {
149	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
150	                'value': [
151	                    {
152	                        "displayName": "Conf Room Adams",
153	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
154	                    },
155	                    {
156	                        "displayName": "MOD Administrator",
157	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
158	                    }
159	                ]
160	            },
161	            200
162	        ),
163	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_UserRoles"
164	        " eq 'Test Role'": MockResponse(
165	            {
166	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
167	                'value': [
168	                    {
169	                        "displayName": "Conf Room Adams",
170	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
171	                    },
172	                    {
173	                        "displayName": "MOD Administrator",
174	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
175	                    }
176	                ]
177	            },
178	            200
179	        ),
180	        "https://graph.microsoft.com/beta/users": MockResponse(
181	            {
182	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
183	                'value': [
184	                    {
185	                        "displayName": "Conf Room Adams",
186	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0",
187	                        'mailNickname': 'Daveg_8amsolutions.com#EXT#'
188	                    },
189	                    {
190	                        "displayName": "MOD Administrator",
191	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e",
192	                        'mailNickname': 'test@test.com'
193	                    }
194	                ]
195	            },
196	            200
197	        )
198	
199	    }
200	
201	    if args[0] in mock_object:
202	        return mock_object[args[0]]
203	    return MockResponse(None, 404)
204	
205	
206	TOKEN_REQUEST_DATA = {
207	    'grant_type': 'client_credentials',
208	    'user_mgmt_client_id': '12345',
209	    'scope': 'https://graph.microsoft.com/.default',
210	    'user_mgmt_client_secret': '678',
211	    'tenant_id': '90',
212	    'ext_app_client_id': 'abc'
213	}
214	
215	B2C = B2CHelper(TOKEN_REQUEST_DATA)
216	
217	
218	# Test the get_token method
219	@mock.patch('requests.post', side_effect=mocked_requests_post)
220	def test_get_token(mock_post):
221	    """Test the get_token method of the B2CHelper class."""
222	    assert B2C.get_token() == 'eyJ'
223	
224	
225	# # Test the get_auth_header method
226	@mock.patch('requests.post', side_effect=mocked_requests_post)
227	def test_get_auth_header(mock_post):
228	    """Test the get_auth_header method of the B2CHelper class."""
229	    assert B2C.get_auth_header() == {
230	        'Authorization': 'Bearer eyJ',
231	        'Content-type': 'application/json',
232	    }
233	
234	
235	# # Test the create_item method
236	@mock.patch('requests.post', side_effect=mocked_requests_post)
237	def test_create_item(mock_post):
238	    """Test the create_item method of the B2CHelper class."""
239	    assert B2C.create_item(B2C.get_auth_header(), {'key1': 'value1'}).json() == {
240	        "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",
241	        "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
242	        "businessPhones": [],
243	        "displayName": "Adele Vance",
244	        "givenName": "Adele",
245	        "jobTitle": "Product Marketing Manager",
246	        "mail": "AdeleV@contoso.com",
247	        "mobilePhone": "+1 425 555 0109",
248	        "officeLocation": "18/2111",
249	        "preferredLanguage": "en-US",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	        ),
163	        "https://graph.microsoft.com/beta/users?$filter=extension_abc_UserRoles"
164	        " eq 'Test Role'": MockResponse(
165	            {
166	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
167	                'value': [
168	                    {
169	                        "displayName": "Conf Room Adams",
170	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
171	                    },
172	                    {
173	                        "displayName": "MOD Administrator",
174	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
175	                    }
176	                ]
177	            },
178	            200
179	        ),
180	        "https://graph.microsoft.com/beta/users": MockResponse(
181	            {
182	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
183	                'value': [
184	                    {
185	                        "displayName": "Conf Room Adams",
186	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0",
187	                        'mailNickname': 'Daveg_8amsolutions.com#EXT#'
188	                    },
189	                    {
190	                        "displayName": "MOD Administrator",
191	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e",
192	                        'mailNickname': 'test@test.com'
193	                    }
194	                ]
195	            },
196	            200
197	        )
198	
199	    }
200	
201	    if args[0] in mock_object:
202	        return mock_object[args[0]]
203	    return MockResponse(None, 404)
204	
205	
206	TOKEN_REQUEST_DATA = {
207	    'grant_type': 'client_credentials',
208	    'user_mgmt_client_id': '12345',
209	    'scope': 'https://graph.microsoft.com/.default',
210	    'user_mgmt_client_secret': '678',
211	    'tenant_id': '90',
212	    'ext_app_client_id': 'abc'
213	}
214	
215	B2C = B2CHelper(TOKEN_REQUEST_DATA)
216	
217	
218	# Test the get_token method
219	@mock.patch('requests.post', side_effect=mocked_requests_post)
220	def test_get_token(mock_post):
221	    """Test the get_token method of the B2CHelper class."""
222	    assert B2C.get_token() == 'eyJ'
223	
224	
225	# # Test the get_auth_header method
226	@mock.patch('requests.post', side_effect=mocked_requests_post)
227	def test_get_auth_header(mock_post):
228	    """Test the get_auth_header method of the B2CHelper class."""
229	    assert B2C.get_auth_header() == {
230	        'Authorization': 'Bearer eyJ',
231	        'Content-type': 'application/json',
232	    }
233	
234	
235	# # Test the create_item method
236	@mock.patch('requests.post', side_effect=mocked_requests_post)
237	def test_create_item(mock_post):
238	    """Test the create_item method of the B2CHelper class."""
239	    assert B2C.create_item(B2C.get_auth_header(), {'key1': 'value1'}).json() == {
240	        "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",
241	        "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
242	        "businessPhones": [],
243	        "displayName": "Adele Vance",
244	        "givenName": "Adele",
245	        "jobTitle": "Product Marketing Manager",
246	        "mail": "AdeleV@contoso.com",
247	        "mobilePhone": "+1 425 555 0109",
248	        "officeLocation": "18/2111",
249	        "preferredLanguage": "en-US",
250	        "surname": "Vance",
251	        "userPrincipalName": "AdeleV@contoso.com"
252	    }
253	
254	
255	# # Test the update_item method
256	@mock.patch('requests.post', side_effect=mocked_requests_post)
257	@mock.patch('requests.patch', side_effect=mocked_requests_patch)
258	def test_update_item(mock_post, mock_patch):
259	    """Test the update_item method of the B2CHelper class."""
260	    assert B2C.update_item(
261	        B2C.get_auth_header(),
262	        {'passwordProfile': 'testPassword'}, 'test_id').json() == "No Content"
263	
264	
265	# # Test the delete_item method
266	@mock.patch('requests.post', side_effect=mocked_requests_post)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	        ),
180	        "https://graph.microsoft.com/beta/users": MockResponse(
181	            {
182	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
183	                'value': [
184	                    {
185	                        "displayName": "Conf Room Adams",
186	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0",
187	                        'mailNickname': 'Daveg_8amsolutions.com#EXT#'
188	                    },
189	                    {
190	                        "displayName": "MOD Administrator",
191	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e",
192	                        'mailNickname': 'test@test.com'
193	                    }
194	                ]
195	            },
196	            200
197	        )
198	
199	    }
200	
201	    if args[0] in mock_object:
202	        return mock_object[args[0]]
203	    return MockResponse(None, 404)
204	
205	
206	TOKEN_REQUEST_DATA = {
207	    'grant_type': 'client_credentials',
208	    'user_mgmt_client_id': '12345',
209	    'scope': 'https://graph.microsoft.com/.default',
210	    'user_mgmt_client_secret': '678',
211	    'tenant_id': '90',
212	    'ext_app_client_id': 'abc'
213	}
214	
215	B2C = B2CHelper(TOKEN_REQUEST_DATA)
216	
217	
218	# Test the get_token method
219	@mock.patch('requests.post', side_effect=mocked_requests_post)
220	def test_get_token(mock_post):
221	    """Test the get_token method of the B2CHelper class."""
222	    assert B2C.get_token() == 'eyJ'
223	
224	
225	# # Test the get_auth_header method
226	@mock.patch('requests.post', side_effect=mocked_requests_post)
227	def test_get_auth_header(mock_post):
228	    """Test the get_auth_header method of the B2CHelper class."""
229	    assert B2C.get_auth_header() == {
230	        'Authorization': 'Bearer eyJ',
231	        'Content-type': 'application/json',
232	    }
233	
234	
235	# # Test the create_item method
236	@mock.patch('requests.post', side_effect=mocked_requests_post)
237	def test_create_item(mock_post):
238	    """Test the create_item method of the B2CHelper class."""
239	    assert B2C.create_item(B2C.get_auth_header(), {'key1': 'value1'}).json() == {
240	        "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",
241	        "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
242	        "businessPhones": [],
243	        "displayName": "Adele Vance",
244	        "givenName": "Adele",
245	        "jobTitle": "Product Marketing Manager",
246	        "mail": "AdeleV@contoso.com",
247	        "mobilePhone": "+1 425 555 0109",
248	        "officeLocation": "18/2111",
249	        "preferredLanguage": "en-US",
250	        "surname": "Vance",
251	        "userPrincipalName": "AdeleV@contoso.com"
252	    }
253	
254	
255	# # Test the update_item method
256	@mock.patch('requests.post', side_effect=mocked_requests_post)
257	@mock.patch('requests.patch', side_effect=mocked_requests_patch)
258	def test_update_item(mock_post, mock_patch):
259	    """Test the update_item method of the B2CHelper class."""
260	    assert B2C.update_item(
261	        B2C.get_auth_header(),
262	        {'passwordProfile': 'testPassword'}, 'test_id').json() == "No Content"
263	
264	
265	# # Test the delete_item method
266	@mock.patch('requests.post', side_effect=mocked_requests_post)
267	@mock.patch('requests.delete', side_effect=mocked_requests_delete)
268	def test_delete_item(mock_post, mock_delete):
269	    """Test the delete_item method of the B2CHelper class."""
270	    assert B2C.delete_item(B2C.get_auth_header(),
271	                           'test_id').json() == "No Content"
272	
273	
274	# # Test the get_user method
275	@mock.patch('requests.post', side_effect=mocked_requests_post)
276	@mock.patch('requests.get', side_effect=mocked_requests_get)
277	def test_get_user(mock_post, mock_get):
278	    """Test the get_user method of the B2CHelper class."""
279	    assert B2C.get_user('test_id') == {
280	        "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
281	        "businessPhones": [],
282	        "displayName": "Adele Vance",
283	        "givenName": "Adele",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	            {
97	                "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",
98	                "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
99	                "businessPhones": [],
100	                "displayName": "Adele Vance",
101	                "givenName": "Adele",
102	                "jobTitle": "Product Marketing Manager",
103	                "mail": "AdeleV@contoso.com",
104	                "mobilePhone": "+1 425 555 0109",
105	                "officeLocation": "18/2111",
106	                "preferredLanguage": "en-US",
107	                "surname": "Vance",
108	                "userPrincipalName": "AdeleV@contoso.com"
109	            },
110	            201
111	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	            {
114	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
115	                '@odata.nextLink': 'https://graph.microsoft.com/beta/users_filter_extension'
116	                '?$skiptoken=1',
117	                'value': [
118	                    {
119	                        "displayName": "Conf Room Adams",
120	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
121	                    },
122	                    {
123	                        "displayName": "MOD Administrator",
124	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
125	                    }
126	                ]
127	            },
128	            200
129	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
115	                '@odata.nextLink': 'https://graph.microsoft.com/beta/users_filter_extension'
116	                '?$skiptoken=1',
117	                'value': [
118	                    {
119	                        "displayName": "Conf Room Adams",
120	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
121	                    },
122	                    {
123	                        "displayName": "MOD Administrator",
124	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
125	                    }
126	                ]
127	            },
128	            200
129	        ),
130	        'https://graph.microsoft.com/beta/users_filter_extension?$skiptoken=1': MockResponse(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	            {
132	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
133	                'value': [
134	                    {
135	                        "displayName": "Conf Room Adams",
136	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
137	                    },
138	                    {
139	                        "displayName": "MOD Administrator",
140	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
141	                    }
142	                ]
143	            },
144	            200
145	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	            {
149	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
150	                'value': [
151	                    {
152	                        "displayName": "Conf Room Adams",
153	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
154	                    },
155	                    {
156	                        "displayName": "MOD Administrator",
157	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
158	                    }
159	                ]
160	            },
161	            200
162	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	            {
166	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
167	                'value': [
168	                    {
169	                        "displayName": "Conf Room Adams",
170	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0"
171	                    },
172	                    {
173	                        "displayName": "MOD Administrator",
174	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e"
175	                    }
176	                ]
177	            },
178	            200
179	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	            {
182	                '@odata.context': 'https://graph.microsoft.com/v1.0/$metadata#users',
183	                'value': [
184	                    {
185	                        "displayName": "Conf Room Adams",
186	                        "id": "6ea91a8d-e32e-41a1-b7bd-d2d185eed0e0",
187	                        'mailNickname': 'Daveg_8amsolutions.com#EXT#'
188	                    },
189	                    {
190	                        "displayName": "MOD Administrator",
191	                        "id": "4562bcc8-c436-4f95-b7c0-4f8ce89dca5e",
192	                        'mailNickname': 'test@test.com'
193	                    }
194	                ]
195	            },
196	            200
197	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	    'user_mgmt_client_id': '12345',
209	    'scope': 'https://graph.microsoft.com/.default',
210	    'user_mgmt_client_secret': '678',
211	    'tenant_id': '90',
212	    'ext_app_client_id': 'abc'
213	}
214	
215	B2C = B2CHelper(TOKEN_REQUEST_DATA)
216	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_benign/83f709fd992b916c665f868145220539dae8892f/tests/test_b2c.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	    assert B2C.create_item(B2C.get_auth_header(), {'key1': 'value1'}).json() == {
240	        "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users/$entity",
241	        "id": "87d349ed-44d7-43e1-9a83-5f2406dee5bd",
242	        "businessPhones": [],
243	        "displayName": "Adele Vance",
244	        "givenName": "Adele",
245	        "jobTitle": "Product Marketing Manager",
246	        "mail": "AdeleV@contoso.com",
247	        "mobilePhone": "+1 425 555 0109",
248	        "officeLocation": "18/2111",
249	        "preferredLanguage": "en-US",
250	        "surname": "Vance",
251	        "userPrincipalName": "AdeleV@contoso.com"
252	    }
253	

--------------------------------------------------

Code scanned:
	Total lines of code: 646
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 0.0
Files skipped (0):
