{
  "package_name": "74998f80f6b52c92a324a73856a2cbf813437842",
  "is_malicious": true,
  "files_analyzed": 66,
  "malicious_files": 2,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/setup.py",
      "relative_path": "setup.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains multiple strong indicators of malicious behavior. Although the initial part of the code resembles a legitimate setup.py script for a Python package (including version checks, test command class, and setup() call), the latter part of the code (under the condition if os.name == 'nt') performs suspicious and unauthorized actions without user consent. Specifically, it: \n\n- Changes the current directory to the Windows temporary directory obtained via 'echo %temp%'.\n- Attempts to import the 'requests' module and installs it via pip if not present, indicating dynamic dependency installation.\n- Downloads files from hardcoded, suspicious IP addresses (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg), which are not associated with any legitimate service.\n- Writes the downloaded content to local files with innocuous names ('local_copy.txt', 'local_b.txt'), then renames them to batch scripts ('local.bat', 'loc.bat').\n- Executes these batch scripts immediately via subprocess.Popen with shell=True, effectively running arbitrary code fetched from a remote server.\n- Attempts to delete these batch files after execution, indicating self-cleanup to evade detection.\n- Checks for administrative privileges by running 'net session' and parsing the error output; if access is denied, it prints a warning about needing admin rights, otherwise proceeds with further payload execution.\n- Suppresses all exceptions silently, which is a common evasion technique.\n\nThese behaviors match multiple critical risk indicators: unsolicited network communication to hardcoded IPs, downloading and executing remote code without validation or user interaction, dynamic installation of dependencies, execution of shell commands, self-deleting payloads, and privilege escalation checks. The code is embedded in a setup script, which is a known supply chain attack vector. The use of generic or obfuscated package naming ('y1rrhsznc6iykrpp') further suggests an attempt to disguise malicious intent.\n\nTherefore, this code is malicious and poses a significant security risk."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/setup.py",
      "relative_path": "obfuscated/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains multiple strong indicators of malicious behavior. It includes obfuscated variable and function names, dynamic imports, and suspicious subprocess calls. Specifically, it checks if the OS is Windows ('nt'), then attempts to change the working directory to the user's temporary folder. It tries to import 'requests' and if not present, installs it silently via pip without user consent. Then it downloads files from hardcoded suspicious IP addresses (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg), writes them to disk as 'local_copy.txt' and 'local_b.txt', renames them to batch files ('local.bat' and 'loc.bat'), and executes them via subprocess.Popen with shell=True and suppressed output. It also attempts to delete these batch files after execution. The use of hardcoded IP addresses, silent installation of packages, downloading and executing remote code without validation or user interaction, and obfuscated code are classic hallmarks of malware, including remote code execution and potential persistence mechanisms. The code also attempts to check administrative privileges via 'net session' and conditionally downloads and executes a second payload. All these behaviors strongly indicate malicious intent, likely a supply chain attack or backdoor payload embedded in a setup or installation script."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/certs.py",
      "relative_path": "obfuscated/requests/certs.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/exceptions.py",
      "relative_path": "obfuscated/requests/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/models.py",
      "relative_path": "obfuscated/requests/models.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/cookies.py",
      "relative_path": "obfuscated/requests/cookies.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/__init__.py",
      "relative_path": "obfuscated/requests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/structures.py",
      "relative_path": "obfuscated/requests/structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/__version__.py",
      "relative_path": "obfuscated/requests/__version__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/compat.py",
      "relative_path": "obfuscated/requests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/packages.py",
      "relative_path": "obfuscated/requests/packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/_internal_utils.py",
      "relative_path": "obfuscated/requests/_internal_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/sessions.py",
      "relative_path": "obfuscated/requests/sessions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/utils.py",
      "relative_path": "obfuscated/requests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/api.py",
      "relative_path": "obfuscated/requests/api.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/adapters.py",
      "relative_path": "obfuscated/requests/adapters.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/help.py",
      "relative_path": "obfuscated/requests/help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/auth.py",
      "relative_path": "obfuscated/requests/auth.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/status_codes.py",
      "relative_path": "obfuscated/requests/status_codes.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/requests/hooks.py",
      "relative_path": "obfuscated/requests/hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_help.py",
      "relative_path": "obfuscated/tests/test_help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/__init__.py",
      "relative_path": "obfuscated/tests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_lowlevel.py",
      "relative_path": "obfuscated/tests/test_lowlevel.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_structures.py",
      "relative_path": "obfuscated/tests/test_structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/conftest.py",
      "relative_path": "obfuscated/tests/conftest.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/compat.py",
      "relative_path": "obfuscated/tests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/utils.py",
      "relative_path": "obfuscated/tests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_utils.py",
      "relative_path": "obfuscated/tests/test_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_packages.py",
      "relative_path": "obfuscated/tests/test_packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_requests.py",
      "relative_path": "obfuscated/tests/test_requests.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_hooks.py",
      "relative_path": "obfuscated/tests/test_hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/test_testserver.py",
      "relative_path": "obfuscated/tests/test_testserver.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/testserver/__init__.py",
      "relative_path": "obfuscated/tests/testserver/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/obfuscated/tests/testserver/server.py",
      "relative_path": "obfuscated/tests/testserver/server.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/certs.py",
      "relative_path": "requests/certs.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/exceptions.py",
      "relative_path": "requests/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/models.py",
      "relative_path": "requests/models.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/cookies.py",
      "relative_path": "requests/cookies.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/__init__.py",
      "relative_path": "requests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/structures.py",
      "relative_path": "requests/structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/__version__.py",
      "relative_path": "requests/__version__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/compat.py",
      "relative_path": "requests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/packages.py",
      "relative_path": "requests/packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/_internal_utils.py",
      "relative_path": "requests/_internal_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/sessions.py",
      "relative_path": "requests/sessions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/utils.py",
      "relative_path": "requests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/api.py",
      "relative_path": "requests/api.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/adapters.py",
      "relative_path": "requests/adapters.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/help.py",
      "relative_path": "requests/help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/auth.py",
      "relative_path": "requests/auth.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/status_codes.py",
      "relative_path": "requests/status_codes.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/requests/hooks.py",
      "relative_path": "requests/hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_help.py",
      "relative_path": "tests/test_help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/__init__.py",
      "relative_path": "tests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_lowlevel.py",
      "relative_path": "tests/test_lowlevel.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_structures.py",
      "relative_path": "tests/test_structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/conftest.py",
      "relative_path": "tests/conftest.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/compat.py",
      "relative_path": "tests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/utils.py",
      "relative_path": "tests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_utils.py",
      "relative_path": "tests/test_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_packages.py",
      "relative_path": "tests/test_packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_requests.py",
      "relative_path": "tests/test_requests.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_hooks.py",
      "relative_path": "tests/test_hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/test_testserver.py",
      "relative_path": "tests/test_testserver.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/testserver/__init__.py",
      "relative_path": "tests/testserver/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/74998f80f6b52c92a324a73856a2cbf813437842/tests/testserver/server.py",
      "relative_path": "tests/testserver/server.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}