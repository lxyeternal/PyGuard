{
  "package_name": "803bc74d3f82a120c4663a2f31c8057b90668cd7",
  "is_malicious": true,
  "files_analyzed": 66,
  "malicious_files": 2,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/setup.py",
      "relative_path": "setup.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains multiple strong indicators of malicious behavior. Although the initial part of the code resembles a typical setup.py script for a Python package, the latter part conditionally executes on Windows (os.name == 'nt') and performs suspicious actions without user consent. It changes the current directory to the user's temporary folder, attempts to import the 'requests' module and installs it if missing, then downloads files from hardcoded, non-standard IP addresses (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg). These files are saved locally with innocuous names but then renamed to .bat files and executed via subprocess.Popen with shell=True, effectively running arbitrary code fetched from a remote server. The code also attempts to delete these .bat files after execution, indicating self-cleanup to evade detection. It checks for administrative privileges by running 'net session' and prints a warning if access is denied, suggesting it tries to escalate or warn about privilege issues. The use of hardcoded IP addresses, silent network communication, downloading and executing remote scripts, self-deleting behavior, and lack of user interaction or validation are classic hallmarks of malware, specifically a remote code execution and payload delivery mechanism embedded in a package installation script. This pattern is consistent with supply chain attacks and is highly suspicious and dangerous."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/setup.py",
      "relative_path": "obfuscated/setup.py",
      "is_malicious": true,
      "malicious_behavior": "The code contains multiple strong indicators of malicious behavior. It is obfuscated with meaningless variable and function names, which is a common evasion technique. The code is embedded in what appears to be a setup or installation script, which is a known supply chain attack vector. It checks if the OS is Windows ('nt') and then performs the following suspicious actions without user consent: it uses subprocess to get the Windows temp directory, changes the working directory there, attempts to import 'requests' and if not present, installs it silently via pip. Then it downloads a file from a hardcoded suspicious IP address (http://52.14.229.35:1122/connect-CANDC.txt), writes it to disk as 'local_copy.txt', renames it to 'local.bat', and executes it via cmd. It then deletes the batch file. It performs a privilege check using 'net session' and if access is granted, downloads another file from the same IP (http://52.14.229.35:1122/shoomsha.jpg), saves it as 'local_b.txt', renames to 'loc.bat', executes it, and deletes it. This sequence of downloading executable scripts from a hardcoded external IP, writing them to disk, executing them silently, and cleaning up is a classic remote payload retrieval and execution pattern, strongly associated with malware. The code suppresses exceptions to avoid detection and uses obfuscation to hide intent. There is no legitimate application logic or user interaction justifying these actions. Therefore, this code is malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/certs.py",
      "relative_path": "obfuscated/requests/certs.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/exceptions.py",
      "relative_path": "obfuscated/requests/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/models.py",
      "relative_path": "obfuscated/requests/models.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/cookies.py",
      "relative_path": "obfuscated/requests/cookies.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/__init__.py",
      "relative_path": "obfuscated/requests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/structures.py",
      "relative_path": "obfuscated/requests/structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/__version__.py",
      "relative_path": "obfuscated/requests/__version__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/compat.py",
      "relative_path": "obfuscated/requests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/packages.py",
      "relative_path": "obfuscated/requests/packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/_internal_utils.py",
      "relative_path": "obfuscated/requests/_internal_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/sessions.py",
      "relative_path": "obfuscated/requests/sessions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/utils.py",
      "relative_path": "obfuscated/requests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/api.py",
      "relative_path": "obfuscated/requests/api.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/adapters.py",
      "relative_path": "obfuscated/requests/adapters.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/help.py",
      "relative_path": "obfuscated/requests/help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/auth.py",
      "relative_path": "obfuscated/requests/auth.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/status_codes.py",
      "relative_path": "obfuscated/requests/status_codes.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/requests/hooks.py",
      "relative_path": "obfuscated/requests/hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_help.py",
      "relative_path": "obfuscated/tests/test_help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/__init__.py",
      "relative_path": "obfuscated/tests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_lowlevel.py",
      "relative_path": "obfuscated/tests/test_lowlevel.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_structures.py",
      "relative_path": "obfuscated/tests/test_structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/conftest.py",
      "relative_path": "obfuscated/tests/conftest.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/compat.py",
      "relative_path": "obfuscated/tests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/utils.py",
      "relative_path": "obfuscated/tests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_utils.py",
      "relative_path": "obfuscated/tests/test_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_packages.py",
      "relative_path": "obfuscated/tests/test_packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_requests.py",
      "relative_path": "obfuscated/tests/test_requests.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_hooks.py",
      "relative_path": "obfuscated/tests/test_hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/test_testserver.py",
      "relative_path": "obfuscated/tests/test_testserver.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/testserver/__init__.py",
      "relative_path": "obfuscated/tests/testserver/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/obfuscated/tests/testserver/server.py",
      "relative_path": "obfuscated/tests/testserver/server.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/certs.py",
      "relative_path": "requests/certs.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/exceptions.py",
      "relative_path": "requests/exceptions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/models.py",
      "relative_path": "requests/models.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/cookies.py",
      "relative_path": "requests/cookies.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/__init__.py",
      "relative_path": "requests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/structures.py",
      "relative_path": "requests/structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/__version__.py",
      "relative_path": "requests/__version__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/compat.py",
      "relative_path": "requests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/packages.py",
      "relative_path": "requests/packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/_internal_utils.py",
      "relative_path": "requests/_internal_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/sessions.py",
      "relative_path": "requests/sessions.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/utils.py",
      "relative_path": "requests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/api.py",
      "relative_path": "requests/api.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/adapters.py",
      "relative_path": "requests/adapters.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/help.py",
      "relative_path": "requests/help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/auth.py",
      "relative_path": "requests/auth.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/status_codes.py",
      "relative_path": "requests/status_codes.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/requests/hooks.py",
      "relative_path": "requests/hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_help.py",
      "relative_path": "tests/test_help.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/__init__.py",
      "relative_path": "tests/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_lowlevel.py",
      "relative_path": "tests/test_lowlevel.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_structures.py",
      "relative_path": "tests/test_structures.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/conftest.py",
      "relative_path": "tests/conftest.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/compat.py",
      "relative_path": "tests/compat.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/utils.py",
      "relative_path": "tests/utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_utils.py",
      "relative_path": "tests/test_utils.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_packages.py",
      "relative_path": "tests/test_packages.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_requests.py",
      "relative_path": "tests/test_requests.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_hooks.py",
      "relative_path": "tests/test_hooks.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/test_testserver.py",
      "relative_path": "tests/test_testserver.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/testserver/__init__.py",
      "relative_path": "tests/testserver/__init__.py",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/803bc74d3f82a120c4663a2f31c8057b90668cd7/tests/testserver/server.py",
      "relative_path": "tests/testserver/server.py",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}