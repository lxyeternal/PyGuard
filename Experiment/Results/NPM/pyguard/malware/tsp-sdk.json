{
  "package_name": "tsp-sdk",
  "is_malicious": true,
  "files_analyzed": 20,
  "malicious_files": 2,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/indexDB.js",
      "relative_path": "esm/indexDB.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/types.js",
      "relative_path": "esm/types.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/sdk.js",
      "relative_path": "esm/sdk.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/index.js",
      "relative_path": "esm/index.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/api/index.js",
      "relative_path": "esm/api/index.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/mdap.js",
      "relative_path": "esm/util/mdap.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/measure-time.js",
      "relative_path": "esm/util/measure-time.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/immutable.js",
      "relative_path": "esm/util/immutable.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/interpolate.js",
      "relative_path": "esm/util/interpolate.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/index.js",
      "relative_path": "esm/util/index.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/delay-exec.js",
      "relative_path": "esm/util/delay-exec.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/plural-rules.js",
      "relative_path": "esm/util/plural-rules.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/interpolation.js",
      "relative_path": "esm/util/interpolation.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/ajax.js",
      "relative_path": "esm/util/ajax.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/util/idle-exec.js",
      "relative_path": "esm/util/idle-exec.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/esm/conf/live.js",
      "relative_path": "esm/conf/live.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/dist/redteam.js",
      "relative_path": "dist/redteam.js",
      "file_type": "js",
      "is_malicious": true,
      "malicious_behavior": "The code exhibits multiple strong indicators of malicious behavior. It collects extensive system and user information (package name, directory, home directory, hostname, username, OS type, platform, architecture, DNS servers, resolved IP addresses, package version) without user consent and exfiltrates this data via an HTTP POST request to a hardcoded external IP address (106.52.224.139) on port 80. Immediately after, it executes a reverse shell payload by running a Python one-liner that connects back to the same IP on port 5566, spawning a bash shell, effectively granting remote control of the host. Furthermore, it writes a cron job to /tmp that repeats this reverse shell connection every 5 minutes, ensuring persistence. The code suppresses error logging for network requests, indicating an attempt to avoid detection. The combination of host fingerprinting, data exfiltration, reverse shell execution, and persistence via cron job is a classic malware pattern. There is no legitimate user-facing functionality or documentation, and the hardcoded IP and reverse shell commands are clear signs of unauthorized remote access and control. Therefore, this code is malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/dist/tsp-sdk.js",
      "relative_path": "dist/tsp-sdk.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/dist/tsp-sdk.min.js",
      "relative_path": "dist/tsp-sdk.min.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/tsp-sdk/package.json",
      "relative_path": "package.json",
      "file_type": "package.json",
      "is_malicious": true,
      "malicious_behavior": "The package.json contains a suspicious 'preinstall' script: \"node dist/redteam.js\". The 'preinstall' lifecycle script runs automatically before the package is installed, which can be exploited to execute arbitrary code on the user's machine. The filename 'redteam.js' is also suspicious, as 'red team' is a term often associated with offensive security or penetration testing, which may indicate malicious intent or unauthorized actions. Without the actual content of 'dist/redteam.js', it is impossible to definitively determine the behavior, but the presence of this script in the preinstall phase is a strong indicator of potentially malicious behavior."
    }
  ],
  "true_label": "malware"
}