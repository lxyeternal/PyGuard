{
  "package_name": "radic-util",
  "is_malicious": true,
  "files_analyzed": 13,
  "malicious_files": 1,
  "file_results": [
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/karma.conf.js",
      "relative_path": "karma.conf.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/jasmine.js",
      "relative_path": "jasmine.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/lib/functions.js",
      "relative_path": "lib/functions.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/lib/JSON.js",
      "relative_path": "lib/JSON.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/lib/object.js",
      "relative_path": "lib/object.js",
      "file_type": "js",
      "is_malicious": true,
      "malicious_behavior": "The provided JavaScript code contains obfuscated and suspicious logic that strongly indicates malicious behavior. Key indicators include:\n\n1. Obfuscation: The code uses an obfuscated string _OH and accesses its characters by index to build strings dynamically, which is a common evasion technique.\n\n2. Data Exfiltration: The code attaches event listeners to form submissions and input elements of type 'password' or with names resembling sensitive fields. It collects form data and document cookies, encodes them (base64 after URI encoding), and sends them to an external URL constructed from obfuscated strings.\n\n3. Network Communication: The code performs a fetch request to the current document URL and inspects response headers for specific obfuscated values, controlling whether to attach event listeners for data capture.\n\n4. Cookie and Form Data Theft: The event listeners gather all form element names and values, concatenate them with delimiters, and exfiltrate this data along with the current location and cookies.\n\n5. Persistence and Evasion: The code sets cookies with obfuscated names and values to control execution flow and avoid repeated exfiltration.\n\n6. Dynamic DOM Manipulation: It creates and appends a <link> element with a rel attribute set to 'stylesheet' and href pointing to the exfiltration URL, which is a stealthy way to send data.\n\n7. Environment Checks: The code checks for certain conditions such as time of day, hostnames, and cookie presence to decide whether to execute the malicious payload, indicating evasion tactics.\n\n8. No Legitimate Functionality: The rest of the code appears to be utility functions unrelated to the obfuscated malicious part, which is hidden at the bottom and executed immediately.\n\nGiven these points, the code is designed to stealthily capture sensitive user input and cookies from web forms and exfiltrate them to an attacker-controlled server without user consent or notification. This behavior is characteristic of credential-stealing malware or form-grabbing scripts. Therefore, the code is malicious."
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/lib/material.js",
      "relative_path": "lib/material.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/lib/general.js",
      "relative_path": "lib/general.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/lib/storage.js",
      "relative_path": "lib/storage.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/lib/config.js",
      "relative_path": "lib/config.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/spec/index.js",
      "relative_path": "spec/index.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/spec/lib/configSpec.js",
      "relative_path": "spec/lib/configSpec.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/spec/helpers/SpecHelper.js",
      "relative_path": "spec/helpers/SpecHelper.js",
      "file_type": "js",
      "is_malicious": false,
      "malicious_behavior": ""
    },
    {
      "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/npm_data/unzip_malware/radic-util/package.json",
      "relative_path": "package.json",
      "file_type": "package.json",
      "is_malicious": false,
      "malicious_behavior": ""
    }
  ],
  "true_label": "malware"
}