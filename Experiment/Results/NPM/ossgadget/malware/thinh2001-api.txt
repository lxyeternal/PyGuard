[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m63 | [0m[35m```js[0m
[30;1m64 | [0m[35mvar credentials = {[0m
[30;1m65 | [0m[35m    email: process.env.FB_EMAIL,[0m
[30;1m66 | [0m[35m    password: process.env.FB_PASSWORD[0m
[30;1m67 | [0m[35m}[0m
[30;1m68 | [0m[35m```[0m
[30;1m69 | [0m[35m```bash[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m62 | [0m[35mIf you want to be even more safe:  _login.js_ can get password with `require("readline")` or with en[0m
[30;1m63 | [0m[35m```js[0m
[30;1m64 | [0m[35mvar credentials = {[0m
[30;1m65 | [0m[35m    email: process.env.FB_EMAIL,[0m
[30;1m66 | [0m[35m    password: process.env.FB_PASSWORD[0m
[30;1m67 | [0m[35m}[0m
[30;1m68 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1601 | [0m[35m__Example (Location)__[0m
[30;1m1602 | [0m[35m```js[0m
[30;1m1603 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m1604 | [0m[35mlogin({email: "EMAIL", password: "PASSWORD"}, (err, api) => {[0m
[30;1m1605 | [0m[35m    if(err) return console.error(err);[0m
[30;1m1606 | [0m[35m    var yourID = "000000000000000";[0m
[30;1m1607 | [0m[35m    const msg = {[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1601 | [0m[35m__Example (Location)__[0m
[30;1m1602 | [0m[35m```js[0m
[30;1m1603 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m1604 | [0m[35mlogin({email: "EMAIL", password: "PASSWORD"}, (err, api) => {[0m
[30;1m1605 | [0m[35m    if(err) return console.error(err);[0m
[30;1m1606 | [0m[35m    var yourID = "000000000000000";[0m
[30;1m1607 | [0m[35m    const msg = {[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1578 | [0m[35m```js[0m
[30;1m1579 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m1580 | [0m[35m[0m
[30;1m1581 | [0m[35mlogin({email: "EMAIL", password: "PASSWORD"}, (err, api) => {[0m
[30;1m1582 | [0m[35m    if(err) return console.error(err);[0m
[30;1m1583 | [0m[35m[0m
[30;1m1584 | [0m[35m    api.listen((err, message) => {[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1578 | [0m[35m```js[0m
[30;1m1579 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m1580 | [0m[35m[0m
[30;1m1581 | [0m[35mlogin({email: "EMAIL", password: "PASSWORD"}, (err, api) => {[0m
[30;1m1582 | [0m[35m    if(err) return console.error(err);[0m
[30;1m1583 | [0m[35m[0m
[30;1m1584 | [0m[35m    api.listen((err, message) => {[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35m  output: process.stdout[0m
[30;1m152 | [0m[35m});[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35mconst obj = {email: "FB_EMAIL", password: "FB_PASSWORD"};[0m
[30;1m155 | [0m[35mlogin(obj, (err, api) => {[0m
[30;1m156 | [0m[35m    if(err) {[0m
[30;1m157 | [0m[35m        switch (err.error) {[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35m  output: process.stdout[0m
[30;1m152 | [0m[35m});[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35mconst obj = {email: "FB_EMAIL", password: "FB_PASSWORD"};[0m
[30;1m155 | [0m[35mlogin(obj, (err, api) => {[0m
[30;1m156 | [0m[35m    if(err) {[0m
[30;1m157 | [0m[35m        switch (err.error) {[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35mconst fs = require("fs");[0m
[30;1m119 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m122 | [0m[35m    if(err) return console.error(err);[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    fs.writeFileSync('appstate.json', JSON.stringify(api.getAppState()));[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35mconst fs = require("fs");[0m
[30;1m119 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m122 | [0m[35m    if(err) return console.error(err);[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    fs.writeFileSync('appstate.json', JSON.stringify(api.getAppState()));[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35m});[0m
[30;1m113 | [0m[35m```[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m__Example (Email & Password then save appState to file)__[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m```js[0m
[30;1m118 | [0m[35mconst fs = require("fs");[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m```js[0m
[30;1m107 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m110 | [0m[35m    if(err) return console.error(err);[0m
[30;1m111 | [0m[35m    // Here you can use the api[0m
[30;1m112 | [0m[35m});[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m```js[0m
[30;1m107 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m110 | [0m[35m    if(err) return console.error(err);[0m
[30;1m111 | [0m[35m    // Here you can use the api[0m
[30;1m112 | [0m[35m});[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m* `options`: An object representing options to use when logging in (as described in [api.setOptions][0m
[30;1m102 | [0m[35m* `callback(err, api)`: A callback called when login is done (successful or not). `err` is an object[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m__Example (Email & Password)__[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m```js[0m
[30;1m107 | [0m[35mconst login = require("fca-unofficial");[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m__Arguments__[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m* `credentials`: An object containing the fields `email` and `password` used to login, __*or*__ an o[0m
[30;1m101 | [0m[35m* `options`: An object representing options to use when logging in (as described in [api.setOptions][0m
[30;1m102 | [0m[35m* `callback(err, api)`: A callback called when login is done (successful or not). `err` is an object[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m68 | [0m[35m```[0m
[30;1m69 | [0m[35m```bash[0m
[30;1m70 | [0m[35mFB_EMAIL="john.doe@example.com"[0m
[30;1m71 | [0m[35mFB_PASSWORD="MySuperHardP@ssw0rd"[0m
[30;1m72 | [0m[35mnodejs login.js[0m
[30;1m73 | [0m[35m```[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m```js[0m
[30;1m64 | [0m[35mvar credentials = {[0m
[30;1m65 | [0m[35m    email: process.env.FB_EMAIL,[0m
[30;1m66 | [0m[35m    password: process.env.FB_PASSWORD[0m
[30;1m67 | [0m[35m}[0m
[30;1m68 | [0m[35m```[0m
[30;1m69 | [0m[35m```bash[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m```js[0m
[30;1m64 | [0m[35mvar credentials = {[0m
[30;1m65 | [0m[35m    email: process.env.FB_EMAIL,[0m
[30;1m66 | [0m[35m    password: process.env.FB_PASSWORD[0m
[30;1m67 | [0m[35m}[0m
[30;1m68 | [0m[35m```[0m
[30;1m69 | [0m[35m```bash[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35mPreferred method is to have `login.js` that saves `AppState` to a file and then use that file from a[0m
[30;1m60 | [0m[35mThis way you can put password in your code for a minute, login to facebook and then remove it.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mIf you want to be even more safe:  _login.js_ can get password with `require("readline")` or with en[0m
[30;1m63 | [0m[35m```js[0m
[30;1m64 | [0m[35mvar credentials = {[0m
[30;1m65 | [0m[35m    email: process.env.FB_EMAIL,[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m* If you change your password in the future (maybe it leaked because _someone_ stored password in so[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mPreferred method is to have `login.js` that saves `AppState` to a file and then use that file from a[0m
[30;1m60 | [0m[35mThis way you can put password in your code for a minute, login to facebook and then remove it.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mIf you want to be even more safe:  _login.js_ can get password with `require("readline")` or with en[0m
[30;1m63 | [0m[35m```js[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35mher service) without removing your password from the file.  Remember: Even if you undo your accident[0m
[30;1m57 | [0m[35m* If you change your password in the future (maybe it leaked because _someone_ stored password in so[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mPreferred method is to have `login.js` that saves `AppState` to a file and then use that file from a[0m
[30;1m60 | [0m[35mThis way you can put password in your code for a minute, login to facebook and then remove it.[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35mect my backups_"[0m
[30;1m56 | [0m[35m* You can't push your code to Github (or any onther service) without removing your password from the[0m
[30;1m57 | [0m[35m* If you change your password in the future (maybe it leaked because _someone_ stored password in so[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mPreferred method is to have `login.js` that saves `AppState` to a file and then use that file from a[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m of source files may be readable by someone else. "_There is nothing secret in my code, why should I[0m
[30;1m56 | [0m[35m* You can't push your code to Github (or any onther service) without removing your password from the[0m
[30;1m57 | [0m[35m* If you change your password in the future (maybe it leaked because _someone_ stored password in so[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35mou may look at your "code" and get your password if it is on the screen[0m
[30;1m55 | [0m[35m* Backups of source files may be readable by someone else. "_There is nothing secret in my code, why[0m
[30;1m56 | [0m[35m* You can't push your code to Github (or any onther service) without removing your password from the[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35mhould not store Facebook password in your scripts.[0m
[30;1m53 | [0m[35mThere are few good reasons:[0m
[30;1m54 | [0m[35m* People who are standing behind you may look at your "code" and get your password if it is on the s[0m
[30;1m55 | [0m[35m* Backups of source files may be readable by someone else. "_There is nothing secret in my code, why[0m
[30;1m56 | [0m[35m* You can't push your code to Github (or any onther service) without removing your password from the[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m`](#unsendMessage)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m---------------------------------------[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m### Password safety[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m**Read this** before you _copy+paste_ examples from below.[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mYou should not store Facebook password in your scripts.[0m
[30;1m53 | [0m[35mThere are few good reasons:[0m
[30;1m54 | [0m[35m* People who are standing behind you may look at your "code" and get your password if it is on the s[0m
[30;1m55 | [0m[35m* Backups of source files may be readable by someone else. "_There is nothing secret in my code, why[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m**Read this** before you _copy+paste_ examples from below.[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mYou should not store Facebook password in your scripts.[0m
[30;1m53 | [0m[35mThere are few good reasons:[0m
[30;1m54 | [0m[35m* People who are standing behind you may look at your "code" and get your password if it is on the s[0m
[30;1m55 | [0m[35m* Backups of source files may be readable by someone else. "_There is nothing secret in my code, why[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m---------------------------------------[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m### Password safety[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m**Read this** before you _copy+paste_ examples from below.[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/example-config.json[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m6 | [0m[35m  "user" : {[0m
[30;1m7 | [0m[35m      "id" : "00000000000000",[0m
[30;1m8 | [0m[35m      "email" : "example@test.com",[0m
[30;1m9 | [0m[35m      "password" : "qwerty"[0m
[30;1m10 | [0m[35m  },[0m
[30;1m11 | [0m[35m  // Array of at least 2 other user IDs (not the same as the test user)[0m
[30;1m12 | [0m[35m  "userIDs" : [[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m525 | [0m[35m        };[0m
[30;1m526 | [0m[35m        callback = prCallback;[0m
[30;1m527 | [0m[35m    }[0m
[30;1m528 | [0m[35m    loginHelper(loginData.appState, loginData.email, loginData.password, globalOptions, callback, pr[0m
[30;1m529 | [0m[35m    return returnPromise;[0m
[30;1m530 | [0m[35m}[0m
[30;1m531 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m436 | [0m[35m        mainPromise = utils[0m
[30;1m437 | [0m[35m            .get("https://www.facebook.com/", null, null, globalOptions, { noRef: true })[0m
[30;1m438 | [0m[35m            .then(utils.saveCookies(jar))[0m
[30;1m439 | [0m[35m            .then(makeLogin(jar, email, password, globalOptions, callback, prCallback))[0m
[30;1m440 | [0m[35m            .then(function() {[0m
[30;1m441 | [0m[35m                return utils.get('https://www.facebook.com/', jar, null, globalOptions).then(utils.s[0m
[30;1m442 | [0m[35m            });[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m416 | [0m[35m}[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m// Helps the login[0m
[30;1m419 | [0m[35mfunction loginHelper(appState, email, password, globalOptions, callback, prCallback) {[0m
[30;1m420 | [0m[35m    var mainPromise = null;[0m
[30;1m421 | [0m[35m    var jar = utils.getJar();[0m
[30;1m422 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m                                        // Simply call loginHelper because all it needs is the jar[0m
[30;1m405 | [0m[35m                                        // and will then complete the login process[0m
[30;1m406 | [0m[35m                                        return loginHelper(appState, email, password, loginOptions, [0m
[30;1m407 | [0m[35m                                    })[0m
[30;1m408 | [0m[35m                                    .catch(e => callback(e));[0m
[30;1m409 | [0m[35m                            }[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m367 | [0m[35m                                                                return prResolve(api);[0m
[30;1m368 | [0m[35m                                                            };[0m
[30;1m369 | [0m[35m                                                        }[0m
[30;1m370 | [0m[35m                                                        return loginHelper(utils.getAppState(jar), e[0m
[30;1m371 | [0m[35m                                                    }[0m
[30;1m372 | [0m[35m                                                })[0m
[30;1m373 | [0m[35m                                                .catch(ex => {[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m                                                    // Simply call loginHelper because all it needs [0m
[30;1m346 | [0m[35m                                                    // and will then complete the login process[0m
[30;1m347 | [0m[35m                                                    return loginHelper(appState, email, password, lo[0m
[30;1m348 | [0m[35m                                                })[0m
[30;1m349 | [0m[35m                                                .catch(function(err) {[0m
[30;1m350 | [0m[35m                                                    // Check if using Promise instead of callback[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m264 | [0m[35m            .then(utils.saveCookies(jar))[0m
[30;1m265 | [0m[35m            .then(function(res) {[0m
[30;1m266 | [0m[35m                var headers = res.headers;[0m
[30;1m267 | [0m[35m                if (!headers.location) throw { error: "Wrong username/password." };[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m                // This means the account has login approvals turned on.[0m
[30;1m270 | [0m[35m                if (headers.location.indexOf('https://www.facebook.com/checkpoint/') > -1) {[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m234 | [0m[35m        form.lsd = utils.getFrom(html, "[\"LSD\",[],{\"token\":\"", "\"}");[0m
[30;1m235 | [0m[35m        form.lgndim = Buffer.from("{\"w\":1440,\"h\":900,\"aw\":1440,\"ah\":834,\"c\":24}").toString[0m
[30;1m236 | [0m[35m        form.email = email;[0m
[30;1m237 | [0m[35m        form.pass = password;[0m
[30;1m238 | [0m[35m        form.default_persistent = '0';[0m
[30;1m239 | [0m[35m        form.lgnrnd = utils.getFrom(html, "name=\"lgnrnd\" value=\"", "\"");[0m
[30;1m240 | [0m[35m        form.locale = 'en_US';[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m217 | [0m[35m    return [ctx, defaultFuncs, api];[0m
[30;1m218 | [0m[35m}[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35mfunction makeLogin(jar, email, password, loginOptions, callback, prCallback) {[0m
[30;1m221 | [0m[35m    return function(res) {[0m
[30;1m222 | [0m[35m        var html = res.body;[0m
[30;1m223 | [0m[35m        var $ = cheerio.load(html);[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/index.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        var form = utils.arrToForm(arr);[0m
[30;1m234 | [0m[35m        form.lsd = utils.getFrom(html, "[\"LSD\",[],{\"token\":\"", "\"}");[0m
[30;1m235 | [0m[35m        form.lgndim = Buffer.from("{\"w\":1440,\"h\":900,\"aw\":1440,\"ah\":834,\"c\":24}").toString[0m
[30;1m236 | [0m[35m        form.email = email;[0m
[30;1m237 | [0m[35m        form.pass = password;[0m
[30;1m238 | [0m[35m        form.default_persistent = '0';[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2 | [0m[35mvar fs = require('fs');[0m
[30;1m3 | [0m[35mvar assert = require('assert');[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mvar conf = JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2 | [0m[35mvar fs = require('fs');[0m
[30;1m3 | [0m[35mvar assert = require('assert');[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mvar conf = JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mvar conf = JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m
[30;1m9 | [0m[35m};[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mvar userIDs = conf.userIDs;[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mvar conf = JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m
[30;1m9 | [0m[35m};[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mvar userIDs = conf.userIDs;[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test-page.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2 | [0m[35mvar fs = require('fs');[0m
[30;1m3 | [0m[35mvar assert = require('assert');[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mvar conf =  JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test-page.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2 | [0m[35mvar fs = require('fs');[0m
[30;1m3 | [0m[35mvar assert = require('assert');[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mvar conf =  JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test-page.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mvar conf =  JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m
[30;1m9 | [0m[35m};[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mvar userIDs = conf.userIDs;[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/test/test-page.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mvar conf =  JSON.parse(process.env.testconfig || fs.readFileSync('test/test-config.json', 'utf8'));[0m
[30;1m6 | [0m[35mvar credentials = {[0m
[30;1m7 | [0m[35m  email: conf.user.email,[0m
[30;1m8 | [0m[35m  password: conf.user.password,[0m
[30;1m9 | [0m[35m};[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mvar userIDs = conf.userIDs;[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/src/getThreadList.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m113 | [0m[35mbled: t.customization_enabled, // false for ONE_TO_ONE with Page or ReducedMessagingActor[0m
[30;1m114 | [0m[35m      participantAddMode: t.participant_add_mode_as_string, // "ADD" if "GROUP" and null if "ONE_TO_[0m
[30;1m115 | [0m[35m      montageThread: t.montage_thread ? Buffer.from(t.montage_thread.id, "base64").toString() : null[0m
[30;1m116 | [0m[35m      // it is not userID nor any other ID known to me...[0m
[30;1m117 | [0m[35m      // can somebody inspect it? where is it used?[0m
[30;1m118 | [0m[35m      // probably Messenger Day uses it[0m
[30;1m119 | [0m[35m      reactionsMuteMode: t.reactions_mute_mode,[0m
[30;1m120 | [0m[35m      mentionsMuteMode: t.mentions_mute_mode,[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/src/getThreadList.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m112 | [0m[35m8-04-04)[0m
[30;1m113 | [0m[35m      customizationEnabled: t.customization_enabled, // false for ONE_TO_ONE with Page or ReducedMes[0m
[30;1m114 | [0m[35m      participantAddMode: t.participant_add_mode_as_string, // "ADD" if "GROUP" and null if "ONE_TO_[0m
[30;1m115 | [0m[35m      montageThread: t.montage_thread ? Buffer.from(t.montage_thread.id, "base64").toString() : null[0m
[30;1m116 | [0m[35m      // it is not userID nor any other ID known to me...[0m
[30;1m117 | [0m[35m      // can somebody inspect it? where is it used?[0m
[30;1m118 | [0m[35m      // probably Messenger Day uses it[0m
[30;1m119 | [0m[35m      reactionsMuteMode: t.reactions_mute_mode,[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35mconst fs = require("fs");[0m
[30;1m104 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mvar credentials = {email: "FB_EMAIL", password: "FB_PASSWORD"};[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mlogin(credentials, (err, api) => {[0m
[30;1m109 | [0m[35m    if(err) return console.error(err);[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35mconst fs = require("fs");[0m
[30;1m104 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mvar credentials = {email: "FB_EMAIL", password: "FB_PASSWORD"};[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mlogin(credentials, (err, api) => {[0m
[30;1m109 | [0m[35m    if(err) return console.error(err);[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m------------------------------------[0m
[30;1m96 | [0m[35m### Saving session.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35mTo avoid logging in every time you should save AppState (cookies etc.) to a file, then you can use i[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m__Example__[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35m```js[0m
[30;1m80 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m83 | [0m[35m    if(err) return console.error(err);[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    // Note this example uploads an image called image.jpg[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35m```js[0m
[30;1m80 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m83 | [0m[35m    if(err) return console.error(err);[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    // Note this example uploads an image called image.jpg[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m66 | [0m[35m```js[0m
[30;1m67 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m70 | [0m[35m    if(err) return console.error(err);[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    var yourID = "000000000000000";[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m66 | [0m[35m```js[0m
[30;1m67 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m70 | [0m[35m    if(err) return console.error(err);[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    var yourID = "000000000000000";[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m// Create simple echo bot[0m
[30;1m31 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m32 | [0m[35m    if(err) return console.error(err);[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    api.listen((err, message) => {[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35mconst login = require("fca-unofficial");[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m// Create simple echo bot[0m
[30;1m31 | [0m[35mlogin({email: "FB_EMAIL", password: "FB_PASSWORD"}, (err, api) => {[0m
[30;1m32 | [0m[35m    if(err) return console.error(err);[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    api.listen((err, message) => {[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m261 | [0m[35m    case "LightweightEventUpdateTitleExtensibleMessageAdminText":[0m
[30;1m262 | [0m[35m    case "LightweightEventUpdateTimeExtensibleMessageAdminText":[0m
[30;1m263 | [0m[35m    case "LightweightEventUpdateLocationExtensibleMessageAdminText":[0m
[30;1m264 | [0m[35m    case "LightweightEventDeleteExtensibleMessageAdminText":[0m
[30;1m265 | [0m[35m      return {};[0m
[30;1m266 | [0m[35m    default:[0m
[30;1m267 | [0m[35m      return { error: "Don't know what to with event data type " + event.__typename };[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m260 | [0m[35m    case "LightweightEventNotifyBeforeEventExtensibleMessageAdminText":[0m
[30;1m261 | [0m[35m    case "LightweightEventUpdateTitleExtensibleMessageAdminText":[0m
[30;1m262 | [0m[35m    case "LightweightEventUpdateTimeExtensibleMessageAdminText":[0m
[30;1m263 | [0m[35m    case "LightweightEventUpdateLocationExtensibleMessageAdminText":[0m
[30;1m264 | [0m[35m    case "LightweightEventDeleteExtensibleMessageAdminText":[0m
[30;1m265 | [0m[35m      return {};[0m
[30;1m266 | [0m[35m    default:[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m259 | [0m[35m    case "LightweightEventNotifyExtensibleMessageAdminText":[0m
[30;1m260 | [0m[35m    case "LightweightEventNotifyBeforeEventExtensibleMessageAdminText":[0m
[30;1m261 | [0m[35m    case "LightweightEventUpdateTitleExtensibleMessageAdminText":[0m
[30;1m262 | [0m[35m    case "LightweightEventUpdateTimeExtensibleMessageAdminText":[0m
[30;1m263 | [0m[35m    case "LightweightEventUpdateLocationExtensibleMessageAdminText":[0m
[30;1m264 | [0m[35m    case "LightweightEventDeleteExtensibleMessageAdminText":[0m
[30;1m265 | [0m[35m      return {};[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m258 | [0m[35m    case "LightweightEventCreateExtensibleMessageAdminText":[0m
[30;1m259 | [0m[35m    case "LightweightEventNotifyExtensibleMessageAdminText":[0m
[30;1m260 | [0m[35m    case "LightweightEventNotifyBeforeEventExtensibleMessageAdminText":[0m
[30;1m261 | [0m[35m    case "LightweightEventUpdateTitleExtensibleMessageAdminText":[0m
[30;1m262 | [0m[35m    case "LightweightEventUpdateTimeExtensibleMessageAdminText":[0m
[30;1m263 | [0m[35m    case "LightweightEventUpdateLocationExtensibleMessageAdminText":[0m
[30;1m264 | [0m[35m    case "LightweightEventDeleteExtensibleMessageAdminText":[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m257 | [0m[35m    case "StartedSharingVideoExtensibleMessageAdminText":[0m
[30;1m258 | [0m[35m    case "LightweightEventCreateExtensibleMessageAdminText":[0m
[30;1m259 | [0m[35m    case "LightweightEventNotifyExtensibleMessageAdminText":[0m
[30;1m260 | [0m[35m    case "LightweightEventNotifyBeforeEventExtensibleMessageAdminText":[0m
[30;1m261 | [0m[35m    case "LightweightEventUpdateTitleExtensibleMessageAdminText":[0m
[30;1m262 | [0m[35m    case "LightweightEventUpdateTimeExtensibleMessageAdminText":[0m
[30;1m263 | [0m[35m    case "LightweightEventUpdateLocationExtensibleMessageAdminText":[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m256 | [0m[35m    case "ThreadEphemeralTtlModeExtensibleMessageAdminText":[0m
[30;1m257 | [0m[35m    case "StartedSharingVideoExtensibleMessageAdminText":[0m
[30;1m258 | [0m[35m    case "LightweightEventCreateExtensibleMessageAdminText":[0m
[30;1m259 | [0m[35m    case "LightweightEventNotifyExtensibleMessageAdminText":[0m
[30;1m260 | [0m[35m    case "LightweightEventNotifyBeforeEventExtensibleMessageAdminText":[0m
[30;1m261 | [0m[35m    case "LightweightEventUpdateTitleExtensibleMessageAdminText":[0m
[30;1m262 | [0m[35m    case "LightweightEventUpdateTimeExtensibleMessageAdminText":[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m255 | [0m[35m    case "ParticipantJoinedGroupCallExtensibleMessageAdminText":[0m
[30;1m256 | [0m[35m    case "ThreadEphemeralTtlModeExtensibleMessageAdminText":[0m
[30;1m257 | [0m[35m    case "StartedSharingVideoExtensibleMessageAdminText":[0m
[30;1m258 | [0m[35m    case "LightweightEventCreateExtensibleMessageAdminText":[0m
[30;1m259 | [0m[35m    case "LightweightEventNotifyExtensibleMessageAdminText":[0m
[30;1m260 | [0m[35m    case "LightweightEventNotifyBeforeEventExtensibleMessageAdminText":[0m
[30;1m261 | [0m[35m    case "LightweightEventUpdateTitleExtensibleMessageAdminText":[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m254 | [0m[35m    // never data[0m
[30;1m255 | [0m[35m    case "ParticipantJoinedGroupCallExtensibleMessageAdminText":[0m
[30;1m256 | [0m[35m    case "ThreadEphemeralTtlModeExtensibleMessageAdminText":[0m
[30;1m257 | [0m[35m    case "StartedSharingVideoExtensibleMessageAdminText":[0m
[30;1m258 | [0m[35m    case "LightweightEventCreateExtensibleMessageAdminText":[0m
[30;1m259 | [0m[35m    case "LightweightEventNotifyExtensibleMessageAdminText":[0m
[30;1m260 | [0m[35m    case "LightweightEventNotifyBeforeEventExtensibleMessageAdminText":[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m253 | [0m[35m      };[0m
[30;1m254 | [0m[35m    // never data[0m
[30;1m255 | [0m[35m    case "ParticipantJoinedGroupCallExtensibleMessageAdminText":[0m
[30;1m256 | [0m[35m    case "ThreadEphemeralTtlModeExtensibleMessageAdminText":[0m
[30;1m257 | [0m[35m    case "StartedSharingVideoExtensibleMessageAdminText":[0m
[30;1m258 | [0m[35m    case "LightweightEventCreateExtensibleMessageAdminText":[0m
[30;1m259 | [0m[35m    case "LightweightEventNotifyExtensibleMessageAdminText":[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m252 | [0m[35m        ad_properties: event.ad_properties[0m
[30;1m253 | [0m[35m      };[0m
[30;1m254 | [0m[35m    // never data[0m
[30;1m255 | [0m[35m    case "ParticipantJoinedGroupCallExtensibleMessageAdminText":[0m
[30;1m256 | [0m[35m    case "ThreadEphemeralTtlModeExtensibleMessageAdminText":[0m
[30;1m257 | [0m[35m    case "StartedSharingVideoExtensibleMessageAdminText":[0m
[30;1m258 | [0m[35m    case "LightweightEventCreateExtensibleMessageAdminText":[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m234 | [0m[35m        accepter_id: event.accepter_id,[0m
[30;1m235 | [0m[35m        requester_id: event.requester_id[0m
[30;1m236 | [0m[35m      };[0m
[30;1m237 | [0m[35m    case "ConfirmFriendRequestExtensibleMessageAdminText":[0m
[30;1m238 | [0m[35m      return {[0m
[30;1m239 | [0m[35m        friend_request_recipient: event.friend_request_recipient,[0m
[30;1m240 | [0m[35m        friend_request_sender: event.friend_request_sender[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m229 | [0m[35m        total_count: event.total_count,[0m
[30;1m230 | [0m[35m        question: event.question[0m
[30;1m231 | [0m[35m      };[0m
[30;1m232 | [0m[35m    case "AcceptPendingThreadExtensibleMessageAdminText":[0m
[30;1m233 | [0m[35m      return {[0m
[30;1m234 | [0m[35m        accepter_id: event.accepter_id,[0m
[30;1m235 | [0m[35m        requester_id: event.requester_id[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m207 | [0m[35m      };[0m
[30;1m208 | [0m[35m    case "ThreadIconExtensibleMessageAdminText":[0m
[30;1m209 | [0m[35m      return { threadIcon: event.thread_icon };[0m
[30;1m210 | [0m[35m    case "InstantGameUpdateExtensibleMessageAdminText":[0m
[30;1m211 | [0m[35m      return {[0m
[30;1m212 | [0m[35m        gameID: (event.game == null ? null : event.game.id),[0m
[30;1m213 | [0m[35m        update_type: event.update_type,[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m200 | [0m[35m  switch (event.__typename) {[0m
[30;1m201 | [0m[35m    case "ThemeColorExtensibleMessageAdminText":[0m
[30;1m202 | [0m[35m      return { color: event.theme_color };[0m
[30;1m203 | [0m[35m    case "ThreadNicknameExtensibleMessageAdminText":[0m
[30;1m204 | [0m[35m      return {[0m
[30;1m205 | [0m[35m        nickname: event.nickname,[0m
[30;1m206 | [0m[35m        participantID: event.participant_id[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m970 | [0m[35m            }[0m
[30;1m971 | [0m[35m[0m
[30;1m972 | [0m[35m            // In some cases the response contains only a redirect URL which should be followed[0m
[30;1m973 | [0m[35m            if (res.redirect && data.request.method === "GET") return defaultFuncs.get(res.redirect,[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m            // TODO: handle multiple cookies?[0m
[30;1m976 | [0m[35m            if (res.jsmods && res.jsmods.require && Array.isArray(res.jsmods.require[0]) && res.jsmo[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m956 | [0m[35mntent-Type"].split(";")[0] === "multipart/form-data") return bluebird.delay(retryTime).then(() => de[0m
[30;1m957 | [0m[35m                else return bluebird.delay(retryTime).then(() => defaultFuncs.post(url, ctx.jar, dat[0m
[30;1m958 | [0m[35m            }[0m
[30;1m959 | [0m[35m            if (data.statusCode !== 200) throw new Error("parseAndCheckLogin got status code: " + da[0m
[30;1m960 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m.hostname[0m
[30;1m953 | [0m[35m     var retryTime = Math.floor(Math.random() * 5000);[0m
[30;1m954 | [0m[35m                log.warn("parseAndCheckLogin", "Got status code " + data.statusCode + " - " + retryC[0m
[30;1m955 | [0m[35m                var url = data.request.uri.protocol + "//" + data.request.uri.hostname + data.reques[0m
[30;1m956 | [0m[35m                if (data.request.headers["Content-Type"].split(";")[0] === "multipart/form-data") re[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m879 | [0m[35m[0m
[30;1m880 | [0m[35m    function mergeWithDefaults(obj) {[0m
[30;1m881 | [0m[35m        // @TODO This is missing a key called __dyn.[0m
[30;1m882 | [0m[35m        // After some investigation it seems like __dyn is some sort of set that FB[0m
[30;1m883 | [0m[35m        // calls BitMap. It seems like certain responses have a "define" key in the[0m
[30;1m884 | [0m[35m        // res.jsmods arrays. I think the code iterates over those and calls `set`[0m
[30;1m885 | [0m[35m        // on the bitmap for each of those keys. Then it calls[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m858 | [0m[35m    var reqCounter = 1;[0m
[30;1m859 | [0m[35m    var fb_dtsg = getFrom(html, 'name="fb_dtsg" value="', '"');[0m
[30;1m860 | [0m[35m[0m
[30;1m861 | [0m[35m    // @Hack Ok we've done hacky things, this is definitely on top 5.[0m
[30;1m862 | [0m[35m    // We totally assume the object is flat and try parsing until a }.[0m
[30;1m863 | [0m[35m    // If it works though it's cool because we get a bunch of extra data things.[0m
[30;1m864 | [0m[35m    //[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m814 | [0m[35m[0m
[30;1m815 | [0m[35m    // (What the fuck FB, why windows style newlines?)[0m
[30;1m816 | [0m[35m    // So sometimes FB will send us base multiple objects in the same response.[0m
[30;1m817 | [0m[35m    // They're all valid JSON, one after the other, at the top level. We detect[0m
[30;1m818 | [0m[35m    // that and make it parse-able by JSON.parse.[0m
[30;1m819 | [0m[35m    //       Ben - July 15th 2017[0m
[30;1m820 | [0m[35m    //[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m805 | [0m[35m[0m
[30;1m806 | [0m[35m    var lastHalf = str.substring(start);[0m
[30;1m807 | [0m[35m    var end = lastHalf.indexOf(endToken);[0m
[30;1m808 | [0m[35m    if (end === -1) throw Error("Could not find endTime `" + endToken + "` in the given string.");[0m
[30;1m809 | [0m[35m    return lastHalf.substring(0, end);[0m
[30;1m810 | [0m[35m}[0m
[30;1m811 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m            kb: 0,[0m
[30;1m232 | [0m[35m            "kb-ts": time,[0m
[30;1m233 | [0m[35m            hcm: 0,[0m
[30;1m234 | [0m[35m            "hcm-ts": time[0m
[30;1m235 | [0m[35m        })[0m
[30;1m236 | [0m[35m    );[0m
[30;1m237 | [0m[35m}[0m
[30;1m238 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m}[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35mfunction generateAccessiblityCookie() {[0m
[30;1m224 | [0m[35m    var time = Date.now();[0m
[30;1m225 | [0m[35m    return encodeURIComponent([0m
[30;1m226 | [0m[35m        JSON.stringify({[0m
[30;1m227 | [0m[35m            sr: 0,[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m                    uct2: time,[0m
[30;1m212 | [0m[35m                    tr: null,[0m
[30;1m213 | [0m[35m                    tw: Math.floor(Math.random() * 4294967295) + 1,[0m
[30;1m214 | [0m[35m                    at: time[0m
[30;1m215 | [0m[35m                },[0m
[30;1m216 | [0m[35m                ch: {[0m
[30;1m217 | [0m[35m                    ["p_" + userID]: 0 }[0m
[30;1m218 | [0m[35m            })[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m196 | [0m[35m}[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35mfunction generatePresence(userID) {[0m
[30;1m199 | [0m[35m    var time = Date.now();[0m
[30;1m200 | [0m[35m    return ([0m
[30;1m201 | [0m[35m        "E" +[0m
[30;1m202 | [0m[35m        presenceEncode([0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/utils.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m814 | [0m[35m[0m
[30;1m815 | [0m[35m    // (What the fuck FB, why windows style newlines?)[0m
[30;1m816 | [0m[35m    // So sometimes FB will send us base multiple objects in the same response.[0m
[30;1m817 | [0m[35m    // They're all valid JSON, one after the other, at the top level. We detect[0m
[30;1m818 | [0m[35m    // that and make it parse-able by JSON.parse.[0m
[30;1m819 | [0m[35m    //       Ben - July 15th 2017[0m
[30;1m820 | [0m[35m    //[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/createNewGroup.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    };[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    defaultFuncs[0m
[30;1m57 | [0m[35m      .post("https://www.facebook.com/api/graphql/", ctx.jar, form)[0m
[30;1m58 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m59 | [0m[35m      .then(function (resData) {[0m
[30;1m60 | [0m[35m        if (resData.errors) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/createNewGroup.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    if (utils.getType(participantIDs) !== "Array") throw { error: "createNewGroup: participantIDs sh[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    if (participantIDs.length < 2) throw { error: "createNewGroup: participantIDs should have at lea[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    var resolveFunc = function () { };[0m
[30;1m18 | [0m[35m    var rejectFunc = function () { };[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1668 | [0m[35mthis to `true` if you want your api[0m
[30;1m1669 | [0m[35m      to receive messages from its own account.  This is to be used with[0m
[30;1m1670 | [0m[35m      caution, as it can result in loops (a simple echo bot will send messages[0m
[30;1m1671 | [0m[35m      forever).[0m
[30;1m1672 | [0m[35m    - `listenEvents`: (Default `false`) Will make [api.listen](#listen) also handle events (look at [0m
[30;1m1673 | [0m[35m    - `pageID`: (Default empty) Makes [api.listen](#listen) only receive messages through the page s[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1635 | [0m[35m* `reaction`: A string containing either an emoji, an emoji in unicode, or an emoji shortcut (see li[0m
[30;1m1636 | [0m[35m* `messageID`: A string representing the message ID.[0m
[30;1m1637 | [0m[35m* `callback(err)`: A callback called when sending the reaction is done.[0m
[30;1m1638 | [0m[35m* `forceCustomReaction`: Forcing the use of an emoji for setting reaction **(WARNING: NOT TESTED, YO[0m
[30;1m1639 | [0m[35m[0m
[30;1m1640 | [0m[35m__Supported Emojis__[0m
[30;1m1641 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1162 | [0m[35m	</tr>[0m
[30;1m1163 | [0m[35m	<tr>[0m
[30;1m1164 | [0m[35m		<td><code>time</code></td>[0m
[30;1m1165 | [0m[35m		<td>The time at which the reader read the message.</td>[0m
[30;1m1166 | [0m[35m	</tr>[0m
[30;1m1167 | [0m[35m	<tr>[0m
[30;1m1168 | [0m[35m		<td><code>type</code></td>[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1142 | [0m[35m	</tr>[0m
[30;1m1143 | [0m[35m	<tr>[0m
[30;1m1144 | [0m[35m		<td><code>time</code></td>[0m
[30;1m1145 | [0m[35m		<td>The time at which the user read the message.</td>[0m
[30;1m1146 | [0m[35m	</tr>[0m
[30;1m1147 | [0m[35m	<tr>[0m
[30;1m1148 | [0m[35m		<td><code>type</code></td>[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m627 | [0m[35m| messageCount | Number of messages |[0m
[30;1m628 | [0m[35m| imageSrc | URL to the group chat photo. Null if unset or a 1-1 thread. |[0m
[30;1m629 | [0m[35m| timestamp | Timestamp of last activity |[0m
[30;1m630 | [0m[35m| muteUntil | Timestamp at which the thread will no longer be muted. The timestamp will be -1 if the[0m
[30;1m631 | [0m[35m| isGroup | boolean, true if this thread is a group thread (more than 2 participants). |[0m
[30;1m632 | [0m[35m| isSubscribed |  |[0m
[30;1m633 | [0m[35m| folder | The folder that the thread is in. Can be one of: <ul><li>'inbox'</li><li>'archive'</li></[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m__Example__[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35mTo load 50 messages at a time, we can use `undefined` as the timestamp to retrieve the most recent m[0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m```js[0m
[30;1m587 | [0m[35mvar timestamp = undefined;[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35mReturns the URL to a Facebook Messenger-style emoji image asset.[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m__note__: This function will return a URL regardless of whether the image at the URL actually exists[0m
[30;1m512 | [0m[35mThis can happen if, for example, Messenger does not have an image asset for the requested emoji.[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m__Arguments__[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m326 | [0m[35mNote: the color needs to start with a "#".[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m__Arguments__[0m
[30;1m329 | [0m[35m* `color`: String representing a theme ID (a list of theme ID can be found at `api.threadColors`).[0m
[30;1m330 | [0m[35m* `threadID`: String representing the ID of the thread.[0m
[30;1m331 | [0m[35m* `callback(err)`: A callback called when the change is done (either with an error or null).[0m
[30;1m332 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m43 | [0m[35mColors)[0m
[30;1m44 | [0m[35m* [`api.unsendMessage`](#unsendMessage)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m---------------------------------------[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m### Password safety[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m**Read this** before you _copy+paste_ examples from below.[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mYou should not store Facebook password in your scripts.[0m
[30;1m53 | [0m[35mThere are few good reasons:[0m
[30;1m54 | [0m[35m* People who are standing behind you may look at your "code" and get your password if it is on the s[0m
[30;1m55 | [0m[35m* Backups of source files may be readable by someone else. "_There is nothing secret in my code, why[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1540 | [0m[35m[0m
[30;1m1541 | [0m[35mNote that a message can only be a regular message (which can be empty) and optionally one of the fol[0m
[30;1m1542 | [0m[35m[0m
[30;1m1543 | [0m[35m__Tip__: to find your own ID, you can look inside the cookies. The `userID` is under the name `c_use[0m
[30;1m1544 | [0m[35m[0m
[30;1m1545 | [0m[35m__Example (Basic Message)__[0m
[30;1m1546 | [0m[35m```js[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1242 | [0m[35m	</tr>[0m
[30;1m1243 | [0m[35m	<tr>[0m
[30;1m1244 | [0m[35m		<td><code>deletionTimestamp</code></td>[0m
[30;1m1245 | [0m[35m		<td>The time when the request was sent.</td>[0m
[30;1m1246 | [0m[35m    </tr>[0m
[30;1m1247 | [0m[35m    <tr>[0m
[30;1m1248 | [0m[35m		<td><code>type</code></td>[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1214 | [0m[35m	</tr>[0m
[30;1m1215 | [0m[35m	<tr>[0m
[30;1m1216 | [0m[35m		<td><code>timestamp</code></td>[0m
[30;1m1217 | [0m[35m		<td>The time when the user was last online.</td>[0m
[30;1m1218 | [0m[35m	</tr>[0m
[30;1m1219 | [0m[35m	<tr>[0m
[30;1m1220 | [0m[35m		<td><code>type</code></td>[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1162 | [0m[35m	</tr>[0m
[30;1m1163 | [0m[35m	<tr>[0m
[30;1m1164 | [0m[35m		<td><code>time</code></td>[0m
[30;1m1165 | [0m[35m		<td>The time at which the reader read the message.</td>[0m
[30;1m1166 | [0m[35m	</tr>[0m
[30;1m1167 | [0m[35m	<tr>[0m
[30;1m1168 | [0m[35m		<td><code>type</code></td>[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1142 | [0m[35m	</tr>[0m
[30;1m1143 | [0m[35m	<tr>[0m
[30;1m1144 | [0m[35m		<td><code>time</code></td>[0m
[30;1m1145 | [0m[35m		<td>The time at which the user read the message.</td>[0m
[30;1m1146 | [0m[35m	</tr>[0m
[30;1m1147 | [0m[35m	<tr>[0m
[30;1m1148 | [0m[35m		<td><code>type</code></td>[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1019 | [0m[35m[0m
[30;1m1020 | [0m[35m__Arguments__[0m
[30;1m1021 | [0m[35m[0m
[30;1m1022 | [0m[35m- `callback(error, message)`: A callback called every time the logged-in account receives a new mess[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m<a name="message"></a>[0m
[30;1m1025 | [0m[35m__Message__[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m661 | [0m[35m  - `["PENDING", "unread"]`[0m
[30;1m662 | [0m[35m  - `["OTHER", "unread"]`[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m*if you find something new, let us know*[0m
[30;1m665 | [0m[35m[0m
[30;1m666 | [0m[35m* `callback(err, list)`: Callback called when the query is done (either with an error or with a prop[0m
[30;1m667 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m576 | [0m[35m__Arguments__[0m
[30;1m577 | [0m[35m* `threadID`: A threadID corresponding to the target chat[0m
[30;1m578 | [0m[35m* `amount`: The amount of messages to *request*[0m
[30;1m579 | [0m[35m* `timestamp`: Used to described the time of the most recent message to load. If timestamp is `undef[0m
[30;1m580 | [0m[35m* `callback(error, history)`: If error is null, history will contain an array of message objects.[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m__Example__[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m__Arguments__[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m* `threadOrThreads` - The id(s) of the threads you wish to remove from your account.[0m
[30;1m461 | [0m[35m* `callback(err)` - A callback called when the operation is done, maybe with an object representing [0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m__Example__[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35mWill change the thread emoji to the one provided.[0m
[30;1m354 | [0m[35m[0m
[30;1m355 | [0m[35mNote: The UI doesn't play nice with all emoji.[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m__Arguments__[0m
[30;1m358 | [0m[35m* `emoji`: String containing a single emoji character.[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35mGiven a threadID, or an array of threadIDs, will set the archive status of the threads to `archive`.[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m__Arguments__[0m
[30;1m231 | [0m[35m* `threadOrThreads`: The id(s) of the threads you wish to archive/unarchive.[0m
[30;1m232 | [0m[35m* `archive`: Boolean indicating the new archive status to assign to the thread(s).[0m
[30;1m233 | [0m[35m* `callback(err)`: A callback called when the query is done (either with an error or null).[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m<a name="changeArchivedStatus"></a>[0m
[30;1m226 | [0m[35m### api.changeArchivedStatus(threadOrThreads, archive[, callback])[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35mGiven a threadID, or an array of threadIDs, will set the archive status of the threads to `archive`.[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m__Arguments__[0m
[30;1m231 | [0m[35m* `threadOrThreads`: The id(s) of the threads you wish to archive/unarchive.[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m__Arguments__[0m
[30;1m199 | [0m[35m* `threadID`: ID of a group chat (can't use in one-to-one conversations)[0m
[30;1m200 | [0m[35m* `adminIDs`: The id(s) of users you wish to admin/unadmin (string or an array).[0m
[30;1m201 | [0m[35m* `adminStatus`: Boolean indicating whether the user(s) should be promoted to admin (`true`) or demo[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m__Example__[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m});[0m
[30;1m173 | [0m[35m```[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m__Review Recent Login__: Sometimes Facebook will ask you to review your recent logins. This means yo[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m---------------------------------------[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35me files may be readable by someone else. "_There is nothing secret in my code, why should I ever pas[0m
[30;1m56 | [0m[35m* You can't push your code to Github (or any onther service) without removing your password from the[0m
[30;1m57 | [0m[35m* If you change your password in the future (maybe it leaked because _someone_ stored password in so[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/DOCS.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m-----------------------------------[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m### Password safety[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m**Read this** before you _copy+paste_ examples from below.[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mYou should not store Facebook password in your scripts.[0m
[30;1m53 | [0m[35mThere are few good reasons:[0m
[30;1m54 | [0m[35m* People who are standing behind you may look at your "code" and get your password if it is on the s[0m
[30;1m55 | [0m[35m* Backups of source files may be readable by someone else. "_There is nothing secret in my code, why[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeGroupImage.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m      form["thread_id"] = threadID;[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m      defaultFuncs[0m
[30;1m90 | [0m[35m        .post("https://www.facebook.com/messaging/set_thread_image/", ctx.jar, form)[0m
[30;1m91 | [0m[35m        .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m92 | [0m[35m        .then(function (resData) {[0m
[30;1m93 | [0m[35m          // check for errors here[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeThreadColor.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    };[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    defaultFuncs[0m
[30;1m48 | [0m[35m      .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m49 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m50 | [0m[35m      .then(function (resData) {[0m
[30;1m51 | [0m[35m        if (resData[resData.length - 1].error_results > 0) throw resData[0].o0.errors;[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeThreadColor.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    var colorList = Object.keys(api.threadColors).map(function (name) {[0m
[30;1m24 | [0m[35m      return api.threadColors[name];[0m
[30;1m25 | [0m[35m    });[0m
[30;1m26 | [0m[35m    if (!colorList.includes(validatedColor)) throw { error: "The color you are trying to use is not [0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    var form = {[0m
[30;1m29 | [0m[35m      dpr: 1,[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m615 | [0m[35m    getSeqID = function getSeqID() {[0m
[30;1m616 | [0m[35m        ctx.t_mqttCalled = false;[0m
[30;1m617 | [0m[35m        defaultFuncs[0m
[30;1m618 | [0m[35m            .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m619 | [0m[35m            .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m620 | [0m[35m            .then((resData) => {[0m
[30;1m621 | [0m[35m                if (utils.getType(resData) != "Array") throw { error: "Not logged in", res: resData [0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m481 | [0m[35m                };[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m                defaultFuncs[0m
[30;1m484 | [0m[35m                    .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m485 | [0m[35m                    .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m486 | [0m[35m                    .then((resData) => {[0m
[30;1m487 | [0m[35m                        if (resData[resData.length - 1].error_results > 0) throw resData[0].o0.error[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m                        };[0m
[30;1m357 | [0m[35m                    } else if (delta.deltaMessageReply.replyToMessageId) {[0m
[30;1m358 | [0m[35m                        return defaultFuncs[0m
[30;1m359 | [0m[35m                            .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, {[0m
[30;1m360 | [0m[35m                                "av": ctx.globalOptions.pageID,[0m
[30;1m361 | [0m[35m                                "queries": JSON.stringify({[0m
[30;1m362 | [0m[35m                                    "o0": {[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m585 | [0m[35m                formattedEvent = utils.formatDeltaEvent(v.delta);[0m
[30;1m586 | [0m[35m            } catch (err) {[0m
[30;1m587 | [0m[35m                return globalCallback({[0m
[30;1m588 | [0m[35m                    error: "Problem parsing message object. Please open an issue at https://github.c[0m
[30;1m589 | [0m[35m                    detail: err,[0m
[30;1m590 | [0m[35m                    res: v.delta,[0m
[30;1m591 | [0m[35m                    type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m447 | [0m[35m                        fmtMsg = utils.formatDeltaEvent(v.delta);[0m
[30;1m448 | [0m[35m                    } catch (err) {[0m
[30;1m449 | [0m[35m                        return globalCallback({[0m
[30;1m450 | [0m[35m                            error: "Problem parsing message object. Please open an issue at https://[0m
[30;1m451 | [0m[35m                            detail: err,[0m
[30;1m452 | [0m[35m                            res: v.delta,[0m
[30;1m453 | [0m[35m                            type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m425 | [0m[35m                fmtMsg = utils.formatDeltaReadReceipt(v.delta);[0m
[30;1m426 | [0m[35m            } catch (err) {[0m
[30;1m427 | [0m[35m                return globalCallback({[0m
[30;1m428 | [0m[35m                    error: "Problem parsing message object. Please open an issue at https://github.c[0m
[30;1m429 | [0m[35m                    detail: err,[0m
[30;1m430 | [0m[35m                    res: v.delta,[0m
[30;1m431 | [0m[35m                    type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m222 | [0m[35m                    fmtMsg = utils.formatDeltaMessage(v);[0m
[30;1m223 | [0m[35m                } catch (err) {[0m
[30;1m224 | [0m[35m                    return globalCallback({[0m
[30;1m225 | [0m[35m                        error: "Problem parsing message object. Please open an issue at https://gith[0m
[30;1m226 | [0m[35m                        detail: err,[0m
[30;1m227 | [0m[35m                        res: v,[0m
[30;1m228 | [0m[35m                        type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m.hostname[0m
[30;1m81 | [0m[35m                'Origin': 'https://www.facebook.com',[0m
[30;1m82 | [0m[35m                'User-Agent': ctx.globalOptions.userAgent,[0m
[30;1m83 | [0m[35m                'Referer': 'https://www.facebook.com/',[0m
[30;1m84 | [0m[35m                'Host': new URL(host).hostname //'edge-chat.facebook.com'[0m
[30;1m85 | [0m[35m            },[0m
[30;1m86 | [0m[35m            origin: 'https://www.facebook.com',[0m
[30;1m87 | [0m[35m            protocolVersion: 13[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt-Test.js[0m
   Pattern: [32m.hostname[0m
[30;1m81 | [0m[35m                'Origin': 'https://www.facebook.com',[0m
[30;1m82 | [0m[35m                'User-Agent': ctx.globalOptions.userAgent,[0m
[30;1m83 | [0m[35m                'Referer': 'https://www.facebook.com/',[0m
[30;1m84 | [0m[35m                'Host': new URL(host).hostname //'edge-chat.facebook.com'[0m
[30;1m85 | [0m[35m            },[0m
[30;1m86 | [0m[35m            origin: 'https://www.facebook.com',[0m
[30;1m87 | [0m[35m            protocolVersion: 13[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/handleFriendRequest.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        };[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        defaultFuncs[0m
[30;1m33 | [0m[35m            .post("https://www.facebook.com/requests/friends/ajax/", ctx.jar, form)[0m
[30;1m34 | [0m[35m            .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m35 | [0m[35m            .then(function(resData) {[0m
[30;1m36 | [0m[35m                if (resData.payload.err) throw { err: resData.payload.err };[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getUserID.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    };[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    defaultFuncs[0m
[30;1m46 | [0m[35m      .get("https://www.facebook.com/ajax/typeahead/search.php", ctx.jar, form)[0m
[30;1m47 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m48 | [0m[35m      .then(function (resData) {[0m
[30;1m49 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/test/example-config.json[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m      "email" : "example@test.com",[0m
[30;1m9 | [0m[35m      "password" : "qwerty"[0m
[30;1m10 | [0m[35m  },[0m
[30;1m11 | [0m[35m  // Array of at least 2 other user IDs (not the same as the test user)[0m
[30;1m12 | [0m[35m  "userIDs" : [[0m
[30;1m13 | [0m[35m    "11111111111111",[0m
[30;1m14 | [0m[35m    "22222222222222"[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/httpGet.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    }[0m
[30;1m36 | [0m[35m    else {[0m
[30;1m37 | [0m[35m      defaultFuncs[0m
[30;1m38 | [0m[35m        .get(url, ctx.jar, form)[0m
[30;1m39 | [0m[35m        .then(resData => callback(null, resData.body.toString()))[0m
[30;1m40 | [0m[35m        .catch(function (err) {[0m
[30;1m41 | [0m[35m          log.error("httpGet", err);[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/httpGet.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    if (notAPI) {[0m
[30;1m28 | [0m[35m      utils[0m
[30;1m29 | [0m[35m        .get(url, ctx.jar, form, ctx.globalOptions)[0m
[30;1m30 | [0m[35m        .then(resData => callback(null, resData.body.toString()))[0m
[30;1m31 | [0m[35m        .catch(function (err) {[0m
[30;1m32 | [0m[35m          log.error("httpGet", err);[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeThreadEmoji.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    };[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    defaultFuncs[0m
[30;1m27 | [0m[35m      .post("https://www.facebook.com/messaging/save_thread_emoji/?source=thread_settings&__pc=EXP1%[0m
[30;1m28 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m29 | [0m[35m      .then(function (resData) {[0m
[30;1m30 | [0m[35m        if (resData.error === 1357031) throw { error: "Trying to change emoji of a chat that doesn't[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeThreadEmoji.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m      .post("https://www.facebook.com/messaging/save_thread_emoji/?source=thread_settings&__pc=EXP1%[0m
[30;1m28 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m29 | [0m[35m      .then(function (resData) {[0m
[30;1m30 | [0m[35m        if (resData.error === 1357031) throw { error: "Trying to change emoji of a chat that doesn't[0m
[30;1m31 | [0m[35m        if (resData.error) throw resData;[0m
[30;1m32 | [0m[35m        return callback();[0m
[30;1m33 | [0m[35m      })[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m.hostname[0m
[30;1m80 | [0m[35m                'Origin': 'https://www.facebook.com',[0m
[30;1m81 | [0m[35m                'User-Agent': ctx.globalOptions.userAgent,[0m
[30;1m82 | [0m[35m                'Referer': 'https://www.facebook.com/',[0m
[30;1m83 | [0m[35m                'Host': new URL(host).hostname //'edge-chat.facebook.com'[0m
[30;1m84 | [0m[35m            },[0m
[30;1m85 | [0m[35m            origin: 'https://www.facebook.com',[0m
[30;1m86 | [0m[35m            protocolVersion: 13[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m.hostname[0m
[30;1m80 | [0m[35m                'Origin': 'https://www.facebook.com',[0m
[30;1m81 | [0m[35m                'User-Agent': ctx.globalOptions.userAgent,[0m
[30;1m82 | [0m[35m                'Referer': 'https://www.facebook.com/',[0m
[30;1m83 | [0m[35m                'Host': new URL(host).hostname //'edge-chat.facebook.com'[0m
[30;1m84 | [0m[35m            },[0m
[30;1m85 | [0m[35m            origin: 'https://www.facebook.com',[0m
[30;1m86 | [0m[35m            protocolVersion: 13[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m605 | [0m[35m    getSeqID = function getSeqID() {[0m
[30;1m606 | [0m[35m        ctx.t_mqttCalled = false;[0m
[30;1m607 | [0m[35m        defaultFuncs[0m
[30;1m608 | [0m[35m            .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m609 | [0m[35m            .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m610 | [0m[35m            .then((resData) => {[0m
[30;1m611 | [0m[35m                if (utils.getType(resData) != "Array") throw { error: "Not logged in", res: resData [0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m                };[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m                defaultFuncs[0m
[30;1m476 | [0m[35m                    .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m477 | [0m[35m                    .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m478 | [0m[35m                    .then((resData) => {[0m
[30;1m479 | [0m[35m                        if (resData[resData.length - 1].error_results > 0) throw resData[0].o0.error[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m                        };[0m
[30;1m349 | [0m[35m                    } else if (delta.deltaMessageReply.replyToMessageId) {[0m
[30;1m350 | [0m[35m                        return defaultFuncs[0m
[30;1m351 | [0m[35m                            .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, {[0m
[30;1m352 | [0m[35m                                "av": ctx.globalOptions.pageID,[0m
[30;1m353 | [0m[35m                                "queries": JSON.stringify({[0m
[30;1m354 | [0m[35m                                    "o0": {[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m574 | [0m[35m                formattedEvent = utils.formatDeltaEvent(v.delta);[0m
[30;1m575 | [0m[35m            } catch (err) {[0m
[30;1m576 | [0m[35m                return globalCallback({[0m
[30;1m577 | [0m[35m                    error: "Problem parsing message object. Please open an issue at https://github.c[0m
[30;1m578 | [0m[35m                    detail: err,[0m
[30;1m579 | [0m[35m                    res: v.delta,[0m
[30;1m580 | [0m[35m                    type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m439 | [0m[35m                        fmtMsg = utils.formatDeltaEvent(v.delta);[0m
[30;1m440 | [0m[35m                    } catch (err) {[0m
[30;1m441 | [0m[35m                        return globalCallback({[0m
[30;1m442 | [0m[35m                            error: "Problem parsing message object. Please open an issue at https://[0m
[30;1m443 | [0m[35m                            detail: err,[0m
[30;1m444 | [0m[35m                            res: v.delta,[0m
[30;1m445 | [0m[35m                            type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m417 | [0m[35m                fmtMsg = utils.formatDeltaReadReceipt(v.delta);[0m
[30;1m418 | [0m[35m            } catch (err) {[0m
[30;1m419 | [0m[35m                return globalCallback({[0m
[30;1m420 | [0m[35m                    error: "Problem parsing message object. Please open an issue at https://github.c[0m
[30;1m421 | [0m[35m                    detail: err,[0m
[30;1m422 | [0m[35m                    res: v.delta,[0m
[30;1m423 | [0m[35m                    type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m216 | [0m[35m                    fmtMsg = utils.formatDeltaMessage(v);[0m
[30;1m217 | [0m[35m                } catch (err) {[0m
[30;1m218 | [0m[35m                    return globalCallback({[0m
[30;1m219 | [0m[35m                        error: "Problem parsing message object. Please open an issue at https://gith[0m
[30;1m220 | [0m[35m                        detail: err,[0m
[30;1m221 | [0m[35m                        res: v,[0m
[30;1m222 | [0m[35m                        type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listenMqtt.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m153 | [0m[35m        try {[0m
[30;1m154 | [0m[35m            var jsonMessage = JSON.parse(message);[0m
[30;1m155 | [0m[35m        } catch (ex) {[0m
[30;1m156 | [0m[35m            return log.error("listenMqtt", "SyntaxError: Unexpected token  in JSON at position 0");[0m
[30;1m157 | [0m[35m        }[0m
[30;1m158 | [0m[35m        if (topic === "/t_ms") {[0m
[30;1m159 | [0m[35m            if (ctx.tmsWait && typeof ctx.tmsWait == "function") ctx.tmsWait();[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/deleteThread.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    for (var i = 0; i < threadOrThreads.length; i++) form["ids[" + i + "]"] = threadOrThreads[i];[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    defaultFuncs[0m
[30;1m29 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/delete_thread.php", ctx.jar, form)[0m
[30;1m30 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m31 | [0m[35m      .then(function (resData) {[0m
[30;1m32 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/deleteMessage.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    for (var i = 0; i < messageOrMessages.length; i++) form["message_ids[" + i + "]"] = messageOrMes[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    defaultFuncs[0m
[30;1m31 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/delete_messages.php", ctx.jar, form)[0m
[30;1m32 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m33 | [0m[35m      .then(function (resData) {[0m
[30;1m34 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/setPostReaction.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    };[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    defaultFuncs[0m
[30;1m51 | [0m[35m      .post("https://www.facebook.com/api/graphql/", ctx.jar, form)[0m
[30;1m52 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m53 | [0m[35m      .then(function (resData) {[0m
[30;1m54 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m472 | [0m[35m            .then(function(resData) {[0m
[30;1m473 | [0m[35m                var url = utils.getFrom(resData.body, 'window.location.replace("https:\\/\\/www.face[0m
[30;1m474 | [0m[35m                url = url.substring(0, url.length - 1);[0m
[30;1m475 | [0m[35m                return utils.get('https://www.facebook.com' + url, ctx.jar, null, globalOptions);[0m
[30;1m476 | [0m[35m            });[0m
[30;1m477 | [0m[35m    }[0m
[30;1m478 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m    if (globalOptions.pageID) {[0m
[30;1m468 | [0m[35m        mainPromise = mainPromise[0m
[30;1m469 | [0m[35m            .then(function() {[0m
[30;1m470 | [0m[35m                return utils.get('https://www.facebook.com/' + ctx.globalOptions.pageID + '/messages[0m
[30;1m471 | [0m[35m            })[0m
[30;1m472 | [0m[35m            .then(function(resData) {[0m
[30;1m473 | [0m[35m                var url = utils.getFrom(resData.body, 'window.location.replace("https:\\/\\/www.face[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m            // Hacky check for the redirection that happens on some ISPs, which doesn't return statu[0m
[30;1m452 | [0m[35m            var reg = /<meta http-equiv="refresh" content="0;url=([^"]+)[^>]+>/;[0m
[30;1m453 | [0m[35m            var redirect = reg.exec(res.body);[0m
[30;1m454 | [0m[35m            if (redirect && redirect[1]) return utils.get(redirect[1], jar, null, globalOptions).the[0m
[30;1m455 | [0m[35m            return res;[0m
[30;1m456 | [0m[35m        })[0m
[30;1m457 | [0m[35m        .then(function(res) {[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m438 | [0m[35m            .then(utils.saveCookies(jar))[0m
[30;1m439 | [0m[35m            .then(makeLogin(jar, email, password, globalOptions, callback, prCallback))[0m
[30;1m440 | [0m[35m            .then(function() {[0m
[30;1m441 | [0m[35m                return utils.get('https://www.facebook.com/', jar, null, globalOptions).then(utils.s[0m
[30;1m442 | [0m[35m            });[0m
[30;1m443 | [0m[35m    }[0m
[30;1m444 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m        // Open the main page, then we login with the given credentials and finally[0m
[30;1m435 | [0m[35m        // load the main page again (it'll give us some IDs that we need)[0m
[30;1m436 | [0m[35m        mainPromise = utils[0m
[30;1m437 | [0m[35m            .get("https://www.facebook.com/", null, null, globalOptions, { noRef: true })[0m
[30;1m438 | [0m[35m            .then(utils.saveCookies(jar))[0m
[30;1m439 | [0m[35m            .then(makeLogin(jar, email, password, globalOptions, callback, prCallback))[0m
[30;1m440 | [0m[35m            .then(function() {[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m429 | [0m[35m        });[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m        // Load the main page.[0m
[30;1m432 | [0m[35m        mainPromise = utils.get('https://www.facebook.com/', jar, null, globalOptions, { noRef: true[0m
[30;1m433 | [0m[35m    } else {[0m
[30;1m434 | [0m[35m        // Open the main page, then we login with the given credentials and finally[0m
[30;1m435 | [0m[35m        // load the main page again (it'll give us some IDs that we need)[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m                        });[0m
[30;1m411 | [0m[35m                }[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35m                return utils.get('https://www.facebook.com/', jar, null, loginOptions).then(utils.sa[0m
[30;1m414 | [0m[35m            });[0m
[30;1m415 | [0m[35m    };[0m
[30;1m416 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m                                        // Use the same form (safe I hope)[0m
[30;1m393 | [0m[35m                                        form.name_action_selected = 'save_device';[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m                                        return utils.post(nextURL, jar, form, loginOptions).then(uti[0m
[30;1m396 | [0m[35m                                    })[0m
[30;1m397 | [0m[35m                                    .then(function(res) {[0m
[30;1m398 | [0m[35m                                        var headers = res.headers;[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m                                else form['submit[This Is Okay]'] = "This Is Okay";[0m
[30;1m387 | [0m[35m[0m
[30;1m388 | [0m[35m                                return utils[0m
[30;1m389 | [0m[35m                                    .post(nextURL, jar, form, loginOptions)[0m
[30;1m390 | [0m[35m                                    .then(utils.saveCookies(jar))[0m
[30;1m391 | [0m[35m                                    .then(function() {[0m
[30;1m392 | [0m[35m                                        // Use the same form (safe I hope)[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m                                                });[0m
[30;1m354 | [0m[35m                                        } else {[0m
[30;1m355 | [0m[35m                                            utils[0m
[30;1m356 | [0m[35m                                                .post("https://www.facebook.com/checkpoint/?next=htt[0m
[30;1m357 | [0m[35m                                                .then(utils.saveCookies(jar))[0m
[30;1m358 | [0m[35m                                                .then(res => {[0m
[30;1m359 | [0m[35m                                                    try {[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m                                                    delete form.approvals_code;[0m
[30;1m328 | [0m[35m                                                    form.name_action_selected = 'dont_save'; //'save[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m                                                    return utils.post(nextURL, jar, form, loginOptio[0m
[30;1m331 | [0m[35m                                                })[0m
[30;1m332 | [0m[35m                                                .then(function(res) {[0m
[30;1m333 | [0m[35m                                                    var headers = res.headers;[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m                                        });[0m
[30;1m308 | [0m[35m                                        if (typeof code == "string") {[0m
[30;1m309 | [0m[35m                                            utils[0m
[30;1m310 | [0m[35m                                                .post(nextURL, jar, form, loginOptions)[0m
[30;1m311 | [0m[35m                                                .then(utils.saveCookies(jar))[0m
[30;1m312 | [0m[35m                                                .then(function(res) {[0m
[30;1m313 | [0m[35m                                                    var $ = cheerio.load(res.body);[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m                    var nextURL = 'https://www.facebook.com/checkpoint/?next=https%3A%2F%2Fwww.faceb[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m                    return utils[0m
[30;1m275 | [0m[35m                        .get(headers.location, jar, null, loginOptions)[0m
[30;1m276 | [0m[35m                        .then(utils.saveCookies(jar))[0m
[30;1m277 | [0m[35m                        .then(function(res) {[0m
[30;1m278 | [0m[35m                            var html = res.body;[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        log.info("login", "Logging in...");[0m
[30;1m262 | [0m[35m        return utils[0m
[30;1m263 | [0m[35m            .post("https://www.facebook.com/login/device-based/regular/login/?login_attempt=1&lwv=11[0m
[30;1m264 | [0m[35m            .then(utils.saveCookies(jar))[0m
[30;1m265 | [0m[35m            .then(function(res) {[0m
[30;1m266 | [0m[35m                var headers = res.headers;[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35mlet legacyFBMQTTMatch = html.match(/(\["MqttWebConfig",\[\],{fbid:")(.+?)(",appID:219994525426954,en[0m
[30;1m116 | [0m[35m            if (legacyFBMQTTMatch) {[0m
[30;1m117 | [0m[35m                mqttEndpoint = legacyFBMQTTMatch[4];[0m
[30;1m118 | [0m[35m                region = new URL(mqttEndpoint).searchParams.get("region").toUpperCase();[0m
[30;1m119 | [0m[35m                log.warn("login", `Cannot get sequence ID with new RegExp. Fallback to old RegExp (w[0m
[30;1m120 | [0m[35m                log.info("login", `Got this account's message region: ${region}`);[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        if (newFBMQTTMatch) {[0m
[30;1m110 | [0m[35m            irisSeqID = newFBMQTTMatch[2];[0m
[30;1m111 | [0m[35m            mqttEndpoint = newFBMQTTMatch[1].replace(/\\\//g, "/");[0m
[30;1m112 | [0m[35m            region = new URL(mqttEndpoint).searchParams.get("region").toUpperCase();[0m
[30;1m113 | [0m[35m            log.info("login", `Got this account's message region: ${region}`);[0m
[30;1m114 | [0m[35m        } else {[0m
[30;1m115 | [0m[35m            let legacyFBMQTTMatch = html.match(/(\["MqttWebConfig",\[\],{fbid:")(.+?)(",appID:219994[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m    if (oldFBMQTTMatch) {[0m
[30;1m103 | [0m[35m        irisSeqID = oldFBMQTTMatch[1];[0m
[30;1m104 | [0m[35m        mqttEndpoint = oldFBMQTTMatch[2];[0m
[30;1m105 | [0m[35m        region = new URL(mqttEndpoint).searchParams.get("region").toUpperCase();[0m
[30;1m106 | [0m[35m        //log.info("login", `Got this account's message region: ${region}`);[0m
[30;1m107 | [0m[35m    } else {[0m
[30;1m108 | [0m[35m        let newFBMQTTMatch = html.match(/{"app_id":"219994525426954","endpoint":"(.+?)","iris_seq_id[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m476 | [0m[35m            });[0m
[30;1m477 | [0m[35m    }[0m
[30;1m478 | [0m[35m[0m
[30;1m479 | [0m[35m    // At the end we call the callback or catch an exception[0m
[30;1m480 | [0m[35m    mainPromise[0m
[30;1m481 | [0m[35m        .then(function() {[0m
[30;1m482 | [0m[35m            //log.info("login", 'Done logging in.');[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m449 | [0m[35m    mainPromise = mainPromise[0m
[30;1m450 | [0m[35m        .then(function(res) {[0m
[30;1m451 | [0m[35m            // Hacky check for the redirection that happens on some ISPs, which doesn't return statu[0m
[30;1m452 | [0m[35m            var reg = /<meta http-equiv="refresh" content="0;url=([^"]+)[^>]+>/;[0m
[30;1m453 | [0m[35m            var redirect = reg.exec(res.body);[0m
[30;1m454 | [0m[35m            if (redirect && redirect[1]) return utils.get(redirect[1], jar, null, globalOptions).the[0m
[30;1m455 | [0m[35m            return res;[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/index.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m246 | [0m[35m        // we used to get a bunch of cookies in the headers of the response of the[0m
[30;1m247 | [0m[35m        // request, but FB changed and they now send those cookies inside the JS.[0m
[30;1m248 | [0m[35m        // They run the JS which then injects the cookies in the page.[0m
[30;1m249 | [0m[35m        // The "solution" is to parse through the html and find those cookies[0m
[30;1m250 | [0m[35m        // which happen to be conveniently indicated with a _js_ in front of their[0m
[30;1m251 | [0m[35m        // variable name.[0m
[30;1m252 | [0m[35m        //[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m            // If there's at least one, we do the post request[0m
[30;1m508 | [0m[35m            if (formDeliveryReceipt["[0]"]) {[0m
[30;1m509 | [0m[35m              defaultFuncs.post([0m
[30;1m510 | [0m[35m                "https://www.facebook.com/ajax/mercury/delivery_receipts.php",[0m
[30;1m511 | [0m[35m                ctx.jar,[0m
[30;1m512 | [0m[35m                formDeliveryReceipt[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m                last_action_timestamp: ~~(Date.now() - 60)[0m
[30;1m134 | [0m[35m              };[0m
[30;1m135 | [0m[35m              defaultFuncs[0m
[30;1m136 | [0m[35m                .post([0m
[30;1m137 | [0m[35m                  "https://www.facebook.com/ajax/mercury/thread_sync.php",[0m
[30;1m138 | [0m[35m                  ctx.jar,[0m
[30;1m139 | [0m[35m                  form[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m            lastSync: ~~(lastSync / 1000)[0m
[30;1m124 | [0m[35m          };[0m
[30;1m125 | [0m[35m          defaultFuncs[0m
[30;1m126 | [0m[35m            .get("https://www.facebook.com/notifications/sync/", ctx.jar, form4)[0m
[30;1m127 | [0m[35m            .then(utils.saveCookies(ctx.jar))[0m
[30;1m128 | [0m[35m            .then(function() {[0m
[30;1m129 | [0m[35m              lastSync = Date.now();[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m      "https://www.facebook.com"[0m
[30;1m101 | [0m[35m    );[0m
[30;1m102 | [0m[35m    defaultFuncs[0m
[30;1m103 | [0m[35m      .get([0m
[30;1m104 | [0m[35m        "https://" + serverNumber + "-edge-chat.facebook.com/pull",[0m
[30;1m105 | [0m[35m        ctx.jar,[0m
[30;1m106 | [0m[35m        form[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m504 | [0m[35m                formDeliveryReceipt["[" + i + "]"] = val.message.mid;[0m
[30;1m505 | [0m[35m              });[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m            // If there's at least one, we do the post request[0m
[30;1m508 | [0m[35m            if (formDeliveryReceipt["[0]"]) {[0m
[30;1m509 | [0m[35m              defaultFuncs.post([0m
[30;1m510 | [0m[35m                "https://www.facebook.com/ajax/mercury/delivery_receipts.php",[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m476 | [0m[35m                      fmtMsg = utils.formatMessage(v);[0m
[30;1m477 | [0m[35m                    } catch (err) {[0m
[30;1m478 | [0m[35m                      return globalCallback({[0m
[30;1m479 | [0m[35m                        error: "Problem parsing message object. Please open an issue at https://gith[0m
[30;1m480 | [0m[35m                        detail: err,[0m
[30;1m481 | [0m[35m                        res: v,[0m
[30;1m482 | [0m[35m                        type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m436 | [0m[35m                          formattedEvent = utils.formatDeltaEvent(v.delta);[0m
[30;1m437 | [0m[35m                        } catch (err) {[0m
[30;1m438 | [0m[35m                          return globalCallback({[0m
[30;1m439 | [0m[35m                            error: "Problem parsing message object. Please open an issue at https://[0m
[30;1m440 | [0m[35m                            detail: err,[0m
[30;1m441 | [0m[35m                            res: v.delta,[0m
[30;1m442 | [0m[35m                            type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m417 | [0m[35m                            fmtMsg = utils.formatDeltaEvent(v.delta);[0m
[30;1m418 | [0m[35m                          } catch (err) {[0m
[30;1m419 | [0m[35m                            return globalCallback({[0m
[30;1m420 | [0m[35m                              error: "Problem parsing message object. Please open an issue at https:[0m
[30;1m421 | [0m[35m                              detail: err,[0m
[30;1m422 | [0m[35m                              res: v.delta,[0m
[30;1m423 | [0m[35m                              type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m398 | [0m[35m                        fmtMsg = utils.formatDeltaReadReceipt(v.delta);[0m
[30;1m399 | [0m[35m                      } catch (err) {[0m
[30;1m400 | [0m[35m                        return globalCallback({[0m
[30;1m401 | [0m[35m                          error: "Problem parsing message object. Please open an issue at https://gi[0m
[30;1m402 | [0m[35m                          detail: err,[0m
[30;1m403 | [0m[35m                          res: v.delta,[0m
[30;1m404 | [0m[35m                          type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m248 | [0m[35m                          fmtMsg = utils.formatDeltaMessage(v);[0m
[30;1m249 | [0m[35m                        } catch (err) {[0m
[30;1m250 | [0m[35m                          return globalCallback({[0m
[30;1m251 | [0m[35m                            error: "Problem parsing message object. Please open an issue at https://[0m
[30;1m252 | [0m[35m                            detail: err,[0m
[30;1m253 | [0m[35m                            res: v,[0m
[30;1m254 | [0m[35m                            type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m223 | [0m[35m                      );[0m
[30;1m224 | [0m[35m                    } catch (err) {[0m
[30;1m225 | [0m[35m                      return globalCallback({[0m
[30;1m226 | [0m[35m                        error: "Problem parsing message object. Please open an issue at https://gith[0m
[30;1m227 | [0m[35m                        detail: err,[0m
[30;1m228 | [0m[35m                        res: v.overlay[userID],[0m
[30;1m229 | [0m[35m                        type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m193 | [0m[35m                        );[0m
[30;1m194 | [0m[35m                      } catch (err) {[0m
[30;1m195 | [0m[35m                        return globalCallback({[0m
[30;1m196 | [0m[35m                          error: "Problem parsing message object. Please open an issue at https://gi[0m
[30;1m197 | [0m[35m                          detail: err,[0m
[30;1m198 | [0m[35m                          res: v.buddyList[userID],[0m
[30;1m199 | [0m[35m                          type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m170 | [0m[35m                    fmtMsg = utils.formatTyp(v);[0m
[30;1m171 | [0m[35m                  } catch (err) {[0m
[30;1m172 | [0m[35m                    return globalCallback({[0m
[30;1m173 | [0m[35m                      error: "Problem parsing message object. Please open an issue at https://github[0m
[30;1m174 | [0m[35m                      detail: err,[0m
[30;1m175 | [0m[35m                      res: v,[0m
[30;1m176 | [0m[35m                      type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35m            .forEach(function parsePackets(v) {[0m
[30;1m156 | [0m[35m              switch (v.type) {[0m
[30;1m157 | [0m[35m                // TODO: 'ttyp' was used before. It changed to 'typ'. We're keeping[0m
[30;1m158 | [0m[35m                // both for now but we should remove 'ttyp' at some point.[0m
[30;1m159 | [0m[35m                case "ttyp":[0m
[30;1m160 | [0m[35m                case "typ":[0m
[30;1m161 | [0m[35m                  if ([0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m71 | [0m[35m          fmtMsg = utils.formatRead(event);[0m
[30;1m72 | [0m[35m        } catch (err) {[0m
[30;1m73 | [0m[35m          globalCallback({[0m
[30;1m74 | [0m[35m            error: "Problem parsing message object. Please open an issue at https://github.com/Schma[0m
[30;1m75 | [0m[35m            detail: err,[0m
[30;1m76 | [0m[35m            res: event,[0m
[30;1m77 | [0m[35m            type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m          fmtMsg = utils.formatReadReceipt(event);[0m
[30;1m56 | [0m[35m        } catch (err) {[0m
[30;1m57 | [0m[35m          globalCallback({[0m
[30;1m58 | [0m[35m            error: "Problem parsing message object. Please open an issue at https://github.com/Schma[0m
[30;1m59 | [0m[35m            detail: err,[0m
[30;1m60 | [0m[35m            res: event,[0m
[30;1m61 | [0m[35m            type: "parse_error"[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/listen.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m528 | [0m[35m      })[0m
[30;1m529 | [0m[35m      .catch(function(err) {[0m
[30;1m530 | [0m[35m        if (err.code === "ETIMEDOUT") {[0m
[30;1m531 | [0m[35m          log.info("listen", "Suppressed timeout error.");[0m
[30;1m532 | [0m[35m        } else if (err.code === "EAI_AGAIN") {[0m
[30;1m533 | [0m[35m          serverNumber = (~~(Math.random() * 6)).toString();[0m
[30;1m534 | [0m[35m        } else {[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/removeUserFromGroup.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    };[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    defaultFuncs[0m
[30;1m32 | [0m[35m      .post("https://www.facebook.com/chat/remove_participants", ctx.jar, form)[0m
[30;1m33 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m34 | [0m[35m      .then(function (resData) {[0m
[30;1m35 | [0m[35m        if (!resData) throw { error: "Remove from group failed." };[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeArchivedStatus.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    else form["ids[" + threadOrThreads + "]"] = archive;[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    defaultFuncs[0m
[30;1m28 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/change_archived_status.php", ctx.jar, form)[0m
[30;1m29 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m30 | [0m[35m      .then(function (resData) {[0m
[30;1m31 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeBio.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    };[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    defaultFuncs[0m
[30;1m51 | [0m[35m      .post("https://www.facebook.com/api/graphql/", ctx.jar, form)[0m
[30;1m52 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m53 | [0m[35m      .then(function (resData) {[0m
[30;1m54 | [0m[35m        if (resData.errors) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadHistoryDeprecated.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m      if (ctx.globalOptions.pageID) form.request_user_id = ctx.globalOptions.pageID;[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m      defaultFuncs[0m
[30;1m37 | [0m[35m        .post("https://www.facebook.com/ajax/mercury/thread_info.php", ctx.jar, form)[0m
[30;1m38 | [0m[35m        .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m39 | [0m[35m        .then(function (resData) {[0m
[30;1m40 | [0m[35m          if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadPictures.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m              image_id: image.fbid[0m
[30;1m38 | [0m[35m            };[0m
[30;1m39 | [0m[35m            return defaultFuncs[0m
[30;1m40 | [0m[35m              .post("https://www.facebook.com/ajax/messaging/attachments/sharedphotos.php", ctx.jar,[0m
[30;1m41 | [0m[35m              .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m42 | [0m[35m              .then(function (resData) {[0m
[30;1m43 | [0m[35m                if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadPictures.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    };[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    defaultFuncs[0m
[30;1m29 | [0m[35m      .post("https://www.facebook.com/ajax/messaging/attachments/sharedphotos.php", ctx.jar, form)[0m
[30;1m30 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m31 | [0m[35m      .then(function (resData) {[0m
[30;1m32 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/setTitle.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m    };[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    defaultFuncs[0m
[30;1m56 | [0m[35m      .post("https://www.facebook.com/messaging/set_thread_name/", ctx.jar, form)[0m
[30;1m57 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m58 | [0m[35m      .then(function (resData) {[0m
[30;1m59 | [0m[35m        if (resData.error && resData.error === 1545012) throw { error: "Cannot change chat title: No[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getUserInfo.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m      form["ids[" + i + "]"] = v;[0m
[30;1m51 | [0m[35m    });[0m
[30;1m52 | [0m[35m    defaultFuncs[0m
[30;1m53 | [0m[35m      .post("https://www.facebook.com/chat/user_info/", ctx.jar, form)[0m
[30;1m54 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m55 | [0m[35m      .then(function (resData) {[0m
[30;1m56 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/markAsSeen.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    };[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    defaultFuncs[0m
[30;1m34 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/mark_seen.php", ctx.jar, form)[0m
[30;1m35 | [0m[35m      .then(utils.saveCookies(ctx.jar))[0m
[30;1m36 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m37 | [0m[35m      .then(function (resData) {[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/unsendMessage.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    };[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    defaultFuncs[0m
[30;1m27 | [0m[35m      .post("https://www.facebook.com/messaging/unsend_message/", ctx.jar, form)[0m
[30;1m28 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m29 | [0m[35m      .then(function (resData) {[0m
[30;1m30 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadInfoDeprecated.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m      if (ctx.globalOptions.pageId) form.request_user_id = ctx.globalOptions.pageId;[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m      defaultFuncs[0m
[30;1m34 | [0m[35m        .post("https://www.facebook.com/ajax/mercury/thread_info.php", ctx.jar, form)[0m
[30;1m35 | [0m[35m        .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m36 | [0m[35m        .then(function (resData) {[0m
[30;1m37 | [0m[35m          if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadListDeprecated.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    if (ctx.globalOptions.pageID) form.request_user_id = ctx.globalOptions.pageID;[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    defaultFuncs[0m
[30;1m34 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/threadlist_info.php", ctx.jar, form)[0m
[30;1m35 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m36 | [0m[35m      .then(function (resData) {[0m
[30;1m37 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/handleMessageRequest.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    for (var i = 0; i < threadID.length; i++) form[messageBox + "[" + i + "]"] = threadID[i];[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    defaultFuncs[0m
[30;1m34 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/move_thread.php", ctx.jar, form)[0m
[30;1m35 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m36 | [0m[35m      .then(function (resData) {[0m
[30;1m37 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/markAsReadAll.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    };[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    defaultFuncs[0m
[30;1m27 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/mark_folder_as_read.php", ctx.jar, form)[0m
[30;1m28 | [0m[35m      .then(utils.saveCookies(ctx.jar))[0m
[30;1m29 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m30 | [0m[35m      .then(function (resData) {[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/httpPost.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    }[0m
[30;1m36 | [0m[35m    else {[0m
[30;1m37 | [0m[35m      defaultFuncs[0m
[30;1m38 | [0m[35m        .post(url, ctx.jar, form, {})[0m
[30;1m39 | [0m[35m        .then(resData => callback(null, resData.body.toString()))[0m
[30;1m40 | [0m[35m        .catch(function (err) {[0m
[30;1m41 | [0m[35m          log.error("httpPost", err);[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/httpPost.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    if (notAPI) {[0m
[30;1m28 | [0m[35m      utils[0m
[30;1m29 | [0m[35m        .post(url, ctx.jar, form, ctx.globalOptions)[0m
[30;1m30 | [0m[35m        .then(resData => callback(null, resData.body.toString()))[0m
[30;1m31 | [0m[35m        .catch(function (err) {[0m
[30;1m32 | [0m[35m          log.error("httpPost", err);[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/muteThread.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    };[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    defaultFuncs[0m
[30;1m30 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/change_mute_thread.php", ctx.jar, form)[0m
[30;1m31 | [0m[35m      .then(utils.saveCookies(ctx.jar))[0m
[30;1m32 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m33 | [0m[35m      .then(function (resData) {[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/unfriend.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    };[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    defaultFuncs[0m
[30;1m30 | [0m[35m      .post("https://www.facebook.com/ajax/profile/removefriendconfirm.php", ctx.jar, form)[0m
[30;1m31 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m32 | [0m[35m      .then(function (resData) {[0m
[30;1m33 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadInfo.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m    };[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    defaultFuncs[0m
[30;1m151 | [0m[35m      .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m152 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m153 | [0m[35m      .then(function (resData) {[0m
[30;1m154 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadInfo.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m    }[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    // `queries` has to be a string. I couldn't tell from the dev console. This[0m
[30;1m132 | [0m[35m    // took me a really long time to figure out. I deserve a cookie for this.[0m
[30;1m133 | [0m[35m    var form = {[0m
[30;1m134 | [0m[35m      queries: JSON.stringify({[0m
[30;1m135 | [0m[35m        o0: {[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadList.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m    };[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    defaultFuncs[0m
[30;1m189 | [0m[35m      .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m190 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m191 | [0m[35m      .then((resData) => {[0m
[30;1m192 | [0m[35m        if (resData[resData.length - 1].error_results > 0) throw resData[0].o0.errors;[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadList.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m          isMessageBlockedByViewer: p.is_message_blocked_by_viewer, // true/false[0m
[30;1m58 | [0m[35m        };[0m
[30;1m59 | [0m[35m      default:[0m
[30;1m60 | [0m[35m        log.warn("getThreadList", "Found participant with unsupported typename. Please open an issue[0m
[30;1m61 | [0m[35m        return {[0m
[30;1m62 | [0m[35m          accountType: p["__typename"],[0m
[30;1m63 | [0m[35m          userID: utils.formatID(p.id.toString()),[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadList.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35mabled: t.customization_enabled, // false for ONE_TO_ONE with Page or ReducedMessagingActor[0m
[30;1m114 | [0m[35m      participantAddMode: t.participant_add_mode_as_string, // "ADD" if "GROUP" and null if "ONE_TO_[0m
[30;1m115 | [0m[35m      montageThread: t.montage_thread ? Buffer.from(t.montage_thread.id, "base64").toString() : null[0m
[30;1m116 | [0m[35m      // it is not userID nor any other ID known to me...[0m
[30;1m117 | [0m[35m      // can somebody inspect it? where is it used?[0m
[30;1m118 | [0m[35m      // probably Messenger Day uses it[0m
[30;1m119 | [0m[35m      reactionsMuteMode: t.reactions_mute_mode,[0m
[30;1m120 | [0m[35m      mentionsMuteMode: t.mentions_mute_mode,[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadList.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m          accountType: p["__typename"],[0m
[30;1m52 | [0m[35m          userID: utils.formatID(p.id.toString()),[0m
[30;1m53 | [0m[35m          name: p.name,[0m
[30;1m54 | [0m[35m          url: createProfileUrl(p.url, p.username, p.id), // in this case p.url is null all the time[0m
[30;1m55 | [0m[35m          profilePicture: p.big_image_src.uri, // in this case it is default facebook photo, we coul[0m
[30;1m56 | [0m[35m          username: (p.username || null), // maybe we could use it to generate profile URL?[0m
[30;1m57 | [0m[35m          isMessageBlockedByViewer: p.is_message_blocked_by_viewer, // true/false[0m
[30;1m58 | [0m[35m        };[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/resolvePhotoUrl.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    }[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    defaultFuncs[0m
[30;1m23 | [0m[35m      .get("https://www.facebook.com/mercury/attachments/photo", ctx.jar, { photo_id: photoID })[0m
[30;1m24 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m25 | [0m[35m      .then(resData => {[0m
[30;1m26 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m    };[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m    defaultFuncs[0m
[30;1m520 | [0m[35m      .post("https://www.facebook.com/api/graphqlbatch/", ctx.jar, form)[0m
[30;1m521 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m522 | [0m[35m      .then(function (resData) {[0m
[30;1m523 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/getThreadHistory.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m498 | [0m[35m    }[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m    // `queries` has to be a string. I couldn't tell from the dev console. This[0m
[30;1m501 | [0m[35m    // took me a really long time to figure out. I deserve a cookie for this.[0m
[30;1m502 | [0m[35m    var form = {[0m
[30;1m503 | [0m[35m      "av": ctx.globalOptions.pageID,[0m
[30;1m504 | [0m[35m      queries: JSON.stringify({[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/forwardAttachment.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    for (var i = 0; i < userOrUsers.length; i++) form["recipient_map[" + (timestamp + i) + "]"] = us[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    defaultFuncs[0m
[30;1m34 | [0m[35m      .post("https://www.facebook.com/mercury/attachments/forward/", ctx.jar, form)[0m
[30;1m35 | [0m[35m      .then(utils.parseAndCheckLogin(ctx.jar, defaultFuncs))[0m
[30;1m36 | [0m[35m      .then(function (resData) {[0m
[30;1m37 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/forwardAttachment.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    var timestamp = Math.floor(Date.now() / 1000);[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    //That's good, the key of the array is really timestmap in seconds + index[0m
[30;1m30 | [0m[35m    //Probably time when the attachment will be sent?[0m
[30;1m31 | [0m[35m    for (var i = 0; i < userOrUsers.length; i++) form["recipient_map[" + (timestamp + i) + "]"] = us[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    defaultFuncs[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/sendMessage.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m        }[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        defaultFuncs[0m
[30;1m107 | [0m[35m            .post("https://www.facebook.com/messaging/send/", ctx.jar, form)[0m
[30;1m108 | [0m[35m            .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m109 | [0m[35m            .then(function(resData) {[0m
[30;1m110 | [0m[35m                if (!resData) return callback({ error: "Send message failed." });[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/sendMessage.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m        };[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        defaultFuncs[0m
[30;1m61 | [0m[35m            .post("https://www.facebook.com/message_share_attachment/fromURI/", ctx.jar, form)[0m
[30;1m62 | [0m[35m            .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m63 | [0m[35m            .then(function(resData) {[0m
[30;1m64 | [0m[35m                if (resData.error) return callback(resData);[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/createPoll.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    }[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    defaultFuncs[0m
[30;1m46 | [0m[35m      .post("https://www.facebook.com/messaging/group_polling/create_poll/?dpr=1", ctx.jar, form)[0m
[30;1m47 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m48 | [0m[35m      .then(function (resData) {[0m
[30;1m49 | [0m[35m        if (resData.payload.status != "success") throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m> ```[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m6. I'm getting some crazy weird syntax error like `SyntaxError: Unexpected token [`!!![0m
[30;1m181 | [0m[35m> Please try to update your version of node.js before submitting an issue of this nature.  We like t[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m7. I don't want all of these logging messages![0m
[30;1m184 | [0m[35m> You can use `api.setOptions` to silence the logging. You get the `api` object from `login` (see ex[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mResult:[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m<img width="517" alt="screen shot 2016-11-04 at 14 36 00" src="https://cloud.githubusercontent.com/a[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m## Documentation[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35mp chats.[0m
[30;1m216 | [0m[35m- [Miscord](https://github.com/Bjornskjald/miscord) - An easy-to-use Facebook bridge for Discord.[0m
[30;1m217 | [0m[35m- [chat-bridge](https://github.com/rexx0520/chat-bridge) - A Messenger, Telegram and IRC chat bridge[0m
[30;1m218 | [0m[35m- [messenger-auto-reply](https://gitlab.com/theSander/messenger-auto-reply) - An auto-reply service [0m
[30;1m219 | [0m[35m- [BotCore](https://github.com/AstroCB/BotCore) – A collection of tools for writing and managing Fac[0m
[30;1m220 | [0m[35m- [mnotify](https://github.com/AstroCB/mnotify) – A command-line utility for sending alerts and noti[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m------------------------------------[0m
[30;1m96 | [0m[35m### Saving session.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35mTo avoid logging in every time you should save AppState (cookies etc.) to a file, then you can use i[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m__Example__[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35mNote that a message can only be a regular message (which can be empty) and optionally one of the fol[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m__Tip__: to find your own ID, you can look inside the cookies. The `userID` is under the name `c_use[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m__Example (Basic Message)__[0m
[30;1m66 | [0m[35m```js[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/markAsDelivered.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    form["thread_ids[" + threadID + "][0]"] = messageID;[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    defaultFuncs[0m
[30;1m30 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/delivery_receipts.php", ctx.jar, form)[0m
[30;1m31 | [0m[35m      .then(utils.saveCookies(ctx.jar))[0m
[30;1m32 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m33 | [0m[35m      .then(function (resData) {[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/addUserToGroup.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    }[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    defaultFuncs[0m
[30;1m62 | [0m[35m      .post("https://www.facebook.com/messaging/send/", ctx.jar, form)[0m
[30;1m63 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m64 | [0m[35m      .then(function (resData) {[0m
[30;1m65 | [0m[35m        if (!resData) throw { error: "Add to group failed." };[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeBlockedStatus.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    }[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    defaultFuncs[0m
[30;1m23 | [0m[35m      .post(`https://www.facebook.com/messaging/${block ? "" : "un"}block_messages/`, ctx.jar, { fbi[0m
[30;1m24 | [0m[35m      .then(utils.saveCookies(ctx.jar))[0m
[30;1m25 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m26 | [0m[35m      .then(function (resData) {[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/searchForThread.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    };[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    defaultFuncs[0m
[30;1m30 | [0m[35m      .post("https://www.facebook.com/ajax/mercury/search_threads.php", ctx.jar, tmpForm)[0m
[30;1m31 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m32 | [0m[35m      .then(function (resData) {[0m
[30;1m33 | [0m[35m        if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/searchForThread.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m32 | [0m[35m      .then(function (resData) {[0m
[30;1m33 | [0m[35m        if (resData.error) throw resData;[0m
[30;1m34 | [0m[35m        if (!resData.payload.mercury_payload.threads) return callback({ error: "Could not find threa[0m
[30;1m35 | [0m[35m        return callback([0m
[30;1m36 | [0m[35m          null,[0m
[30;1m37 | [0m[35m          resData.payload.mercury_payload.threads.map(utils.formatThread)[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/sendTypingIndicator.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        // If id is single person chat[0m
[30;1m37 | [0m[35m        if (Object.keys(res).length > 0) form.to = threadID;[0m
[30;1m38 | [0m[35m        defaultFuncs[0m
[30;1m39 | [0m[35m          .post("https://www.facebook.com/ajax/messaging/typ.php", ctx.jar, form)[0m
[30;1m40 | [0m[35m          .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m41 | [0m[35m          .then(function (resData) {[0m
[30;1m42 | [0m[35m            if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/sendTypingIndicator.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m      if (!isGroup) form.to = threadID;[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m      defaultFuncs[0m
[30;1m21 | [0m[35m        .post("https://www.facebook.com/ajax/messaging/typ.php", ctx.jar, form)[0m
[30;1m22 | [0m[35m        .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m23 | [0m[35m        .then(function (resData) {[0m
[30;1m24 | [0m[35m          if (resData.error) throw resData;[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/markAsRead.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m      try {[0m
[30;1m29 | [0m[35m        resData = await ([0m
[30;1m30 | [0m[35m          defaultFuncs[0m
[30;1m31 | [0m[35m            .post("https://www.facebook.com/ajax/mercury/change_read_status.php", ctx.jar, form)[0m
[30;1m32 | [0m[35m            .then(utils.saveCookies(ctx.jar))[0m
[30;1m33 | [0m[35m            .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m34 | [0m[35m        );[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/logout.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m        if (!res.headers) throw { error: "An error occurred when logging out." };[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        return defaultFuncs[0m
[30;1m53 | [0m[35m          .get(res.headers.location, ctx.jar)[0m
[30;1m54 | [0m[35m          .then(utils.saveCookies(ctx.jar));[0m
[30;1m55 | [0m[35m      })[0m
[30;1m56 | [0m[35m      .then(function () {[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/logout.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        };[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        return defaultFuncs[0m
[30;1m46 | [0m[35m          .post("https://www.facebook.com/logout.php", ctx.jar, form)[0m
[30;1m47 | [0m[35m          .then(utils.saveCookies(ctx.jar));[0m
[30;1m48 | [0m[35m      })[0m
[30;1m49 | [0m[35m      .then(function (res) {[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/logout.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    };[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    defaultFuncs[0m
[30;1m28 | [0m[35m      .post("https://www.facebook.com/bluebar/modern_settings_menu/?help_type=364455653583099&show_c[0m
[30;1m29 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m30 | [0m[35m      .then(function (resData) {[0m
[30;1m31 | [0m[35m        var elem = resData.jsmods.instances[0][2][0].filter(function (v) {[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeNickname.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    };[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    defaultFuncs[0m
[30;1m28 | [0m[35m      .post("https://www.facebook.com/messaging/save_thread_nickname/?source=thread_settings&dpr=1",[0m
[30;1m29 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m30 | [0m[35m      .then(function (resData) {[0m
[30;1m31 | [0m[35m        if (resData.error === 1545014) throw { error: "Trying to change nickname of user isn't in th[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeNickname.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35m        return callback();[0m
[30;1m35 | [0m[35m      })[0m
[30;1m36 | [0m[35m      .catch(function (err) {[0m
[30;1m37 | [0m[35m        log.error("changeNickname", "Trying to change user nickname of a thread that doesn't exist. [0m
[30;1m38 | [0m[35m        return callback(err);[0m
[30;1m39 | [0m[35m      });[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m231[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/src/changeNickname.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m      .then(utils.parseAndCheckLogin(ctx, defaultFuncs))[0m
[30;1m30 | [0m[35m      .then(function (resData) {[0m
[30;1m31 | [0m[35m        if (resData.error === 1545014) throw { error: "Trying to change nickname of user isn't in th[0m
[30;1m32 | [0m[35m        if (resData.error === 1357031) throw { error: "Trying to change user nickname of a thread th[0m
[30;1m33 | [0m[35m        if (resData.error) throw resData;[0m
[30;1m34 | [0m[35m        return callback();[0m
[30;1m35 | [0m[35m      })[0m

231 matches found.
